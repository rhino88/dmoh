/*!
 * jQuery JavaScript Library v1.8.3
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Tue Nov 13 2012 08:20:33 GMT-0500 (Eastern Standard Time)
 */
(function(a2,aB){var w,af,o=a2.document,aI=a2.location,d=a2.navigator,bg=a2.jQuery,I=a2.$,am=Array.prototype.push,a4=Array.prototype.slice,aK=Array.prototype.indexOf,z=Object.prototype.toString,V=Object.prototype.hasOwnProperty,aO=String.prototype.trim,bG=function(e,bZ){return new bG.fn.init(e,bZ,w)
},bx=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,aa=/\S/,aV=/\s+/,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bo=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bf=/^[\],:{}\s]*$/,bi=/(?:^|:|,)(?:\s*\[)+/g,bD=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,a0=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,bP=/^-ms-/,aU=/-([\da-z])/gi,N=function(e,bZ){return(bZ+"").toUpperCase()
},aF=function(){if(o.addEventListener){o.removeEventListener("DOMContentLoaded",aF,false);
bG.ready()
}else{if(o.readyState==="complete"){o.detachEvent("onreadystatechange",aF);
bG.ready()
}}},Z={};
bG.fn=bG.prototype={constructor:bG,init:function(e,b2,b1){var b0,b3,bZ,b4;
if(!e){return this
}if(e.nodeType){this.context=this[0]=e;
this.length=1;
return this
}if(typeof e==="string"){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3){b0=[null,e,null]
}else{b0=bo.exec(e)
}if(b0&&(b0[1]||!b2)){if(b0[1]){b2=b2 instanceof bG?b2[0]:b2;
b4=(b2&&b2.nodeType?b2.ownerDocument||b2:o);
e=bG.parseHTML(b0[1],b4,true);
if(a.test(b0[1])&&bG.isPlainObject(b2)){this.attr.call(e,b2,true)
}return bG.merge(this,e)
}else{b3=o.getElementById(b0[2]);
if(b3&&b3.parentNode){if(b3.id!==b0[2]){return b1.find(e)
}this.length=1;
this[0]=b3
}this.context=o;
this.selector=e;
return this
}}else{if(!b2||b2.jquery){return(b2||b1).find(e)
}else{return this.constructor(b2).find(e)
}}}else{if(bG.isFunction(e)){return b1.ready(e)
}}if(e.selector!==aB){this.selector=e.selector;
this.context=e.context
}return bG.makeArray(e,this)
},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length
},toArray:function(){return a4.call(this)
},get:function(e){return e==null?this.toArray():(e<0?this[this.length+e]:this[e])
},pushStack:function(bZ,b1,e){var b0=bG.merge(this.constructor(),bZ);
b0.prevObject=this;
b0.context=this.context;
if(b1==="find"){b0.selector=this.selector+(this.selector?" ":"")+e
}else{if(b1){b0.selector=this.selector+"."+b1+"("+e+")"
}}return b0
},each:function(bZ,e){return bG.each(this,bZ,e)
},ready:function(e){bG.ready.promise().done(e);
return this
},eq:function(e){e=+e;
return e===-1?this.slice(e):this.slice(e,e+1)
},first:function(){return this.eq(0)
},last:function(){return this.eq(-1)
},slice:function(){return this.pushStack(a4.apply(this,arguments),"slice",a4.call(arguments).join(","))
},map:function(e){return this.pushStack(bG.map(this,function(b0,bZ){return e.call(b0,bZ,b0)
}))
},end:function(){return this.prevObject||this.constructor(null)
},push:am,sort:[].sort,splice:[].splice};
bG.fn.init.prototype=bG.fn;
bG.extend=bG.fn.extend=function(){var b7,b0,e,bZ,b4,b5,b3=arguments[0]||{},b2=1,b1=arguments.length,b6=false;
if(typeof b3==="boolean"){b6=b3;
b3=arguments[1]||{};
b2=2
}if(typeof b3!=="object"&&!bG.isFunction(b3)){b3={}
}if(b1===b2){b3=this;
--b2
}for(;
b2<b1;
b2++){if((b7=arguments[b2])!=null){for(b0 in b7){e=b3[b0];
bZ=b7[b0];
if(b3===bZ){continue
}if(b6&&bZ&&(bG.isPlainObject(bZ)||(b4=bG.isArray(bZ)))){if(b4){b4=false;
b5=e&&bG.isArray(e)?e:[]
}else{b5=e&&bG.isPlainObject(e)?e:{}
}b3[b0]=bG.extend(b6,b5,bZ)
}else{if(bZ!==aB){b3[b0]=bZ
}}}}}return b3
};
bG.extend({noConflict:function(e){if(a2.$===bG){a2.$=I
}if(e&&a2.jQuery===bG){a2.jQuery=bg
}return bG
},isReady:false,readyWait:1,holdReady:function(e){if(e){bG.readyWait++
}else{bG.ready(true)
}},ready:function(e){if(e===true?--bG.readyWait:bG.isReady){return
}if(!o.body){return setTimeout(bG.ready,1)
}bG.isReady=true;
if(e!==true&&--bG.readyWait>0){return
}af.resolveWith(o,[bG]);
if(bG.fn.trigger){bG(o).trigger("ready").off("ready")
}},isFunction:function(e){return bG.type(e)==="function"
},isArray:Array.isArray||function(e){return bG.type(e)==="array"
},isWindow:function(e){return e!=null&&e==e.window
},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)
},type:function(e){return e==null?String(e):Z[z.call(e)]||"object"
},isPlainObject:function(b1){if(!b1||bG.type(b1)!=="object"||b1.nodeType||bG.isWindow(b1)){return false
}try{if(b1.constructor&&!V.call(b1,"constructor")&&!V.call(b1.constructor.prototype,"isPrototypeOf")){return false
}}catch(b0){return false
}var bZ;
for(bZ in b1){}return bZ===aB||V.call(b1,bZ)
},isEmptyObject:function(bZ){var e;
for(e in bZ){return false
}return true
},error:function(e){throw new Error(e)
},parseHTML:function(b1,b0,e){var bZ;
if(!b1||typeof b1!=="string"){return null
}if(typeof b0==="boolean"){e=b0;
b0=0
}b0=b0||o;
if((bZ=a.exec(b1))){return[b0.createElement(bZ[1])]
}bZ=bG.buildFragment([b1],b0,e?null:[]);
return bG.merge([],(bZ.cacheable?bG.clone(bZ.fragment):bZ.fragment).childNodes)
},parseJSON:function(e){if(!e||typeof e!=="string"){return null
}e=bG.trim(e);
if(a2.JSON&&a2.JSON.parse){return a2.JSON.parse(e)
}if(bf.test(e.replace(bD,"@").replace(a0,"]").replace(bi,""))){return(new Function("return "+e))()
}bG.error("Invalid JSON: "+e)
},parseXML:function(b1){var bZ,b0;
if(!b1||typeof b1!=="string"){return null
}try{if(a2.DOMParser){b0=new DOMParser();
bZ=b0.parseFromString(b1,"text/xml")
}else{bZ=new ActiveXObject("Microsoft.XMLDOM");
bZ.async="false";
bZ.loadXML(b1)
}}catch(b2){bZ=aB
}if(!bZ||!bZ.documentElement||bZ.getElementsByTagName("parsererror").length){bG.error("Invalid XML: "+b1)
}return bZ
},noop:function(){},globalEval:function(e){if(e&&aa.test(e)){(a2.execScript||function(bZ){a2["eval"].call(a2,bZ)
})(e)
}},camelCase:function(e){return e.replace(bP,"ms-").replace(aU,N)
},nodeName:function(bZ,e){return bZ.nodeName&&bZ.nodeName.toLowerCase()===e.toLowerCase()
},each:function(b3,b4,b0){var bZ,b1=0,b2=b3.length,e=b2===aB||bG.isFunction(b3);
if(b0){if(e){for(bZ in b3){if(b4.apply(b3[bZ],b0)===false){break
}}}else{for(;
b1<b2;
){if(b4.apply(b3[b1++],b0)===false){break
}}}}else{if(e){for(bZ in b3){if(b4.call(b3[bZ],bZ,b3[bZ])===false){break
}}}else{for(;
b1<b2;
){if(b4.call(b3[b1],b1,b3[b1++])===false){break
}}}}return b3
},trim:aO&&!aO.call("\uFEFF\xA0")?function(e){return e==null?"":aO.call(e)
}:function(e){return e==null?"":(e+"").replace(C,"")
},makeArray:function(e,b0){var b1,bZ=b0||[];
if(e!=null){b1=bG.type(e);
if(e.length==null||b1==="string"||b1==="function"||b1==="regexp"||bG.isWindow(e)){am.call(bZ,e)
}else{bG.merge(bZ,e)
}}return bZ
},inArray:function(b1,bZ,b0){var e;
if(bZ){if(aK){return aK.call(bZ,b1,b0)
}e=bZ.length;
b0=b0?b0<0?Math.max(0,e+b0):b0:0;
for(;
b0<e;
b0++){if(b0 in bZ&&bZ[b0]===b1){return b0
}}}return -1
},merge:function(b2,b0){var e=b0.length,b1=b2.length,bZ=0;
if(typeof e==="number"){for(;
bZ<e;
bZ++){b2[b1++]=b0[bZ]
}}else{while(b0[bZ]!==aB){b2[b1++]=b0[bZ++]
}}b2.length=b1;
return b2
},grep:function(bZ,b4,e){var b3,b0=[],b1=0,b2=bZ.length;
e=!!e;
for(;
b1<b2;
b1++){b3=!!b4(bZ[b1],b1);
if(e!==b3){b0.push(bZ[b1])
}}return b0
},map:function(e,b5,b6){var b3,b4,b2=[],b0=0,bZ=e.length,b1=e instanceof bG||bZ!==aB&&typeof bZ==="number"&&((bZ>0&&e[0]&&e[bZ-1])||bZ===0||bG.isArray(e));
if(b1){for(;
b0<bZ;
b0++){b3=b5(e[b0],b0,b6);
if(b3!=null){b2[b2.length]=b3
}}}else{for(b4 in e){b3=b5(e[b4],b4,b6);
if(b3!=null){b2[b2.length]=b3
}}}return b2.concat.apply([],b2)
},guid:1,proxy:function(b2,b1){var b0,e,bZ;
if(typeof b1==="string"){b0=b2[b1];
b1=b2;
b2=b0
}if(!bG.isFunction(b2)){return aB
}e=a4.call(arguments,2);
bZ=function(){return b2.apply(b1,e.concat(a4.call(arguments)))
};
bZ.guid=b2.guid=b2.guid||bG.guid++;
return bZ
},access:function(e,b4,b7,b5,b2,b8,b6){var b0,b3=b7==null,b1=0,bZ=e.length;
if(b7&&typeof b7==="object"){for(b1 in b7){bG.access(e,b4,b1,b7[b1],1,b8,b5)
}b2=1
}else{if(b5!==aB){b0=b6===aB&&bG.isFunction(b5);
if(b3){if(b0){b0=b4;
b4=function(ca,b9,cb){return b0.call(bG(ca),cb)
}
}else{b4.call(e,b5);
b4=null
}}if(b4){for(;
b1<bZ;
b1++){b4(e[b1],b7,b0?b5.call(e[b1],b1,b4(e[b1],b7)):b5,b6)
}}b2=1
}}return b2?e:b3?b4.call(e):bZ?b4(e[0],b7):b8
},now:function(){return(new Date()).getTime()
}});
bG.ready.promise=function(b2){if(!af){af=bG.Deferred();
if(o.readyState==="complete"){setTimeout(bG.ready,1)
}else{if(o.addEventListener){o.addEventListener("DOMContentLoaded",aF,false);
a2.addEventListener("load",bG.ready,false)
}else{o.attachEvent("onreadystatechange",aF);
a2.attachEvent("onload",bG.ready);
var b1=false;
try{b1=a2.frameElement==null&&o.documentElement
}catch(b0){}if(b1&&b1.doScroll){(function bZ(){if(!bG.isReady){try{b1.doScroll("left")
}catch(b3){return setTimeout(bZ,50)
}bG.ready()
}})()
}}}}return af.promise(b2)
};
bG.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(bZ,e){Z["[object "+e+"]"]=e.toLowerCase()
});
w=bG(o);
var bU={};
function ac(bZ){var e=bU[bZ]={};
bG.each(bZ.split(aV),function(b1,b0){e[b0]=true
});
return e
}bG.Callbacks=function(b8){b8=typeof b8==="string"?(bU[b8]||ac(b8)):bG.extend({},b8);
var b1,e,b2,b0,b3,b4,b5=[],b6=!b8.once&&[],bZ=function(b9){b1=b8.memory&&b9;
e=true;
b4=b0||0;
b0=0;
b3=b5.length;
b2=true;
for(;
b5&&b4<b3;
b4++){if(b5[b4].apply(b9[0],b9[1])===false&&b8.stopOnFalse){b1=false;
break
}}b2=false;
if(b5){if(b6){if(b6.length){bZ(b6.shift())
}}else{if(b1){b5=[]
}else{b7.disable()
}}}},b7={add:function(){if(b5){var ca=b5.length;
(function b9(cb){bG.each(cb,function(cd,cc){var ce=bG.type(cc);
if(ce==="function"){if(!b8.unique||!b7.has(cc)){b5.push(cc)
}}else{if(cc&&cc.length&&ce!=="string"){b9(cc)
}}})
})(arguments);
if(b2){b3=b5.length
}else{if(b1){b0=ca;
bZ(b1)
}}}return this
},remove:function(){if(b5){bG.each(arguments,function(cb,b9){var ca;
while((ca=bG.inArray(b9,b5,ca))>-1){b5.splice(ca,1);
if(b2){if(ca<=b3){b3--
}if(ca<=b4){b4--
}}}})
}return this
},has:function(b9){return bG.inArray(b9,b5)>-1
},empty:function(){b5=[];
return this
},disable:function(){b5=b6=b1=aB;
return this
},disabled:function(){return !b5
},lock:function(){b6=aB;
if(!b1){b7.disable()
}return this
},locked:function(){return !b6
},fireWith:function(ca,b9){b9=b9||[];
b9=[ca,b9.slice?b9.slice():b9];
if(b5&&(!e||b6)){if(b2){b6.push(b9)
}else{bZ(b9)
}}return this
},fire:function(){b7.fireWith(this,arguments);
return this
},fired:function(){return !!e
}};
return b7
};
bG.extend({Deferred:function(b0){var bZ=[["resolve","done",bG.Callbacks("once memory"),"resolved"],["reject","fail",bG.Callbacks("once memory"),"rejected"],["notify","progress",bG.Callbacks("memory")]],b1="pending",b2={state:function(){return b1
},always:function(){e.done(arguments).fail(arguments);
return this
},then:function(){var b3=arguments;
return bG.Deferred(function(b4){bG.each(bZ,function(b6,b5){var b8=b5[0],b7=b3[b6];
e[b5[1]](bG.isFunction(b7)?function(){var b9=b7.apply(this,arguments);
if(b9&&bG.isFunction(b9.promise)){b9.promise().done(b4.resolve).fail(b4.reject).progress(b4.notify)
}else{b4[b8+"With"](this===e?b4:this,[b9])
}}:b4[b8])
});
b3=null
}).promise()
},promise:function(b3){return b3!=null?bG.extend(b3,b2):b2
}},e={};
b2.pipe=b2.then;
bG.each(bZ,function(b4,b3){var b6=b3[2],b5=b3[3];
b2[b3[1]]=b6.add;
if(b5){b6.add(function(){b1=b5
},bZ[b4^1][2].disable,bZ[2][2].lock)
}e[b3[0]]=b6.fire;
e[b3[0]+"With"]=b6.fireWith
});
b2.promise(e);
if(b0){b0.call(e,e)
}return e
},when:function(b2){var b0=0,b4=a4.call(arguments),e=b4.length,bZ=e!==1||(b2&&bG.isFunction(b2.promise))?e:0,b7=bZ===1?b2:bG.Deferred(),b1=function(b9,ca,b8){return function(cb){ca[b9]=this;
b8[b9]=arguments.length>1?a4.call(arguments):cb;
if(b8===b6){b7.notifyWith(ca,b8)
}else{if(!(--bZ)){b7.resolveWith(ca,b8)
}}}
},b6,b3,b5;
if(e>1){b6=new Array(e);
b3=new Array(e);
b5=new Array(e);
for(;
b0<e;
b0++){if(b4[b0]&&bG.isFunction(b4[b0].promise)){b4[b0].promise().done(b1(b0,b5,b4)).fail(b7.reject).progress(b1(b0,b3,b6))
}else{--bZ
}}}if(!bZ){b7.resolveWith(b5,b4)
}return b7.promise()
}});
bG.support=(function(){var cb,ca,b8,b9,b2,b7,b6,b4,b3,b1,bZ,b0=o.createElement("div");
b0.setAttribute("className","t");
b0.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
ca=b0.getElementsByTagName("*");
b8=b0.getElementsByTagName("a")[0];
if(!ca||!b8||!ca.length){return{}
}b9=o.createElement("select");
b2=b9.appendChild(o.createElement("option"));
b7=b0.getElementsByTagName("input")[0];
b8.style.cssText="top:1px;float:left;opacity:.5";
cb={leadingWhitespace:(b0.firstChild.nodeType===3),tbody:!b0.getElementsByTagName("tbody").length,htmlSerialize:!!b0.getElementsByTagName("link").length,style:/top/.test(b8.getAttribute("style")),hrefNormalized:(b8.getAttribute("href")==="/a"),opacity:/^0.5/.test(b8.style.opacity),cssFloat:!!b8.style.cssFloat,checkOn:(b7.value==="on"),optSelected:b2.selected,getSetAttribute:b0.className!=="t",enctype:!!o.createElement("form").enctype,html5Clone:o.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:(o.compatMode==="CSS1Compat"),submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,boxSizingReliable:true,pixelPosition:false};
b7.checked=true;
cb.noCloneChecked=b7.cloneNode(true).checked;
b9.disabled=true;
cb.optDisabled=!b2.disabled;
try{delete b0.test
}catch(b5){cb.deleteExpando=false
}if(!b0.addEventListener&&b0.attachEvent&&b0.fireEvent){b0.attachEvent("onclick",bZ=function(){cb.noCloneEvent=false
});
b0.cloneNode(true).fireEvent("onclick");
b0.detachEvent("onclick",bZ)
}b7=o.createElement("input");
b7.value="t";
b7.setAttribute("type","radio");
cb.radioValue=b7.value==="t";
b7.setAttribute("checked","checked");
b7.setAttribute("name","t");
b0.appendChild(b7);
b6=o.createDocumentFragment();
b6.appendChild(b0.lastChild);
cb.checkClone=b6.cloneNode(true).cloneNode(true).lastChild.checked;
cb.appendChecked=b7.checked;
b6.removeChild(b7);
b6.appendChild(b0);
if(b0.attachEvent){for(b3 in {submit:true,change:true,focusin:true}){b4="on"+b3;
b1=(b4 in b0);
if(!b1){b0.setAttribute(b4,"return;");
b1=(typeof b0[b4]==="function")
}cb[b3+"Bubbles"]=b1
}}bG(function(){var cc,cg,ce,cf,cd="padding:0;margin:0;border:0;display:block;overflow:hidden;",e=o.getElementsByTagName("body")[0];
if(!e){return
}cc=o.createElement("div");
cc.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px";
e.insertBefore(cc,e.firstChild);
cg=o.createElement("div");
cc.appendChild(cg);
cg.innerHTML="<table><tr><td></td><td>t</td></tr></table>";
ce=cg.getElementsByTagName("td");
ce[0].style.cssText="padding:0;margin:0;border:0;display:none";
b1=(ce[0].offsetHeight===0);
ce[0].style.display="";
ce[1].style.display="none";
cb.reliableHiddenOffsets=b1&&(ce[0].offsetHeight===0);
cg.innerHTML="";
cg.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";
cb.boxSizing=(cg.offsetWidth===4);
cb.doesNotIncludeMarginInBodyOffset=(e.offsetTop!==1);
if(a2.getComputedStyle){cb.pixelPosition=(a2.getComputedStyle(cg,null)||{}).top!=="1%";
cb.boxSizingReliable=(a2.getComputedStyle(cg,null)||{width:"4px"}).width==="4px";
cf=o.createElement("div");
cf.style.cssText=cg.style.cssText=cd;
cf.style.marginRight=cf.style.width="0";
cg.style.width="1px";
cg.appendChild(cf);
cb.reliableMarginRight=!parseFloat((a2.getComputedStyle(cf,null)||{}).marginRight)
}if(typeof cg.style.zoom!=="undefined"){cg.innerHTML="";
cg.style.cssText=cd+"width:1px;padding:1px;display:inline;zoom:1";
cb.inlineBlockNeedsLayout=(cg.offsetWidth===3);
cg.style.display="block";
cg.style.overflow="visible";
cg.innerHTML="<div></div>";
cg.firstChild.style.width="5px";
cb.shrinkWrapBlocks=(cg.offsetWidth!==3);
cc.style.zoom=1
}e.removeChild(cc);
cc=cg=ce=cf=null
});
b6.removeChild(b0);
ca=b8=b9=b2=b7=b6=b0=null;
return cb
})();
var bt=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,aL=/([A-Z])/g;
bG.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(bG.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(e){e=e.nodeType?bG.cache[e[bG.expando]]:e[bG.expando];
return !!e&&!O(e)
},data:function(b1,bZ,b3,b2){if(!bG.acceptData(b1)){return
}var b4,b6,b7=bG.expando,b5=typeof bZ==="string",b8=b1.nodeType,e=b8?bG.cache:b1,b0=b8?b1[b7]:b1[b7]&&b7;
if((!b0||!e[b0]||(!b2&&!e[b0].data))&&b5&&b3===aB){return
}if(!b0){if(b8){b1[b7]=b0=bG.deletedIds.pop()||bG.guid++
}else{b0=b7
}}if(!e[b0]){e[b0]={};
if(!b8){e[b0].toJSON=bG.noop
}}if(typeof bZ==="object"||typeof bZ==="function"){if(b2){e[b0]=bG.extend(e[b0],bZ)
}else{e[b0].data=bG.extend(e[b0].data,bZ)
}}b4=e[b0];
if(!b2){if(!b4.data){b4.data={}
}b4=b4.data
}if(b3!==aB){b4[bG.camelCase(bZ)]=b3
}if(b5){b6=b4[bZ];
if(b6==null){b6=b4[bG.camelCase(bZ)]
}}else{b6=b4
}return b6
},removeData:function(b1,bZ,b2){if(!bG.acceptData(b1)){return
}var b5,b4,b3,b6=b1.nodeType,e=b6?bG.cache:b1,b0=b6?b1[bG.expando]:bG.expando;
if(!e[b0]){return
}if(bZ){b5=b2?e[b0]:e[b0].data;
if(b5){if(!bG.isArray(bZ)){if(bZ in b5){bZ=[bZ]
}else{bZ=bG.camelCase(bZ);
if(bZ in b5){bZ=[bZ]
}else{bZ=bZ.split(" ")
}}}for(b4=0,b3=bZ.length;
b4<b3;
b4++){delete b5[bZ[b4]]
}if(!(b2?O:bG.isEmptyObject)(b5)){return
}}}if(!b2){delete e[b0].data;
if(!O(e[b0])){return
}}if(b6){bG.cleanData([b1],true)
}else{if(bG.support.deleteExpando||e!=e.window){delete e[b0]
}else{e[b0]=null
}}},_data:function(bZ,e,b0){return bG.data(bZ,e,b0,true)
},acceptData:function(bZ){var e=bZ.nodeName&&bG.noData[bZ.nodeName.toLowerCase()];
return !e||e!==true&&bZ.getAttribute("classid")===e
}});
bG.fn.extend({data:function(b7,b6){var b2,bZ,b5,e,b1,b0=this[0],b4=0,b3=null;
if(b7===aB){if(this.length){b3=bG.data(b0);
if(b0.nodeType===1&&!bG._data(b0,"parsedAttrs")){b5=b0.attributes;
for(b1=b5.length;
b4<b1;
b4++){e=b5[b4].name;
if(!e.indexOf("data-")){e=bG.camelCase(e.substring(5));
bv(b0,e,b3[e])
}}bG._data(b0,"parsedAttrs",true)
}}return b3
}if(typeof b7==="object"){return this.each(function(){bG.data(this,b7)
})
}b2=b7.split(".",2);
b2[1]=b2[1]?"."+b2[1]:"";
bZ=b2[1]+"!";
return bG.access(this,function(b8){if(b8===aB){b3=this.triggerHandler("getData"+bZ,[b2[0]]);
if(b3===aB&&b0){b3=bG.data(b0,b7);
b3=bv(b0,b7,b3)
}return b3===aB&&b2[1]?this.data(b2[0]):b3
}b2[1]=b8;
this.each(function(){var b9=bG(this);
b9.triggerHandler("setData"+bZ,b2);
bG.data(this,b7,b8);
b9.triggerHandler("changeData"+bZ,b2)
})
},null,b6,arguments.length>1,null,false)
},removeData:function(e){return this.each(function(){bG.removeData(this,e)
})
}});
function bv(b1,b0,b2){if(b2===aB&&b1.nodeType===1){var bZ="data-"+b0.replace(aL,"-$1").toLowerCase();
b2=b1.getAttribute(bZ);
if(typeof b2==="string"){try{b2=b2==="true"?true:b2==="false"?false:b2==="null"?null:+b2+""===b2?+b2:bt.test(b2)?bG.parseJSON(b2):b2
}catch(b3){}bG.data(b1,b0,b2)
}else{b2=aB
}}return b2
}function O(bZ){var e;
for(e in bZ){if(e==="data"&&bG.isEmptyObject(bZ[e])){continue
}if(e!=="toJSON"){return false
}}return true
}bG.extend({queue:function(b0,bZ,b1){var e;
if(b0){bZ=(bZ||"fx")+"queue";
e=bG._data(b0,bZ);
if(b1){if(!e||bG.isArray(b1)){e=bG._data(b0,bZ,bG.makeArray(b1))
}else{e.push(b1)
}}return e||[]
}},dequeue:function(b3,b2){b2=b2||"fx";
var bZ=bG.queue(b3,b2),b4=bZ.length,b1=bZ.shift(),e=bG._queueHooks(b3,b2),b0=function(){bG.dequeue(b3,b2)
};
if(b1==="inprogress"){b1=bZ.shift();
b4--
}if(b1){if(b2==="fx"){bZ.unshift("inprogress")
}delete e.stop;
b1.call(b3,b0,e)
}if(!b4&&e){e.empty.fire()
}},_queueHooks:function(b0,bZ){var e=bZ+"queueHooks";
return bG._data(b0,e)||bG._data(b0,e,{empty:bG.Callbacks("once memory").add(function(){bG.removeData(b0,bZ+"queue",true);
bG.removeData(b0,e,true)
})})
}});
bG.fn.extend({queue:function(e,bZ){var b0=2;
if(typeof e!=="string"){bZ=e;
e="fx";
b0--
}if(arguments.length<b0){return bG.queue(this[0],e)
}return bZ===aB?this:this.each(function(){var b1=bG.queue(this,e,bZ);
bG._queueHooks(this,e);
if(e==="fx"&&b1[0]!=="inprogress"){bG.dequeue(this,e)
}})
},dequeue:function(e){return this.each(function(){bG.dequeue(this,e)
})
},delay:function(bZ,e){bZ=bG.fx?bG.fx.speeds[bZ]||bZ:bZ;
e=e||"fx";
return this.queue(e,function(b1,b0){var b2=setTimeout(b1,bZ);
b0.stop=function(){clearTimeout(b2)
}
})
},clearQueue:function(e){return this.queue(e||"fx",[])
},promise:function(b0,b4){var bZ,b1=1,b5=bG.Deferred(),b3=this,e=this.length,b2=function(){if(!(--b1)){b5.resolveWith(b3,[b3])
}};
if(typeof b0!=="string"){b4=b0;
b0=aB
}b0=b0||"fx";
while(e--){bZ=bG._data(b3[e],b0+"queueHooks");
if(bZ&&bZ.empty){b1++;
bZ.empty.add(b2)
}}b2();
return b5.promise(b4)
}});
var a7,bV,n,bJ=/[\t\r\n]/g,ai=/\r/g,j=/^(?:button|input)$/i,aA=/^(?:button|input|object|select|textarea)$/i,D=/^a(?:rea|)$/i,M=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,bL=bG.support.getSetAttribute;
bG.fn.extend({attr:function(e,bZ){return bG.access(this,bG.attr,e,bZ,arguments.length>1)
},removeAttr:function(e){return this.each(function(){bG.removeAttr(this,e)
})
},prop:function(e,bZ){return bG.access(this,bG.prop,e,bZ,arguments.length>1)
},removeProp:function(e){e=bG.propFix[e]||e;
return this.each(function(){try{this[e]=aB;
delete this[e]
}catch(bZ){}})
},addClass:function(b2){var b4,b0,bZ,b1,b3,b5,e;
if(bG.isFunction(b2)){return this.each(function(b6){bG(this).addClass(b2.call(this,b6,this.className))
})
}if(b2&&typeof b2==="string"){b4=b2.split(aV);
for(b0=0,bZ=this.length;
b0<bZ;
b0++){b1=this[b0];
if(b1.nodeType===1){if(!b1.className&&b4.length===1){b1.className=b2
}else{b3=" "+b1.className+" ";
for(b5=0,e=b4.length;
b5<e;
b5++){if(b3.indexOf(" "+b4[b5]+" ")<0){b3+=b4[b5]+" "
}}b1.className=bG.trim(b3)
}}}}return this
},removeClass:function(b4){var b1,b2,b3,b5,bZ,b0,e;
if(bG.isFunction(b4)){return this.each(function(b6){bG(this).removeClass(b4.call(this,b6,this.className))
})
}if((b4&&typeof b4==="string")||b4===aB){b1=(b4||"").split(aV);
for(b0=0,e=this.length;
b0<e;
b0++){b3=this[b0];
if(b3.nodeType===1&&b3.className){b2=(" "+b3.className+" ").replace(bJ," ");
for(b5=0,bZ=b1.length;
b5<bZ;
b5++){while(b2.indexOf(" "+b1[b5]+" ")>=0){b2=b2.replace(" "+b1[b5]+" "," ")
}}b3.className=b4?bG.trim(b2):""
}}}return this
},toggleClass:function(b1,bZ){var b0=typeof b1,e=typeof bZ==="boolean";
if(bG.isFunction(b1)){return this.each(function(b2){bG(this).toggleClass(b1.call(this,b2,this.className,bZ),bZ)
})
}return this.each(function(){if(b0==="string"){var b4,b3=0,b2=bG(this),b5=bZ,b6=b1.split(aV);
while((b4=b6[b3++])){b5=e?b5:!b2.hasClass(b4);
b2[b5?"addClass":"removeClass"](b4)
}}else{if(b0==="undefined"||b0==="boolean"){if(this.className){bG._data(this,"__className__",this.className)
}this.className=this.className||b1===false?"":bG._data(this,"__className__")||""
}}})
},hasClass:function(e){var b1=" "+e+" ",b0=0,bZ=this.length;
for(;
b0<bZ;
b0++){if(this[b0].nodeType===1&&(" "+this[b0].className+" ").replace(bJ," ").indexOf(b1)>=0){return true
}}return false
},val:function(b1){var e,bZ,b2,b0=this[0];
if(!arguments.length){if(b0){e=bG.valHooks[b0.type]||bG.valHooks[b0.nodeName.toLowerCase()];
if(e&&"get" in e&&(bZ=e.get(b0,"value"))!==aB){return bZ
}bZ=b0.value;
return typeof bZ==="string"?bZ.replace(ai,""):bZ==null?"":bZ
}return
}b2=bG.isFunction(b1);
return this.each(function(b4){var b5,b3=bG(this);
if(this.nodeType!==1){return
}if(b2){b5=b1.call(this,b4,b3.val())
}else{b5=b1
}if(b5==null){b5=""
}else{if(typeof b5==="number"){b5+=""
}else{if(bG.isArray(b5)){b5=bG.map(b5,function(b6){return b6==null?"":b6+""
})
}}}e=bG.valHooks[this.type]||bG.valHooks[this.nodeName.toLowerCase()];
if(!e||!("set" in e)||e.set(this,b5,"value")===aB){this.value=b5
}})
}});
bG.extend({valHooks:{option:{get:function(e){var bZ=e.attributes.value;
return !bZ||bZ.specified?e.value:e.text
}},select:{get:function(e){var b4,b0,b6=e.options,b2=e.selectedIndex,b1=e.type==="select-one"||b2<0,b5=b1?null:[],b3=b1?b2+1:b6.length,bZ=b2<0?b3:b1?b2:0;
for(;
bZ<b3;
bZ++){b0=b6[bZ];
if((b0.selected||bZ===b2)&&(bG.support.optDisabled?!b0.disabled:b0.getAttribute("disabled")===null)&&(!b0.parentNode.disabled||!bG.nodeName(b0.parentNode,"optgroup"))){b4=bG(b0).val();
if(b1){return b4
}b5.push(b4)
}}return b5
},set:function(bZ,b0){var e=bG.makeArray(b0);
bG(bZ).find("option").each(function(){this.selected=bG.inArray(bG(this).val(),e)>=0
});
if(!e.length){bZ.selectedIndex=-1
}return e
}}},attrFn:{},attr:function(b4,b1,b5,b3){var b0,e,b2,bZ=b4.nodeType;
if(!b4||bZ===3||bZ===8||bZ===2){return
}if(b3&&bG.isFunction(bG.fn[b1])){return bG(b4)[b1](b5)
}if(typeof b4.getAttribute==="undefined"){return bG.prop(b4,b1,b5)
}b2=bZ!==1||!bG.isXMLDoc(b4);
if(b2){b1=b1.toLowerCase();
e=bG.attrHooks[b1]||(M.test(b1)?bV:a7)
}if(b5!==aB){if(b5===null){bG.removeAttr(b4,b1);
return
}else{if(e&&"set" in e&&b2&&(b0=e.set(b4,b5,b1))!==aB){return b0
}else{b4.setAttribute(b1,b5+"");
return b5
}}}else{if(e&&"get" in e&&b2&&(b0=e.get(b4,b1))!==null){return b0
}else{b0=b4.getAttribute(b1);
return b0===null?aB:b0
}}},removeAttr:function(b1,b3){var b2,b4,bZ,e,b0=0;
if(b3&&b1.nodeType===1){b4=b3.split(aV);
for(;
b0<b4.length;
b0++){bZ=b4[b0];
if(bZ){b2=bG.propFix[bZ]||bZ;
e=M.test(bZ);
if(!e){bG.attr(b1,bZ,"")
}b1.removeAttribute(bL?bZ:b2);
if(e&&b2 in b1){b1[b2]=false
}}}}},attrHooks:{type:{set:function(e,bZ){if(j.test(e.nodeName)&&e.parentNode){bG.error("type property can't be changed")
}else{if(!bG.support.radioValue&&bZ==="radio"&&bG.nodeName(e,"input")){var b0=e.value;
e.setAttribute("type",bZ);
if(b0){e.value=b0
}return bZ
}}}},value:{get:function(bZ,e){if(a7&&bG.nodeName(bZ,"button")){return a7.get(bZ,e)
}return e in bZ?bZ.value:null
},set:function(bZ,b0,e){if(a7&&bG.nodeName(bZ,"button")){return a7.set(bZ,b0,e)
}bZ.value=b0
}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(b3,b1,b4){var b0,e,b2,bZ=b3.nodeType;
if(!b3||bZ===3||bZ===8||bZ===2){return
}b2=bZ!==1||!bG.isXMLDoc(b3);
if(b2){b1=bG.propFix[b1]||b1;
e=bG.propHooks[b1]
}if(b4!==aB){if(e&&"set" in e&&(b0=e.set(b3,b4,b1))!==aB){return b0
}else{return(b3[b1]=b4)
}}else{if(e&&"get" in e&&(b0=e.get(b3,b1))!==null){return b0
}else{return b3[b1]
}}},propHooks:{tabIndex:{get:function(bZ){var e=bZ.getAttributeNode("tabindex");
return e&&e.specified?parseInt(e.value,10):aA.test(bZ.nodeName)||D.test(bZ.nodeName)&&bZ.href?0:aB
}}}});
bV={get:function(bZ,e){var b1,b0=bG.prop(bZ,e);
return b0===true||typeof b0!=="boolean"&&(b1=bZ.getAttributeNode(e))&&b1.nodeValue!==false?e.toLowerCase():aB
},set:function(bZ,b1,e){var b0;
if(b1===false){bG.removeAttr(bZ,e)
}else{b0=bG.propFix[e]||e;
if(b0 in bZ){bZ[b0]=true
}bZ.setAttribute(e,e.toLowerCase())
}return e
}};
if(!bL){n={name:true,id:true,coords:true};
a7=bG.valHooks.button={get:function(b0,bZ){var e;
e=b0.getAttributeNode(bZ);
return e&&(n[bZ]?e.value!=="":e.specified)?e.value:aB
},set:function(b0,b1,bZ){var e=b0.getAttributeNode(bZ);
if(!e){e=o.createAttribute(bZ);
b0.setAttributeNode(e)
}return(e.value=b1+"")
}};
bG.each(["width","height"],function(bZ,e){bG.attrHooks[e]=bG.extend(bG.attrHooks[e],{set:function(b0,b1){if(b1===""){b0.setAttribute(e,"auto");
return b1
}}})
});
bG.attrHooks.contenteditable={get:a7.get,set:function(bZ,b0,e){if(b0===""){b0="false"
}a7.set(bZ,b0,e)
}}
}if(!bG.support.hrefNormalized){bG.each(["href","src","width","height"],function(bZ,e){bG.attrHooks[e]=bG.extend(bG.attrHooks[e],{get:function(b1){var b0=b1.getAttribute(e,2);
return b0===null?aB:b0
}})
})
}if(!bG.support.style){bG.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||aB
},set:function(e,bZ){return(e.style.cssText=bZ+"")
}}
}if(!bG.support.optSelected){bG.propHooks.selected=bG.extend(bG.propHooks.selected,{get:function(bZ){var e=bZ.parentNode;
if(e){e.selectedIndex;
if(e.parentNode){e.parentNode.selectedIndex
}}return null
}})
}if(!bG.support.enctype){bG.propFix.enctype="encoding"
}if(!bG.support.checkOn){bG.each(["radio","checkbox"],function(){bG.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value
}}
})
}bG.each(["radio","checkbox"],function(){bG.valHooks[this]=bG.extend(bG.valHooks[this],{set:function(e,bZ){if(bG.isArray(bZ)){return(e.checked=bG.inArray(bG(e).val(),bZ)>=0)
}}})
});
var bE=/^(?:textarea|input|select)$/i,br=/^([^\.]*|)(?:\.(.+)|)$/,ba=/(?:^|\s)hover(\.\S+|)\b/,a3=/^key/,bK=/^(?:mouse|contextmenu)|click/,by=/^(?:focusinfocus|focusoutblur)$/,aq=function(e){return bG.event.special.hover?e:e.replace(ba,"mouseenter$1 mouseleave$1")
};
bG.event={add:function(b1,b5,cc,b3,b2){var b6,b4,cd,cb,ca,b8,e,b9,bZ,b0,b7;
if(b1.nodeType===3||b1.nodeType===8||!b5||!cc||!(b6=bG._data(b1))){return
}if(cc.handler){bZ=cc;
cc=bZ.handler;
b2=bZ.selector
}if(!cc.guid){cc.guid=bG.guid++
}cd=b6.events;
if(!cd){b6.events=cd={}
}b4=b6.handle;
if(!b4){b6.handle=b4=function(ce){return typeof bG!=="undefined"&&(!ce||bG.event.triggered!==ce.type)?bG.event.dispatch.apply(b4.elem,arguments):aB
};
b4.elem=b1
}b5=bG.trim(aq(b5)).split(" ");
for(cb=0;
cb<b5.length;
cb++){ca=br.exec(b5[cb])||[];
b8=ca[1];
e=(ca[2]||"").split(".").sort();
b7=bG.event.special[b8]||{};
b8=(b2?b7.delegateType:b7.bindType)||b8;
b7=bG.event.special[b8]||{};
b9=bG.extend({type:b8,origType:ca[1],data:b3,handler:cc,guid:cc.guid,selector:b2,needsContext:b2&&bG.expr.match.needsContext.test(b2),namespace:e.join(".")},bZ);
b0=cd[b8];
if(!b0){b0=cd[b8]=[];
b0.delegateCount=0;
if(!b7.setup||b7.setup.call(b1,b3,e,b4)===false){if(b1.addEventListener){b1.addEventListener(b8,b4,false)
}else{if(b1.attachEvent){b1.attachEvent("on"+b8,b4)
}}}}if(b7.add){b7.add.call(b1,b9);
if(!b9.handler.guid){b9.handler.guid=cc.guid
}}if(b2){b0.splice(b0.delegateCount++,0,b9)
}else{b0.push(b9)
}bG.event.global[b8]=true
}b1=null
},global:{},remove:function(b1,b6,cc,b2,b5){var cd,ce,b9,b0,bZ,b3,b4,cb,b8,e,ca,b7=bG.hasData(b1)&&bG._data(b1);
if(!b7||!(cb=b7.events)){return
}b6=bG.trim(aq(b6||"")).split(" ");
for(cd=0;
cd<b6.length;
cd++){ce=br.exec(b6[cd])||[];
b9=b0=ce[1];
bZ=ce[2];
if(!b9){for(b9 in cb){bG.event.remove(b1,b9+b6[cd],cc,b2,true)
}continue
}b8=bG.event.special[b9]||{};
b9=(b2?b8.delegateType:b8.bindType)||b9;
e=cb[b9]||[];
b3=e.length;
bZ=bZ?new RegExp("(^|\\.)"+bZ.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;
for(b4=0;
b4<e.length;
b4++){ca=e[b4];
if((b5||b0===ca.origType)&&(!cc||cc.guid===ca.guid)&&(!bZ||bZ.test(ca.namespace))&&(!b2||b2===ca.selector||b2==="**"&&ca.selector)){e.splice(b4--,1);
if(ca.selector){e.delegateCount--
}if(b8.remove){b8.remove.call(b1,ca)
}}}if(e.length===0&&b3!==e.length){if(!b8.teardown||b8.teardown.call(b1,bZ,b7.handle)===false){bG.removeEvent(b1,b9,b7.handle)
}delete cb[b9]
}}if(bG.isEmptyObject(cb)){delete b7.handle;
bG.removeData(b1,"events",true)
}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(bZ,b6,b4,cd){if(b4&&(b4.nodeType===3||b4.nodeType===8)){return
}var e,b1,b7,cb,b3,b2,b9,b8,b5,cc,ca=bZ.type||bZ,b0=[];
if(by.test(ca+bG.event.triggered)){return
}if(ca.indexOf("!")>=0){ca=ca.slice(0,-1);
b1=true
}if(ca.indexOf(".")>=0){b0=ca.split(".");
ca=b0.shift();
b0.sort()
}if((!b4||bG.event.customEvent[ca])&&!bG.event.global[ca]){return
}bZ=typeof bZ==="object"?bZ[bG.expando]?bZ:new bG.Event(ca,bZ):new bG.Event(ca);
bZ.type=ca;
bZ.isTrigger=true;
bZ.exclusive=b1;
bZ.namespace=b0.join(".");
bZ.namespace_re=bZ.namespace?new RegExp("(^|\\.)"+b0.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;
b2=ca.indexOf(":")<0?"on"+ca:"";
if(!b4){e=bG.cache;
for(b7 in e){if(e[b7].events&&e[b7].events[ca]){bG.event.trigger(bZ,b6,e[b7].handle.elem,true)
}}return
}bZ.result=aB;
if(!bZ.target){bZ.target=b4
}b6=b6!=null?bG.makeArray(b6):[];
b6.unshift(bZ);
b9=bG.event.special[ca]||{};
if(b9.trigger&&b9.trigger.apply(b4,b6)===false){return
}b5=[[b4,b9.bindType||ca]];
if(!cd&&!b9.noBubble&&!bG.isWindow(b4)){cc=b9.delegateType||ca;
cb=by.test(cc+ca)?b4:b4.parentNode;
for(b3=b4;
cb;
cb=cb.parentNode){b5.push([cb,cc]);
b3=cb
}if(b3===(b4.ownerDocument||o)){b5.push([b3.defaultView||b3.parentWindow||a2,cc])
}}for(b7=0;
b7<b5.length&&!bZ.isPropagationStopped();
b7++){cb=b5[b7][0];
bZ.type=b5[b7][1];
b8=(bG._data(cb,"events")||{})[bZ.type]&&bG._data(cb,"handle");
if(b8){b8.apply(cb,b6)
}b8=b2&&cb[b2];
if(b8&&bG.acceptData(cb)&&b8.apply&&b8.apply(cb,b6)===false){bZ.preventDefault()
}}bZ.type=ca;
if(!cd&&!bZ.isDefaultPrevented()){if((!b9._default||b9._default.apply(b4.ownerDocument,b6)===false)&&!(ca==="click"&&bG.nodeName(b4,"a"))&&bG.acceptData(b4)){if(b2&&b4[ca]&&((ca!=="focus"&&ca!=="blur")||bZ.target.offsetWidth!==0)&&!bG.isWindow(b4)){b3=b4[b2];
if(b3){b4[b2]=null
}bG.event.triggered=ca;
b4[ca]();
bG.event.triggered=aB;
if(b3){b4[b2]=b3
}}}}return bZ.result
},dispatch:function(e){e=bG.event.fix(e||a2.event);
var b5,b4,ce,b8,b7,bZ,b6,cc,b1,cd,b2=((bG._data(this,"events")||{})[e.type]||[]),b3=b2.delegateCount,ca=a4.call(arguments),b0=!e.exclusive&&!e.namespace,b9=bG.event.special[e.type]||{},cb=[];
ca[0]=e;
e.delegateTarget=this;
if(b9.preDispatch&&b9.preDispatch.call(this,e)===false){return
}if(b3&&!(e.button&&e.type==="click")){for(ce=e.target;
ce!=this;
ce=ce.parentNode||this){if(ce.disabled!==true||e.type!=="click"){b7={};
b6=[];
for(b5=0;
b5<b3;
b5++){cc=b2[b5];
b1=cc.selector;
if(b7[b1]===aB){b7[b1]=cc.needsContext?bG(b1,this).index(ce)>=0:bG.find(b1,this,null,[ce]).length
}if(b7[b1]){b6.push(cc)
}}if(b6.length){cb.push({elem:ce,matches:b6})
}}}}if(b2.length>b3){cb.push({elem:this,matches:b2.slice(b3)})
}for(b5=0;
b5<cb.length&&!e.isPropagationStopped();
b5++){bZ=cb[b5];
e.currentTarget=bZ.elem;
for(b4=0;
b4<bZ.matches.length&&!e.isImmediatePropagationStopped();
b4++){cc=bZ.matches[b4];
if(b0||(!e.namespace&&!cc.namespace)||e.namespace_re&&e.namespace_re.test(cc.namespace)){e.data=cc.data;
e.handleObj=cc;
b8=((bG.event.special[cc.origType]||{}).handle||cc.handler).apply(bZ.elem,ca);
if(b8!==aB){e.result=b8;
if(b8===false){e.preventDefault();
e.stopPropagation()
}}}}}if(b9.postDispatch){b9.postDispatch.call(this,e)
}return e.result
},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(bZ,e){if(bZ.which==null){bZ.which=e.charCode!=null?e.charCode:e.keyCode
}return bZ
}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b1,b0){var b2,b3,e,bZ=b0.button,b4=b0.fromElement;
if(b1.pageX==null&&b0.clientX!=null){b2=b1.target.ownerDocument||o;
b3=b2.documentElement;
e=b2.body;
b1.pageX=b0.clientX+(b3&&b3.scrollLeft||e&&e.scrollLeft||0)-(b3&&b3.clientLeft||e&&e.clientLeft||0);
b1.pageY=b0.clientY+(b3&&b3.scrollTop||e&&e.scrollTop||0)-(b3&&b3.clientTop||e&&e.clientTop||0)
}if(!b1.relatedTarget&&b4){b1.relatedTarget=b4===b1.target?b0.toElement:b4
}if(!b1.which&&bZ!==aB){b1.which=(bZ&1?1:(bZ&2?3:(bZ&4?2:0)))
}return b1
}},fix:function(b0){if(b0[bG.expando]){return b0
}var bZ,b3,e=b0,b1=bG.event.fixHooks[b0.type]||{},b2=b1.props?this.props.concat(b1.props):this.props;
b0=bG.Event(e);
for(bZ=b2.length;
bZ;
){b3=b2[--bZ];
b0[b3]=e[b3]
}if(!b0.target){b0.target=e.srcElement||o
}if(b0.target.nodeType===3){b0.target=b0.target.parentNode
}b0.metaKey=!!b0.metaKey;
return b1.filter?b1.filter(b0,e):b0
},special:{load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(b0,bZ,e){if(bG.isWindow(this)){this.onbeforeunload=e
}},teardown:function(bZ,e){if(this.onbeforeunload===e){this.onbeforeunload=null
}}}},simulate:function(b0,b2,b1,bZ){var b3=bG.extend(new bG.Event(),b1,{type:b0,isSimulated:true,originalEvent:{}});
if(bZ){bG.event.trigger(b3,null,b2)
}else{bG.event.dispatch.call(b2,b3)
}if(b3.isDefaultPrevented()){b1.preventDefault()
}}};
bG.event.handle=bG.event.dispatch;
bG.removeEvent=o.removeEventListener?function(bZ,e,b0){if(bZ.removeEventListener){bZ.removeEventListener(e,b0,false)
}}:function(b0,bZ,b1){var e="on"+bZ;
if(b0.detachEvent){if(typeof b0[e]==="undefined"){b0[e]=null
}b0.detachEvent(e,b1)
}};
bG.Event=function(bZ,e){if(!(this instanceof bG.Event)){return new bG.Event(bZ,e)
}if(bZ&&bZ.type){this.originalEvent=bZ;
this.type=bZ.type;
this.isDefaultPrevented=(bZ.defaultPrevented||bZ.returnValue===false||bZ.getPreventDefault&&bZ.getPreventDefault())?R:X
}else{this.type=bZ
}if(e){bG.extend(this,e)
}this.timeStamp=bZ&&bZ.timeStamp||bG.now();
this[bG.expando]=true
};
function X(){return false
}function R(){return true
}bG.Event.prototype={preventDefault:function(){this.isDefaultPrevented=R;
var bZ=this.originalEvent;
if(!bZ){return
}if(bZ.preventDefault){bZ.preventDefault()
}else{bZ.returnValue=false
}},stopPropagation:function(){this.isPropagationStopped=R;
var bZ=this.originalEvent;
if(!bZ){return
}if(bZ.stopPropagation){bZ.stopPropagation()
}bZ.cancelBubble=true
},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=R;
this.stopPropagation()
},isDefaultPrevented:X,isPropagationStopped:X,isImmediatePropagationStopped:X};
bG.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(bZ,e){bG.event.special[bZ]={delegateType:e,bindType:e,handle:function(b3){var b1,b5=this,b4=b3.relatedTarget,b2=b3.handleObj,b0=b2.selector;
if(!b4||(b4!==b5&&!bG.contains(b5,b4))){b3.type=b2.origType;
b1=b2.handler.apply(this,arguments);
b3.type=e
}return b1
}}
});
if(!bG.support.submitBubbles){bG.event.special.submit={setup:function(){if(bG.nodeName(this,"form")){return false
}bG.event.add(this,"click._submit keypress._submit",function(b1){var b0=b1.target,bZ=bG.nodeName(b0,"input")||bG.nodeName(b0,"button")?b0.form:aB;
if(bZ&&!bG._data(bZ,"_submit_attached")){bG.event.add(bZ,"submit._submit",function(e){e._submit_bubble=true
});
bG._data(bZ,"_submit_attached",true)
}})
},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;
if(this.parentNode&&!e.isTrigger){bG.event.simulate("submit",this.parentNode,e,true)
}}},teardown:function(){if(bG.nodeName(this,"form")){return false
}bG.event.remove(this,"._submit")
}}
}if(!bG.support.changeBubbles){bG.event.special.change={setup:function(){if(bE.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){bG.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true
}});
bG.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false
}bG.event.simulate("change",this,e,true)
})
}return false
}bG.event.add(this,"beforeactivate._change",function(b0){var bZ=b0.target;
if(bE.test(bZ.nodeName)&&!bG._data(bZ,"_change_attached")){bG.event.add(bZ,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){bG.event.simulate("change",this.parentNode,e,true)
}});
bG._data(bZ,"_change_attached",true)
}})
},handle:function(bZ){var e=bZ.target;
if(this!==e||bZ.isSimulated||bZ.isTrigger||(e.type!=="radio"&&e.type!=="checkbox")){return bZ.handleObj.handler.apply(this,arguments)
}},teardown:function(){bG.event.remove(this,"._change");
return !bE.test(this.nodeName)
}}
}if(!bG.support.focusinBubbles){bG.each({focus:"focusin",blur:"focusout"},function(b1,e){var bZ=0,b0=function(b2){bG.event.simulate(e,b2.target,bG.event.fix(b2),true)
};
bG.event.special[e]={setup:function(){if(bZ++===0){o.addEventListener(b1,b0,true)
}},teardown:function(){if(--bZ===0){o.removeEventListener(b1,b0,true)
}}}
})
}bG.fn.extend({on:function(b0,e,b3,b2,bZ){var b4,b1;
if(typeof b0==="object"){if(typeof e!=="string"){b3=b3||e;
e=aB
}for(b1 in b0){this.on(b1,e,b3,b0[b1],bZ)
}return this
}if(b3==null&&b2==null){b2=e;
b3=e=aB
}else{if(b2==null){if(typeof e==="string"){b2=b3;
b3=aB
}else{b2=b3;
b3=e;
e=aB
}}}if(b2===false){b2=X
}else{if(!b2){return this
}}if(bZ===1){b4=b2;
b2=function(b5){bG().off(b5);
return b4.apply(this,arguments)
};
b2.guid=b4.guid||(b4.guid=bG.guid++)
}return this.each(function(){bG.event.add(this,b0,b2,b3,e)
})
},one:function(bZ,e,b1,b0){return this.on(bZ,e,b1,b0,1)
},off:function(b0,e,b2){var bZ,b1;
if(b0&&b0.preventDefault&&b0.handleObj){bZ=b0.handleObj;
bG(b0.delegateTarget).off(bZ.namespace?bZ.origType+"."+bZ.namespace:bZ.origType,bZ.selector,bZ.handler);
return this
}if(typeof b0==="object"){for(b1 in b0){this.off(b1,e,b0[b1])
}return this
}if(e===false||typeof e==="function"){b2=e;
e=aB
}if(b2===false){b2=X
}return this.each(function(){bG.event.remove(this,b0,b2,e)
})
},bind:function(e,b0,bZ){return this.on(e,null,b0,bZ)
},unbind:function(e,bZ){return this.off(e,null,bZ)
},live:function(e,b0,bZ){bG(this.context).on(e,this.selector,b0,bZ);
return this
},die:function(e,bZ){bG(this.context).off(e,this.selector||"**",bZ);
return this
},delegate:function(e,bZ,b1,b0){return this.on(bZ,e,b1,b0)
},undelegate:function(e,bZ,b0){return arguments.length===1?this.off(e,"**"):this.off(bZ,e||"**",b0)
},trigger:function(e,bZ){return this.each(function(){bG.event.trigger(e,bZ,this)
})
},triggerHandler:function(e,bZ){if(this[0]){return bG.event.trigger(e,bZ,this[0],true)
}},toggle:function(b1){var bZ=arguments,e=b1.guid||bG.guid++,b0=0,b2=function(b3){var b4=(bG._data(this,"lastToggle"+b1.guid)||0)%b0;
bG._data(this,"lastToggle"+b1.guid,b4+1);
b3.preventDefault();
return bZ[b4].apply(this,arguments)||false
};
b2.guid=e;
while(b0<bZ.length){bZ[b0++].guid=e
}return this.click(b2)
},hover:function(e,bZ){return this.mouseenter(e).mouseleave(bZ||e)
}});
bG.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(bZ,e){bG.fn[e]=function(b1,b0){if(b0==null){b0=b1;
b1=null
}return arguments.length>0?this.on(e,null,b1,b0):this.trigger(e)
};
if(a3.test(e)){bG.event.fixHooks[e]=bG.event.keyHooks
}if(bK.test(e)){bG.event.fixHooks[e]=bG.event.mouseHooks
}});
/*!
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */
(function(cS,ch){var cX,ca,cL,b0,cm,cA,cd,cg,cc,cJ,b9=true,cu="undefined",cZ=("sizcache"+Math.random()).replace(".",""),b4=String,b8=cS.document,cb=b8.documentElement,cr=0,cf=0,cE=[].pop,cW=[].push,cl=[].slice,co=[].indexOf||function(c8){var c7=0,e=this.length;
for(;
c7<e;
c7++){if(this[c7]===c8){return c7
}}return -1
},c1=function(e,c7){e[cZ]=c7==null||c7;
return e
},c5=function(){var e={},c7=[];
return c1(function(c8,c9){if(c7.push(c8)>cL.cacheLength){delete e[c7.shift()]
}return(e[c8+" "]=c9)
},e)
},cU=c5(),cV=c5(),cn=c5(),cy="[\\x20\\t\\r\\n\\f]",ck="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",ci=ck.replace("w","w#"),c4="([*^$|!~]?=)",cP="\\["+cy+"*("+ck+")"+cy+"*(?:"+c4+cy+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ci+")|)|)"+cy+"*\\]",c6=":("+ck+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+cP+")|[^:]|\\\\.)*|.*))\\)|)",cz=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+cy+"*((?:-\\d)?\\d*)"+cy+"*\\)|)(?=[^-]|$)",cT=new RegExp("^"+cy+"+|((?:^|[^\\\\])(?:\\\\.)*)"+cy+"+$","g"),b5=new RegExp("^"+cy+"*,"+cy+"*"),cH=new RegExp("^"+cy+"*([\\x20\\t\\r\\n\\f>+~])"+cy+"*"),cM=new RegExp(c6),cO=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,cD=/^:not/,cR=/[\x20\t\r\n\f]*[+~]/,c0=/:not\($/,cs=/h\d/i,cN=/input|select|textarea|button/i,ct=/\\(?!\\)/g,cG={ID:new RegExp("^#("+ck+")"),CLASS:new RegExp("^\\.("+ck+")"),NAME:new RegExp("^\\[name=['\"]?("+ck+")['\"]?\\]"),TAG:new RegExp("^("+ck.replace("w","w*")+")"),ATTR:new RegExp("^"+cP),PSEUDO:new RegExp("^"+c6),POS:new RegExp(cz,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+cy+"*(even|odd|(([+-]|)(\\d*)n|)"+cy+"*(?:([+-]|)"+cy+"*(\\d+)|))"+cy+"*\\)|)","i"),needsContext:new RegExp("^"+cy+"*[>+~]|"+cz,"i")},cK=function(c7){var c9=b8.createElement("div");
try{return c7(c9)
}catch(c8){return false
}finally{c9=null
}},b7=cK(function(e){e.appendChild(b8.createComment(""));
return !e.getElementsByTagName("*").length
}),cC=cK(function(e){e.innerHTML="<a href='#'></a>";
return e.firstChild&&typeof e.firstChild.getAttribute!==cu&&e.firstChild.getAttribute("href")==="#"
}),cq=cK(function(c7){c7.innerHTML="<select></select>";
var e=typeof c7.lastChild.getAttribute("multiple");
return e!=="boolean"&&e!=="string"
}),cB=cK(function(e){e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";
if(!e.getElementsByClassName||!e.getElementsByClassName("e").length){return false
}e.lastChild.className="e";
return e.getElementsByClassName("e").length===2
}),bZ=cK(function(c7){c7.id=cZ+0;
c7.innerHTML="<a name='"+cZ+"'></a><div name='"+cZ+"'></div>";
cb.insertBefore(c7,cb.firstChild);
var e=b8.getElementsByName&&b8.getElementsByName(cZ).length===2+b8.getElementsByName(cZ+0).length;
ca=!b8.getElementById(cZ);
cb.removeChild(c7);
return e
});
try{cl.call(cb.childNodes,0)[0].nodeType
}catch(c3){cl=function(c7){var c8,e=[];
for(;
(c8=this[c7]);
c7++){e.push(c8)
}return e
}
}function cQ(c9,e,db,de){db=db||[];
e=e||b8;
var dc,c7,dd,c8,da=e.nodeType;
if(!c9||typeof c9!=="string"){return db
}if(da!==1&&da!==9){return[]
}dd=cm(e);
if(!dd&&!de){if((dc=cO.exec(c9))){if((c8=dc[1])){if(da===9){c7=e.getElementById(c8);
if(c7&&c7.parentNode){if(c7.id===c8){db.push(c7);
return db
}}else{return db
}}else{if(e.ownerDocument&&(c7=e.ownerDocument.getElementById(c8))&&cA(e,c7)&&c7.id===c8){db.push(c7);
return db
}}}else{if(dc[2]){cW.apply(db,cl.call(e.getElementsByTagName(c9),0));
return db
}else{if((c8=dc[3])&&cB&&e.getElementsByClassName){cW.apply(db,cl.call(e.getElementsByClassName(c8),0));
return db
}}}}}return cY(c9.replace(cT,"$1"),e,db,de,dd)
}cQ.matches=function(c7,e){return cQ(c7,null,null,e)
};
cQ.matchesSelector=function(e,c7){return cQ(c7,null,null,[e]).length>0
};
function cI(e){return function(c8){var c7=c8.nodeName.toLowerCase();
return c7==="input"&&c8.type===e
}
}function b3(e){return function(c8){var c7=c8.nodeName.toLowerCase();
return(c7==="input"||c7==="button")&&c8.type===e
}
}function cF(e){return c1(function(c7){c7=+c7;
return c1(function(c8,dc){var da,c9=e([],c8.length,c7),db=c9.length;
while(db--){if(c8[(da=c9[db])]){c8[da]=!(dc[da]=c8[da])
}}})
})
}b0=cQ.getText=function(da){var c9,c7="",c8=0,e=da.nodeType;
if(e){if(e===1||e===9||e===11){if(typeof da.textContent==="string"){return da.textContent
}else{for(da=da.firstChild;
da;
da=da.nextSibling){c7+=b0(da)
}}}else{if(e===3||e===4){return da.nodeValue
}}}else{for(;
(c9=da[c8]);
c8++){c7+=b0(c9)
}}return c7
};
cm=cQ.isXML=function(e){var c7=e&&(e.ownerDocument||e).documentElement;
return c7?c7.nodeName!=="HTML":false
};
cA=cQ.contains=cb.contains?function(c7,e){var c9=c7.nodeType===9?c7.documentElement:c7,c8=e&&e.parentNode;
return c7===c8||!!(c8&&c8.nodeType===1&&c9.contains&&c9.contains(c8))
}:cb.compareDocumentPosition?function(c7,e){return e&&!!(c7.compareDocumentPosition(e)&16)
}:function(c7,e){while((e=e.parentNode)){if(e===c7){return true
}}return false
};
cQ.attr=function(c8,c7){var c9,e=cm(c8);
if(!e){c7=c7.toLowerCase()
}if((c9=cL.attrHandle[c7])){return c9(c8)
}if(e||cq){return c8.getAttribute(c7)
}c9=c8.getAttributeNode(c7);
return c9?typeof c8[c7]==="boolean"?c8[c7]?c7:null:c9.specified?c9.value:null:null
};
cL=cQ.selectors={cacheLength:50,createPseudo:c1,match:cG,attrHandle:cC?{}:{href:function(e){return e.getAttribute("href",2)
},type:function(e){return e.getAttribute("type")
}},find:{ID:ca?function(c9,c8,c7){if(typeof c8.getElementById!==cu&&!c7){var e=c8.getElementById(c9);
return e&&e.parentNode?[e]:[]
}}:function(c9,c8,c7){if(typeof c8.getElementById!==cu&&!c7){var e=c8.getElementById(c9);
return e?e.id===c9||typeof e.getAttributeNode!==cu&&e.getAttributeNode("id").value===c9?[e]:ch:[]
}},TAG:b7?function(e,c7){if(typeof c7.getElementsByTagName!==cu){return c7.getElementsByTagName(e)
}}:function(e,da){var c9=da.getElementsByTagName(e);
if(e==="*"){var db,c8=[],c7=0;
for(;
(db=c9[c7]);
c7++){if(db.nodeType===1){c8.push(db)
}}return c8
}return c9
},NAME:bZ&&function(e,c7){if(typeof c7.getElementsByName!==cu){return c7.getElementsByName(name)
}},CLASS:cB&&function(c8,c7,e){if(typeof c7.getElementsByClassName!==cu&&!e){return c7.getElementsByClassName(c8)
}}},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(ct,"");
e[3]=(e[4]||e[5]||"").replace(ct,"");
if(e[2]==="~="){e[3]=" "+e[3]+" "
}return e.slice(0,4)
},CHILD:function(e){e[1]=e[1].toLowerCase();
if(e[1]==="nth"){if(!e[2]){cQ.error(e[0])
}e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd"));
e[4]=+((e[6]+e[7])||e[2]==="odd")
}else{if(e[2]){cQ.error(e[0])
}}return e
},PSEUDO:function(c7){var c8,e;
if(cG.CHILD.test(c7[0])){return null
}if(c7[3]){c7[2]=c7[3]
}else{if((c8=c7[4])){if(cM.test(c8)&&(e=b1(c8,true))&&(e=c8.indexOf(")",c8.length-e)-c8.length)){c8=c8.slice(0,e);
c7[0]=c7[0].slice(0,e)
}c7[2]=c8
}}return c7.slice(0,3)
}},filter:{ID:ca?function(e){e=e.replace(ct,"");
return function(c7){return c7.getAttribute("id")===e
}
}:function(e){e=e.replace(ct,"");
return function(c8){var c7=typeof c8.getAttributeNode!==cu&&c8.getAttributeNode("id");
return c7&&c7.value===e
}
},TAG:function(e){if(e==="*"){return function(){return true
}
}e=e.replace(ct,"").toLowerCase();
return function(c7){return c7.nodeName&&c7.nodeName.toLowerCase()===e
}
},CLASS:function(e){var c7=cU[cZ][e+" "];
return c7||(c7=new RegExp("(^|"+cy+")"+e+"("+cy+"|$)"))&&cU(e,function(c8){return c7.test(c8.className||(typeof c8.getAttribute!==cu&&c8.getAttribute("class"))||"")
})
},ATTR:function(c8,c7,e){return function(db,da){var c9=cQ.attr(db,c8);
if(c9==null){return c7==="!="
}if(!c7){return true
}c9+="";
return c7==="="?c9===e:c7==="!="?c9!==e:c7==="^="?e&&c9.indexOf(e)===0:c7==="*="?e&&c9.indexOf(e)>-1:c7==="$="?e&&c9.substr(c9.length-e.length)===e:c7==="~="?(" "+c9+" ").indexOf(e)>-1:c7==="|="?c9===e||c9.substr(0,e.length+1)===e+"-":false
}
},CHILD:function(e,c8,c9,c7){if(e==="nth"){return function(dc){var db,dd,da=dc.parentNode;
if(c9===1&&c7===0){return true
}if(da){dd=0;
for(db=da.firstChild;
db;
db=db.nextSibling){if(db.nodeType===1){dd++;
if(dc===db){break
}}}}dd-=c7;
return dd===c9||(dd%c9===0&&dd/c9>=0)
}
}return function(db){var da=db;
switch(e){case"only":case"first":while((da=da.previousSibling)){if(da.nodeType===1){return false
}}if(e==="first"){return true
}da=db;
case"last":while((da=da.nextSibling)){if(da.nodeType===1){return false
}}return true
}}
},PSEUDO:function(c9,c8){var e,c7=cL.pseudos[c9]||cL.setFilters[c9.toLowerCase()]||cQ.error("unsupported pseudo: "+c9);
if(c7[cZ]){return c7(c8)
}if(c7.length>1){e=[c9,c9,"",c8];
return cL.setFilters.hasOwnProperty(c9.toLowerCase())?c1(function(dc,de){var db,da=c7(dc,c8),dd=da.length;
while(dd--){db=co.call(dc,da[dd]);
dc[db]=!(de[db]=da[dd])
}}):function(da){return c7(da,0,e)
}
}return c7
}},pseudos:{not:c1(function(e){var c7=[],c8=[],c9=cd(e.replace(cT,"$1"));
return c9[cZ]?c1(function(db,dg,de,dc){var df,da=c9(db,null,dc,[]),dd=db.length;
while(dd--){if((df=da[dd])){db[dd]=!(dg[dd]=df)
}}}):function(dc,db,da){c7[0]=dc;
c9(c7,null,da,c8);
return !c8.pop()
}
}),has:c1(function(e){return function(c7){return cQ(e,c7).length>0
}
}),contains:c1(function(e){return function(c7){return(c7.textContent||c7.innerText||b0(c7)).indexOf(e)>-1
}
}),enabled:function(e){return e.disabled===false
},disabled:function(e){return e.disabled===true
},checked:function(e){var c7=e.nodeName.toLowerCase();
return(c7==="input"&&!!e.checked)||(c7==="option"&&!!e.selected)
},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex
}return e.selected===true
},parent:function(e){return !cL.pseudos.empty(e)
},empty:function(c7){var e;
c7=c7.firstChild;
while(c7){if(c7.nodeName>"@"||(e=c7.nodeType)===3||e===4){return false
}c7=c7.nextSibling
}return true
},header:function(e){return cs.test(e.nodeName)
},text:function(c8){var c7,e;
return c8.nodeName.toLowerCase()==="input"&&(c7=c8.type)==="text"&&((e=c8.getAttribute("type"))==null||e.toLowerCase()===c7)
},radio:cI("radio"),checkbox:cI("checkbox"),file:cI("file"),password:cI("password"),image:cI("image"),submit:b3("submit"),reset:b3("reset"),button:function(c7){var e=c7.nodeName.toLowerCase();
return e==="input"&&c7.type==="button"||e==="button"
},input:function(e){return cN.test(e.nodeName)
},focus:function(e){var c7=e.ownerDocument;
return e===c7.activeElement&&(!c7.hasFocus||c7.hasFocus())&&!!(e.type||e.href||~e.tabIndex)
},active:function(e){return e===e.ownerDocument.activeElement
},first:cF(function(){return[0]
}),last:cF(function(e,c7){return[c7-1]
}),eq:cF(function(e,c8,c7){return[c7<0?c7+c8:c7]
}),even:cF(function(e,c8){for(var c7=0;
c7<c8;
c7+=2){e.push(c7)
}return e
}),odd:cF(function(e,c8){for(var c7=1;
c7<c8;
c7+=2){e.push(c7)
}return e
}),lt:cF(function(e,c9,c8){for(var c7=c8<0?c8+c9:c8;
--c7>=0;
){e.push(c7)
}return e
}),gt:cF(function(e,c9,c8){for(var c7=c8<0?c8+c9:c8;
++c7<c9;
){e.push(c7)
}return e
})}};
function b2(c7,e,c8){if(c7===e){return c8
}var c9=c7.nextSibling;
while(c9){if(c9===e){return -1
}c9=c9.nextSibling
}return 1
}cg=cb.compareDocumentPosition?function(c7,e){if(c7===e){cc=true;
return 0
}return(!c7.compareDocumentPosition||!e.compareDocumentPosition?c7.compareDocumentPosition:c7.compareDocumentPosition(e)&4)?-1:1
}:function(de,dd){if(de===dd){cc=true;
return 0
}else{if(de.sourceIndex&&dd.sourceIndex){return de.sourceIndex-dd.sourceIndex
}}var db,c7,c8=[],e=[],da=de.parentNode,dc=dd.parentNode,df=da;
if(da===dc){return b2(de,dd)
}else{if(!da){return -1
}else{if(!dc){return 1
}}}while(df){c8.unshift(df);
df=df.parentNode
}df=dc;
while(df){e.unshift(df);
df=df.parentNode
}db=c8.length;
c7=e.length;
for(var c9=0;
c9<db&&c9<c7;
c9++){if(c8[c9]!==e[c9]){return b2(c8[c9],e[c9])
}}return c9===db?b2(de,e[c9],-1):b2(c8[c9],dd,1)
};
[0,0].sort(cg);
b9=!cc;
cQ.uniqueSort=function(c8){var c9,da=[],c7=1,e=0;
cc=b9;
c8.sort(cg);
if(cc){for(;
(c9=c8[c7]);
c7++){if(c9===c8[c7-1]){e=da.push(c7)
}}while(e--){c8.splice(da[e],1)
}}return c8
};
cQ.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)
};
function b1(da,df){var c7,db,dd,de,dc,c8,e,c9=cV[cZ][da+" "];
if(c9){return df?0:c9.slice(0)
}dc=da;
c8=[];
e=cL.preFilter;
while(dc){if(!c7||(db=b5.exec(dc))){if(db){dc=dc.slice(db[0].length)||dc
}c8.push(dd=[])
}c7=false;
if((db=cH.exec(dc))){dd.push(c7=new b4(db.shift()));
dc=dc.slice(c7.length);
c7.type=db[0].replace(cT," ")
}for(de in cL.filter){if((db=cG[de].exec(dc))&&(!e[de]||(db=e[de](db)))){dd.push(c7=new b4(db.shift()));
dc=dc.slice(c7.length);
c7.type=de;
c7.matches=db
}}if(!c7){break
}}return df?dc.length:dc?cQ.error(da):cV(da,c8).slice(0)
}function cw(da,c8,c9){var e=c8.dir,db=c9&&c8.dir==="parentNode",c7=cf++;
return c8.first?function(de,dd,dc){while((de=de[e])){if(db||de.nodeType===1){return da(de,dd,dc)
}}}:function(df,de,dd){if(!dd){var dc,dg=cr+" "+c7+" ",dh=dg+cX;
while((df=df[e])){if(db||df.nodeType===1){if((dc=df[cZ])===dh){return df.sizset
}else{if(typeof dc==="string"&&dc.indexOf(dg)===0){if(df.sizset){return df
}}else{df[cZ]=dh;
if(da(df,de,dd)){df.sizset=true;
return df
}df.sizset=false
}}}}}else{while((df=df[e])){if(db||df.nodeType===1){if(da(df,de,dd)){return df
}}}}}
}function ce(e){return e.length>1?function(da,c9,c7){var c8=e.length;
while(c8--){if(!e[c8](da,c9,c7)){return false
}}return true
}:e[0]
}function cv(e,c7,c8,c9,dc){var da,df=[],db=0,dd=e.length,de=c7!=null;
for(;
db<dd;
db++){if((da=e[db])){if(!c8||c8(da,c9,dc)){df.push(da);
if(de){c7.push(db)
}}}}return df
}function c2(c8,c7,da,c9,db,e){if(c9&&!c9[cZ]){c9=c2(c9)
}if(db&&!db[cZ]){db=c2(db,e)
}return c1(function(dm,dj,de,dl){var dp,dk,dg,df=[],dn=[],dd=dj.length,dc=dm||cp(c7||"*",de.nodeType?[de]:de,[]),dh=c8&&(dm||!c7)?cv(dc,df,c8,de,dl):dc,di=da?db||(dm?c8:dd||c9)?[]:dj:dh;
if(da){da(dh,di,de,dl)
}if(c9){dp=cv(di,dn);
c9(dp,[],de,dl);
dk=dp.length;
while(dk--){if((dg=dp[dk])){di[dn[dk]]=!(dh[dn[dk]]=dg)
}}}if(dm){if(db||c8){if(db){dp=[];
dk=di.length;
while(dk--){if((dg=di[dk])){dp.push((dh[dk]=dg))
}}db(null,(di=[]),dp,dl)
}dk=di.length;
while(dk--){if((dg=di[dk])&&(dp=db?co.call(dm,dg):df[dk])>-1){dm[dp]=!(dj[dp]=dg)
}}}}else{di=cv(di===dj?di.splice(dd,di.length):di);
if(db){db(null,dj,di,dl)
}else{cW.apply(dj,di)
}}})
}function cx(dc){var c7,da,c8,db=dc.length,df=cL.relative[dc[0].type],dg=df||cL.relative[" "],c9=df?1:0,dd=cw(function(dh){return dh===c7
},dg,true),de=cw(function(dh){return co.call(c7,dh)>-1
},dg,true),e=[function(dj,di,dh){return(!df&&(dh||di!==cJ))||((c7=di).nodeType?dd(dj,di,dh):de(dj,di,dh))
}];
for(;
c9<db;
c9++){if((da=cL.relative[dc[c9].type])){e=[cw(ce(e),da)]
}else{da=cL.filter[dc[c9].type].apply(null,dc[c9].matches);
if(da[cZ]){c8=++c9;
for(;
c8<db;
c8++){if(cL.relative[dc[c8].type]){break
}}return c2(c9>1&&ce(e),c9>1&&dc.slice(0,c9-1).join("").replace(cT,"$1"),da,c9<c8&&cx(dc.slice(c9,c8)),c8<db&&cx((dc=dc.slice(c8))),c8<db&&dc.join(""))
}e.push(da)
}}return ce(e)
}function b6(c9,c8){var e=c8.length>0,da=c9.length>0,c7=function(dk,de,dj,di,dr){var df,dg,dl,dq=[],dp=0,dh="0",db=dk&&[],dm=dr!=null,dn=cJ,dd=dk||da&&cL.find.TAG("*",dr&&de.parentNode||de),dc=(cr+=dn==null?1:Math.E);
if(dm){cJ=de!==b8&&de;
cX=c7.el
}for(;
(df=dd[dh])!=null;
dh++){if(da&&df){for(dg=0;
(dl=c9[dg]);
dg++){if(dl(df,de,dj)){di.push(df);
break
}}if(dm){cr=dc;
cX=++c7.el
}}if(e){if((df=!dl&&df)){dp--
}if(dk){db.push(df)
}}}dp+=dh;
if(e&&dh!==dp){for(dg=0;
(dl=c8[dg]);
dg++){dl(db,dq,de,dj)
}if(dk){if(dp>0){while(dh--){if(!(db[dh]||dq[dh])){dq[dh]=cE.call(di)
}}}dq=cv(dq)
}cW.apply(di,dq);
if(dm&&!dk&&dq.length>0&&(dp+c8.length)>1){cQ.uniqueSort(di)
}}if(dm){cr=dc;
cJ=dn
}return db
};
c7.el=0;
return e?c1(c7):c7
}cd=cQ.compile=function(e,db){var c8,c7=[],da=[],c9=cn[cZ][e+" "];
if(!c9){if(!db){db=b1(e)
}c8=db.length;
while(c8--){c9=cx(db[c8]);
if(c9[cZ]){c7.push(c9)
}else{da.push(c9)
}}c9=cn(e,b6(da,c7))
}return c9
};
function cp(c7,da,c9){var c8=0,e=da.length;
for(;
c8<e;
c8++){cQ(c7,da[c8],c9)
}return c9
}function cY(c8,e,da,de,dd){var db,dh,c7,dg,df,dc=b1(c8),c9=dc.length;
if(!de){if(dc.length===1){dh=dc[0]=dc[0].slice(0);
if(dh.length>2&&(c7=dh[0]).type==="ID"&&e.nodeType===9&&!dd&&cL.relative[dh[1].type]){e=cL.find.ID(c7.matches[0].replace(ct,""),e,dd)[0];
if(!e){return da
}c8=c8.slice(dh.shift().length)
}for(db=cG.POS.test(c8)?-1:dh.length-1;
db>=0;
db--){c7=dh[db];
if(cL.relative[(dg=c7.type)]){break
}if((df=cL.find[dg])){if((de=df(c7.matches[0].replace(ct,""),cR.test(dh[0].type)&&e.parentNode||e,dd))){dh.splice(db,1);
c8=de.length&&dh.join("");
if(!c8){cW.apply(da,cl.call(de,0));
return da
}break
}}}}}cd(c8,dc)(de,e,dd,da,cR.test(c8));
return da
}if(b8.querySelectorAll){(function(){var db,dc=cY,da=/'|\\/g,c8=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,c7=[":focus"],e=[":active"],c9=cb.matchesSelector||cb.mozMatchesSelector||cb.webkitMatchesSelector||cb.oMatchesSelector||cb.msMatchesSelector;
cK(function(dd){dd.innerHTML="<select><option selected=''></option></select>";
if(!dd.querySelectorAll("[selected]").length){c7.push("\\["+cy+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")
}if(!dd.querySelectorAll(":checked").length){c7.push(":checked")
}});
cK(function(dd){dd.innerHTML="<p test=''></p>";
if(dd.querySelectorAll("[test^='']").length){c7.push("[*^$]="+cy+"*(?:\"\"|'')")
}dd.innerHTML="<input type='hidden'/>";
if(!dd.querySelectorAll(":enabled").length){c7.push(":enabled",":disabled")
}});
c7=new RegExp(c7.join("|"));
cY=function(dj,de,dl,dp,dn){if(!dp&&!dn&&!c7.test(dj)){var dh,dm,dg=true,dd=cZ,df=de,dk=de.nodeType===9&&dj;
if(de.nodeType===1&&de.nodeName.toLowerCase()!=="object"){dh=b1(dj);
if((dg=de.getAttribute("id"))){dd=dg.replace(da,"\\$&")
}else{de.setAttribute("id",dd)
}dd="[id='"+dd+"'] ";
dm=dh.length;
while(dm--){dh[dm]=dd+dh[dm].join("")
}df=cR.test(dj)&&de.parentNode||de;
dk=dh.join(",")
}if(dk){try{cW.apply(dl,cl.call(df.querySelectorAll(dk),0));
return dl
}catch(di){}finally{if(!dg){de.removeAttribute("id")
}}}}return dc(dj,de,dl,dp,dn)
};
if(c9){cK(function(de){db=c9.call(de,"div");
try{c9.call(de,"[test!='']:sizzle");
e.push("!=",c6)
}catch(dd){}});
e=new RegExp(e.join("|"));
cQ.matchesSelector=function(de,dg){dg=dg.replace(c8,"='$1']");
if(!cm(de)&&!e.test(dg)&&!c7.test(dg)){try{var dd=c9.call(de,dg);
if(dd||db||de.document&&de.document.nodeType!==11){return dd
}}catch(df){}}return cQ(dg,null,null,[de]).length>0
}
}})()
}cL.pseudos.nth=cL.pseudos.eq;
function cj(){}cL.filters=cj.prototype=cL.pseudos;
cL.setFilters=new cj();
cQ.attr=bG.attr;
bG.find=cQ;
bG.expr=cQ.selectors;
bG.expr[":"]=bG.expr.pseudos;
bG.unique=cQ.uniqueSort;
bG.text=cQ.getText;
bG.isXMLDoc=cQ.isXML;
bG.contains=cQ.contains
})(a2);
var ag=/Until$/,bq=/^(?:parents|prev(?:Until|All))/,al=/^.[^:#\[\.,]*$/,y=bG.expr.match.needsContext,bu={children:true,contents:true,next:true,prev:true};
bG.fn.extend({find:function(e){var b2,bZ,b4,b5,b3,b1,b0=this;
if(typeof e!=="string"){return bG(e).filter(function(){for(b2=0,bZ=b0.length;
b2<bZ;
b2++){if(bG.contains(b0[b2],this)){return true
}}})
}b1=this.pushStack("","find",e);
for(b2=0,bZ=this.length;
b2<bZ;
b2++){b4=b1.length;
bG.find(e,this[b2],b1);
if(b2>0){for(b5=b4;
b5<b1.length;
b5++){for(b3=0;
b3<b4;
b3++){if(b1[b3]===b1[b5]){b1.splice(b5--,1);
break
}}}}}return b1
},has:function(b1){var b0,bZ=bG(b1,this),e=bZ.length;
return this.filter(function(){for(b0=0;
b0<e;
b0++){if(bG.contains(this,bZ[b0])){return true
}}})
},not:function(e){return this.pushStack(aM(this,e,false),"not",e)
},filter:function(e){return this.pushStack(aM(this,e,true),"filter",e)
},is:function(e){return !!e&&(typeof e==="string"?y.test(e)?bG(e,this.context).index(this[0])>=0:bG.filter(e,this).length>0:this.filter(e).length>0)
},closest:function(b2,b1){var b3,b0=0,e=this.length,bZ=[],b4=y.test(b2)||typeof b2!=="string"?bG(b2,b1||this.context):0;
for(;
b0<e;
b0++){b3=this[b0];
while(b3&&b3.ownerDocument&&b3!==b1&&b3.nodeType!==11){if(b4?b4.index(b3)>-1:bG.find.matchesSelector(b3,b2)){bZ.push(b3);
break
}b3=b3.parentNode
}}bZ=bZ.length>1?bG.unique(bZ):bZ;
return this.pushStack(bZ,"closest",b2)
},index:function(e){if(!e){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1
}if(typeof e==="string"){return bG.inArray(this[0],bG(e))
}return bG.inArray(e.jquery?e[0]:e,this)
},add:function(e,bZ){var b1=typeof e==="string"?bG(e,bZ):bG.makeArray(e&&e.nodeType?[e]:e),b0=bG.merge(this.get(),b1);
return this.pushStack(aR(b1[0])||aR(b0[0])?b0:bG.unique(b0))
},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))
}});
bG.fn.andSelf=bG.fn.addBack;
function aR(e){return !e||!e.parentNode||e.parentNode.nodeType===11
}function aY(bZ,e){do{bZ=bZ[e]
}while(bZ&&bZ.nodeType!==1);
return bZ
}bG.each({parent:function(bZ){var e=bZ.parentNode;
return e&&e.nodeType!==11?e:null
},parents:function(e){return bG.dir(e,"parentNode")
},parentsUntil:function(bZ,e,b0){return bG.dir(bZ,"parentNode",b0)
},next:function(e){return aY(e,"nextSibling")
},prev:function(e){return aY(e,"previousSibling")
},nextAll:function(e){return bG.dir(e,"nextSibling")
},prevAll:function(e){return bG.dir(e,"previousSibling")
},nextUntil:function(bZ,e,b0){return bG.dir(bZ,"nextSibling",b0)
},prevUntil:function(bZ,e,b0){return bG.dir(bZ,"previousSibling",b0)
},siblings:function(e){return bG.sibling((e.parentNode||{}).firstChild,e)
},children:function(e){return bG.sibling(e.firstChild)
},contents:function(e){return bG.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:bG.merge([],e.childNodes)
}},function(e,bZ){bG.fn[e]=function(b2,b0){var b1=bG.map(this,bZ,b2);
if(!ag.test(e)){b0=b2
}if(b0&&typeof b0==="string"){b1=bG.filter(b0,b1)
}b1=this.length>1&&!bu[e]?bG.unique(b1):b1;
if(this.length>1&&bq.test(e)){b1=b1.reverse()
}return this.pushStack(b1,e,a4.call(arguments).join(","))
}
});
bG.extend({filter:function(b0,e,bZ){if(bZ){b0=":not("+b0+")"
}return e.length===1?bG.find.matchesSelector(e[0],b0)?[e[0]]:[]:bG.find.matches(b0,e)
},dir:function(b0,bZ,b2){var e=[],b1=b0[bZ];
while(b1&&b1.nodeType!==9&&(b2===aB||b1.nodeType!==1||!bG(b1).is(b2))){if(b1.nodeType===1){e.push(b1)
}b1=b1[bZ]
}return e
},sibling:function(b0,bZ){var e=[];
for(;
b0;
b0=b0.nextSibling){if(b0.nodeType===1&&b0!==bZ){e.push(b0)
}}return e
}});
function aM(b1,b0,e){b0=b0||0;
if(bG.isFunction(b0)){return bG.grep(b1,function(b3,b2){var b4=!!b0.call(b3,b2,b3);
return b4===e
})
}else{if(b0.nodeType){return bG.grep(b1,function(b3,b2){return(b3===b0)===e
})
}else{if(typeof b0==="string"){var bZ=bG.grep(b1,function(b2){return b2.nodeType===1
});
if(al.test(b0)){return bG.filter(b0,bZ,!e)
}else{b0=bG.filter(b0,bZ)
}}}}return bG.grep(b1,function(b3,b2){return(bG.inArray(b3,b0)>=0)===e
})
}function A(e){var b0=c.split("|"),bZ=e.createDocumentFragment();
if(bZ.createElement){while(b0.length){bZ.createElement(b0.pop())
}}return bZ
}var c="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",av=/ jQuery\d+="(?:null|\d+)"/g,bY=/^\s+/,ay=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,p=/<([\w:]+)/,bT=/<tbody/i,J=/<|&#?\w+;/,aj=/<(?:script|style|link)/i,ap=/<(?:script|object|embed|option|style)/i,K=new RegExp("<(?:"+c+")[\\s/>]","i"),aE=/^(?:checkbox|radio)$/,bR=/checked\s*(?:[^=]|=\s*.checked.)/i,bw=/\/(java|ecma)script/i,aH=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,T={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},aQ=A(o),l=aQ.appendChild(o.createElement("div"));
T.optgroup=T.option;
T.tbody=T.tfoot=T.colgroup=T.caption=T.thead;
T.th=T.td;
if(!bG.support.htmlSerialize){T._default=[1,"X<div>","</div>"]
}bG.fn.extend({text:function(e){return bG.access(this,function(bZ){return bZ===aB?bG.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(bZ))
},null,e,arguments.length)
},wrapAll:function(e){if(bG.isFunction(e)){return this.each(function(b0){bG(this).wrapAll(e.call(this,b0))
})
}if(this[0]){var bZ=bG(e,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode){bZ.insertBefore(this[0])
}bZ.map(function(){var b0=this;
while(b0.firstChild&&b0.firstChild.nodeType===1){b0=b0.firstChild
}return b0
}).append(this)
}return this
},wrapInner:function(e){if(bG.isFunction(e)){return this.each(function(bZ){bG(this).wrapInner(e.call(this,bZ))
})
}return this.each(function(){var bZ=bG(this),b0=bZ.contents();
if(b0.length){b0.wrapAll(e)
}else{bZ.append(e)
}})
},wrap:function(e){var bZ=bG.isFunction(e);
return this.each(function(b0){bG(this).wrapAll(bZ?e.call(this,b0):e)
})
},unwrap:function(){return this.parent().each(function(){if(!bG.nodeName(this,"body")){bG(this).replaceWith(this.childNodes)
}}).end()
},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11){this.appendChild(e)
}})
},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11){this.insertBefore(e,this.firstChild)
}})
},before:function(){if(!aR(this[0])){return this.domManip(arguments,false,function(bZ){this.parentNode.insertBefore(bZ,this)
})
}if(arguments.length){var e=bG.clean(arguments);
return this.pushStack(bG.merge(e,this),"before",this.selector)
}},after:function(){if(!aR(this[0])){return this.domManip(arguments,false,function(bZ){this.parentNode.insertBefore(bZ,this.nextSibling)
})
}if(arguments.length){var e=bG.clean(arguments);
return this.pushStack(bG.merge(this,e),"after",this.selector)
}},remove:function(e,b1){var b0,bZ=0;
for(;
(b0=this[bZ])!=null;
bZ++){if(!e||bG.filter(e,[b0]).length){if(!b1&&b0.nodeType===1){bG.cleanData(b0.getElementsByTagName("*"));
bG.cleanData([b0])
}if(b0.parentNode){b0.parentNode.removeChild(b0)
}}}return this
},empty:function(){var bZ,e=0;
for(;
(bZ=this[e])!=null;
e++){if(bZ.nodeType===1){bG.cleanData(bZ.getElementsByTagName("*"))
}while(bZ.firstChild){bZ.removeChild(bZ.firstChild)
}}return this
},clone:function(bZ,e){bZ=bZ==null?false:bZ;
e=e==null?bZ:e;
return this.map(function(){return bG.clone(this,bZ,e)
})
},html:function(e){return bG.access(this,function(b2){var b1=this[0]||{},b0=0,bZ=this.length;
if(b2===aB){return b1.nodeType===1?b1.innerHTML.replace(av,""):aB
}if(typeof b2==="string"&&!aj.test(b2)&&(bG.support.htmlSerialize||!K.test(b2))&&(bG.support.leadingWhitespace||!bY.test(b2))&&!T[(p.exec(b2)||["",""])[1].toLowerCase()]){b2=b2.replace(ay,"<$1></$2>");
try{for(;
b0<bZ;
b0++){b1=this[b0]||{};
if(b1.nodeType===1){bG.cleanData(b1.getElementsByTagName("*"));
b1.innerHTML=b2
}}b1=0
}catch(b3){}}if(b1){this.empty().append(b2)
}},null,e,arguments.length)
},replaceWith:function(e){if(!aR(this[0])){if(bG.isFunction(e)){return this.each(function(b1){var b0=bG(this),bZ=b0.html();
b0.replaceWith(e.call(this,b1,bZ))
})
}if(typeof e!=="string"){e=bG(e).detach()
}return this.each(function(){var b0=this.nextSibling,bZ=this.parentNode;
bG(this).remove();
if(b0){bG(b0).before(e)
}else{bG(bZ).append(e)
}})
}return this.length?this.pushStack(bG(bG.isFunction(e)?e():e),"replaceWith",e):this
},detach:function(e){return this.remove(e,true)
},domManip:function(b4,b8,b7){b4=[].concat.apply([],b4);
var b0,b2,b3,b6,b1=0,b5=b4[0],bZ=[],e=this.length;
if(!bG.support.checkClone&&e>1&&typeof b5==="string"&&bR.test(b5)){return this.each(function(){bG(this).domManip(b4,b8,b7)
})
}if(bG.isFunction(b5)){return this.each(function(ca){var b9=bG(this);
b4[0]=b5.call(this,ca,b8?b9.html():aB);
b9.domManip(b4,b8,b7)
})
}if(this[0]){b0=bG.buildFragment(b4,this,bZ);
b3=b0.fragment;
b2=b3.firstChild;
if(b3.childNodes.length===1){b3=b2
}if(b2){b8=b8&&bG.nodeName(b2,"tr");
for(b6=b0.cacheable||e-1;
b1<e;
b1++){b7.call(b8&&bG.nodeName(this[b1],"table")?x(this[b1],"tbody"):this[b1],b1===b6?b3:bG.clone(b3,true,true))
}}b3=b2=null;
if(bZ.length){bG.each(bZ,function(b9,ca){if(ca.src){if(bG.ajax){bG.ajax({url:ca.src,type:"GET",dataType:"script",async:false,global:false,"throws":true})
}else{bG.error("no ajax")
}}else{bG.globalEval((ca.text||ca.textContent||ca.innerHTML||"").replace(aH,""))
}if(ca.parentNode){ca.parentNode.removeChild(ca)
}})
}}return this
}});
function x(bZ,e){return bZ.getElementsByTagName(e)[0]||bZ.appendChild(bZ.ownerDocument.createElement(e))
}function ao(b5,bZ){if(bZ.nodeType!==1||!bG.hasData(b5)){return
}var b2,b1,e,b4=bG._data(b5),b3=bG._data(bZ,b4),b0=b4.events;
if(b0){delete b3.handle;
b3.events={};
for(b2 in b0){for(b1=0,e=b0[b2].length;
b1<e;
b1++){bG.event.add(bZ,b2,b0[b2][b1])
}}}if(b3.data){b3.data=bG.extend({},b3.data)
}}function F(bZ,e){var b0;
if(e.nodeType!==1){return
}if(e.clearAttributes){e.clearAttributes()
}if(e.mergeAttributes){e.mergeAttributes(bZ)
}b0=e.nodeName.toLowerCase();
if(b0==="object"){if(e.parentNode){e.outerHTML=bZ.outerHTML
}if(bG.support.html5Clone&&(bZ.innerHTML&&!bG.trim(e.innerHTML))){e.innerHTML=bZ.innerHTML
}}else{if(b0==="input"&&aE.test(bZ.type)){e.defaultChecked=e.checked=bZ.checked;
if(e.value!==bZ.value){e.value=bZ.value
}}else{if(b0==="option"){e.selected=bZ.defaultSelected
}else{if(b0==="input"||b0==="textarea"){e.defaultValue=bZ.defaultValue
}else{if(b0==="script"&&e.text!==bZ.text){e.text=bZ.text
}}}}}e.removeAttribute(bG.expando)
}bG.buildFragment=function(b1,b2,bZ){var b0,e,b3,b4=b1[0];
b2=b2||o;
b2=!b2.nodeType&&b2[0]||b2;
b2=b2.ownerDocument||b2;
if(b1.length===1&&typeof b4==="string"&&b4.length<512&&b2===o&&b4.charAt(0)==="<"&&!ap.test(b4)&&(bG.support.checkClone||!bR.test(b4))&&(bG.support.html5Clone||!K.test(b4))){e=true;
b0=bG.fragments[b4];
b3=b0!==aB
}if(!b0){b0=b2.createDocumentFragment();
bG.clean(b1,b2,b0,bZ);
if(e){bG.fragments[b4]=b3&&b0
}}return{fragment:b0,cacheable:e}
};
bG.fragments={};
bG.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,bZ){bG.fn[e]=function(b0){var b2,b4=0,b3=[],b6=bG(b0),b1=b6.length,b5=this.length===1&&this[0].parentNode;
if((b5==null||b5&&b5.nodeType===11&&b5.childNodes.length===1)&&b1===1){b6[bZ](this[0]);
return this
}else{for(;
b4<b1;
b4++){b2=(b4>0?this.clone(true):this).get();
bG(b6[b4])[bZ](b2);
b3=b3.concat(b2)
}return this.pushStack(b3,e,b6.selector)
}}
});
function m(e){if(typeof e.getElementsByTagName!=="undefined"){return e.getElementsByTagName("*")
}else{if(typeof e.querySelectorAll!=="undefined"){return e.querySelectorAll("*")
}else{return[]
}}}function bS(e){if(aE.test(e.type)){e.defaultChecked=e.checked
}}bG.extend({clone:function(b2,b4,b0){var e,bZ,b1,b3;
if(bG.support.html5Clone||bG.isXMLDoc(b2)||!K.test("<"+b2.nodeName+">")){b3=b2.cloneNode(true)
}else{l.innerHTML=b2.outerHTML;
l.removeChild(b3=l.firstChild)
}if((!bG.support.noCloneEvent||!bG.support.noCloneChecked)&&(b2.nodeType===1||b2.nodeType===11)&&!bG.isXMLDoc(b2)){F(b2,b3);
e=m(b2);
bZ=m(b3);
for(b1=0;
e[b1];
++b1){if(bZ[b1]){F(e[b1],bZ[b1])
}}}if(b4){ao(b2,b3);
if(b0){e=m(b2);
bZ=m(b3);
for(b1=0;
e[b1];
++b1){ao(e[b1],bZ[b1])
}}}e=bZ=null;
return b3
},clean:function(cb,b0,e,b1){var b8,b7,ca,cf,b4,ce,b5,b2,bZ,b9,cd,b6,b3=b0===o&&aQ,cc=[];
if(!b0||typeof b0.createDocumentFragment==="undefined"){b0=o
}for(b8=0;
(ca=cb[b8])!=null;
b8++){if(typeof ca==="number"){ca+=""
}if(!ca){continue
}if(typeof ca==="string"){if(!J.test(ca)){ca=b0.createTextNode(ca)
}else{b3=b3||A(b0);
b5=b0.createElement("div");
b3.appendChild(b5);
ca=ca.replace(ay,"<$1></$2>");
cf=(p.exec(ca)||["",""])[1].toLowerCase();
b4=T[cf]||T._default;
ce=b4[0];
b5.innerHTML=b4[1]+ca+b4[2];
while(ce--){b5=b5.lastChild
}if(!bG.support.tbody){b2=bT.test(ca);
bZ=cf==="table"&&!b2?b5.firstChild&&b5.firstChild.childNodes:b4[1]==="<table>"&&!b2?b5.childNodes:[];
for(b7=bZ.length-1;
b7>=0;
--b7){if(bG.nodeName(bZ[b7],"tbody")&&!bZ[b7].childNodes.length){bZ[b7].parentNode.removeChild(bZ[b7])
}}}if(!bG.support.leadingWhitespace&&bY.test(ca)){b5.insertBefore(b0.createTextNode(bY.exec(ca)[0]),b5.firstChild)
}ca=b5.childNodes;
b5.parentNode.removeChild(b5)
}}if(ca.nodeType){cc.push(ca)
}else{bG.merge(cc,ca)
}}if(b5){ca=b5=b3=null
}if(!bG.support.appendChecked){for(b8=0;
(ca=cc[b8])!=null;
b8++){if(bG.nodeName(ca,"input")){bS(ca)
}else{if(typeof ca.getElementsByTagName!=="undefined"){bG.grep(ca.getElementsByTagName("input"),bS)
}}}}if(e){cd=function(cg){if(!cg.type||bw.test(cg.type)){return b1?b1.push(cg.parentNode?cg.parentNode.removeChild(cg):cg):e.appendChild(cg)
}};
for(b8=0;
(ca=cc[b8])!=null;
b8++){if(!(bG.nodeName(ca,"script")&&cd(ca))){e.appendChild(ca);
if(typeof ca.getElementsByTagName!=="undefined"){b6=bG.grep(bG.merge([],ca.getElementsByTagName("script")),cd);
cc.splice.apply(cc,[b8+1,0].concat(b6));
b8+=b6.length
}}}}return cc
},cleanData:function(bZ,b7){var b2,b0,b1,b6,b3=0,b8=bG.expando,e=bG.cache,b4=bG.support.deleteExpando,b5=bG.event.special;
for(;
(b1=bZ[b3])!=null;
b3++){if(b7||bG.acceptData(b1)){b0=b1[b8];
b2=b0&&e[b0];
if(b2){if(b2.events){for(b6 in b2.events){if(b5[b6]){bG.event.remove(b1,b6)
}else{bG.removeEvent(b1,b6,b2.handle)
}}}if(e[b0]){delete e[b0];
if(b4){delete b1[b8]
}else{if(b1.removeAttribute){b1.removeAttribute(b8)
}else{b1[b8]=null
}}bG.deletedIds.push(b0)
}}}}}});
(function(){var e,bZ;
bG.uaMatch=function(b1){b1=b1.toLowerCase();
var b0=/(chrome)[ \/]([\w.]+)/.exec(b1)||/(webkit)[ \/]([\w.]+)/.exec(b1)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b1)||/(msie) ([\w.]+)/.exec(b1)||b1.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b1)||[];
return{browser:b0[1]||"",version:b0[2]||"0"}
};
e=bG.uaMatch(d.userAgent);
bZ={};
if(e.browser){bZ[e.browser]=true;
bZ.version=e.version
}if(bZ.chrome){bZ.webkit=true
}else{if(bZ.webkit){bZ.safari=true
}}bG.browser=bZ;
bG.sub=function(){function b0(b3,b4){return new b0.fn.init(b3,b4)
}bG.extend(true,b0,this);
b0.superclass=this;
b0.fn=b0.prototype=this();
b0.fn.constructor=b0;
b0.sub=this.sub;
b0.fn.init=function b2(b3,b4){if(b4&&b4 instanceof bG&&!(b4 instanceof b0)){b4=b0(b4)
}return bG.fn.init.call(this,b3,b4,b1)
};
b0.fn.init.prototype=b0.fn;
var b1=b0(o);
return b0
}
})();
var E,az,aW,be=/alpha\([^)]*\)/i,aS=/opacity=([^)]*)/,bk=/^(top|right|bottom|left)$/,G=/^(none|table(?!-c[ea]).+)/,aZ=/^margin/,a8=new RegExp("^("+bx+")(.*)$","i"),W=new RegExp("^("+bx+")(?!px)[a-z%]+$","i"),S=new RegExp("^([-+])=("+bx+")","i"),bh={BODY:"block"},a9={position:"absolute",visibility:"hidden",display:"block"},bA={letterSpacing:0,fontWeight:400},bQ=["Top","Right","Bottom","Left"],ar=["Webkit","O","Moz","ms"],aJ=bG.fn.toggle;
function b(b1,bZ){if(bZ in b1){return bZ
}var b2=bZ.charAt(0).toUpperCase()+bZ.slice(1),e=bZ,b0=ar.length;
while(b0--){bZ=ar[b0]+b2;
if(bZ in b1){return bZ
}}return e
}function Q(bZ,e){bZ=e||bZ;
return bG.css(bZ,"display")==="none"||!bG.contains(bZ.ownerDocument,bZ)
}function s(b3,e){var b2,b4,bZ=[],b0=0,b1=b3.length;
for(;
b0<b1;
b0++){b2=b3[b0];
if(!b2.style){continue
}bZ[b0]=bG._data(b2,"olddisplay");
if(e){if(!bZ[b0]&&b2.style.display==="none"){b2.style.display=""
}if(b2.style.display===""&&Q(b2)){bZ[b0]=bG._data(b2,"olddisplay",bC(b2.nodeName))
}}else{b4=E(b2,"display");
if(!bZ[b0]&&b4!=="none"){bG._data(b2,"olddisplay",b4)
}}}for(b0=0;
b0<b1;
b0++){b2=b3[b0];
if(!b2.style){continue
}if(!e||b2.style.display==="none"||b2.style.display===""){b2.style.display=e?bZ[b0]||"":"none"
}}return b3
}bG.fn.extend({css:function(e,bZ){return bG.access(this,function(b1,b0,b2){return b2!==aB?bG.style(b1,b0,b2):bG.css(b1,b0)
},e,bZ,arguments.length>1)
},show:function(){return s(this,true)
},hide:function(){return s(this)
},toggle:function(b0,bZ){var e=typeof b0==="boolean";
if(bG.isFunction(b0)&&bG.isFunction(bZ)){return aJ.apply(this,arguments)
}return this.each(function(){if(e?b0:Q(this)){bG(this).show()
}else{bG(this).hide()
}})
}});
bG.extend({cssHooks:{opacity:{get:function(b0,bZ){if(bZ){var e=E(b0,"opacity");
return e===""?"1":e
}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":bG.support.cssFloat?"cssFloat":"styleFloat"},style:function(b1,b0,b7,b2){if(!b1||b1.nodeType===3||b1.nodeType===8||!b1.style){return
}var b5,b6,b8,b3=bG.camelCase(b0),bZ=b1.style;
b0=bG.cssProps[b3]||(bG.cssProps[b3]=b(bZ,b3));
b8=bG.cssHooks[b0]||bG.cssHooks[b3];
if(b7!==aB){b6=typeof b7;
if(b6==="string"&&(b5=S.exec(b7))){b7=(b5[1]+1)*b5[2]+parseFloat(bG.css(b1,b0));
b6="number"
}if(b7==null||b6==="number"&&isNaN(b7)){return
}if(b6==="number"&&!bG.cssNumber[b3]){b7+="px"
}if(!b8||!("set" in b8)||(b7=b8.set(b1,b7,b2))!==aB){try{bZ[b0]=b7
}catch(b4){}}}else{if(b8&&"get" in b8&&(b5=b8.get(b1,false,b2))!==aB){return b5
}return bZ[b0]
}},css:function(b4,b2,b3,bZ){var b5,b1,e,b0=bG.camelCase(b2);
b2=bG.cssProps[b0]||(bG.cssProps[b0]=b(b4.style,b0));
e=bG.cssHooks[b2]||bG.cssHooks[b0];
if(e&&"get" in e){b5=e.get(b4,true,bZ)
}if(b5===aB){b5=E(b4,b2)
}if(b5==="normal"&&b2 in bA){b5=bA[b2]
}if(b3||bZ!==aB){b1=parseFloat(b5);
return b3||bG.isNumeric(b1)?b1||0:b5
}return b5
},swap:function(b2,b1,b3){var b0,bZ,e={};
for(bZ in b1){e[bZ]=b2.style[bZ];
b2.style[bZ]=b1[bZ]
}b0=b3.call(b2);
for(bZ in b1){b2.style[bZ]=e[bZ]
}return b0
}});
if(a2.getComputedStyle){E=function(b5,bZ){var e,b2,b1,b4,b3=a2.getComputedStyle(b5,null),b0=b5.style;
if(b3){e=b3.getPropertyValue(bZ)||b3[bZ];
if(e===""&&!bG.contains(b5.ownerDocument,b5)){e=bG.style(b5,bZ)
}if(W.test(e)&&aZ.test(bZ)){b2=b0.width;
b1=b0.minWidth;
b4=b0.maxWidth;
b0.minWidth=b0.maxWidth=b0.width=e;
e=b3.width;
b0.width=b2;
b0.minWidth=b1;
b0.maxWidth=b4
}}return e
}
}else{if(o.documentElement.currentStyle){E=function(b2,b0){var b3,e,bZ=b2.currentStyle&&b2.currentStyle[b0],b1=b2.style;
if(bZ==null&&b1&&b1[b0]){bZ=b1[b0]
}if(W.test(bZ)&&!bk.test(b0)){b3=b1.left;
e=b2.runtimeStyle&&b2.runtimeStyle.left;
if(e){b2.runtimeStyle.left=b2.currentStyle.left
}b1.left=b0==="fontSize"?"1em":bZ;
bZ=b1.pixelLeft+"px";
b1.left=b3;
if(e){b2.runtimeStyle.left=e
}}return bZ===""?"auto":bZ
}
}}function aG(e,b0,b1){var bZ=a8.exec(b0);
return bZ?Math.max(0,bZ[1]-(b1||0))+(bZ[2]||"px"):b0
}function at(b1,bZ,e,b3){var b0=e===(b3?"border":"content")?4:bZ==="width"?1:0,b2=0;
for(;
b0<4;
b0+=2){if(e==="margin"){b2+=bG.css(b1,e+bQ[b0],true)
}if(b3){if(e==="content"){b2-=parseFloat(E(b1,"padding"+bQ[b0]))||0
}if(e!=="margin"){b2-=parseFloat(E(b1,"border"+bQ[b0]+"Width"))||0
}}else{b2+=parseFloat(E(b1,"padding"+bQ[b0]))||0;
if(e!=="padding"){b2+=parseFloat(E(b1,"border"+bQ[b0]+"Width"))||0
}}}return b2
}function u(b1,bZ,e){var b2=bZ==="width"?b1.offsetWidth:b1.offsetHeight,b0=true,b3=bG.support.boxSizing&&bG.css(b1,"boxSizing")==="border-box";
if(b2<=0||b2==null){b2=E(b1,bZ);
if(b2<0||b2==null){b2=b1.style[bZ]
}if(W.test(b2)){return b2
}b0=b3&&(bG.support.boxSizingReliable||b2===b1.style[bZ]);
b2=parseFloat(b2)||0
}return(b2+at(b1,bZ,e||(b3?"border":"content"),b0))+"px"
}function bC(b0){if(bh[b0]){return bh[b0]
}var e=bG("<"+b0+">").appendTo(o.body),bZ=e.css("display");
e.remove();
if(bZ==="none"||bZ===""){az=o.body.appendChild(az||bG.extend(o.createElement("iframe"),{frameBorder:0,width:0,height:0}));
if(!aW||!az.createElement){aW=(az.contentWindow||az.contentDocument).document;
aW.write("<!doctype html><html><body>");
aW.close()
}e=aW.body.appendChild(aW.createElement(b0));
bZ=E(e,"display");
o.body.removeChild(az)
}bh[b0]=bZ;
return bZ
}bG.each(["height","width"],function(bZ,e){bG.cssHooks[e]={get:function(b2,b1,b0){if(b1){if(b2.offsetWidth===0&&G.test(E(b2,"display"))){return bG.swap(b2,a9,function(){return u(b2,e,b0)
})
}else{return u(b2,e,b0)
}}},set:function(b1,b2,b0){return aG(b1,b2,b0?at(b1,e,b0,bG.support.boxSizing&&bG.css(b1,"boxSizing")==="border-box"):0)
}}
});
if(!bG.support.opacity){bG.cssHooks.opacity={get:function(bZ,e){return aS.test((e&&bZ.currentStyle?bZ.currentStyle.filter:bZ.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":e?"1":""
},set:function(b2,b3){var b1=b2.style,bZ=b2.currentStyle,e=bG.isNumeric(b3)?"alpha(opacity="+b3*100+")":"",b0=bZ&&bZ.filter||b1.filter||"";
b1.zoom=1;
if(b3>=1&&bG.trim(b0.replace(be,""))===""&&b1.removeAttribute){b1.removeAttribute("filter");
if(bZ&&!bZ.filter){return
}}b1.filter=be.test(b0)?b0.replace(be,e):b0+" "+e
}}
}bG(function(){if(!bG.support.reliableMarginRight){bG.cssHooks.marginRight={get:function(bZ,e){return bG.swap(bZ,{display:"inline-block"},function(){if(e){return E(bZ,"marginRight")
}})
}}
}if(!bG.support.pixelPosition&&bG.fn.position){bG.each(["top","left"],function(e,bZ){bG.cssHooks[bZ]={get:function(b2,b1){if(b1){var b0=E(b2,bZ);
return W.test(b0)?bG(b2).position()[bZ]+"px":b0
}}}
})
}});
if(bG.expr&&bG.expr.filters){bG.expr.filters.hidden=function(e){return(e.offsetWidth===0&&e.offsetHeight===0)||(!bG.support.reliableHiddenOffsets&&((e.style&&e.style.display)||E(e,"display"))==="none")
};
bG.expr.filters.visible=function(e){return !bG.expr.filters.hidden(e)
}
}bG.each({margin:"",padding:"",border:"Width"},function(e,bZ){bG.cssHooks[e+bZ]={expand:function(b2){var b1,b3=typeof b2==="string"?b2.split(" "):[b2],b0={};
for(b1=0;
b1<4;
b1++){b0[e+bQ[b1]+bZ]=b3[b1]||b3[b1-2]||b3[0]
}return b0
}};
if(!aZ.test(e)){bG.cssHooks[e+bZ].set=aG
}});
var bs=/%20/g,aP=/\[\]$/,U=/\r?\n/g,bz=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aD=/^(?:select|textarea)/i;
bG.fn.extend({serialize:function(){return bG.param(this.serializeArray())
},serializeArray:function(){return this.map(function(){return this.elements?bG.makeArray(this.elements):this
}).filter(function(){return this.name&&!this.disabled&&(this.checked||aD.test(this.nodeName)||bz.test(this.type))
}).map(function(e,bZ){var b0=bG(this).val();
return b0==null?null:bG.isArray(b0)?bG.map(b0,function(b2,b1){return{name:bZ.name,value:b2.replace(U,"\r\n")}
}):{name:bZ.name,value:b0.replace(U,"\r\n")}
}).get()
}});
bG.param=function(e,b0){var b1,bZ=[],b2=function(b3,b4){b4=bG.isFunction(b4)?b4():(b4==null?"":b4);
bZ[bZ.length]=encodeURIComponent(b3)+"="+encodeURIComponent(b4)
};
if(b0===aB){b0=bG.ajaxSettings&&bG.ajaxSettings.traditional
}if(bG.isArray(e)||(e.jquery&&!bG.isPlainObject(e))){bG.each(e,function(){b2(this.name,this.value)
})
}else{for(b1 in e){k(b1,e[b1],b0,b2)
}}return bZ.join("&").replace(bs,"+")
};
function k(b0,b2,bZ,b1){var e;
if(bG.isArray(b2)){bG.each(b2,function(b4,b3){if(bZ||aP.test(b0)){b1(b0,b3)
}else{k(b0+"["+(typeof b3==="object"?b4:"")+"]",b3,bZ,b1)
}})
}else{if(!bZ&&bG.type(b2)==="object"){for(e in b2){k(b0+"["+e+"]",b2[e],bZ,b1)
}}else{b1(b0,b2)
}}}var bX,Y,an=/#.*$/,ad=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,B=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,r=/^(?:GET|HEAD)$/,aC=/^\/\//,bN=/\?/,g=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,P=/([?&])_=[^&]*/,aT=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,bW=bG.fn.load,v={},a6={},aX=["*/"]+["*"];
try{Y=aI.href
}catch(bd){Y=o.createElement("a");
Y.href="";
Y=Y.href
}bX=aT.exec(Y.toLowerCase())||[];
function bI(e){return function(b2,b4){if(typeof b2!=="string"){b4=b2;
b2="*"
}var bZ,b5,b6,b1=b2.toLowerCase().split(aV),b0=0,b3=b1.length;
if(bG.isFunction(b4)){for(;
b0<b3;
b0++){bZ=b1[b0];
b6=/^\+/.test(bZ);
if(b6){bZ=bZ.substr(1)||"*"
}b5=e[bZ]=e[bZ]||[];
b5[b6?"unshift":"push"](b4)
}}}
}function q(bZ,b8,b3,b6,b5,b1){b5=b5||b8.dataTypes[0];
b1=b1||{};
b1[b5]=true;
var b7,b4=bZ[b5],b0=0,e=b4?b4.length:0,b2=(bZ===v);
for(;
b0<e&&(b2||!b7);
b0++){b7=b4[b0](b8,b3,b6);
if(typeof b7==="string"){if(!b2||b1[b7]){b7=aB
}else{b8.dataTypes.unshift(b7);
b7=q(bZ,b8,b3,b6,b7,b1)
}}}if((b2||!b7)&&!b1["*"]){b7=q(bZ,b8,b3,b6,"*",b1)
}return b7
}function t(b0,b1){var bZ,e,b2=bG.ajaxSettings.flatOptions||{};
for(bZ in b1){if(b1[bZ]!==aB){(b2[bZ]?b0:(e||(e={})))[bZ]=b1[bZ]
}}if(e){bG.extend(true,b0,e)
}}bG.fn.load=function(b1,b4,b5){if(typeof b1!=="string"&&bW){return bW.apply(this,arguments)
}if(!this.length){return this
}var e,b2,b0,bZ=this,b3=b1.indexOf(" ");
if(b3>=0){e=b1.slice(b3,b1.length);
b1=b1.slice(0,b3)
}if(bG.isFunction(b4)){b5=b4;
b4=aB
}else{if(b4&&typeof b4==="object"){b2="POST"
}}bG.ajax({url:b1,type:b2,dataType:"html",data:b4,complete:function(b7,b6){if(b5){bZ.each(b5,b0||[b7.responseText,b6,b7])
}}}).done(function(b6){b0=arguments;
bZ.html(e?bG("<div>").append(b6.replace(g,"")).find(e):b6)
});
return this
};
bG.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,bZ){bG.fn[bZ]=function(b0){return this.on(bZ,b0)
}
});
bG.each(["get","post"],function(e,bZ){bG[bZ]=function(b0,b2,b3,b1){if(bG.isFunction(b2)){b1=b1||b3;
b3=b2;
b2=aB
}return bG.ajax({type:bZ,url:b0,data:b2,success:b3,dataType:b1})
}
});
bG.extend({getScript:function(e,bZ){return bG.get(e,aB,bZ,"script")
},getJSON:function(e,bZ,b0){return bG.get(e,bZ,b0,"json")
},ajaxSetup:function(bZ,e){if(e){t(bZ,bG.ajaxSettings)
}else{e=bZ;
bZ=bG.ajaxSettings
}t(bZ,e);
return bZ
},ajaxSettings:{url:Y,isLocal:B.test(bX[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":aX},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a2.String,"text html":true,"text json":bG.parseJSON,"text xml":bG.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:bI(v),ajaxTransport:bI(a6),ajax:function(b4,b1){if(typeof b4==="object"){b1=b4;
b4=aB
}b1=b1||{};
var b7,cl,b2,cg,b9,cd,b0,cf,b8=bG.ajaxSetup({},b1),cn=b8.context||b8,cb=cn!==b8&&(cn.nodeType||cn instanceof bG)?bG(cn):bG.event,cm=bG.Deferred(),ci=bG.Callbacks("once memory"),b5=b8.statusCode||{},cc={},cj={},b3=0,b6="canceled",ce={readyState:0,setRequestHeader:function(co,cp){if(!b3){var e=co.toLowerCase();
co=cj[e]=cj[e]||co;
cc[co]=cp
}return this
},getAllResponseHeaders:function(){return b3===2?cl:null
},getResponseHeader:function(co){var e;
if(b3===2){if(!b2){b2={};
while((e=ad.exec(cl))){b2[e[1].toLowerCase()]=e[2]
}}e=b2[co.toLowerCase()]
}return e===aB?null:e
},overrideMimeType:function(e){if(!b3){b8.mimeType=e
}return this
},abort:function(e){e=e||b6;
if(cg){cg.abort(e)
}ca(0,e);
return this
}};
function ca(cs,co,ct,cq){var e,cw,cu,cr,cv,cp=co;
if(b3===2){return
}b3=2;
if(b9){clearTimeout(b9)
}cg=aB;
cl=cq||"";
ce.readyState=cs>0?4:0;
if(ct){cr=h(b8,ce,ct)
}if(cs>=200&&cs<300||cs===304){if(b8.ifModified){cv=ce.getResponseHeader("Last-Modified");
if(cv){bG.lastModified[b7]=cv
}cv=ce.getResponseHeader("Etag");
if(cv){bG.etag[b7]=cv
}}if(cs===304){cp="notmodified";
e=true
}else{e=ae(b8,cr);
cp=e.state;
cw=e.data;
cu=e.error;
e=!cu
}}else{cu=cp;
if(!cp||cs){cp="error";
if(cs<0){cs=0
}}}ce.status=cs;
ce.statusText=(co||cp)+"";
if(e){cm.resolveWith(cn,[cw,cp,ce])
}else{cm.rejectWith(cn,[ce,cp,cu])
}ce.statusCode(b5);
b5=aB;
if(b0){cb.trigger("ajax"+(e?"Success":"Error"),[ce,b8,e?cw:cu])
}ci.fireWith(cn,[ce,cp]);
if(b0){cb.trigger("ajaxComplete",[ce,b8]);
if(!(--bG.active)){bG.event.trigger("ajaxStop")
}}}cm.promise(ce);
ce.success=ce.done;
ce.error=ce.fail;
ce.complete=ci.add;
ce.statusCode=function(co){if(co){var e;
if(b3<2){for(e in co){b5[e]=[b5[e],co[e]]
}}else{e=co[ce.status];
ce.always(e)
}}return this
};
b8.url=((b4||b8.url)+"").replace(an,"").replace(aC,bX[1]+"//");
b8.dataTypes=bG.trim(b8.dataType||"*").toLowerCase().split(aV);
if(b8.crossDomain==null){cd=aT.exec(b8.url.toLowerCase());
b8.crossDomain=!!(cd&&(cd[1]!==bX[1]||cd[2]!==bX[2]||(cd[3]||(cd[1]==="http:"?80:443))!=(bX[3]||(bX[1]==="http:"?80:443))))
}if(b8.data&&b8.processData&&typeof b8.data!=="string"){b8.data=bG.param(b8.data,b8.traditional)
}q(v,b8,b1,ce);
if(b3===2){return ce
}b0=b8.global;
b8.type=b8.type.toUpperCase();
b8.hasContent=!r.test(b8.type);
if(b0&&bG.active++===0){bG.event.trigger("ajaxStart")
}if(!b8.hasContent){if(b8.data){b8.url+=(bN.test(b8.url)?"&":"?")+b8.data;
delete b8.data
}b7=b8.url;
if(b8.cache===false){var bZ=bG.now(),ck=b8.url.replace(P,"$1_="+bZ);
b8.url=ck+((ck===b8.url)?(bN.test(b8.url)?"&":"?")+"_="+bZ:"")
}}if(b8.data&&b8.hasContent&&b8.contentType!==false||b1.contentType){ce.setRequestHeader("Content-Type",b8.contentType)
}if(b8.ifModified){b7=b7||b8.url;
if(bG.lastModified[b7]){ce.setRequestHeader("If-Modified-Since",bG.lastModified[b7])
}if(bG.etag[b7]){ce.setRequestHeader("If-None-Match",bG.etag[b7])
}}ce.setRequestHeader("Accept",b8.dataTypes[0]&&b8.accepts[b8.dataTypes[0]]?b8.accepts[b8.dataTypes[0]]+(b8.dataTypes[0]!=="*"?", "+aX+"; q=0.01":""):b8.accepts["*"]);
for(cf in b8.headers){ce.setRequestHeader(cf,b8.headers[cf])
}if(b8.beforeSend&&(b8.beforeSend.call(cn,ce,b8)===false||b3===2)){return ce.abort()
}b6="abort";
for(cf in {success:1,error:1,complete:1}){ce[cf](b8[cf])
}cg=q(a6,b8,b1,ce);
if(!cg){ca(-1,"No Transport")
}else{ce.readyState=1;
if(b0){cb.trigger("ajaxSend",[ce,b8])
}if(b8.async&&b8.timeout>0){b9=setTimeout(function(){ce.abort("timeout")
},b8.timeout)
}try{b3=1;
cg.send(cc,ca)
}catch(ch){if(b3<2){ca(-1,ch)
}else{throw ch
}}}return ce
},active:0,lastModified:{},etag:{}});
function h(b7,b6,b3){var b2,b4,b1,e,bZ=b7.contents,b5=b7.dataTypes,b0=b7.responseFields;
for(b4 in b0){if(b4 in b3){b6[b0[b4]]=b3[b4]
}}while(b5[0]==="*"){b5.shift();
if(b2===aB){b2=b7.mimeType||b6.getResponseHeader("content-type")
}}if(b2){for(b4 in bZ){if(bZ[b4]&&bZ[b4].test(b2)){b5.unshift(b4);
break
}}}if(b5[0] in b3){b1=b5[0]
}else{for(b4 in b3){if(!b5[0]||b7.converters[b4+" "+b5[0]]){b1=b4;
break
}if(!e){e=b4
}}b1=b1||e
}if(b1){if(b1!==b5[0]){b5.unshift(b1)
}return b3[b1]
}}function ae(b9,b1){var b7,bZ,b5,b3,b6=b9.dataTypes.slice(),b0=b6[0],b8={},b2=0;
if(b9.dataFilter){b1=b9.dataFilter(b1,b9.dataType)
}if(b6[1]){for(b7 in b9.converters){b8[b7.toLowerCase()]=b9.converters[b7]
}}for(;
(b5=b6[++b2]);
){if(b5!=="*"){if(b0!=="*"&&b0!==b5){b7=b8[b0+" "+b5]||b8["* "+b5];
if(!b7){for(bZ in b8){b3=bZ.split(" ");
if(b3[1]===b5){b7=b8[b0+" "+b3[0]]||b8["* "+b3[0]];
if(b7){if(b7===true){b7=b8[bZ]
}else{if(b8[bZ]!==true){b5=b3[0];
b6.splice(b2--,0,b5)
}}break
}}}}if(b7!==true){if(b7&&b9["throws"]){b1=b7(b1)
}else{try{b1=b7(b1)
}catch(b4){return{state:"parsererror",error:b7?b4:"No conversion from "+b0+" to "+b5}
}}}}b0=b5
}}return{state:"success",data:b1}
}var bp=[],aw=/\?/,a5=/(=)\?(?=&|$)|\?\?/,bl=bG.now();
bG.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=bp.pop()||(bG.expando+"_"+(bl++));
this[e]=true;
return e
}});
bG.ajaxPrefilter("json jsonp",function(b8,b3,b7){var b6,e,b5,b1=b8.data,bZ=b8.url,b0=b8.jsonp!==false,b4=b0&&a5.test(bZ),b2=b0&&!b4&&typeof b1==="string"&&!(b8.contentType||"").indexOf("application/x-www-form-urlencoded")&&a5.test(b1);
if(b8.dataTypes[0]==="jsonp"||b4||b2){b6=b8.jsonpCallback=bG.isFunction(b8.jsonpCallback)?b8.jsonpCallback():b8.jsonpCallback;
e=a2[b6];
if(b4){b8.url=bZ.replace(a5,"$1"+b6)
}else{if(b2){b8.data=b1.replace(a5,"$1"+b6)
}else{if(b0){b8.url+=(aw.test(bZ)?"&":"?")+b8.jsonp+"="+b6
}}}b8.converters["script json"]=function(){if(!b5){bG.error(b6+" was not called")
}return b5[0]
};
b8.dataTypes[0]="json";
a2[b6]=function(){b5=arguments
};
b7.always(function(){a2[b6]=e;
if(b8[b6]){b8.jsonpCallback=b3.jsonpCallback;
bp.push(b6)
}if(b5&&bG.isFunction(e)){e(b5[0])
}b5=e=aB
});
return"script"
}});
bG.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){bG.globalEval(e);
return e
}}});
bG.ajaxPrefilter("script",function(e){if(e.cache===aB){e.cache=false
}if(e.crossDomain){e.type="GET";
e.global=false
}});
bG.ajaxTransport("script",function(b0){if(b0.crossDomain){var e,bZ=o.head||o.getElementsByTagName("head")[0]||o.documentElement;
return{send:function(b1,b2){e=o.createElement("script");
e.async="async";
if(b0.scriptCharset){e.charset=b0.scriptCharset
}e.src=b0.url;
e.onload=e.onreadystatechange=function(b4,b3){if(b3||!e.readyState||/loaded|complete/.test(e.readyState)){e.onload=e.onreadystatechange=null;
if(bZ&&e.parentNode){bZ.removeChild(e)
}e=aB;
if(!b3){b2(200,"success")
}}};
bZ.insertBefore(e,bZ.firstChild)
},abort:function(){if(e){e.onload(0,1)
}}}
}});
var ah,aN=a2.ActiveXObject?function(){for(var e in ah){ah[e](0,1)
}}:false,au=0;
function bB(){try{return new a2.XMLHttpRequest()
}catch(bZ){}}function bb(){try{return new a2.ActiveXObject("Microsoft.XMLHTTP")
}catch(bZ){}}bG.ajaxSettings.xhr=a2.ActiveXObject?function(){return !this.isLocal&&bB()||bb()
}:bB;
(function(e){bG.extend(bG.support,{ajax:!!e,cors:!!e&&("withCredentials" in e)})
})(bG.ajaxSettings.xhr());
if(bG.support.ajax){bG.ajaxTransport(function(e){if(!e.crossDomain||bG.support.cors){var bZ;
return{send:function(b5,b0){var b3,b2,b4=e.xhr();
if(e.username){b4.open(e.type,e.url,e.async,e.username,e.password)
}else{b4.open(e.type,e.url,e.async)
}if(e.xhrFields){for(b2 in e.xhrFields){b4[b2]=e.xhrFields[b2]
}}if(e.mimeType&&b4.overrideMimeType){b4.overrideMimeType(e.mimeType)
}if(!e.crossDomain&&!b5["X-Requested-With"]){b5["X-Requested-With"]="XMLHttpRequest"
}try{for(b2 in b5){b4.setRequestHeader(b2,b5[b2])
}}catch(b1){}b4.send((e.hasContent&&e.data)||null);
bZ=function(ce,b8){var b9,b7,b6,cc,cb;
try{if(bZ&&(b8||b4.readyState===4)){bZ=aB;
if(b3){b4.onreadystatechange=bG.noop;
if(aN){delete ah[b3]
}}if(b8){if(b4.readyState!==4){b4.abort()
}}else{b9=b4.status;
b6=b4.getAllResponseHeaders();
cc={};
cb=b4.responseXML;
if(cb&&cb.documentElement){cc.xml=cb
}try{cc.text=b4.responseText
}catch(cd){}try{b7=b4.statusText
}catch(cd){b7=""
}if(!b9&&e.isLocal&&!e.crossDomain){b9=cc.text?200:404
}else{if(b9===1223){b9=204
}}}}}catch(ca){if(!b8){b0(-1,ca)
}}if(cc){b0(b9,b7,cc,b6)
}};
if(!e.async){bZ()
}else{if(b4.readyState===4){setTimeout(bZ,0)
}else{b3=++au;
if(aN){if(!ah){ah={};
bG(a2).unload(aN)
}ah[b3]=bZ
}b4.onreadystatechange=bZ
}}},abort:function(){if(bZ){bZ(0,1)
}}}
}})
}var L,ab,bO=/^(?:toggle|show|hide)$/,bH=new RegExp("^(?:([-+])=|)("+bx+")([a-z%]*)$","i"),bM=/queueHooks$/,ax=[i],a1={"*":[function(e,b5){var b1,b6,b7=this.createTween(e,b5),b2=bH.exec(b5),b3=b7.cur(),bZ=+b3||0,b0=1,b4=20;
if(b2){b1=+b2[2];
b6=b2[3]||(bG.cssNumber[e]?"":"px");
if(b6!=="px"&&bZ){bZ=bG.css(b7.elem,e,true)||b1||1;
do{b0=b0||".5";
bZ=bZ/b0;
bG.style(b7.elem,e,bZ+b6)
}while(b0!==(b0=b7.cur()/b3)&&b0!==1&&--b4)
}b7.unit=b6;
b7.start=bZ;
b7.end=b2[1]?bZ+(b2[1]+1)*b1:b1
}return b7
}]};
function bj(){setTimeout(function(){L=aB
},0);
return(L=bG.now())
}function bc(bZ,e){bG.each(e,function(b4,b2){var b3=(a1[b4]||[]).concat(a1["*"]),b0=0,b1=b3.length;
for(;
b0<b1;
b0++){if(b3[b0].call(bZ,b4,b2)){return
}}})
}function f(b0,b4,b7){var b8,b3=0,e=0,bZ=ax.length,b6=bG.Deferred().always(function(){delete b2.elem
}),b2=function(){var ce=L||bj(),cb=Math.max(0,b1.startTime+b1.duration-ce),b9=cb/b1.duration||0,cd=1-b9,ca=0,cc=b1.tweens.length;
for(;
ca<cc;
ca++){b1.tweens[ca].run(cd)
}b6.notifyWith(b0,[b1,cd,cb]);
if(cd<1&&cc){return cb
}else{b6.resolveWith(b0,[b1]);
return false
}},b1=b6.promise({elem:b0,props:bG.extend({},b4),opts:bG.extend(true,{specialEasing:{}},b7),originalProperties:b4,originalOptions:b7,startTime:L||bj(),duration:b7.duration,tweens:[],createTween:function(cc,b9,cb){var ca=bG.Tween(b0,b1.opts,cc,b9,b1.opts.specialEasing[cc]||b1.opts.easing);
b1.tweens.push(ca);
return ca
},stop:function(ca){var b9=0,cb=ca?b1.tweens.length:0;
for(;
b9<cb;
b9++){b1.tweens[b9].run(1)
}if(ca){b6.resolveWith(b0,[b1,ca])
}else{b6.rejectWith(b0,[b1,ca])
}return this
}}),b5=b1.props;
ak(b5,b1.opts.specialEasing);
for(;
b3<bZ;
b3++){b8=ax[b3].call(b1,b0,b5,b1.opts);
if(b8){return b8
}}bc(b1,b5);
if(bG.isFunction(b1.opts.start)){b1.opts.start.call(b0,b1)
}bG.fx.timer(bG.extend(b2,{anim:b1,queue:b1.opts.queue,elem:b0}));
return b1.progress(b1.opts.progress).done(b1.opts.done,b1.opts.complete).fail(b1.opts.fail).always(b1.opts.always)
}function ak(b1,b3){var b0,bZ,b4,b2,e;
for(b0 in b1){bZ=bG.camelCase(b0);
b4=b3[bZ];
b2=b1[b0];
if(bG.isArray(b2)){b4=b2[1];
b2=b1[b0]=b2[0]
}if(b0!==bZ){b1[bZ]=b2;
delete b1[b0]
}e=bG.cssHooks[bZ];
if(e&&"expand" in e){b2=e.expand(b2);
delete b1[bZ];
for(b0 in b2){if(!(b0 in b1)){b1[b0]=b2[b0];
b3[b0]=b4
}}}else{b3[bZ]=b4
}}}bG.Animation=bG.extend(f,{tweener:function(bZ,b2){if(bG.isFunction(bZ)){b2=bZ;
bZ=["*"]
}else{bZ=bZ.split(" ")
}var b1,e=0,b0=bZ.length;
for(;
e<b0;
e++){b1=bZ[e];
a1[b1]=a1[b1]||[];
a1[b1].unshift(b2)
}},prefilter:function(bZ,e){if(e){ax.unshift(bZ)
}else{ax.push(bZ)
}}});
function i(b2,b8,e){var b7,b0,ca,b1,ce,b4,cd,cc,cb,b3=this,bZ=b2.style,b9={},b6=[],b5=b2.nodeType&&Q(b2);
if(!e.queue){cc=bG._queueHooks(b2,"fx");
if(cc.unqueued==null){cc.unqueued=0;
cb=cc.empty.fire;
cc.empty.fire=function(){if(!cc.unqueued){cb()
}}
}cc.unqueued++;
b3.always(function(){b3.always(function(){cc.unqueued--;
if(!bG.queue(b2,"fx").length){cc.empty.fire()
}})
})
}if(b2.nodeType===1&&("height" in b8||"width" in b8)){e.overflow=[bZ.overflow,bZ.overflowX,bZ.overflowY];
if(bG.css(b2,"display")==="inline"&&bG.css(b2,"float")==="none"){if(!bG.support.inlineBlockNeedsLayout||bC(b2.nodeName)==="inline"){bZ.display="inline-block"
}else{bZ.zoom=1
}}}if(e.overflow){bZ.overflow="hidden";
if(!bG.support.shrinkWrapBlocks){b3.done(function(){bZ.overflow=e.overflow[0];
bZ.overflowX=e.overflow[1];
bZ.overflowY=e.overflow[2]
})
}}for(b7 in b8){ca=b8[b7];
if(bO.exec(ca)){delete b8[b7];
b4=b4||ca==="toggle";
if(ca===(b5?"hide":"show")){continue
}b6.push(b7)
}}b1=b6.length;
if(b1){ce=bG._data(b2,"fxshow")||bG._data(b2,"fxshow",{});
if("hidden" in ce){b5=ce.hidden
}if(b4){ce.hidden=!b5
}if(b5){bG(b2).show()
}else{b3.done(function(){bG(b2).hide()
})
}b3.done(function(){var cf;
bG.removeData(b2,"fxshow",true);
for(cf in b9){bG.style(b2,cf,b9[cf])
}});
for(b7=0;
b7<b1;
b7++){b0=b6[b7];
cd=b3.createTween(b0,b5?ce[b0]:0);
b9[b0]=ce[b0]||bG.style(b2,b0);
if(!(b0 in ce)){ce[b0]=cd.start;
if(b5){cd.end=cd.start;
cd.start=b0==="width"||b0==="height"?1:0
}}}}}function H(b0,bZ,b2,e,b1){return new H.prototype.init(b0,bZ,b2,e,b1)
}bG.Tween=H;
H.prototype={constructor:H,init:function(b1,bZ,b3,e,b2,b0){this.elem=b1;
this.prop=b3;
this.easing=b2||"swing";
this.options=bZ;
this.start=this.now=this.cur();
this.end=e;
this.unit=b0||(bG.cssNumber[b3]?"":"px")
},cur:function(){var e=H.propHooks[this.prop];
return e&&e.get?e.get(this):H.propHooks._default.get(this)
},run:function(b0){var bZ,e=H.propHooks[this.prop];
if(this.options.duration){this.pos=bZ=bG.easing[this.easing](b0,this.options.duration*b0,0,1,this.options.duration)
}else{this.pos=bZ=b0
}this.now=(this.end-this.start)*bZ+this.start;
if(this.options.step){this.options.step.call(this.elem,this.now,this)
}if(e&&e.set){e.set(this)
}else{H.propHooks._default.set(this)
}return this
}};
H.prototype.init.prototype=H.prototype;
H.propHooks={_default:{get:function(bZ){var e;
if(bZ.elem[bZ.prop]!=null&&(!bZ.elem.style||bZ.elem.style[bZ.prop]==null)){return bZ.elem[bZ.prop]
}e=bG.css(bZ.elem,bZ.prop,false,"");
return !e||e==="auto"?0:e
},set:function(e){if(bG.fx.step[e.prop]){bG.fx.step[e.prop](e)
}else{if(e.elem.style&&(e.elem.style[bG.cssProps[e.prop]]!=null||bG.cssHooks[e.prop])){bG.style(e.elem,e.prop,e.now+e.unit)
}else{e.elem[e.prop]=e.now
}}}}};
H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now
}}};
bG.each(["toggle","show","hide"],function(bZ,e){var b0=bG.fn[e];
bG.fn[e]=function(b1,b3,b2){return b1==null||typeof b1==="boolean"||(!bZ&&bG.isFunction(b1)&&bG.isFunction(b3))?b0.apply(this,arguments):this.animate(bF(e,true),b1,b3,b2)
}
});
bG.fn.extend({fadeTo:function(e,b1,b0,bZ){return this.filter(Q).css("opacity",0).show().end().animate({opacity:b1},e,b0,bZ)
},animate:function(b4,b1,b3,b2){var b0=bG.isEmptyObject(b4),e=bG.speed(b1,b3,b2),bZ=function(){var b5=f(this,bG.extend({},b4),e);
if(b0){b5.stop(true)
}};
return b0||e.queue===false?this.each(bZ):this.queue(e.queue,bZ)
},stop:function(b0,bZ,e){var b1=function(b2){var b3=b2.stop;
delete b2.stop;
b3(e)
};
if(typeof b0!=="string"){e=bZ;
bZ=b0;
b0=aB
}if(bZ&&b0!==false){this.queue(b0||"fx",[])
}return this.each(function(){var b5=true,b2=b0!=null&&b0+"queueHooks",b4=bG.timers,b3=bG._data(this);
if(b2){if(b3[b2]&&b3[b2].stop){b1(b3[b2])
}}else{for(b2 in b3){if(b3[b2]&&b3[b2].stop&&bM.test(b2)){b1(b3[b2])
}}}for(b2=b4.length;
b2--;
){if(b4[b2].elem===this&&(b0==null||b4[b2].queue===b0)){b4[b2].anim.stop(e);
b5=false;
b4.splice(b2,1)
}}if(b5||!e){bG.dequeue(this,b0)
}})
}});
function bF(b0,b2){var b1,e={height:b0},bZ=0;
b2=b2?1:0;
for(;
bZ<4;
bZ+=2-b2){b1=bQ[bZ];
e["margin"+b1]=e["padding"+b1]=b0
}if(b2){e.opacity=e.width=b0
}return e
}bG.each({slideDown:bF("show"),slideUp:bF("hide"),slideToggle:bF("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,bZ){bG.fn[e]=function(b0,b2,b1){return this.animate(bZ,b0,b2,b1)
}
});
bG.speed=function(b0,b1,bZ){var e=b0&&typeof b0==="object"?bG.extend({},b0):{complete:bZ||!bZ&&b1||bG.isFunction(b0)&&b0,duration:b0,easing:bZ&&b1||b1&&!bG.isFunction(b1)&&b1};
e.duration=bG.fx.off?0:typeof e.duration==="number"?e.duration:e.duration in bG.fx.speeds?bG.fx.speeds[e.duration]:bG.fx.speeds._default;
if(e.queue==null||e.queue===true){e.queue="fx"
}e.old=e.complete;
e.complete=function(){if(bG.isFunction(e.old)){e.old.call(this)
}if(e.queue){bG.dequeue(this,e.queue)
}};
return e
};
bG.easing={linear:function(e){return e
},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2
}};
bG.timers=[];
bG.fx=H.prototype.init;
bG.fx.tick=function(){var b0,bZ=bG.timers,e=0;
L=bG.now();
for(;
e<bZ.length;
e++){b0=bZ[e];
if(!b0()&&bZ[e]===b0){bZ.splice(e--,1)
}}if(!bZ.length){bG.fx.stop()
}L=aB
};
bG.fx.timer=function(e){if(e()&&bG.timers.push(e)&&!ab){ab=setInterval(bG.fx.tick,bG.fx.interval)
}};
bG.fx.interval=13;
bG.fx.stop=function(){clearInterval(ab);
ab=null
};
bG.fx.speeds={slow:600,fast:200,_default:400};
bG.fx.step={};
if(bG.expr&&bG.expr.filters){bG.expr.filters.animated=function(e){return bG.grep(bG.timers,function(bZ){return e===bZ.elem
}).length
}
}var bm=/^(?:body|html)$/i;
bG.fn.offset=function(b8){if(arguments.length){return b8===aB?this:this.each(function(b9){bG.offset.setOffset(this,b8,b9)
})
}var bZ,b4,b5,b2,b6,e,b1,b3={top:0,left:0},b0=this[0],b7=b0&&b0.ownerDocument;
if(!b7){return
}if((b4=b7.body)===b0){return bG.offset.bodyOffset(b0)
}bZ=b7.documentElement;
if(!bG.contains(bZ,b0)){return b3
}if(typeof b0.getBoundingClientRect!=="undefined"){b3=b0.getBoundingClientRect()
}b5=bn(b7);
b2=bZ.clientTop||b4.clientTop||0;
b6=bZ.clientLeft||b4.clientLeft||0;
e=b5.pageYOffset||bZ.scrollTop;
b1=b5.pageXOffset||bZ.scrollLeft;
return{top:b3.top+e-b2,left:b3.left+b1-b6}
};
bG.offset={bodyOffset:function(e){var b0=e.offsetTop,bZ=e.offsetLeft;
if(bG.support.doesNotIncludeMarginInBodyOffset){b0+=parseFloat(bG.css(e,"marginTop"))||0;
bZ+=parseFloat(bG.css(e,"marginLeft"))||0
}return{top:b0,left:bZ}
},setOffset:function(b1,ca,b4){var b5=bG.css(b1,"position");
if(b5==="static"){b1.style.position="relative"
}var b3=bG(b1),bZ=b3.offset(),e=bG.css(b1,"top"),b8=bG.css(b1,"left"),b9=(b5==="absolute"||b5==="fixed")&&bG.inArray("auto",[e,b8])>-1,b7={},b6={},b0,b2;
if(b9){b6=b3.position();
b0=b6.top;
b2=b6.left
}else{b0=parseFloat(e)||0;
b2=parseFloat(b8)||0
}if(bG.isFunction(ca)){ca=ca.call(b1,b4,bZ)
}if(ca.top!=null){b7.top=(ca.top-bZ.top)+b0
}if(ca.left!=null){b7.left=(ca.left-bZ.left)+b2
}if("using" in ca){ca.using.call(b1,b7)
}else{b3.css(b7)
}}};
bG.fn.extend({position:function(){if(!this[0]){return
}var b0=this[0],bZ=this.offsetParent(),b1=this.offset(),e=bm.test(bZ[0].nodeName)?{top:0,left:0}:bZ.offset();
b1.top-=parseFloat(bG.css(b0,"marginTop"))||0;
b1.left-=parseFloat(bG.css(b0,"marginLeft"))||0;
e.top+=parseFloat(bG.css(bZ[0],"borderTopWidth"))||0;
e.left+=parseFloat(bG.css(bZ[0],"borderLeftWidth"))||0;
return{top:b1.top-e.top,left:b1.left-e.left}
},offsetParent:function(){return this.map(function(){var e=this.offsetParent||o.body;
while(e&&(!bm.test(e.nodeName)&&bG.css(e,"position")==="static")){e=e.offsetParent
}return e||o.body
})
}});
bG.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b0,bZ){var e=/Y/.test(bZ);
bG.fn[b0]=function(b1){return bG.access(this,function(b2,b5,b4){var b3=bn(b2);
if(b4===aB){return b3?(bZ in b3)?b3[bZ]:b3.document.documentElement[b5]:b2[b5]
}if(b3){b3.scrollTo(!e?b4:bG(b3).scrollLeft(),e?b4:bG(b3).scrollTop())
}else{b2[b5]=b4
}},b0,b1,arguments.length,null)
}
});
function bn(e){return bG.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false
}bG.each({Height:"height",Width:"width"},function(e,bZ){bG.each({padding:"inner"+e,content:bZ,"":"outer"+e},function(b0,b1){bG.fn[b1]=function(b5,b4){var b3=arguments.length&&(b0||typeof b5!=="boolean"),b2=b0||(b5===true||b4===true?"margin":"border");
return bG.access(this,function(b7,b6,b8){var b9;
if(bG.isWindow(b7)){return b7.document.documentElement["client"+e]
}if(b7.nodeType===9){b9=b7.documentElement;
return Math.max(b7.body["scroll"+e],b9["scroll"+e],b7.body["offset"+e],b9["offset"+e],b9["client"+e])
}return b8===aB?bG.css(b7,b6,b8,b2):bG.style(b7,b6,b8,b2)
},bZ,b3?b5:aB,b3,null)
}
})
});
a2.jQuery=a2.$=bG;
if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return bG
})
}})(window);(function(b,d,a){var e=b(d),c=d.document;
b.plugin2=function(h,g){var i="plugin-"+h,f=h+"-options";
g._mergeOptions=function(j){return b.extend(true,{},this._defaultOptions,j)
};
g.closestInit=function(){var j=this.$caller.closest("."+i);
return j.length>0?j:b(c)
};
g.option=function(j,l){var k=this.closestInit(),m;
if(typeof j==="undefined"){m=k[0];
return m?b.data(m,f):null
}else{if(typeof l==="undefined"){m=k[0];
return m?b.data(m,f)[j]:null
}else{k.each(function(){b.data(this,f)[j]=l
});
return this.$caller
}}};
g.live=function(j,k){var m=this,l=m.$caller;
k=m._mergeOptions(k);
if(m._init){m._init(j,k)
}l.onCreate(j,function(){var o,n;
if(!b.data(this,f)){o=b(this);
n=b.extend({},m,{"$caller":o});
b.data(this,f,k);
o.addClass(i);
if(n._create){n._create(this,k)
}}});
if(m._createAll){l.bind("create",function(n){m._createAll(n.target,j,k)
})
}return l
};
g.init=function(j){return this.live(null,j)
};
b.fn[h]=function(k){var j=b.extend({},g,{"$caller":this});
if(!k||typeof k==="object"){return j.init(k)
}k=""+k;
if(k.substr(0,1)!=="_"&&j[k]){return j[k].apply(j,Array.prototype.slice.call(arguments,1))
}else{return b.error("["+k+"] method doesn't exist on ["+h+"] plugin!")
}}
};
b.run=function(f){f();
return f
};
b.throttle=function(g,f){var j=0,i,h;
if(g<=0){return f
}return function(){var m,l,k;
h=arguments;
if(i){return
}m=this;
l=+new Date();
k=g-l+j;
if(k<=0){j=l;
f.apply(m,h)
}else{i=setTimeout(function(){j=l;
i=null;
f.apply(m,h)
},k)
}}
};
(function(){var l,o,f,k,p,n,m,j,i,g,h;
l=b("<div/>",{css:{height:"100%",left:0,position:"fixed",top:0,"user-select":"none",width:"100%","z-index":1000000}});
o=function(q){if(p){clearTimeout(p);
p=null
}g=null;
b(c.body).css("user-select","");
if(f){f.unbind(".drag");
f=null
}if(h){h(q);
h=null
}};
b.drag=function(r,s,q,v,u){var t;
if(s.which!==1||s.altKey||s.ctrlKey||s.metaKey||s.shiftKey){return
}t={"$dragCover":l};
o(s);
b(c.body).css("user-select","none");
f=b(r);
f.bind("dragstart.drag",function(){return false
});
n=j=s.pageX;
m=i=s.pageY;
k=function(){var w=function(){g=function(x){return v.call(r,x,t)
};
h=function(x){return u.call(r,x,t)
};
b(c.body).append(l);
q.call(r,s,t)
};
if(s.dragImmediately){w()
}else{p=setTimeout(function(){var y=j-n,x=i-m;
if(Math.sqrt(y*y+x*x)<(s.dragDistance||5)){k();
return
}w()
},(s.dragDelay||100))
}};
k()
};
e.mousemove(b.throttle(50,function(q){if(p){j=q.pageX;
i=q.pageY
}if(g){g(q)
}}));
e.mouseup(function(q){o(q);
l.remove()
})
}());
b.fn.isFixedPosition=function(){var g=this,f;
while(true){if(g.css("position")==="fixed"){return true
}f=g.offsetParent();
if(g.length===0||g[0]===f[0]){break
}else{g=f
}}return false
};
b.fn.zIndex=function(){var h;
for(var g=this;
g.length>0;
g=g.parent()){try{h=parseInt(g.css("z-index"),10)
}catch(f){break
}if(!isNaN(h)&&h!==0){break
}}return h
};
(function(){var f=b.fn.delegate;
b.fn.delegate=function(){if(arguments[0]){return f.apply(this,arguments)
}else{return b.fn.bind.apply(this,Array.prototype.slice.call(arguments,1))
}}
}());
(function(){var f="input-checkInterval";
if(!("oninput" in c.createElement("input"))){b.event.special.input={add:function(i){var j=b(this),g=i.selector,h,k;
h=b.throttle(50,function(){b(this).trigger("input")
});
j.delegate(g,"keyup",function(){setTimeout(h,0)
});
k=function(){var l=b.data(this,f);
if(l){clearInterval(l);
b.removeData(this,f)
}};
j.delegate(g,"focus",function(){k.call(this);
b.data(this,f,setInterval(h,50))
});
j.delegate(g,"blur",k)
}}
}}());
b.elementFromPoint=function(f,h){var g=c.elementFromPoint(f,h);
if(g){if(g.nodeType===3){g=g.parentNode
}if(g){return b(g)
}}return b()
};
b.fn.onCreate=function(f,g){if(f){this.bind("create",function(h){b(h.target).find(f).each(g)
})
}else{this.each(g)
}};
b.easing.easeOutBack=function(g,h,f,k,j,i){if(i===undefined){i=1.70158
}return k*((h=h/j-1)*h*((i+1)*h+i)+1)+f
}
}(jQuery,window));(function(b,c,a){b.plugin2("autoSubmit",{_create:function(g){var i=b(g),f=b(g).closest("form"),h,d,e;
d=b.throttle(500,function(){var j=f.serialize();
if(h!==j){h=j;
f.submit()
}});
i.data("autoSubmit-submitFunction",d);
if(i[0]===f[0]){f.find(":input").attr("autocomplete","off");
f.delegate(":input","input.autoSubmit change.autoSubmit",d)
}else{i.attr("autocomplete","off");
i.bind("input.autoSubmit change.autoSubmit",d)
}e=b(".frame[name="+f.attr("target")+"]:not(.loading):not(.loaded)");
if(e.length>0){d()
}},submit:function(){this.closestInit().data("autoSubmit-submitFunction")();
return this
}})
}(jQuery,window));(function(e,f,c){var b={dayLabels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"]};
var h=function(i){return i<10?"0"+i:i
};
var a;
var g=function(m){var k=a();
var j=k.data("selectedDate");
k.data("viewDate",m);
var l=m.getMonth();
k.find("> .monthYear > .month").val(l);
k.find("> .monthYear > .year").val(m.getFullYear());
var i=new Date(m.getTime());
i.setDate(1);
i.setDate(i.getDate()-i.getDay());
k.find("> .week > .day").each(function(){var n=e(this);
n.data("date",new Date(i.getTime()));
var o=i.getDate();
n.text(o);
if(l===i.getMonth()){n.removeClass("offMonth")
}else{n.addClass("offMonth")
}if(i.getMonth()===j.getMonth()&&o===j.getDate()){n.addClass("selected")
}else{n.removeClass("selected")
}i.setDate(o+1)
})
};
var d=function(){var l=a();
var k=l.data("selectedDate");
var o=h(k.getDate());
var i=k.getHours();
var m=h(k.getMinutes());
var j="AM";
if(i>=12){i-=12;
j="PM"
}i=i===0?12:h(i);
var n=l.data("$input");
n.val(k.getFullYear()+"-"+h(k.getMonth()+1)+"-"+h(k.getDate())+" "+h(k.getHours())+":"+h(k.getMinutes())+":00");
n.change();
l.data("$calendarButton").toggleClass("calendarButton-empty",!n.val());
l.data("$calendarButton").text(b.dayLabels[k.getDay()]+", "+b.monthLabels[k.getMonth()].substring(0,3)+" "+o+", "+i+":"+m+" "+j)
};
a=function(){var z=e("#calendar");
if(z.length===0){z=e("<div/>",{id:"calendar"});
var l=e("<div/>",{"class":"monthYear"});
var q=e("<select/>",{"class":"month",change:function(){var C=new Date(z.data("viewDate").getTime());
C.setDate(1);
C.setMonth(q.val());
g(C)
}});
l.append(q);
e.each(b.monthLabels,function(C,D){q.append(e("<option/>",{value:C,text:D}))
});
var v=e("<input/>",{type:"text","class":"year",bind:{input:function(){var D=parseInt(v.val(),10)||0;
if(D<1900){v.addClass("invalid")
}else{var C=new Date(z.data("viewDate").getTime());
C.setDate(1);
C.setYear(D);
g(C);
v.removeClass("invalid")
}}}});
l.append(" ");
l.append(v);
var n=e("<span/>",{"class":"previousButton"});
n.bind("click.calendar",function(){var C=new Date(z.data("viewDate").getTime());
C.setDate(1);
C.setMonth(C.getMonth()-1);
g(C)
});
var k=e("<span/>",{"class":"nextButton"});
k.bind("click.calendar",function(){var C=new Date(z.data("viewDate").getTime());
C.setDate(1);
C.setMonth(C.getMonth()+1);
g(C)
});
var m=e("<div/>",{"class":"dayLabels"});
e.each(b.dayLabels,function(C,D){m.append(e("<span/>",{"class":"day day"+C,text:D}))
});
z.append(l);
z.append(n);
z.append(k);
z.append(m);
var w,B,y;
for(w=0;
w<6;
++w){B=e("<div/>",{"class":"week week"+w});
for(y=0;
y<7;
++y){B.append(e("<span/>",{"class":"day day"+y}))
}z.append(B)
}var s=e("<div/>",{"class":"time"});
var t=e("<select/>",{"class":"meridiem"});
var r=e("<select/>",{"class":"hour"});
var A=function(){z.data("selectedDate").setHours((t.val()==="PM"?12:0)+parseInt(r.val(),10));
d()
};
t.append(e("<option/>",{text:"AM",value:"AM"}));
t.append(e("<option/>",{text:"PM",value:"PM"}));
t.change(A);
var o,p;
for(o=0;
o<12;
++o){p=o===0?12:h(o);
r.append(e("<option/>",{text:p,value:o}))
}r.change(A);
var x=e("<select/>",{"class":"minute"});
var u,j;
for(u=0;
u<60;
++u){j=h(u);
x.append(e("<option/>",{text:j,value:u}))
}x.change(function(){z.data("selectedDate").setMinutes(x.val());
d()
});
s.append(r);
s.append(x);
s.append(t);
z.append(s);
var i=e("<span/>",{"class":"empty"});
i.click(function(){z.data("selectedDate",new Date());
var C=z.data("$input");
C.val("");
C.change();
z.data("$calendarButton").toggleClass("calendarButton-empty",!C.val());
z.data("$calendarButton").text(C.val()||C.attr("placeholder")||C.attr("data-emptylabel")||"N/A")
});
z.append(i);
e("body").append(z);
z.popup();
z.popup("container").attr("id","calendarPopup");
z.popup("close");
z.find(".day").click(function(){var C=e(this).data("date");
z.data("selectedDate",C);
g(C);
d(C)
})
}return z
};
e.plugin2("calendar",{_create:function(i){var k=e(i);
var j=e("<span/>",{"class":"calendarButton",text:k.val()||k.attr("placeholder")||k.attr("data-emptylabel")||"N/A"});
j.toggleClass("calendarButton-empty",!k.val());
j.click(function(){var q=a();
q.data("$input",k);
q.data("$calendarButton",j);
var p=k.val();
var o=new Date();
if(p){var n=/^(\d\d\d\d)-(\d\d)-(\d\d) (\d\d):(\d\d):(\d\d)?$/.exec(p);
if(n){o.setFullYear(parseInt(n[1],10));
o.setMonth(parseInt(n[2],10)-1);
o.setDate(parseInt(n[3],10));
o.setHours(parseInt(n[4],10));
o.setMinutes(parseInt(n[5],10));
o.setSeconds(parseInt(n[6],10))
}}q.data("selectedDate",o);
g(o);
var l=o.getHours();
var m="AM";
if(l>=12){l-=12;
m="PM"
}q.find("select.hour").val(l);
q.find("select.minute").val(o.getMinutes());
q.find("select.meridiem").val(m);
q.find(".empty").text(k.attr("placeholder")||k.attr("data-emptylabel")||"N/A");
q.popup("source",j);
q.popup("open")
});
k.hide();
k.after(j)
}})
}(jQuery,window));(function(d,f,b){var h=d(f),e=f.document,g=d(e),c,a;
d.plugin2("dropDown",{_defaultOptions:{classPrefix:"dropDown-"},className:function(i){return this.option("classPrefix")+i
},_create:function(k){var p=this,u=d(k),t=u.isFixedPosition(),o=u.is("[multiple]"),l=u.is('[data-searchable="true"]'),r,s,q,j,i,w,n,m,v;
if(!o&&u.find("option:selected").length===0){u.find("option:first").prop("selected",true)
}r=d("<div/>",{"class":p.className("input"),css:{"margin-bottom":u.css("margin-bottom"),"margin-left":u.css("margin-left"),"margin-right":u.css("margin-right"),"margin-top":u.css("margin-top"),position:"relative",width:u.outerWidth()}});
r.click(function(){if(s.is(":visible")){s.click()
}else{q.click()
}return false
});
s=d("<a/>",{"class":p.className("label"),href:"#",click:function(){if(a&&a[0]===m[0]){m.trigger("dropDown-close")
}else{m.trigger("dropDown-open")
}return false
}});
s.bind("dropDown-update",function(){var x=d.map(u.find("option:selected"),function(y){return d(y).text()
});
s.html(x.join(", ")||"&nbsp;")
});
j={display:"none",position:t?"fixed":"absolute","z-index":u.zIndex()};
i=d("<div/>",{css:j});
w=d("<div/>",{"class":p.className("marker")});
n=d("<div/>",{css:j});
m=d("<div/>",{"class":p.className("list")});
m.bind("dropDown-open",function(){var y=r.offset(),x=r.outerWidth(true)>n.outerWidth(true);
y.top+=r.outerHeight();
if(t){y.top-=h.scrollTop()
}n.css(y);
i.css(y);
i.css("width",r.outerWidth());
r.add(w).add(m).toggleClass(p.className("input-larger"),x);
r.addClass(p.className("list-open"));
m.find("."+p.className("listItem")).removeClass("state-hover");
m.find("."+p.className("listItem")+(o?":first":":has(:checked)")).addClass("state-hover");
if(a){a.trigger("dropDown-close")
}c=u;
a=m;
i.show();
n.show()
});
m.bind("dropDown-close",function(){r.removeClass(p.className("list-open"));
c=null;
a=null;
i.hide();
n.hide()
});
m.bind("dropDown-hover",function(y,x){m.find("."+p.className("listItem")).removeClass("state-hover");
if(x){x.addClass("state-hover")
}});
m.bind("mousewheel",function(A,C,y,x){var z=d(this),B=d.data(this,"dropDown-maxScrollTop");
if(typeof B==="undefined"){B=z.prop("scrollHeight")-z.innerHeight();
d.data(this,"dropDown-maxScrollTop",B)
}if((x>0&&z.scrollTop()===0)||(x<0&&z.scrollTop()>=B)){A.preventDefault()
}});
g.click(function(x){if(n.is(":visible")&&!d.contains(n[0],x.target)){m.trigger("dropDown-close")
}});
v=function(y){var x,z;
x=d("<div/>",{"class":p.className("listItem"),html:y.text()||"&nbsp;"});
z=d("<input/>",{type:o?"checkbox":"radio"});
if(y.is(":selected")){z.prop("checked",true);
x.addClass(p.className("listItem-selected"))
}x.mouseenter(function(){m.trigger("dropDown-hover",[x])
});
x.mouseleave(function(){m.trigger("dropDown-hover")
});
x.click(o?function(){if(y.is(":selected")){y.prop("selected",false);
x.find(":checkbox").prop("checked",false);
x.removeClass(p.className("listItem-selected"))
}else{y.prop("selected",true);
x.find(":checkbox").prop("checked",true);
x.addClass(p.className("listItem-selected"))
}s.trigger("dropDown-update");
u.change();
return false
}:function(){if(!y.is(":selected")){u.find("option").prop("selected",false);
m.find(":radio").prop("checked",false);
m.find("."+p.className("listItem")).removeClass(p.className("listItem-selected"));
y.prop("selected",true);
z.prop("checked",true);
x.addClass(p.className("listItem-selected"));
s.trigger("dropDown-update");
u.change()
}m.trigger("dropDown-close");
return false
});
x.prepend(" ");
x.prepend(z);
m.append(x)
};
u.find("> optgroup, > option").each(function(){var x=d(this);
if(x.is("option")){v(x)
}else{m.append(d("<div/>",{"class":p.className("listGroupLabel"),text:x.attr("label")}));
x.find("> option").each(function(){v(d(this))
})
}});
s.trigger("dropDown-update");
r.append(s);
u.before(r);
u.hide();
n.append(m);
d(e.body).append(n);
n.css("min-width",n.outerWidth());
i.append(w);
d(e.body).append(i);
if(l){q=d("<input/>",{"class":p.className("search"),type:"text"});
q.bind("input",function(){var x=new RegExp(q.val().replace(/\s/,"").split("").join("(?:.*\\W)?"),"i"),y;
m.find("."+p.className("listItem")).each(function(){var z=d(this);
if(x.test(z.text())){z.show();
if(!y){y=z
}}else{z.hide()
}});
m.trigger("dropDown-hover",[y])
});
q.click(function(){return false
});
m.bind("dropDown-open",function(){s.hide();
m.find("."+p.className("listItem")).show();
q.val(s.text());
q.show();
q.focus();
q.select()
});
m.bind("dropDown-close",function(){s.show();
q.hide()
});
q.hide();
r.append(q)
}}});
g.keydown(function(k){var o,m,n,j,l,i,p;
if(a){o=k.which;
m=o===38;
if(!(k.altKey||k.ctrlKey||k.metaKey||k.shiftKey)){n=c.dropDown("className","listItem");
if(m||o===40){j=a.find(".state-hover:visible."+n).eq(0);
if(j.length===0){j=a.find(":visible."+n).eq(m?-1:0)
}else{j=j[m?"prevAll":"nextAll"](":visible."+n).eq(0)
}if(j.length>0){a.trigger("dropDown-hover",[j]);
l=j.position().top;
i=j.outerHeight();
if(m){if(l<0){a.scrollTop(a.scrollTop()+l)
}}else{p=l+i-a.height();
if(p>0){a.scrollTop(a.scrollTop()+p)
}}}return false
}else{if(o===13){a.find(".state-hover."+n).click();
return false
}else{if(o===27){a.trigger("dropDown-close");
return false
}}}}}return true
})
}(jQuery,window));(function(f,g,c){var a=f(g),h=g.document,e=f(h),b,i,d="expandable-shadow";
i=function(j){j.each(function(){var k=f.data(this,d);
if(k.display==="block"){k.width=this.getBoundingClientRect().width
}});
j.each(function(){var k=f.data(this,d);
k.$element.text(f(this).val()+" foo foo foo")
});
j.each(function(){var k=f.data(this,d);
if(k.display==="block"){k.$element.css("width",k.width)
}});
j.each(function(){var l=f.data(this,d),k=l.$element[0].getBoundingClientRect();
if(l.display==="block"){l.height=k.height
}else{l.width=k.width
}});
j.each(function(){var l=f.data(this,d),k=f(this);
if(l.display==="block"){k.css("height",l.height)
}else{k.css("width",l.width)
}})
};
f.plugin2("expandable",{_init:function(j,k){var l=this;
l.$caller.delegate(j,"expand.expandable input.expandable",function(){i(f(this))
})
},_create:function(j,k){var o,m,l,n;
if(f.data(j,d)){return
}o=f(j);
m=o.css("display");
l=j.getBoundingClientRect();
n=o.css("box-sizing");
f.data(j,d,{display:m,width:l.width,height:l.height,"$element":f("<div/>",{"class":k.shadowClass,text:o.val()+" foo",css:{display:m,"border-width":n==="border-box"?"":0,padding:n==="border-box"?"":0}})})
},_createAll:function(m,j,k){var l=f(m).find(j);
if(!b){f(h.body).append(b=f("<div/>",{"class":"expandable-shadows",css:{left:-10000,position:"absolute",top:0,visibility:"hidden"}}))
}l.each(function(){var o=f(this),n=f.data(o[0],d);
o.css("overflow","hidden");
b.append(n.$element)
});
i(l)
}});
a.resize(f.throttle(200,function(){i(e.find(".plugin-expandable:visible"))
}))
}(jQuery,window));(function(b,d,a){var e=b(d),c=d.document;
b.plugin2("popup",{_defaultOptions:{padding:{left:35,right:35,top:20}},_create:function(i){var m=b(i);
var h=this.option();
var l=b("<div/>",{"class":"popup"});
var g=b("<div/>",{"class":"content"});
var k=b("<div/>",{"class":"closeButton"});
var f=m.attr("name");
if(f){l.attr("name",f)
}l.bind("open.popup",function(){var n=b(this);
var p=n.data("popup-scrollLeft");
var o=n.data("popup-scrollTop");
if(typeof p!=="number"&&typeof o!=="number"){n.data("popup-scrollLeft",e.scrollLeft());
n.data("popup-scrollTop",e.scrollTop())
}n.show()
});
l.bind("restoreOriginalPosition.popup",function(){var n=b(this);
var p=n.data("popup-scrollLeft");
var o=n.data("popup-scrollTop");
n.removeData("popup-scrollLeft");
n.removeData("popup-scrollTop");
if(typeof p==="number"&&typeof o==="number"){e.scrollLeft(p);
e.scrollTop(o)
}});
l.bind("close.popup",function(){var n=b(this);
n.hide();
b(".popup").each(function(){var o=b(this);
var p=o.popup("source");
if(p&&b.contains(n[0],p[0])){o.popup("close")
}})
});
k.bind("click.popup",function(){b(this).popup("close")
});
var j=b(c.body);
g.append(m);
g.append(k);
l.append(g);
j.append(l)
},open:function(){this.$caller.popup("container").trigger("open");
return this.$caller
},restoreOriginalPosition:function(){this.$caller.popup("container").trigger("restoreOriginalPosition");
return this.$caller
},close:function(){this.container().trigger("close");
return this.$caller
},container:function(){return this.$caller.closest(".popup")
},content:function(){return this.$caller.popup("container").find("> .content")
},source:function(f,i){var u=this.option();
if(i&&(f.height()<30||typeof i.pageX!=="number"||typeof i.pageY!=="number")){i=a
}if(typeof f==="undefined"){var j=this.$caller.popup("container")[0];
return j?b.data(j,"popup-$source"):null
}else{var q=this.$caller.popup("container");
q.each(function(){b.data(this,"popup-$source",f)
});
var m=f.offset();
var p=q.outerWidth();
var r=0;
var l=i?i.pageX-p/2:m.left+(f.outerWidth()-p)/2;
if(l<u.padding.left){r=l-u.padding.left;
l=u.padding.left
}else{var h=l+p-b(c).width()+u.padding.right;
if(h>0){r=h;
l-=h
}}var g=q.popup("content");
var t=g.find("> .marker");
if(t.length===0){t=b("<div/>",{"class":"marker"});
g.append(t)
}var s=(p-t.outerWidth())/2+r;
t.css("left",s<5?5:s);
var n=i?i.pageY:m.top+f.outerHeight();
if(n<30){n=30
}var o=f.isFixedPosition();
if(o){l-=b(window).scrollLeft();
n-=b(window).scrollTop()
}var k=f.closest(".popup");
if(k.length===0){k=f.parent()
}q.css({left:l,margin:0,position:o?"fixed":"absolute",top:n,"z-index":f.parent().zIndex()+1});
return this.$caller
}}});
e.click(function(f){var g=f.target;
if(b(g).popup("container").length===0){b(".popup").each(function(){var i=b(this);
var j=i.popup("source");
if(j&&j.length>0){var h=j[0];
if(!(h==g||b.contains(h,g))){i.popup("close")
}}})
}});
e.keydown(function(g){if(g.which===27){var f=b(".popup");
if(f.length>0){f.popup("close");
return false
}else{return true
}}})
}(jQuery,window));(function(b,d,a){var f=b(d),c=d.document,e=0;
b.plugin2("frame",{_defaultOptions:{frameClassName:"dari-frame",loadingClassName:"dari-frame-loading",loadedClassName:"dari-frame-loaded",bodyClassName:"dari-frame-body",setBody:function(g){b(this).html(g)
}},_init:function(i,r){var k=this,o=k.$caller,n=r.frameClassName,m=r.loadingClassName,l=r.loadedClassName,h=r.bodyClassName,j,q,g,p;
j=function(t,w){var s=b(t),v=s.attr("target"),u;
if(v&&b('frame[name="'+v+'"], iframe[name="'+v+'"]').length>0){return true
}if(v!=="_top"&&v!=="_blank"){if(v==="_parent"){u=s.frame("container").parent().frame("container")
}else{if(v){u=b("."+n+'[name="'+v+'"]');
if(u.length===0){u=b("<div/>",{"class":n,name:v});
b(c.body).append(u);
u.popup()
}}else{u=s.frame("container")
}}if(u.length>0&&u[0]!==c){return w(s,u)
}}return true
};
q=function(v,x,u){var s=(v.data("frame-loadVersion")||0)+1,w=v.popup("container"),t;
v.add(w).removeClass(l).addClass(m);
v.data("frame-loadVersion",s);
v.data("frame-$source",x);
t=v.popup("source");
if(w[0]&&(!t||t[0]!=x[0])&&(!x[0]||!b.contains(w[0],x[0]))){v.popup("source",x,u);
v.empty()
}v.popup("open");
return s
};
g=function(v,t,x){var y,w,u,s;
if(t>=v.data("frame-loadVersion")){y=v.popup("container");
s=x;
s=s.replace(/^.*?<body[^>]*>/ig,"");
s=s.replace(/<\/body>.*?$/ig,"");
v.add(y).removeClass(m).addClass(l);
r.setBody.call(v[0],s);
v.trigger("create");
v.trigger("load");
f.resize()
}};
p=function(v,z,s,u,x,t){var y=this,A=q(v,z,t),w=v.attr("data-extra-form-data");
if(w){u+=(u.indexOf("?")<0?"?":"&")+w
}b.ajax({cache:false,type:s,url:u,data:x,complete:function(B){g(v,A,B.responseText)
}})
};
o.delegate("a","click.frame",function(s){return j(this,function(u,t){p(t,u,"get",u.attr("href"),null,s);
return false
})
});
o.delegate("form","click.frame",function(s){if(!b(s.target).is('button, input[type="submit"]')){return
}b.data(this,"frame-clicked",s.target)
});
o.delegate("form","submit.frame",function(){return j(this,function(D,s){var w=D.attr("action"),v=s.attr("data-extra-form-data"),A=b.data(D[0],"frame-clicked"),B,t;
if(A){B=b(A).prop("name");
t=b(A).prop("value");
if(B&&t){w+=(w.indexOf("?")>-1?"&":"?")+encodeURIComponent(B)+"="+encodeURIComponent(t)
}}if(D.attr("enctype")!=="multipart/form-data"){p(s,D,D.attr("method"),w,D.serialize());
return false
}D.attr("action",w+(w.indexOf("?")<0?"?":"&")+v);
var C=D.find(':hidden[name="_isFrame"]');
if(C.length===0){C=b('<input name="_isFrame" type="hidden" value="true"/>');
D.prepend(C)
}var y=D.attr("target");
var z=true;
if(!y){e+=1;
y="frameTarget"+e+(+new Date());
D.attr("target",y);
z=false
}var u=b("iframe[name="+y+"]");
if(u.length===0){u=b("<iframe/>",{name:y});
u.hide();
b(c.body).append(u)
}var x=q(s,D);
u.unbind(".frame");
u.bind("load.frame",function(){D.attr("action",w);
g(s,x,u.contents().find("body").html());
if(!z){D.removeAttr("target");
setTimeout(function(){u.remove()
},0)
}});
return true
})
});
o.onCreate("."+n,function(){var t=b(this),s;
if(t.is(":not(."+m+"):not(."+l+")")){s=t.find("a:only-child:not([target])");
if(s.length>0){s.click()
}else{t.find("form:only-child:not([target])").submit()
}}});
return o
},container:function(){return this.$caller.closest("."+this.option("frameClassName"))
},source:function(){return this.container().data("frame-$source")
}})
}(jQuery,window));(function(c,e,b){var f="x y width height texts textSizes textXs textYs textWidths".split(" "),a="aaaf7c5a9e604daaa126f11e23e321d8",d=e.document;
c.plugin2("imageEditor",{_create:function(k){var r=c(k);
var q=r.closest("form");
var l=r.find(".imageEditor-image img");
var D=l.attr("src");
var B=l;
var m=l.clone();
var w=m[0];
var t=r.find(".imageEditor-tools ul");
var A=r.find(".imageEditor-edit");
var C=c("<li/>",{html:c("<a/>",{"class":"action-image-edit",text:"Edit Image",click:function(){A.popup("source",c(this));
A.popup("open");
return false
}})});
t.prepend(C);
var i=c("<div/>");
C.append(i);
var u;
var E;
var j=function(){var H={};
A.find(":input").each(function(){var N=c(this);
var M=N.is(":checkbox")?N.is(":checked"):parseFloat(N.val());
if(M===false||isNaN(M)){return
}var L=/.([^.]+)$/.exec(N.attr("name"));
L=L?L[1]:null;
if(L==="brightness"){H.brightness=H.brightness||{};
H.brightness.brightness=M*150;
H.brightness.legacy=true
}else{if(L==="contrast"){H.brightness=H.brightness||{};
H.brightness.contrast=M<0?M:M*3
}else{if(L==="flipH"){H.fliph=H.fliph||{}
}else{if(L==="flipV"){H.flipv=H.flipv||{}
}else{if(L==="grayscale"){H.desaturate=H.desaturate||{}
}else{if(L==="invert"){H.invert=H.invert||{}
}else{if(L==="rotate"){H.rotate=H.rotate||{};
H.rotate.angle=-M
}else{if(L==="sepia"){H.sepia=H.sepia||{}
}}}}}}}}});
var J=JSON.stringify(H);
if(J!==u){u=J;
i.empty();
A.find(":input").each(function(){var L=c(this);
if(!L.is(":checkbox")||L.is(":checked")){i.append(c("<input/>",{type:"hidden",name:L.attr("name"),value:L.val()}))
}});
var G=[];
var K=0;
for(var I in H){if(H.hasOwnProperty(I)){G[G.length]=I
}}var F=function(L,M){if(M<G.length){var N=G[M];
Pixastic.process(L,N,H[N],function(O){++M;
F(O,M)
})
}else{if(l!==B){l.remove()
}B.before(L);
B.hide();
l=c(L);
E=setTimeout(j,100)
}};
F(w,0)
}else{E=setTimeout(j,100)
}};
j();
A.popup("container").bind("open",function(){j()
});
A.popup("container").bind("close",function(){if(E){clearTimeout(E)
}});
var s=c("<button/>",{text:"Reset",click:function(){A.find(":input").each(function(){var F=c(this);
if(F.is(":checkbox")){F.removeAttr("checked")
}else{F.val(0)
}});
j();
return false
}});
A.append(s);
A.popup();
A.popup("container").addClass("imageEditor-editPopup");
A.popup("close");
var z=c("<div/>",{"class":"imageEditor-cover",css:{display:"none",left:"0",position:"absolute",top:"0"}});
var p=z.clone(true);
var h=z.clone(true);
var x=z.clone(true);
r.append(z);
r.append(p);
r.append(h);
r.append(x);
var y=function(J){var H=l.width();
var F=l.height();
var G=J.left+J.width;
var I=J.top+J.height;
z.css({height:J.top,width:H});
p.css({height:J.height,top:J.top,width:J.left});
h.css({height:J.height,left:G,top:J.top,width:H-G});
x.css({height:F-I,top:I,width:H});
z.show();
p.show();
h.show();
x.show()
};
var v=r.find(".imageEditor-sizes table");
var g=c("<ul/>",{"class":"imageEditor-sizeSelectors"});
var o={};
v.find("th").each(function(){var I=c(this);
var Y=I.closest("tr");
var K=Y.attr("data-size-name");
var W=I.popup("source");
if(W){var F=W.closest(".inputContainer").attr("data-standard-image-sizes");
if(F){if(c.inArray(K,F.split(" "))<0){return
}}}var O=Y.attr("data-size-independent")==="true";
var T=parseFloat(Y.attr("data-size-width"));
var Q=parseFloat(Y.attr("data-size-height"));
var U=T/Q;
var G={};
c.each(f,function(aa,Z){G[Z]=Y.find(':input[name$=".'+Z+'"]')
});
var N=Math.floor(U*100)/100;
var S=o[""+N];
if(!O){if(S){S["$sizeLabel"].html(S["$sizeLabel"].html()+"<br>"+I.text());
c.each(f,function(aa,Z){S[Z]=S[Z].add(G[Z])
});
return
}else{o[""+(N-0.02)]=G;
o[""+(N-0.01)]=G;
o[""+N]=G;
o[""+(N+0.01)]=G;
o[""+(N+0.02)]=G
}}var X=c("<div/>",{"class":"imageEditor-sizeBox",css:{position:"absolute"}});
X.hide();
r.append(X);
var P=function(ad){var ab=ad.width();
var aa=ad.height();
var af=parseFloat(G.x.val())||0;
var ae=parseFloat(G.y.val())||0;
var ac=parseFloat(G.width.val())||0;
var Z=parseFloat(G.height.val())||0;
if(ac===0||Z===0){ac=aa*U;
Z=ab/U;
if(ac>ab){ac=Z*U
}else{Z=ac/U
}af=(ab-ac)/2;
ae=0
}else{af*=ab;
ae*=aa;
ac*=ab;
Z*=aa
}return{left:af,top:ae,width:ac,height:Z}
};
var R=c("<li/>",{"class":"imageEditor-sizeButton",click:function(){var Z=c(this).closest("li");
if(Z.is(".imageEditor-sizeSelected")){Z.removeClass("imageEditor-sizeSelected");
z.hide();
p.hide();
h.hide();
x.hide();
X.hide();
return false
}else{Z.closest("ul").find("li").removeClass("imageEditor-sizeSelected");
Z.addClass("imageEditor-sizeSelected")
}r.find(".imageEditor-sizeBox").hide();
var aa=P(l);
y(aa);
X.css(aa);
X.show();
X.find(".imageEditor-textOverlay").each(function(ad){var ae=c(this);
ae.trigger("resizeTextOverlayFont");
var af=parseFloat(G.textWidths.val().split(a)[ad+1])||0;
if(af!==0){var ac=parseFloat(G.textXs.val().split(a)[ad+1])||0;
var ab=parseFloat(G.textYs.val().split(a)[ad+1])||0;
ae.css({left:(ac*100)+"%",top:(ab*100)+"%",width:(af*100)+"%"})
}});
return false
}});
g.append(R);
var V=function(){var aa=c(d.body);
aa.append(m);
var Z=P(m);
m.remove();
Pixastic.process(w,"crop",Z,function(ac){var ab=R.find(".imageEditor-sizePreview");
ab.empty();
ab.append(ac)
})
};
var J=function(Z){return function(ae){var ac=X.position();
var ad={left:ac.left,top:ac.top,width:X.width(),height:X.height(),pageX:ae.pageX,pageY:ae.pageY};
var ab=l.width();
var aa=l.height();
c.drag(this,ae,function(af){},function(ai){var ag=ai.pageX-ad.pageX;
var af=ai.pageY-ad.pageY;
var ah=Z(ai,ad,{x:ag,y:af,constrainedX:Math.max(ag,af*U),constrainedY:Math.max(af,ag/U)});
for(key in ad){ah[key]=ah[key]||ad[key]
}var aj;
if(ah.moving){if(ah.left<0){ah.left=0
}if(ah.top<0){ah.top=0
}aj=ah.left+ah.width-ab;
if(aj>0){ah.left-=aj
}aj=ah.top+ah.height-aa;
if(aj>0){ah.top-=aj
}}else{if(ah.width<10||ah.height<10){if(U>1){ah.width=U*10;
ah.height=10
}else{ah.width=10;
ah.height=10/U
}}if(ah.left<0){ah.width+=ah.left;
ah.height=ah.width/U;
ah.top-=ah.left/U;
ah.left=0
}if(ah.top<0){ah.height+=ah.top;
ah.width=ah.height*U;
ah.left-=ah.top*U;
ah.top=0
}aj=ah.left+ah.width-ab;
if(aj>0){ah.width-=aj;
ah.height=ah.width/U
}aj=ah.top+ah.height-aa;
if(aj>0){ah.height-=aj;
ah.width=ah.height*U
}}y(ah);
X.css(ah);
X.find(".imageEditor-textOverlay").trigger("resizeTextOverlayFont")
},function(){var ag=X.position();
var af=X.width();
var ah=X.height();
G.x.val(ag.left/ab);
G.y.val(ag.top/aa);
G.width.val(af/ab);
G.height.val(af/U/aa);
V();
X.find(".imageEditor-textOverlay").trigger("resizeTextOverlayFont")
});
return false
}
};
X.mousedown(J(function(aa,Z,ab){return{moving:true,left:Z.left+ab.x,top:Z.top+ab.y}
}));
X.append(c("<div/>",{"class":"imageEditor-resizer imageEditor-resizer-topLeft",mousedown:J(function(aa,Z,ab){return{left:Z.left+ab.constrainedX,top:Z.top+ab.constrainedY,width:Z.width-ab.constrainedX,height:Z.height-ab.constrainedY}
})}));
X.append(c("<div/>",{"class":"imageEditor-resizer imageEditor-resizer-bottomRight",mousedown:J(function(aa,Z,ab){return{width:Z.width+ab.constrainedX,height:Z.height+ab.constrainedY}
})}));
var H=c("<span/>",{"class":"imageEditor-sizeLabel",text:I.text()});
G["$sizeLabel"]=H;
R.append(H);
var L=c("<div/>",{"class":"imageEditor-sizePreview",html:c("<img/>",{alt:I.text(),src:D,load:function(){V()
}})});
R.append(L);
var M=0;
H.after(c("<a/>",{"class":"imageEditor-addTextOverlay",text:"Add Text",click:function(Z,ao){++M;
var ad=c("<div/>",{"class":"imageEditor-textOverlay",css:{left:((G.textXs.val().split(a)[M]||0.25)*100)+"%",position:"absolute",top:((G.textYs.val().split(a)[M]||0.25)*100)+"%",width:((G.textWidths.val().split(a)[M]||0.5)*100)+"%","z-index":1}});
X.append(ad);
var ab=c("<div/>",{"class":"imageEditor-textOverlayLabel",text:"Text #"+M});
var ai=function(){if(!X.is(":visible")){return
}var ap="";
X.find(".imageEditor-textOverlay").each(function(){var av=c(this),au=c(av.find(".rte-container iframe")[0].contentDocument.body),ar=c.data(this,"imageEditor-originalFontSize"),at,aq;
if(!ar&&au.is(".rte-loaded")){ar=parseFloat(au.css("font-size"));
c.data(this,"imageEditor-originalFontSize",ar)
}ap+=a;
if(ar>0){at=1/Q*ar;
ap+=at;
au.css("font-size",X.height()*at)
}});
G.textSizes.val(ap)
};
ad.bind("resizeTextOverlayFont",ai);
var am=function(ap){return function(au){ai();
var at=ad.position();
var ar={left:at.left,top:at.top,width:ad.width(),height:ad.height(),pageX:au.pageX,pageY:au.pageY};
var aq=X.width();
var av=X.height();
au.dragImmediately=true;
c.drag(this,au,function(aw){},function(az){var ax=az.pageX-ar.pageX;
var aw=az.pageY-ar.pageY;
var ay=ap(az,ar,{x:ax,y:aw});
for(key in ar){ay[key]=ay[key]||ar[key]
}ay.left=((ay.left/aq)*100)+"%";
ay.top=((ay.top/av)*100)+"%";
ay.width=((ay.width/aq)*100)+"%";
ay.height="auto";
ad.css(ay)
},function(){var az="",aw="",ax="",ay="";
X.find(".imageEditor-textOverlay").each(function(){var aD=c(this),aC=aD.position(),aB=aD.width(),aA=aD.height();
az+=a+(aD.find(".imageEditor-textOverlayInput").val());
aw+=a+(aC.left/aq);
ax+=a+(aC.top/av);
ay+=a+(aB/aq)
});
G.texts.val(az);
G.textXs.val(aw);
G.textYs.val(ax);
G.textWidths.val(ay)
});
return false
}
};
ab.mousedown(am(function(aq,ap,ar){return{moving:true,left:ap.left+ar.x,top:ap.top+ar.y}
}));
ad.append(ab);
var al=c("<div/>",{"class":"imageEditor-textOverlayRemove",text:"Remove",click:function(){ad.remove();
return false
}});
ad.append(al);
ad.append(c("<div/>",{"class":"imageEditor-resizer imageEditor-resizer-left",mousedown:am(function(aq,ap,ar){return{left:ap.left+ar.x,width:ap.width-ar.x}
})}));
ad.append(c("<div/>",{"class":"imageEditor-resizer imageEditor-resizer-right",mousedown:am(function(aq,ap,ar){return{left:ap.left,width:ap.width+ar.x}
})}));
var ac=c("<input/>",{"class":"imageEditor-textOverlayInput",type:"text",value:G.texts.val().split(a)[M]||""});
ad.append(ac);
ac.rte({useLineBreaks:true});
r.before(ad.find(".rte-toolbar-container"));
if(!ao){ac.focus()
}var aj=5000;
var ak=function(){var ap=c(ad.find(".rte-container iframe")[0].contentDocument.body);
if(ap.is(".rte-loaded")){ai()
}else{aj-=100;
if(aj>0){setTimeout(ak,100)
}}};
ak();
q.submit(function(){var ap="";
X.find(".imageEditor-textOverlay").each(function(){ap+=a+c(this).find(".imageEditor-textOverlayInput").val()
});
G.texts.val(ap)
});
if(!ao){var aa=X.width();
var ae=X.height();
var ah="",af="",an="",ag="";
X.find(".imageEditor-textOverlay").each(function(){var at=c(this),ar=at.position(),aq=at.width(),ap=at.height();
ah+=a+(at.find(".imageEditor-textOverlayInput").val());
af+=a+(ar.left/aa);
an+=a+(ar.top/ae);
ag+=a+(aq/aa)
});
G.texts.val(ah);
G.textXs.val(af);
G.textYs.val(an);
G.textWidths.val(ag)
}return false
}}));
c.each(G.texts.val().split(a),function(Z,aa){if(Z>0){R.find(".imageEditor-addTextOverlay").trigger("click",true)
}})
});
v.before(g);
v.hide();
var n=g.find(".imageEditor-sizeButton");
if(n.length==1){n.click()
}}})
}(jQuery,window));(function(e,f,c){var b,d="objectId-shadow",g="objectId-target",a=0;
b=function(h){h.each(function(){var n=e(this),r=e.data(this,d),j,m,k,l,i,o,q,p;
if(!r){return
}j=r.$select;
m=r.$edit;
k=r.$clear;
l=n.attr("data-preview");
i=n.attr("data-visibility");
p=n.val();
if(l){j.html(e("<img/>",{src:l}))
}else{o=n.attr("data-label");
if(o){j.text(o);
if(i){j.prepend(" ");
j.prepend(e("<span/>",{"class":"visibilityLabel",text:i}))
}}else{q=n.attr("placeholder");
if(q){j.html(e("<span/>",{"class":"objectId-placeholder",text:q}))
}else{j.text("\u00a0")
}}}m.toggle(n.attr("data-editable")!=="false"&&!!p);
k.toggle(k.is(".restore")||(n.attr("data-clearable")!=="false"&&n.closest(".repeatableObjectId").length===0&&!!p));
m.attr("href",CONTEXT_PATH+"content/objectIdEdit.jsp?id="+(p||"")+"&"+(((/[&?](variationId=[^&]+)/).exec(f.location.search)||[])[1]||""))
})
};
e.plugin2("objectId",{_init:function(h){this.$caller.on("change.objectId",h,function(){b(e(this))
})
},_create:function(n){var m,p,k,h,q,i,l,j,o;
if(e.data(n,d)){return
}m=e(n);
p=n.form?e(n.form):m.closest("form");
k=e.data(p[0],g);
if(!k){++a;
k="objectId-"+a;
e.data(p[0],g,k)
}h=m.attr("data-typeIds");
q=p.attr("action");
i=e("<a/>",{"class":"objectId-select",target:k,href:(m.attr("data-searcher-path")||(CONTEXT_PATH+"content/objectId.jsp"))+"?pt="+encodeURIComponent((/id=([^&]+)/.exec(q)||[])[1]||"")+"&p="+encodeURIComponent(m.attr("data-pathed"))+"&"+(h?e.map(h.split(","),function(r){return"rt="+r
}).join("&"):"")+"&aq="+encodeURIComponent(m.attr("data-additional-query")||"")+"&sg="+encodeURIComponent(m.attr("data-suggestions")||"")});
l=e("<a/>",{"class":"objectId-edit",target:k,text:"Edit"});
j=e("<a/>",{"class":"objectId-clear",text:"Clear",click:function(){var t=e(this),u=e.data(t[0],d),s=u.$select,r=u.$edit;
if(m.val()){if(m.attr("data-restorable")==="false"){m.removeAttr("data-label");
m.removeAttr("data-preview")
}else{s.addClass("toBeRemoved");
r.addClass("toBeRemoved");
t.addClass("restore");
t.text("Restore")
}m.val("")
}else{s.removeClass("toBeRemoved");
r.removeClass("toBeRemoved");
t.removeClass("restore");
t.text("Clear");
m.val(m[0].defaultValue)
}m.change();
return false
}});
o={"$input":m,"$select":i,"$edit":l,"$clear":j};
e.data(n,d,o);
e.data(i[0],d,o);
e.data(l[0],d,o);
e.data(j[0],d,o)
},_createAll:function(j,h){var i=e(j).find(h);
i.each(function(){var l=e(this),k=e.data(this,d);
l.hide();
l.after(k.$clear);
l.after(k.$edit);
l.after(k.$select)
});
b(i)
}})
}(jQuery,window));(function(b,d,a){var c=d.document,e=b(d);
b.plugin2("pageLayout",{_create:function(q){var k=b(q);
var h=k.attr("data-pageid");
var m;
var f;
var p=false;
var i;
var o=b("<div/>",{"class":"pageLayout-visual"});
o.bind("updateJson",function(){k.val(JSON.stringify(m,null,2))
});
var j=function(){o.empty();
i(o,m.outermostSection);
o.find(".section > .hat").hide();
o.trigger("updateJson")
};
o.mousemove(b.throttle(100,function(t){if(!p){var u=o.find(".section > .hat");
var s;
var r=c.elementFromPoint(t.pageX-e.scrollLeft(),t.pageY-e.scrollTop());
if(r){s=b(r).closest(".section").find("> .hat");
u=u.not(s)
}u.hide();
if(s){s.show()
}}}));
i=function(F,v,w){var D=b("<div/>",{"class":"section","data-flex":1});
v.page=v.page||h;
D.data("definition",v);
var A=b("<div/>",{"class":"hat"});
var C=b("<div/>",{"class":"heading"});
var s=b("<div/>",{"class":"content","data-flex":1});
if(w){var u=w.children;
if(u){var y=u.length;
if(y>1){var x={};
b.each(["Up","Down","Left","Right"],function(G,H){A.append(x[H]=b("<span/>",{"class":"move"+H+"Button",text:H}))
});
x.Up.add(x.Left).click(function(){for(var G=1;
G<y;
++G){if(u[G]===v){var H=u[G-1];
u[G-1]=v;
u[G]=H;
j();
break
}}});
x.Down.add(x.Right).click(function(){for(var G=0;
G<y-1;
++G){if(u[G]===v){var H=u[G+1];
u[G+1]=v;
u[G]=H;
j();
break
}}})
}}}A.append(b("<a/>",{"class":"settingsButton",text:"Settings",click:function(){f(b(this),v);
return false
}}));
var z=b("<span/>",{"class":"removeButton",text:"Remove",click:function(){if(D.is(".toBeRemoved")){v._isIgnore=false;
o.trigger("updateJson");
D.removeClass("toBeRemoved");
b(this).text("Remove").attr("src",CONTEXT_PATH+"style/icon/delete.png")
}else{v._isIgnore=true;
o.trigger("updateJson");
D.addClass("toBeRemoved");
b(this).text("Restore").attr("src",CONTEXT_PATH+"style/icon/add.png")
}}});
A.append(z);
if(v._isIgnore){z.click()
}var t=true;
if(v._type==="com.psddev.cms.db.HorizontalContainerSection"){D.add(s).addClass("horizontal")
}else{if(v._type==="com.psddev.cms.db.VerticalContainerSection"){D.add(s).addClass("vertical")
}else{if(v._type==="com.psddev.cms.db.MainSection"){D.addClass("main")
}t=false
}}if(v.isShareable){D.addClass("shared")
}var E=b("<div/>",{"class":"name"});
if(v.name){E.text(v.name)
}else{E.addClass("anonymous");
E.text("Unnamed "+(t?"Container":"Section"))
}C.append(E);
if(v._type==="com.psddev.cms.db.ContentSection"){var B=b("<a/>",{"class":"contentButton",text:v.contentTypeLabel&&v.contentLabel?v.contentTypeLabel+": "+v.contentLabel:"Select Content"});
if(F.closest(".contentForm").length>0&&v.content){var r=location.href.replace(/&contentId=[^&]*/,"");
r=r.replace(/\?contentId=[^&]*/,"?");
r+="&contentId="+v.content;
B.attr("href",r);
B.attr("target","_top")
}else{B.attr("href",CONTEXT_PATH+"content/sectionContent.jsp?id="+(v.content||""));
B.attr("target","contentSectionContent")
}C.append(B);
if(v.contentTypeLabel&&v.contentLabel){C.append(b("<a/>",{"class":"removeContentButton",text:"Remove",click:function(){v.content=null;
v.contentTypeLabel=null;
v.contentLabel=null;
j()
}}))
}}D.append(A);
D.append(C);
D.append(s);
F.append(D);
if(t){C.append(b("<span/>",{"class":"addButton",click:function(){var G={_type:"com.psddev.cms.db.ScriptSection"};
(v.children=v.children||[]).push(G);
j()
}}));
if(v.children){b.each(v.children,function(H,G){i(s,G,v)
})
}}if(v._type==="com.psddev.cms.db.MainSection"){D.parentsUntil(".pageLayout-visual").add(D).filter("[data-flex]").attr("data-flex",2.5)
}};
f=function(u,s){var r=b("#sectionSettings");
if(r.length===0){var t='<option value=""></option><option value="JSP">JSP</option><option value="RawText">Raw Text</option>';
r=b('<div id="sectionSettings"><h1>Section: <strong class="name"></strong></h1><div class="inputContainer"><div class="inputLabel">Shareable?</div><div class="inputSmall"><input name="isShareable" type="checkbox"></div></div><div class="inputContainer"><div class="inputLabel">Cache Duration (in Milliseconds)</div><div class="inputSmall"><input name="cacheDuration" type="text"></div></div><div class="inputContainer"><div class="inputLabel">Type</div><div class="inputSmall"><select class="toggleable" name="_type"><option data-hide="#sectionSettings .i" data-show="#sectionSettings .hc" value="com.psddev.cms.db.HorizontalContainerSection">Container (Horizontal)</option><option data-hide="#sectionSettings .i" data-show="#sectionSettings .vc" value="com.psddev.cms.db.VerticalContainerSection">Container (Vertical)</option><option data-hide="#sectionSettings .i" data-show="#sectionSettings .s" value="com.psddev.cms.db.ScriptSection">Script</option><option data-hide="#sectionSettings .i" data-show="#sectionSettings .c" value="com.psddev.cms.db.ContentSection">Script (with Content)</option><option data-hide="#sectionSettings .i" data-show="#sectionSettings .s" value="com.psddev.cms.db.MainSection">Script (with Main Content)</option></select></div></div><div class="inputContainer i hc vc s c"><div class="inputLabel">Name</div><div class="inputSmall"><input name="name" type="text"></div></div><div class="inputContainer i s c"><div class="inputLabel">Engine</div><div class="inputSmall"><select name="engine">'+t+'</select></div></div><div class="inputContainer i s c"><div class="inputLabel">Script</div><div class="inputSmall"><input name="script" type="text"></div></div><div class="inputContainer i hc vc"><div class="inputLabel">Begin Engine</div><div class="inputSmall"><select name="beginEngine">'+t+'</select></div></div><div class="inputContainer i hc vc"><div class="inputLabel">Begin Script</div><div class="inputSmall"><input name="beginScript" type="text"></div></div><div class="inputContainer i hc vc"><div class="inputLabel">End Engine</div><div class="inputSmall"><select name="endEngine">'+t+'</select></div></div><div class="inputContainer i hc vc"><div class="inputLabel">End Script</div><div class="inputSmall"><input name="endScript" type="text"></div></div><div class="buttons"><a class="button continueButton" href="#">Continue Editing</a></div></div>');
r.find(".continueButton").click(function(){r.popup("close");
return false
});
b("body").append(r);
r.popup()
}r.popup("source",u);
r.popup("open");
p=true;
r.find("> h1 > .name").text(s.name||"Unnamed");
b.each("isShareable cacheDuration _type name engine script beginEngine beginScript endEngine endScript".split(" "),function(x,w){var y=r.find(":input[name="+w+"]");
if(y.is(":checkbox")){if(s[w]){y.attr("checked","checked")
}else{y.removeAttr("checked")
}}else{y.val(s[w]||"")
}y.change()
});
var v=r.popup("container");
v.unbind("close.section");
v.bind("close.section",function(){b.each("isShareable cacheDuration _type name engine script beginEngine beginScript endEngine endScript".split(" "),function(x,w){var y=r.find(":input[name="+w+"]");
if(y.is(":checkbox")){s[w]=y.is(":checked")
}else{if(w==="cacheDuration"){s[w]=y.val()||0
}else{s[w]=y.val()
}}});
j();
p=false
})
};
var n=b("<div/>",{"class":"pageLayout-tabs"});
var l=b("<span/>",{"class":"visualButton",text:"Visual",click:function(){try{m=b.parseJSON(k.val())
}catch(r){}m=b.extend(true,{outermostSection:{_type:"com.psddev.cms.db.ScriptSection"}},m);
k.hide();
g.removeClass("selected");
o.show();
l.addClass("selected");
j()
}});
var g=b("<span/>",{"class":"jsonButton",text:"JSON",click:function(){o.hide();
l.removeClass("selected");
k.show();
g.addClass("selected")
}});
n.append(l);
n.append(g);
k.before(n);
k.before(o);
l.click()
}})
}(jQuery,window));(function(h,i,f){var c=h(i),k=i.document,g=h(k),j=h(),e,d,b,a;
h.plugin2("pageThumbnails",{_create:function(l){var q=this,v=h(l),p=h(k.body),t,o,u,r,s,x,n,m,w;
j=j.add(v);
v.bind("hidePreview.pageThumbnails",function(){if(a){a.remove();
a=null
}t=false;
if(o){o.remove();
o=null
}if(d){clearTimeout(d);
d=null
}});
v.delegate('[data-preview-url]:not([data-preview-url=""])',"mouseenter.pageThumbnails",function(){var A,y,z;
if(e&&e!==v){e.trigger("hidePreview")
}e=v;
r=h(this);
s=r.attr("data-preview-url");
if(!a){a=h("<div/>",{"class":"pageThumbnails_toggle",text:"Preview"});
a.bind("click.pageThumbnails",function(B){t=!t;
a.toggleClass("pageThumbnails_toggle-enabled",t);
u();
return false
});
p.append(a)
}x=r.find("[data-preview-anchor]");
if(x.length===0){x=v
}A=r.offset().top;
y=r.outerHeight();
n=x.offset();
m=x.outerWidth();
w=n.left>g.width()-n.left-m;
if(w){z=n.left-h.css(x[0],"padding-left",true)-h.css(x[0],"border-left-width",true)-h.css(x[0],"margin-left",true)
}else{z=n.left+m-a.outerWidth(true)
}a.toggleClass("pageThumbnails_toggle-right",w);
u(function(){a.css({height:y,left:z,"line-height":y+"px",position:"absolute",top:A})
})
});
u=function(y){var z;
if(t){if(!o){o=h("<div/>",{"class":"pageThumbnails_preview"});
o.hide();
p.append(o)
}if(d){clearTimeout(d);
d=null
}z=function(){var C,B,A;
if(y){y()
}o.html(h("<a/>",{"class":"pageThumbnails_preview_livePage",href:s,target:"_blank",text:"Live Page",click:function(){i.open(h(this).attr("href"));
return false
}}).add(h("<iframe/>",{"class":"pageThumbnails_preview_frame",src:s,load:function(){C();
if(B){clearTimeout(B);
B=null
}}})));
C=function(){var D;
if(o&&o.is(":visible")){D=o.find("iframe");
D.height(D.contents().find("body").height()+50);
B=setTimeout(C,100)
}};
C();
if(w){A=n.left-h.css(x[0],"padding-left",true)-h.css(x[0],"border-left-width",true)-h.css(x[0],"margin-left",true)-o.outerWidth(true)
}else{A=n.left+m
}o.toggleClass("pageThumbnails_preview-right",w);
o.css("left",A);
o.show()
};
if(o.is(":visible")){d=setTimeout(function(){z();
d=null
},500)
}else{z()
}}else{if(y){y()
}if(o){o.remove();
o=null
}}}
}});
c.bind("mousemove.pageThumbnails",h.throttle(100,function(n){var l=h(n.target),o,m;
if(l.length===0){return
}if(l.closest(".pageThumbnails_preview").length>0){o=true;
if(d){clearTimeout(d);
d=null
}}else{if(l.closest(".pageThumbnails_toggle").length>0){o=true
}}if(!o&&e&&!h.contains(e[0],l[0])){m=e;
if(!b){b=setTimeout(function(){m.trigger("hidePreview");
b=null;
if(e===m){e=null
}},200)
}return
}if(b){clearTimeout(b);
b=null
}}))
}(jQuery,window));(function(b,c,a){var d=b(c);
b.plugin2("repeatable",{_defaultOptions:{addButtonText:"Add",removeButtonText:"Remove",restoreButtonText:"Restore",sortableOptions:{delay:300}},_create:function(g){var n=b(g),o=this.option();
var h=function(){var q=b(this);
var s=q.attr("data-type");
if(s){var r=q.attr("data-label");
var t=q.find(" > .repeatableLabel");
t.removeClass("repeatableLabel");
if(q.find(".message-error").length===0){q.addClass("collapsed")
}var p=b("<div/>",{"class":"repeatableLabel",text:s+(r?": "+r:""),click:function(){q.toggleClass("collapsed");
q.resize()
}});
if(t.size()!==0){p.append(t);
p.find(":input").click(function(u){u.stopPropagation()
})
}q.prepend(p)
}q.find(':input[name$=".toggle"]').hide();
q.append(b("<span/>",{"class":"removeButton",text:o.removeButtonText}))
};
var k=n.find("> ul:first");
if(k.length===0){k=n.find("> ol:first");
if(k.length===0){return
}else{k.sortable(o.sortableOptions)
}}var l=k.find("> li.template").remove();
k.find("> li").each(h);
var i=b("<div/>",{"class":"addButtonContainer"});
n.append(i);
var j;
if(!o.addButtonText&&l.length==1){var f=l.find(":input");
var e=l.find(':input[name$=".toggle"]');
f=f.not(e);
if(f.length==1){j=f.clone();
j.removeAttr("id");
j.keydown(function(p){if(p.which==13){i.find(".addButton").trigger("click");
return false
}});
i.append(b("<input/>",{name:e.attr("name"),type:"hidden",value:e.attr("value")}));
i.append(j)
}}var m=0;
l.each(function(){var p=b(this);
i.append(b("<span/>",{"class":"addButton",text:o.addButtonText?o.addButtonText+" "+(p.attr("data-type")||"Item"):"",click:function(){if(j&&!j.val()){return false
}var r=p.clone();
r.removeClass("template");
r.find(':input[name$=".toggle"]').attr("checked","checked");
var s=function(){k.append(r);
r.each(h);
r.removeClass("collapsed");
if(j){r.find(':input:not([name$=".toggle"])').val(j.val());
j.val("")
}r.find("*[id]").attr("id",function(u,t){m+=1;
var v=t+"r"+m;
r.find("*[for="+t+"]").attr("for",v);
r.find("*[data-show=#"+t+"]").attr("data-show","#"+v);
return v
});
r.change();
r.trigger("create");
d.resize()
};
var q;
if(r.find(":input").length===0&&(q=r.find("a")).length>0){b.ajax({cache:false,url:q.attr("href"),complete:function(t){r.html(t.responseText);
s()
}})
}else{s()
}return false
}}))
});
k.delegate("> li > .removeButton","click",function(){var r=b(this);
var p=r.closest("li");
var q=p.find(":input");
if(p.is(".toBeRemoved")){p.removeClass("toBeRemoved");
q.removeAttr("disabled");
if(o.removeButtonText){r.text(o.removeButtonText)
}}else{p.addClass("toBeRemoved");
q.attr("disabled","disabled");
if(o.restoreButtonText){r.text(o.restoreButtonText)
}}p.change()
})
}})
}(jQuery,window));(function(b,d,a){var e=b(d),c=d.document;
b.plugin2("sortable",{_defaultOptions:{itemSelector:"> *"},_create:function(f){var h=b(f),g=this.option();
h.addClass("_sortable");
h.find(g.itemSelector).addClass("_sortable-item");
h.delegate(g.itemSelector,"mousedown.sortable",function(i){if(b(i.target).closest("._sortable")[0]!=f){return
}if(b(i.target).is(":input")){return
}b.drag(this,i,function(k,l){var j=b(this),m=j.offset();
l.originalStyle=j.attr("style");
j.css({height:j.height(),width:j.width()});
l.$placeholder=j.clone().empty();
j.before(l.$placeholder);
l.adjustX=m.left-k.pageX;
l.adjustY=m.top-k.pageY;
j.css({display:"block",left:k.pageX-e.scrollLeft()+l.adjustX,position:"fixed",top:k.pageY-e.scrollTop()+l.adjustY,"z-index":1000000})
},function(m,n){var l=b(this),o,p,j,k;
l.css({left:m.pageX-e.scrollLeft()+n.adjustX,top:m.pageY-e.scrollTop()+n.adjustY});
l.hide();
n.$dragCover.hide();
o=b.elementFromPoint(m.clientX,m.clientY).closest("._sortable-item");
if(o.closest("._sortable")[0]!=f){o=b()
}if(o.length>0&&o[0]!==n.$placeholder[0]){p=h.find(g.itemSelector);
j=Array.prototype.indexOf.call(p,n.$placeholder[0]);
k=Array.prototype.indexOf.call(p,o[0]);
o[j>k?"before":"after"](n.$placeholder)
}l.show();
n.$dragCover.show()
},function(k,l){var j=b(this);
if(l.originalStyle){j.attr("style",l.originalStyle)
}else{j.removeAttr("style")
}if(l.$placeholder.next()[0]!==j[0]){l.$placeholder.after(j)
}l.$placeholder.remove()
})
})
}})
}(jQuery,window));(function(b,c,a){b.plugin2("taxonomy",{_create:function(d){var e=b(d),f,g;
f=b("<div/>",{"class":"taxonomyContainer"});
e.after(f);
f.append(e);
g=function(h){var j=h.find("> li"),i=b();
j.each(function(){var k=b(this),l=k.find("> ul");
if(l.length>0){i=i.add(l);
g(l);
l.before(b("<a/>",{"class":"taxonomyExpand",text:"Expand",click:function(){j.removeClass("state-selected");
i.nextAll("ul").find(".state-selected").removeClass("state-selected");
k.addClass("state-selected");
i.nextAll("ul").hide();
i.hide();
l.show();
f.scrollLeft(1000);
return false
}}))
}});
e.after(i);
i.hide()
};
g(e)
}})
})(jQuery,window);(function(b,c,a){b.plugin2("toggleable",{_init:function(d){this.$caller.delegate(d,"toggle.toggleable change",function(){var g=b(this).find(":selected"),i=g.attr("data-hide"),e=g.attr("data-show"),h,f;
if(i){h=b(i);
h.hide();
h.find(":input").attr("disabled","disabled")
}if(e){f=b(e);
f.show();
f.find(":input").removeAttr("disabled");
f.rte("enable")
}})
},_create:function(d){b(d).trigger("toggle")
}})
}(jQuery,window));(function(b,c,a){var d=b(c);
b.plugin2("workflow",{_create:function(p){var k=b(p),f=b.parseJSON(k.val())||{},m,n,j,g={},l,r,h,q=0,e,o,i;
m=b("<div/>",{"class":"workflowVisual"});
n=function(s,y,A,C,B){var x=A.position(),v=x.left,u=x.top+A.outerHeight()*0.1,w,t,z;
if(v>C){w=-1;
t=1
}else{v+=A.outerWidth();
w=1;
t=-1
}sourceControlX=v+w*100;
sourceControlY=u;
targetControlX=C+t*100;
targetControlY=B;
s.strokeStyle=y;
s.fillStyle=y;
s.lineWidth=1;
s.beginPath();
s.moveTo(v,u);
s.bezierCurveTo(sourceControlX,sourceControlY,targetControlX,targetControlY,C,B);
s.stroke();
z=C>targetControlX?5:-5;
s.beginPath();
s.moveTo(C,B);
s.lineTo(C-2*z,B-z);
s.lineTo(C-2*z,B+z);
s.closePath();
s.fill();
return{sourceX:v,sourceY:u,targetX:C,targetY:B}
};
m.append(j=b("<canvas/>",{css:{left:0,position:"absolute",top:0,"z-index":-1}}));
j.bind("redraw",function(x,y,w,v){var t=this.getContext("2d"),u=j.outerWidth(),s=j.outerHeight();
f={states:[],transitions:[]};
t.clearRect(0,0,m.width(),m.height());
m.find(".workflowTransitionName").hide();
m.find(".workflowState").each(function(){var D=b(this),B=D.attr("data-id"),A=D.position(),z=b.data(this,"workflow-targets"),C=0.9;
if(!(B==="initial"||B==="final")){f.states.push({id:B,name:D.find(":input").val(),left:A.left/u,top:A.top/s})
}if(z){b.each(z,function(H,N){var O=N.target,E=m.find('[data-id="'+O+'"]'),I,L,G,M,J,F,K;
if(E.length===0){return
}I=B+"/"+O;
L=g[I];
if(!L){m.append(L=b("<input/>",{type:"text","class":"workflowTransitionName",value:N.name||""}));
g[I]=L
}G=E.position();
M=G.left;
J=G.top+E.outerHeight()*C;
C-=0.1;
F=n(t,"black",D,M,J);
K=F.sourceX<F.targetX?0.3:0.7;
L.css({left:(F.sourceX+F.targetX-L.outerWidth())/2,position:"absolute",top:(F.sourceY+F.targetY-L.outerHeight())/2,transform:"rotate("+(Math.atan((F.targetY-F.sourceY)/(F.targetX-F.sourceX))*180/Math.PI)+"deg)"});
L.show();
f.transitions.push({name:L.val(),source:B,target:O})
})
}});
k.val(JSON.stringify(f));
if(y){n(t,"black",y,w,v)
}});
m.delegate(":input","input",function(){j.trigger("redraw")
});
l=function(t){var u=m.find('[data-id="'+t.source+'"]'),s;
if(u.length>0){s=b.data(u[0],"workflow-targets")||[];
s.push(t);
b.data(u[0],"workflow-targets",s)
}};
r=function(s){s.append(b("<a/>",{"class":"workflowTransitionAdd",text:"Add "+(k.attr("data-transition-label")||"Transition"),click:function(){if(m.is(".workflowVisual-addingTransition")){return true
}m.addClass("workflowVisual-addingTransition");
d.bind("mousemove.workflows",b.throttle(50,function(u){var t=m.offset();
j.trigger("redraw",[s,u.pageX-t.left,u.pageY-t.top])
}));
d.bind("click.workflows",function(u){var t=b(u.target).closest(".workflowState");
if(t.length>0){l({source:s.attr("data-id"),target:t.attr("data-id")})
}m.removeClass("workflowVisual-addingTransition");
d.unbind(".workflows");
j.trigger("redraw");
return false
});
return false
}}))
};
h=function(s){var t;
m.prepend(t=b("<div/>",{"class":"workflowState","data-id":s.id,css:{left:(s.left*100)+"%",top:(s.top*100)+"%"},mousedown:function(u){b.drag(this,u,function(v,w){w.delta=t.position();
w.delta.left-=v.pageX;
w.delta.top-=v.pageY
},function(v,w){t.css({left:v.pageX+w.delta.left,top:v.pageY+w.delta.top});
j.trigger("redraw")
},function(v){})
}}));
t.append(b("<input/>",{type:"text",value:s.name||""}));
t.append(b("<a/>",{"class":"workflowStateRemove",text:"Remove",click:function(){t.remove();
j.trigger("redraw");
return false
}}));
r(t);
return t
};
m.append(e=b("<a/>",{"class":"workflowStateAdd",text:"Add "+(k.attr("data-state-label")||"State"),click:function(){h({id:q,left:Math.random()*0.6+0.1,top:Math.random()*0.7+0.1});
++q;
return false
}}));
m.append(o=b("<div/>",{"class":"workflowState","data-id":"initial",text:k.attr("data-state-initial")||"Initial State"}));
r(o);
m.append(i=b("<div/>",{"class":"workflowState","data-id":"final",text:k.attr("data-state-final")||"Final State"}));
if(f.states){b.each(f.states,function(){var s=parseInt(this.id,10);
h(this);
if(s>=q){q=s+1
}})
}k.after(m);
k.hide();
j.attr({width:m.width(),height:m.height()});
if(f.transitions){b.each(f.transitions,function(){l(this)
});
j.trigger("redraw")
}}})
}(jQuery,window));var JsDiff=(function(){function d(i){return{newPos:i.newPos,components:i.components.slice(0)}
}function h(l){var j=[];
for(var k=0;
k<l.length;
k++){if(l[k]){j.push(l[k])
}}return j
}function g(i){var j=i;
j=j.replace(/&/g,"&amp;");
j=j.replace(/</g,"&lt;");
j=j.replace(/>/g,"&gt;");
j=j.replace(/"/g,"&quot;");
return j
}var f=function(i){this.ignoreWhitespace=i
};
f.prototype={diff:function(n,p){if(p===n){return[{value:p}]
}if(!p){return[{value:n,removed:true}]
}if(!n){return[{value:p,added:true}]
}p=this.tokenize(p);
n=this.tokenize(n);
var m=p.length,j=n.length;
var r=m+j;
var q=[{newPos:-1,components:[]}];
var l=this.extractCommon(q[0],p,n,0);
if(q[0].newPos+1>=m&&l+1>=j){return q[0].components
}for(var i=1;
i<=r;
i++){for(var s=-1*i;
s<=i;
s+=2){var v;
var u=q[s-1],t=q[s+1];
l=(t?t.newPos:0)-s;
if(u){q[s-1]=undefined
}var k=u&&u.newPos+1<m;
var o=t&&0<=l&&l<j;
if(!k&&!o){q[s]=undefined;
continue
}if(!k||(o&&u.newPos<t.newPos)){v=d(t);
this.pushComponent(v.components,n[l],undefined,true)
}else{v=d(u);
v.newPos++;
this.pushComponent(v.components,p[v.newPos],true,undefined)
}var l=this.extractCommon(v,p,n,s);
if(v.newPos+1>=m&&l+1>=j){return v.components
}else{q[s]=v
}}}},pushComponent:function(k,l,i,m){var j=k[k.length-1];
if(j&&j.added===i&&j.removed===m){k[k.length-1]={value:this.join(j.value,l),added:i,removed:m}
}else{k.push({value:l,added:i,removed:m})
}},extractCommon:function(p,n,j,i){var o=n.length,m=j.length,l=p.newPos,k=l-i;
while(l+1<o&&k+1<m&&this.equals(n[l+1],j[k+1])){l++;
k++;
this.pushComponent(p.components,n[l],undefined,undefined)
}p.newPos=l;
return k
},equals:function(k,j){var i=/\S/;
if(this.ignoreWhitespace&&!i.test(k)&&!i.test(j)){return true
}else{return k===j
}},join:function(j,i){return j+i
},tokenize:function(i){return i
}};
var c=new f();
var e=new f(true);
e.tokenize=function(i){return h(i.split(/(\s+|\b)/))
};
var b=new f(true);
b.tokenize=function(i){return h(i.split(/([{}:;,]|\s+)/))
};
var a=new f();
a.tokenize=function(i){return i.split(/^/m)
};
return{Diff:f,diffChars:function(i,j){return c.diff(i,j)
},diffWords:function(i,j){return e.diff(i,j)
},diffLines:function(i,j){return a.diff(i,j)
},diffCss:function(i,j){return b.diff(i,j)
},createPatch:function(A,k,q,s,y){var B=[];
B.push("Index: "+A);
B.push("===================================================================");
B.push("--- "+A+(typeof s==="undefined"?"":"\t"+s));
B.push("+++ "+A+(typeof y==="undefined"?"":"\t"+y));
var r=a.diff(k,q);
if(!r[r.length-1].value){r.pop()
}r.push({value:"",lines:[]});
function m(i){return i.map(function(C){return" "+C
})
}function l(D,E,H){var F=r[r.length-2],G=E===r.length-2,C=E===r.length-3&&(H.added!==F.added||H.removed!==F.removed);
if(!/\n$/.test(H.value)&&(G||C)){D.push("\\ No newline at end of file")
}}var x=0,n=0,v=[],o=1,z=1;
for(var w=0;
w<r.length;
w++){var u=r[w],j=u.lines||u.value.replace(/\n$/,"").split("\n");
u.lines=j;
if(u.added||u.removed){if(!x){var t=r[w-1];
x=o;
n=z;
if(t){v=m(t.lines.slice(-4));
x-=v.length;
n-=v.length
}}v.push.apply(v,j.map(function(i){return(u.added?"+":"-")+i
}));
l(v,w,u);
if(u.added){z+=j.length
}else{o+=j.length
}}else{if(x){if(j.length<=8&&w<r.length-2){v.push.apply(v,m(j))
}else{var p=Math.min(j.length,4);
B.push("@@ -"+x+","+(o-x+p)+" +"+n+","+(z-n+p)+" @@");
B.push.apply(B,v);
B.push.apply(B,m(j.slice(0,p)));
if(j.length<=4){l(B,w,u)
}x=0;
n=0;
v=[]
}}o+=j.length;
z+=j.length
}}return B.join("\n")+"\n"
},applyPatch:function(m,l){var p=l.split("\n");
var t=[];
var u=false,s=false;
for(var o=(p[0][0]==="I"?4:0);
o<p.length;
o++){if(p[o][0]==="@"){var k=p[o].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);
t.unshift({start:k[3],oldlength:k[2],oldlines:[],newlength:k[4],newlines:[]})
}else{if(p[o][0]==="+"){t[0].newlines.push(p[o].substr(1))
}else{if(p[o][0]==="-"){t[0].oldlines.push(p[o].substr(1))
}else{if(p[o][0]===" "){t[0].newlines.push(p[o].substr(1));
t[0].oldlines.push(p[o].substr(1))
}else{if(p[o][0]==="\\"){if(p[o-1][0]==="+"){u=true
}else{if(p[o-1][0]==="-"){s=true
}}}}}}}}var r=m.split("\n");
for(var o=t.length-1;
o>=0;
o--){var q=t[o];
for(var n=0;
n<q.oldlength;
n++){if(r[q.start-1+n]!==q.oldlines[n]){return false
}}Array.prototype.splice.apply(r,[q.start-1,+q.oldlength].concat(q.newlines))
}if(u){while(!r[r.length-1]){r.pop()
}}else{if(s){r.push("")
}}return r.join("\n")
},convertChangesToXML:function(l){var j=[];
for(var k=0;
k<l.length;
k++){var m=l[k];
if(m.added){j.push("<ins>")
}else{if(m.removed){j.push("<del>")
}}j.push(g(m.value));
if(m.added){j.push("</ins>")
}else{if(m.removed){j.push("</del>")
}}}return j.join("")
},convertChangesToDMP:function(l){var j=[],m;
for(var k=0;
k<l.length;
k++){m=l[k];
j.push([(m.added?1:m.removed?-1:0),m.value])
}return j
}}
})();
if(typeof module!=="undefined"){module.exports=JsDiff
};if(typeof JSON!=="object"){JSON={}
}(function(){function f(n){return n<10?"0"+n:n
}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null
};
String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()
}
}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;
function quote(string){escapable.lastIndex=0;
return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];
return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})+'"':'"'+string+'"'
}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];
if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)
}if(typeof rep==="function"){value=rep.call(holder,key,value)
}switch(typeof value){case"string":return quote(value);
case"number":return isFinite(value)?String(value):"null";
case"boolean":case"null":return String(value);
case"object":if(!value){return"null"
}gap+=indent;
partial=[];
if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;
for(i=0;
i<length;
i+=1){partial[i]=str(i,value)||"null"
}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";
gap=mind;
return v
}if(rep&&typeof rep==="object"){length=rep.length;
for(i=0;
i<length;
i+=1){if(typeof rep[i]==="string"){k=rep[i];
v=str(k,value);
if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);
if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";
gap=mind;
return v
}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;
gap="";
indent="";
if(typeof space==="number"){for(i=0;
i<space;
i+=1){indent+=" "
}}else{if(typeof space==="string"){indent=space
}}rep=replacer;
if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")
}return str("",{"":value})
}
}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;
function walk(holder,key){var k,v,value=holder[key];
if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);
if(v!==undefined){value[k]=v
}else{delete value[k]
}}}}return reviver.call(holder,key,value)
}text=String(text);
cx.lastIndex=0;
if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})
}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");
return typeof reviver==="function"?walk({"":j},""):j
}throw new SyntaxError("JSON.parse")
}
}}());var Pixastic=(function(){function d(m,n,l){if(m.addEventListener){m.addEventListener(n,l,false)
}else{if(m.attachEvent){m.attachEvent("on"+n,l)
}}}function g(n){var l=false;
var o=function(){if(!l){l=true;
n()
}};
document.write('<script defer src="//:" id="__onload_ie_pixastic__"><\/script>');
var m=document.getElementById("__onload_ie_pixastic__");
m.onreadystatechange=function(){if(m.readyState=="complete"){m.parentNode.removeChild(m);
o()
}};
if(document.addEventListener){document.addEventListener("DOMContentLoaded",o,false)
}d(window,"load",o)
}function k(){var l=c("pixastic",null,"img");
var o=c("pixastic",null,"canvas");
var n=l.concat(o);
for(var m=0;
m<n.length;
m++){(function(){var q=n[m];
var s=[];
var r=q.className.split(" ");
for(var v=0;
v<r.length;
v++){var x=r[v];
if(x.substring(0,9)=="pixastic-"){var u=x.substring(9);
if(u!=""){s.push(u)
}}}if(s.length){if(q.tagName.toLowerCase()=="img"){var p=new Image();
p.src=q.src;
if(p.complete){for(var w=0;
w<s.length;
w++){var t=Pixastic.applyAction(q,q,s[w],null);
if(t){q=t
}}}else{p.onload=function(){for(var y=0;
y<s.length;
y++){var z=Pixastic.applyAction(q,q,s[y],null);
if(z){q=z
}}}
}}else{setTimeout(function(){for(var y=0;
y<s.length;
y++){var z=Pixastic.applyAction(q,q,s[y],null);
if(z){q=z
}}},1)
}}})()
}}if(typeof pixastic_parseonload!="undefined"&&pixastic_parseonload){g(k)
}function c(r,p,l){var o=new Array();
if(p==null){p=document
}if(l==null){l="*"
}var n=p.getElementsByTagName(l);
var m=n.length;
var q=new RegExp("(^|\\s)"+r+"(\\s|$)");
for(i=0,j=0;
i<m;
i++){if(q.test(n[i].className)){o[j]=n[i];
j++
}}return o
}var e;
function a(m,n){if(!Pixastic.debug){return
}try{switch(n){case"warn":console.warn("Pixastic:",m);
break;
case"error":console.error("Pixastic:",m);
break;
default:console.log("Pixastic:",m)
}}catch(l){}if(!e){}}var b=(function(){var n=document.createElement("canvas");
var m=false;
try{m=!!((typeof n.getContext=="function")&&n.getContext("2d"))
}catch(l){}return function(){return m
}
})();
var f=(function(){var o=document.createElement("canvas");
var n=false;
var l;
try{if(typeof o.getContext=="function"&&(l=o.getContext("2d"))){n=(typeof l.getImageData=="function")
}}catch(m){}return function(){return n
}
})();
var h=(function(){var n=false;
var p=document.createElement("canvas");
if(b()&&f()){p.width=p.height=1;
var o=p.getContext("2d");
o.fillStyle="rgb(255,0,0)";
o.fillRect(0,0,1,1);
var l=document.createElement("canvas");
l.width=l.height=1;
var q=l.getContext("2d");
q.fillStyle="rgb(0,0,255)";
q.fillRect(0,0,1,1);
o.globalAlpha=0.5;
o.drawImage(l,0,0);
var m=o.getImageData(0,0,1,1).data;
n=(m[2]!=255)
}return function(){return n
}
})();
return{parseOnLoad:false,debug:false,applyAction:function(E,p,o,n){n=n||{};
var r=(E.tagName.toLowerCase()=="canvas");
if(r&&Pixastic.Client.isIE()){if(Pixastic.debug){a("Tried to process a canvas element but browser is IE.")
}return false
}var m,v;
var u=false;
if(Pixastic.Client.hasCanvas()){u=!!n.resultCanvas;
m=n.resultCanvas||document.createElement("canvas");
v=m.getContext("2d")
}var t=E.offsetWidth;
var x=E.offsetHeight;
if(r){t=E.width;
x=E.height
}if(t==0||x==0){if(E.parentNode==null){var s=E.style.position;
var C=E.style.left;
E.style.position="absolute";
E.style.left="-9999px";
document.body.appendChild(E);
t=E.offsetWidth;
x=E.offsetHeight;
document.body.removeChild(E);
E.style.position=s;
E.style.left=C
}else{if(Pixastic.debug){a("Image has 0 width and/or height.")
}return
}}if(o.indexOf("(")>-1){var A=o;
o=A.substr(0,A.indexOf("("));
var q=A.match(/\((.*?)\)/);
if(q[1]){q=q[1].split(";");
for(var B=0;
B<q.length;
B++){thisArg=q[B].split("=");
if(thisArg.length==2){if(thisArg[0]=="rect"){var l=thisArg[1].split(",");
n[thisArg[0]]={left:parseInt(l[0],10)||0,top:parseInt(l[1],10)||0,width:parseInt(l[2],10)||0,height:parseInt(l[3],10)||0}
}else{n[thisArg[0]]=thisArg[1]
}}}}}if(!n.rect){n.rect={left:0,top:0,width:t,height:x}
}else{n.rect.left=Math.round(n.rect.left);
n.rect.top=Math.round(n.rect.top);
n.rect.width=Math.round(n.rect.width);
n.rect.height=Math.round(n.rect.height)
}var y=false;
if(Pixastic.Actions[o]&&typeof Pixastic.Actions[o].process=="function"){y=true
}if(!y){if(Pixastic.debug){a('Invalid action "'+o+'". Maybe file not included?')
}return false
}if(!Pixastic.Actions[o].checkSupport()){if(Pixastic.debug){a('Action "'+o+'" not supported by this browser.')
}return false
}if(Pixastic.Client.hasCanvas()){if(m!==E){m.width=t;
m.height=x
}if(!u){m.style.width=t+"px";
m.style.height=x+"px"
}v.drawImage(p,0,0,t,x);
if(!E.__pixastic_org_image){m.__pixastic_org_image=E;
m.__pixastic_org_width=t;
m.__pixastic_org_height=x
}else{m.__pixastic_org_image=E.__pixastic_org_image;
m.__pixastic_org_width=E.__pixastic_org_width;
m.__pixastic_org_height=E.__pixastic_org_height
}}else{if(Pixastic.Client.isIE()&&typeof E.__pixastic_org_style=="undefined"){E.__pixastic_org_style=E.style.cssText
}}var z={image:E,canvas:m,width:t,height:x,useData:true,options:n};
var D=Pixastic.Actions[o].process(z);
if(!D){return false
}if(Pixastic.Client.hasCanvas()){if(z.useData){if(Pixastic.Client.hasCanvasImageData()){m.getContext("2d").putImageData(z.canvasData,n.rect.left,n.rect.top);
m.getContext("2d").fillRect(0,0,0,0)
}}if(!n.leaveDOM){m.title=E.title;
m.imgsrc=E.imgsrc;
if(!r){m.alt=E.alt
}if(!r){m.imgsrc=E.src
}m.className=E.className;
m.style.cssText=E.style.cssText;
m.name=E.name;
m.tabIndex=E.tabIndex;
m.id=E.id;
if(E.parentNode&&E.parentNode.replaceChild){E.parentNode.replaceChild(m,E)
}}n.resultCanvas=m;
return m
}return E
},prepareData:function(q,m){var l=q.canvas.getContext("2d");
var o=q.options.rect;
var n=l.getImageData(o.left,o.top,o.width,o.height);
var p=n.data;
if(!m){q.canvasData=n
}return p
},process:function(m,l,n,q){if(m.tagName.toLowerCase()=="img"){var p=new Image();
p.src=m.src;
if(p.complete){var o=Pixastic.applyAction(m,p,l,n);
if(q){q(o)
}return o
}else{p.onload=function(){var r=Pixastic.applyAction(m,p,l,n);
if(q){q(r)
}}
}}if(m.tagName.toLowerCase()=="canvas"){var o=Pixastic.applyAction(m,m,l,n);
if(q){q(o)
}return o
}},revert:function(l){if(Pixastic.Client.hasCanvas()){if(l.tagName.toLowerCase()=="canvas"&&l.__pixastic_org_image){l.width=l.__pixastic_org_width;
l.height=l.__pixastic_org_height;
l.getContext("2d").drawImage(l.__pixastic_org_image,0,0);
if(l.parentNode&&l.parentNode.replaceChild){l.parentNode.replaceChild(l.__pixastic_org_image,l)
}return l
}}else{if(Pixastic.Client.isIE()){if(typeof l.__pixastic_org_style!="undefined"){l.style.cssText=l.__pixastic_org_style
}}}},Client:{hasCanvas:b,hasCanvasImageData:f,hasGlobalAlpha:h,isIE:function(){return !!document.all&&!!window.attachEvent&&!window.opera
}},Actions:{}}
})();Pixastic.Actions.brightness={process:function(s){var u=parseInt(s.options.brightness,10)||0;
var d=parseFloat(s.options.contrast)||0;
var m=!!(s.options.legacy&&s.options.legacy!="false");
if(m){u=Math.min(150,Math.max(-150,u))
}else{var v=1+Math.min(150,Math.max(-150,u))/150
}d=Math.max(0,d+1);
if(Pixastic.Client.hasCanvasImageData()){var x=Pixastic.prepareData(s);
var a=s.options.rect;
var e=a.width;
var n=a.height;
var l=e*n;
var c=l*4,j,f;
var q,i;
if(d!=1){if(m){q=d;
i=(u-128)*d+128
}else{q=v*d;
i=-d*128+128
}}else{if(m){q=1;
i=u
}else{q=v;
i=0
}}var k,o,t;
while(l--){if((k=x[c-=4]*q+i)>255){x[c]=255
}else{if(k<0){x[c]=0
}else{x[c]=k
}}if((o=x[j=c+1]*q+i)>255){x[j]=255
}else{if(o<0){x[j]=0
}else{x[j]=o
}}if((t=x[f=c+2]*q+i)>255){x[f]=255
}else{if(t<0){x[f]=0
}else{x[f]=t
}}}return true
}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()
}};Pixastic.Actions.crop={process:function(f){if(Pixastic.Client.hasCanvas()){var c=f.options.rect;
var b=c.width;
var a=c.height;
var e=c.top;
var d=c.left;
if(typeof f.options.left!="undefined"){d=parseInt(f.options.left,10)
}if(typeof f.options.top!="undefined"){e=parseInt(f.options.top,10)
}if(typeof f.options.height!="undefined"){b=parseInt(f.options.width,10)
}if(typeof f.options.height!="undefined"){a=parseInt(f.options.height,10)
}if(d<0){d=0
}if(d>f.width-1){d=f.width-1
}if(e<0){e=0
}if(e>f.height-1){e=f.height-1
}if(b<1){b=1
}if(d+b>f.width){b=f.width-d
}if(a<1){a=1
}if(e+a>f.height){a=f.height-e
}var g=document.createElement("canvas");
g.width=f.width;
g.height=f.height;
g.getContext("2d").drawImage(f.canvas,0,0);
f.canvas.width=b;
f.canvas.height=a;
f.canvas.getContext("2d").clearRect(0,0,b,a);
f.canvas.getContext("2d").drawImage(g,d,e,b,a,0,0,b,a);
f.useData=false;
return true
}},checkSupport:function(){return Pixastic.Client.hasCanvas()
}};Pixastic.Actions.desaturate={process:function(b){var c=!!(b.options.average&&b.options.average!="false");
if(Pixastic.Client.hasCanvasImageData()){var d=Pixastic.prepareData(b);
var j=b.options.rect;
var k=j.width;
var e=j.height;
var a=k*e;
var f=a*4,i,g;
if(c){while(a--){d[f-=4]=d[i=f+1]=d[g=f+2]=(d[f]+d[i]+d[g])/3
}}else{while(a--){d[f-=4]=d[i=f+1]=d[g=f+2]=(d[f]*0.3+d[i]*0.59+d[g]*0.11)
}}return true
}else{if(Pixastic.Client.isIE()){b.image.style.filter+=" gray";
return true
}}},checkSupport:function(){return(Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE())
}};Pixastic.Actions.fliph={process:function(d){if(Pixastic.Client.hasCanvas()){var b=d.options.rect;
var c=document.createElement("canvas");
c.width=b.width;
c.height=b.height;
c.getContext("2d").drawImage(d.image,b.left,b.top,b.width,b.height,0,0,b.width,b.height);
var a=d.canvas.getContext("2d");
a.clearRect(b.left,b.top,b.width,b.height);
a.scale(-1,1);
a.drawImage(c,-b.left-b.width,b.top,b.width,b.height);
d.useData=false;
return true
}else{if(Pixastic.Client.isIE()){d.image.style.filter+=" fliph";
return true
}}},checkSupport:function(){return(Pixastic.Client.hasCanvas()||Pixastic.Client.isIE())
}};Pixastic.Actions.flipv={process:function(d){if(Pixastic.Client.hasCanvas()){var b=d.options.rect;
var c=document.createElement("canvas");
c.width=b.width;
c.height=b.height;
c.getContext("2d").drawImage(d.image,b.left,b.top,b.width,b.height,0,0,b.width,b.height);
var a=d.canvas.getContext("2d");
a.clearRect(b.left,b.top,b.width,b.height);
a.scale(1,-1);
a.drawImage(c,b.left,-b.top-b.height,b.width,b.height);
d.useData=false;
return true
}else{if(Pixastic.Client.isIE()){d.image.style.filter+=" flipv";
return true
}}},checkSupport:function(){return(Pixastic.Client.hasCanvas()||Pixastic.Client.isIE())
}};Pixastic.Actions.invert={process:function(c){if(Pixastic.Client.hasCanvasImageData()){var d=Pixastic.prepareData(c);
var b=!!c.options.invertAlpha;
var h=c.options.rect;
var a=h.width*h.height;
var e=a*4,i=e+1,g=e+2,f=e+3;
while(a--){d[e-=4]=255-d[e];
d[i-=4]=255-d[i];
d[g-=4]=255-d[g];
if(b){d[f-=4]=255-d[f]
}}return true
}else{if(Pixastic.Client.isIE()){c.image.style.filter+=" invert";
return true
}}},checkSupport:function(){return(Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE())
}};Pixastic.Actions.rotate={process:function(f){if(Pixastic.Client.hasCanvas()){var d=f.canvas;
var c=f.width;
var l=f.height;
var b=document.createElement("canvas");
b.width=c;
b.height=l;
b.getContext("2d").drawImage(d,0,0,c,l);
var e=-parseFloat(f.options.angle)*Math.PI/180;
var k=e;
if(k>Math.PI*0.5){k=Math.PI-k
}if(k<-Math.PI*0.5){k=-Math.PI-k
}var h=Math.sqrt(c*c+l*l);
var j=Math.abs(k)-Math.abs(Math.atan2(l,c));
var i=Math.abs(k)+Math.abs(Math.atan2(l,c));
var g=Math.abs(Math.cos(j)*h);
var a=Math.abs(Math.sin(i)*h);
d.width=g;
d.height=a;
var m=d.getContext("2d");
m.translate(g/2,a/2);
m.rotate(e);
m.drawImage(b,-c/2,-l/2);
f.useData=false;
return true
}},checkSupport:function(){return Pixastic.Client.hasCanvas()
}};Pixastic.Actions.sepia={process:function(u){var l=(parseInt(u.options.mode,10)||0);
if(l<0){l=0
}if(l>1){l=1
}if(Pixastic.Client.hasCanvasImageData()){var z=Pixastic.prepareData(u);
var a=u.options.rect;
var k=a.width;
var p=a.height;
var f=k*4;
var i=p;
do{var s=(i-1)*f;
var j=k;
do{var c=s+(j-1)*4;
if(l){var t=z[c]*0.299+z[c+1]*0.587+z[c+2]*0.114;
var m=(t+39);
var q=(t+14);
var v=(t-36)
}else{var e=z[c];
var n=z[c+1];
var o=z[c+2];
var m=(e*0.393+n*0.769+o*0.189);
var q=(e*0.349+n*0.686+o*0.168);
var v=(e*0.272+n*0.534+o*0.131)
}if(m<0){m=0
}if(m>255){m=255
}if(q<0){q=0
}if(q>255){q=255
}if(v<0){v=0
}if(v>255){v=255
}z[c]=m;
z[c+1]=q;
z[c+2]=v
}while(--j)
}while(--i);
return true
}},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()
}};(function(){var m=document.createElement("input");
try{m.type="range";
if(m.type=="range"){return
}}catch(k){return
}if(!document.mozSetImageElement||!("MozAppearance" in m.style)){return
}var g;
var j=navigator.platform=="MacIntel";
var a={radius:j?9:6,width:j?22:12,height:j?16:20};
var d="-moz-linear-gradient(top, transparent "+(j?"6px, #999 6px, #999 7px, #ccc 9px, #bbb 11px, #bbb 12px, transparent 12px":"9px, #999 9px, #bbb 10px, #fff 11px, transparent 11px")+", transparent)";
var n={"min-width":a.width+"px","min-height":a.height+"px","max-height":a.height+"px",padding:0,border:0,"border-radius":0,cursor:"default","text-indent":"-999999px"};
var l=document.createEvent("HTMLEvents");
l.initEvent("change",true,false);
if(document.readyState=="loading"){document.addEventListener("DOMContentLoaded",h,true)
}else{h()
}function h(){Array.forEach(document.querySelectorAll("input[type=range]"),f);
document.addEventListener("DOMNodeInserted",i,true)
}function i(o){c(o.target);
if(o.target.querySelectorAll){Array.forEach(o.target.querySelectorAll("input"),c)
}}function c(e,o){if(e.localName!="input"||e.type=="range"){}else{if(e.getAttribute("type")=="range"){f(e)
}else{if(!o){setTimeout(c,0,e,true)
}}}}function f(F){var w,L,v,K,H,I,u;
var G,J,y,D,E=F.value;
if(!g){g=document.body.appendChild(document.createElement("hr"));
b(g,{"-moz-appearance":j?"scale-horizontal":"scalethumb-horizontal",display:"block",visibility:"visible",opacity:1,position:"fixed",top:"-999999px"});
document.mozSetImageElement("__sliderthumb__",g)
}var q=function(){return""+E
};
var p=function p(M){E=""+M;
w=true;
A();
delete F.value;
F.value=E;
F.__defineGetter__("value",q);
F.__defineSetter__("value",p)
};
F.__defineGetter__("value",q);
F.__defineSetter__("value",p);
F.__defineGetter__("type",function(){return"range"
});
["min","max","step"].forEach(function(M){if(F.hasAttribute(M)){L=true
}F.__defineGetter__(M,function(){return this.hasAttribute(M)?this.getAttribute(M):""
});
F.__defineSetter__(M,function(N){N===null?this.removeAttribute(M):this.setAttribute(M,N)
})
});
F.readOnly=true;
b(F,n);
z();
F.addEventListener("DOMAttrModified",function(M){if(M.attrName=="value"&&!w){E=M.newValue;
A()
}else{if(~["min","max","step"].indexOf(M.attrName)){z();
L=true
}}},true);
F.addEventListener("mousedown",x,true);
F.addEventListener("keydown",r,true);
F.addEventListener("focus",t,true);
F.addEventListener("blur",B,true);
function x(O){K=true;
setTimeout(function(){K=false
},0);
if(O.button||!D){return
}var N=parseFloat(getComputedStyle(this,0).width);
var P=(N-a.width)/D;
if(!P){return
}var M=O.clientX-this.getBoundingClientRect().left-a.width/2-(E-G)*P;
if(Math.abs(M)>a.radius){v=true;
this.value-=-M/P
}I=E;
u=O.clientX;
this.addEventListener("mousemove",C,true);
this.addEventListener("mouseup",o,true)
}function C(N){var M=parseFloat(getComputedStyle(this,0).width);
var O=(M-a.width)/D;
if(!O){return
}I+=(N.clientX-u)/O;
u=N.clientX;
v=true;
this.value=I
}function o(){this.removeEventListener("mousemove",C,true);
this.removeEventListener("mouseup",o,true)
}function r(M){if(M.keyCode>36&&M.keyCode<41){t.call(this);
v=true;
this.value=E+(M.keyCode==38||M.keyCode==39?y:-y)
}}function t(){if(!K){this.style.boxShadow=!j?"0 0 0 2px #fb0":"0 0 2px 1px -moz-mac-focusring, inset 0 0 1px -moz-mac-focusring"
}}function B(){this.style.boxShadow=""
}function s(M){return !isNaN(M)&&+M==parseFloat(M)
}function z(){G=s(F.min)?+F.min:0;
J=s(F.max)?+F.max:100;
if(J<G){J=G>100?G:100
}y=s(F.step)&&F.step>0?+F.step:1;
D=J-G;
A(true)
}function e(){if(!w&&!L){E=F.getAttribute("value")
}if(!s(E)){E=(G+J)/2
}E=Math.round((E-G)/y)*y+G;
if(E<G){E=G
}else{if(E>J){E=G+~~(D/y)*y
}}}function A(O){e();
if(v&&E!=H){F.dispatchEvent(l)
}v=false;
if(!O&&E==H){return
}H=E;
var M=D?(E-G)/D*100:0;
var N="-moz-element(#__sliderthumb__) "+M+"% no-repeat, ";
b(F,{background:N+d})
}}function b(e,o){for(var p in o){e.style.setProperty(p,o[p],"important")
}}})();var wysihtml5={version:"0.3.0",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\uFEFF",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};
window.rangy=(function(){var j="object",g="function",z="undefined";
var k=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"];
var c=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"];
var r=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"];
var o=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"];
function i(C,B){var A=typeof C[B];
return A==g||(!!(A==j&&C[B]))||A=="unknown"
}function d(B,A){return !!(typeof B[A]==j&&B[A])
}function p(B,A){return typeof B[A]!=z
}function l(A){return function(D,C){var B=C.length;
while(B--){if(!A(D,C[B])){return false
}}return true
}
}var n=l(i);
var q=l(d);
var y=l(p);
function u(A){return A&&n(A,o)&&y(A,r)
}var m={version:"1.2.2",initialized:false,supported:true,util:{isHostMethod:i,isHostObject:d,isHostProperty:p,areHostMethods:n,areHostObjects:q,areHostProperties:y,isTextRange:u},features:{},modules:{},config:{alertOnWarn:false,preferTextRange:false}};
function f(A){window.alert("Rangy not supported in your browser. Reason: "+A);
m.initialized=true;
m.supported=false
}m.fail=f;
function t(B){var A="Rangy warning: "+B;
if(m.config.alertOnWarn){window.alert(A)
}else{if(typeof window.console!=z&&typeof window.console.log!=z){window.console.log(A)
}}}m.warn=t;
if({}.hasOwnProperty){m.util.extend=function(C,B){for(var A in B){if(B.hasOwnProperty(A)){C[A]=B[A]
}}}
}else{f("hasOwnProperty not supported")
}var v=[];
var a=[];
function s(){if(m.initialized){return
}var C;
var G=false,H=false;
if(i(document,"createRange")){C=document.createRange();
if(n(C,c)&&y(C,k)){G=true
}C.detach()
}var B=d(document,"body")?document.body:document.getElementsByTagName("body")[0];
if(B&&i(B,"createTextRange")){C=B.createTextRange();
if(u(C)){H=true
}}if(!G&&!H){f("Neither Range nor TextRange are implemented")
}m.initialized=true;
m.features={implementsDomRange:G,implementsTextRange:H};
var F=a.concat(v);
for(var E=0,A=F.length;
E<A;
++E){try{F[E](m)
}catch(D){if(d(window,"console")&&i(window.console,"log")){window.console.log("Init listener threw an exception. Continuing.",D)
}}}}m.init=s;
m.addInitListener=function(A){if(m.initialized){A(m)
}else{v.push(A)
}};
var w=[];
m.addCreateMissingNativeApiListener=function(A){w.push(A)
};
function e(C){C=C||window;
s();
for(var B=0,A=w.length;
B<A;
++B){w[B](C)
}}m.createMissingNativeApi=e;
function x(A){this.name=A;
this.initialized=false;
this.supported=false
}x.prototype.fail=function(A){this.initialized=true;
this.supported=false;
throw new Error("Module '"+this.name+"' failed to load: "+A)
};
x.prototype.warn=function(A){m.warn("Module "+this.name+": "+A)
};
x.prototype.createError=function(A){return new Error("Error in Rangy "+this.name+" module: "+A)
};
m.createModule=function(A,C){var B=new x(A);
m.modules[A]=B;
a.push(function(D){C(D,B);
B.initialized=true;
B.supported=true
})
};
m.requireModules=function(C){for(var E=0,A=C.length,D,B;
E<A;
++E){B=C[E];
D=m.modules[B];
if(!D||!(D instanceof x)){throw new Error("Module '"+B+"' not found")
}if(!D.supported){throw new Error("Module '"+B+"' not supported")
}}};
var b=false;
var h=function(A){if(!b){b=true;
if(!m.initialized){s()
}}};
if(typeof window==z){f("No window found");
return
}if(typeof document==z){f("No document found");
return
}if(i(document,"addEventListener")){document.addEventListener("DOMContentLoaded",h,false)
}if(i(window,"addEventListener")){window.addEventListener("load",h,false)
}else{if(i(window,"attachEvent")){window.attachEvent("onload",h)
}else{f("Window does not have required addEventListener or attachEvent method")
}}return m
})();
rangy.createModule("DomUtil",function(p,d){var t="undefined";
var b=p.util;
if(!b.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])){d.fail("document missing a Node creation method")
}if(!b.isHostMethod(document,"getElementsByTagName")){d.fail("document missing getElementsByTagName method")
}var e=document.createElement("div");
if(!b.areHostMethods(e,["insertBefore","appendChild","cloneNode"]||!b.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"]))){d.fail("Incomplete Element implementation")
}if(!b.isHostProperty(e,"innerHTML")){d.fail("Element is missing innerHTML property")
}var s=document.createTextNode("test");
if(!b.areHostMethods(s,["splitText","deleteData","insertData","appendData","cloneNode"]||!b.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"])||!b.areHostProperties(s,["data"]))){d.fail("Incomplete Text Node implementation")
}var y=function(E,G){var F=E.length;
while(F--){if(E[F]===G){return true
}}return false
};
function i(F){var E;
return typeof F.namespaceURI==t||((E=F.namespaceURI)===null||E=="http://www.w3.org/1999/xhtml")
}function j(F){var E=F.parentNode;
return(E.nodeType==1)?E:null
}function a(F){var E=0;
while((F=F.previousSibling)){E++
}return E
}function g(E){var F;
return m(E)?E.length:((F=E.childNodes)?F.length:0)
}function x(F,E){var G=[],H;
for(H=F;
H;
H=H.parentNode){G.push(H)
}for(H=E;
H;
H=H.parentNode){if(y(G,H)){return H
}}return null
}function C(E,F,H){var G=H?F:F.parentNode;
while(G){if(G===E){return true
}else{G=G.parentNode
}}return false
}function z(F,E,I){var G,H=I?F:F.parentNode;
while(H){G=H.parentNode;
if(G===E){return H
}H=G
}return null
}function m(F){var E=F.nodeType;
return E==3||E==4||E==8
}function v(H,F){var E=F.nextSibling,G=F.parentNode;
if(E){G.insertBefore(H,E)
}else{G.appendChild(H)
}return H
}function w(G,E){var F=G.cloneNode(false);
F.deleteData(0,E);
G.deleteData(E,G.length-E);
v(F,G);
return F
}function q(E){if(E.nodeType==9){return E
}else{if(typeof E.ownerDocument!=t){return E.ownerDocument
}else{if(typeof E.document!=t){return E.document
}else{if(E.parentNode){return q(E.parentNode)
}else{throw new Error("getDocument: no document found for node")
}}}}}function l(E){var F=q(E);
if(typeof F.defaultView!=t){return F.defaultView
}else{if(typeof F.parentWindow!=t){return F.parentWindow
}else{throw new Error("Cannot get a window object for node")
}}}function B(E){if(typeof E.contentDocument!=t){return E.contentDocument
}else{if(typeof E.contentWindow!=t){return E.contentWindow.document
}else{throw new Error("getIframeWindow: No Document object found for iframe element")
}}}function f(E){if(typeof E.contentWindow!=t){return E.contentWindow
}else{if(typeof E.contentDocument!=t){return E.contentDocument.defaultView
}else{throw new Error("getIframeWindow: No Window object found for iframe element")
}}}function D(E){return b.isHostObject(E,"body")?E.body:E.getElementsByTagName("body")[0]
}function c(F){var E;
while((E=F.parentNode)){F=E
}return F
}function r(H,J,G,I){var E,K,M,L,F;
if(H==G){return J===I?0:(J<I)?-1:1
}else{if((E=z(G,H,true))){return J<=a(E)?-1:1
}else{if((E=z(H,G,true))){return a(E)<I?-1:1
}else{K=x(H,G);
M=(H===K)?K:z(H,K,true);
L=(G===K)?K:z(G,K,true);
if(M===L){throw new Error("comparePoints got to case 4 and childA and childB are the same!")
}else{F=K.firstChild;
while(F){if(F===M){return -1
}else{if(F===L){return 1
}}F=F.nextSibling
}throw new Error("Should not be here!")
}}}}}function A(F){var E=q(F).createDocumentFragment(),G;
while((G=F.firstChild)){E.appendChild(G)
}return E
}function o(E){if(!E){return"[No node]"
}if(m(E)){return'"'+E.data+'"'
}else{if(E.nodeType==1){var F=E.id?' id="'+E.id+'"':"";
return"<"+E.nodeName+F+">["+E.childNodes.length+"]"
}else{return E.nodeName
}}}function n(E){this.root=E;
this._next=E
}n.prototype={_current:null,hasNext:function(){return !!this._next
},next:function(){var G=this._current=this._next;
var F,E;
if(this._current){F=G.firstChild;
if(F){this._next=F
}else{E=null;
while((G!==this.root)&&!(E=G.nextSibling)){G=G.parentNode
}this._next=E
}}return this._current
},detach:function(){this._current=this._next=this.root=null
}};
function h(E){return new n(E)
}function k(E,F){this.node=E;
this.offset=F
}k.prototype={equals:function(E){return this.node===E.node&this.offset==E.offset
},inspect:function(){return"[DomPosition("+o(this.node)+":"+this.offset+")]"
}};
function u(E){this.code=this[E];
this.codeName=E;
this.message="DOMException: "+this.codeName
}u.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};
u.prototype.toString=function(){return this.message
};
p.dom={arrayContains:y,isHtmlNamespace:i,parentElement:j,getNodeIndex:a,getNodeLength:g,getCommonAncestor:x,isAncestorOf:C,getClosestAncestorIn:z,isCharacterDataNode:m,insertAfter:v,splitDataNode:w,getDocument:q,getWindow:l,getIframeWindow:f,getIframeDocument:B,getBody:D,getRootContainer:c,comparePoints:r,inspectNode:o,fragmentFromNodeChildren:A,createIterator:h,DomPosition:k};
p.DOMException=u
});
rangy.createModule("DomRange",function(i,f){i.requireModules(["DomUtil"]);
var b=i.dom;
var E=b.DomPosition;
var T=i.DOMException;
function x(al,e){return(al.nodeType!=3)&&(b.isAncestorOf(al,e.startContainer,true)||b.isAncestorOf(al,e.endContainer,true))
}function m(e){return b.getDocument(e.startContainer)
}function u(al,ap,am){var ao=al._listeners[ap];
if(ao){for(var an=0,e=ao.length;
an<e;
++an){ao[an].call(al,{target:al,args:am})
}}}function A(e){return new E(e.parentNode,b.getNodeIndex(e))
}function W(e){return new E(e.parentNode,b.getNodeIndex(e)+1)
}function j(al,an,am){var e=al.nodeType==11?al.firstChild:al;
if(b.isCharacterDataNode(an)){if(am==an.length){b.insertAfter(al,an)
}else{an.parentNode.insertBefore(al,am==0?an:b.splitDataNode(an,am))
}}else{if(am>=an.childNodes.length){an.appendChild(al)
}else{an.insertBefore(al,an.childNodes[am])
}}return e
}function H(am){var al;
for(var an,ao=m(am.range).createDocumentFragment(),e;
an=am.next();
){al=am.isPartiallySelectedSubtree();
an=an.cloneNode(!al);
if(al){e=am.getSubtreeIterator();
an.appendChild(H(e));
e.detach(true)
}if(an.nodeType==10){throw new T("HIERARCHY_REQUEST_ERR")
}ao.appendChild(an)
}return ao
}function V(al,ao,e){var am,aq;
e=e||{stop:false};
for(var an,ap;
an=al.next();
){if(al.isPartiallySelectedSubtree()){if(ao(an)===false){e.stop=true;
return
}else{ap=al.getSubtreeIterator();
V(ap,ao,e);
ap.detach(true);
if(e.stop){return
}}}else{am=b.createIterator(an);
while((aq=am.next())){if(ao(aq)===false){e.stop=true;
return
}}}}}function n(al){var e;
while(al.next()){if(al.isPartiallySelectedSubtree()){e=al.getSubtreeIterator();
n(e);
e.detach(true)
}else{al.remove()
}}}function Q(al){for(var am,an=m(al.range).createDocumentFragment(),e;
am=al.next();
){if(al.isPartiallySelectedSubtree()){am=am.cloneNode(false);
e=al.getSubtreeIterator();
am.appendChild(Q(e));
e.detach(true)
}else{al.remove()
}if(am.nodeType==10){throw new T("HIERARCHY_REQUEST_ERR")
}an.appendChild(am)
}return an
}function p(am,e,an){var ap=!!(e&&e.length),ao;
var aq=!!an;
if(ap){ao=new RegExp("^("+e.join("|")+")$")
}var al=[];
V(new g(am,false),function(ar){if((!ap||ao.test(ar.nodeType))&&(!aq||an(ar))){al.push(ar)
}});
return al
}function z(e){var al=(typeof e.getName=="undefined")?"Range":e.getName();
return"["+al+"("+b.inspectNode(e.startContainer)+":"+e.startOffset+", "+b.inspectNode(e.endContainer)+":"+e.endOffset+")]"
}function g(am,al){this.range=am;
this.clonePartiallySelectedTextNodes=al;
if(!am.collapsed){this.sc=am.startContainer;
this.so=am.startOffset;
this.ec=am.endContainer;
this.eo=am.endOffset;
var e=am.commonAncestorContainer;
if(this.sc===this.ec&&b.isCharacterDataNode(this.sc)){this.isSingleCharacterDataNode=true;
this._first=this._last=this._next=this.sc
}else{this._first=this._next=(this.sc===e&&!b.isCharacterDataNode(this.sc))?this.sc.childNodes[this.so]:b.getClosestAncestorIn(this.sc,e,true);
this._last=(this.ec===e&&!b.isCharacterDataNode(this.ec))?this.ec.childNodes[this.eo-1]:b.getClosestAncestorIn(this.ec,e,true)
}}}g.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;
this._next=this._first
},hasNext:function(){return !!this._next
},next:function(){var e=this._current=this._next;
if(e){this._next=(e!==this._last)?e.nextSibling:null;
if(b.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes){if(e===this.ec){(e=e.cloneNode(true)).deleteData(this.eo,e.length-this.eo)
}if(this._current===this.sc){(e=e.cloneNode(true)).deleteData(0,this.so)
}}}return e
},remove:function(){var al=this._current,am,e;
if(b.isCharacterDataNode(al)&&(al===this.sc||al===this.ec)){am=(al===this.sc)?this.so:0;
e=(al===this.ec)?this.eo:al.length;
if(am!=e){al.deleteData(am,e-am)
}}else{if(al.parentNode){al.parentNode.removeChild(al)
}else{}}},isPartiallySelectedSubtree:function(){var e=this._current;
return x(e,this.range)
},getSubtreeIterator:function(){var al;
if(this.isSingleCharacterDataNode){al=this.range.cloneRange();
al.collapse()
}else{al=new aj(m(this.range));
var ap=this._current;
var an=ap,e=0,ao=ap,am=b.getNodeLength(ap);
if(b.isAncestorOf(ap,this.sc,true)){an=this.sc;
e=this.so
}if(b.isAncestorOf(ap,this.ec,true)){ao=this.ec;
am=this.eo
}D(al,an,e,ao,am)
}return new g(al,this.clonePartiallySelectedTextNodes)
},detach:function(e){if(e){this.range.detach()
}this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null
}};
function O(e){this.code=this[e];
this.codeName=e;
this.message="RangeException: "+this.codeName
}O.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};
O.prototype.toString=function(){return this.message
};
function w(al,e,am){this.nodes=p(al,e,am);
this._next=this.nodes[0];
this._position=0
}w.prototype={_current:null,hasNext:function(){return !!this._next
},next:function(){this._current=this._next;
this._next=this.nodes[++this._position];
return this._current
},detach:function(){this._current=this._next=this.nodes=null
}};
var ae=[1,3,4,5,7,8,10];
var ac=[2,9,11];
var B=[5,6,10,12];
var M=[1,3,4,5,7,8,10,11];
var F=[1,3,4,5,7,8];
function Y(e){return function(am,ao){var al,an=ao?am:am.parentNode;
while(an){al=an.nodeType;
if(b.arrayContains(e,al)){return an
}an=an.parentNode
}return null
}
}var t=b.getRootContainer;
var I=Y([9,11]);
var K=Y(B);
var c=Y([6,10,12]);
function r(al,e){if(c(al,e)){throw new O("INVALID_NODE_TYPE_ERR")
}}function C(e){if(!e.startContainer){throw new T("INVALID_STATE_ERR")
}}function U(e,al){if(!b.arrayContains(al,e.nodeType)){throw new O("INVALID_NODE_TYPE_ERR")
}}function ad(e,al){if(al<0||al>(b.isCharacterDataNode(e)?e.length:e.childNodes.length)){throw new T("INDEX_SIZE_ERR")
}}function d(al,e){if(I(al,true)!==I(e,true)){throw new T("WRONG_DOCUMENT_ERR")
}}function aa(e){if(K(e,true)){throw new T("NO_MODIFICATION_ALLOWED_ERR")
}}function ah(al,e){if(!al){throw new T(e)
}}function o(e){return !b.arrayContains(ac,e.nodeType)&&!I(e,true)
}function ak(e,al){return al<=(b.isCharacterDataNode(e)?e.length:e.childNodes.length)
}function h(e){C(e);
if(o(e.startContainer)||o(e.endContainer)||!ak(e.startContainer,e.startOffset)||!ak(e.endContainer,e.endOffset)){throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")
}}var a=document.createElement("style");
var P=false;
try{a.innerHTML="<b>x</b>";
P=(a.firstChild.nodeType==3)
}catch(ag){}i.features.htmlParsingConforms=P;
var R=P?function(am){var al=this.startContainer;
var an=b.getDocument(al);
if(!al){throw new T("INVALID_STATE_ERR")
}var e=null;
if(al.nodeType==1){e=al
}else{if(b.isCharacterDataNode(al)){e=b.parentElement(al)
}}if(e===null||(e.nodeName=="HTML"&&b.isHtmlNamespace(b.getDocument(e).documentElement)&&b.isHtmlNamespace(e))){e=an.createElement("body")
}else{e=e.cloneNode(false)
}e.innerHTML=am;
return b.fragmentFromNodeChildren(e)
}:function(al){C(this);
var am=m(this);
var e=am.createElement("body");
e.innerHTML=al;
return b.fragmentFromNodeChildren(e)
};
var L=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];
var l=0,y=1,af=2,Z=3;
var s=0,v=1,J=2,k=3;
function ab(){}ab.prototype={attachListener:function(e,al){this._listeners[e].push(al)
},compareBoundaryPoints:function(ap,am){h(this);
d(this.startContainer,am.startContainer);
var ar,al,aq,e;
var ao=(ap==Z||ap==l)?"start":"end";
var an=(ap==y||ap==l)?"start":"end";
ar=this[ao+"Container"];
al=this[ao+"Offset"];
aq=am[an+"Container"];
e=am[an+"Offset"];
return b.comparePoints(ar,al,aq,e)
},insertNode:function(al){h(this);
U(al,M);
aa(this.startContainer);
if(b.isAncestorOf(al,this.startContainer,true)){throw new T("HIERARCHY_REQUEST_ERR")
}var e=j(al,this.startContainer,this.startOffset);
this.setStartBefore(e)
},cloneContents:function(){h(this);
var am,al;
if(this.collapsed){return m(this).createDocumentFragment()
}else{if(this.startContainer===this.endContainer&&b.isCharacterDataNode(this.startContainer)){am=this.startContainer.cloneNode(true);
am.data=am.data.slice(this.startOffset,this.endOffset);
al=m(this).createDocumentFragment();
al.appendChild(am);
return al
}else{var e=new g(this,true);
am=H(e);
e.detach()
}return am
}},canSurroundContents:function(){h(this);
aa(this.startContainer);
aa(this.endContainer);
var e=new g(this,true);
var al=(e._first&&(x(e._first,this))||(e._last&&x(e._last,this)));
e.detach();
return !al
},surroundContents:function(al){U(al,F);
if(!this.canSurroundContents()){throw new O("BAD_BOUNDARYPOINTS_ERR")
}var e=this.extractContents();
if(al.hasChildNodes()){while(al.lastChild){al.removeChild(al.lastChild)
}}j(al,this.startContainer,this.startOffset);
al.appendChild(e);
this.selectNode(al)
},cloneRange:function(){h(this);
var e=new aj(m(this));
var al=L.length,am;
while(al--){am=L[al];
e[am]=this[am]
}return e
},toString:function(){h(this);
var al=this.startContainer;
if(al===this.endContainer&&b.isCharacterDataNode(al)){return(al.nodeType==3||al.nodeType==4)?al.data.slice(this.startOffset,this.endOffset):""
}else{var am=[],e=new g(this,true);
V(e,function(an){if(an.nodeType==3||an.nodeType==4){am.push(an.data)
}});
e.detach();
return am.join("")
}},compareNode:function(am){h(this);
var al=am.parentNode;
var ao=b.getNodeIndex(am);
if(!al){throw new T("NOT_FOUND_ERR")
}var an=this.comparePoint(al,ao),e=this.comparePoint(al,ao+1);
if(an<0){return(e>0)?J:s
}else{return(e>0)?v:k
}},comparePoint:function(e,al){h(this);
ah(e,"HIERARCHY_REQUEST_ERR");
d(e,this.startContainer);
if(b.comparePoints(e,al,this.startContainer,this.startOffset)<0){return -1
}else{if(b.comparePoints(e,al,this.endContainer,this.endOffset)>0){return 1
}}return 0
},createContextualFragment:R,toHtml:function(){h(this);
var e=m(this).createElement("div");
e.appendChild(this.cloneContents());
return e.innerHTML
},intersectsNode:function(an,e){h(this);
ah(an,"NOT_FOUND_ERR");
if(b.getDocument(an)!==m(this)){return false
}var am=an.parentNode,ap=b.getNodeIndex(an);
ah(am,"NOT_FOUND_ERR");
var ao=b.comparePoints(am,ap,this.endContainer,this.endOffset),al=b.comparePoints(am,ap+1,this.startContainer,this.startOffset);
return e?ao<=0&&al>=0:ao<0&&al>0
},isPointInRange:function(e,al){h(this);
ah(e,"HIERARCHY_REQUEST_ERR");
d(e,this.startContainer);
return(b.comparePoints(e,al,this.startContainer,this.startOffset)>=0)&&(b.comparePoints(e,al,this.endContainer,this.endOffset)<=0)
},intersectsRange:function(al,e){h(this);
if(m(al)!=m(this)){throw new T("WRONG_DOCUMENT_ERR")
}var an=b.comparePoints(this.startContainer,this.startOffset,al.endContainer,al.endOffset),am=b.comparePoints(this.endContainer,this.endOffset,al.startContainer,al.startOffset);
return e?an<=0&&am>=0:an<0&&am>0
},intersection:function(e){if(this.intersectsRange(e)){var an=b.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),al=b.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset);
var am=this.cloneRange();
if(an==-1){am.setStart(e.startContainer,e.startOffset)
}if(al==1){am.setEnd(e.endContainer,e.endOffset)
}return am
}return null
},union:function(e){if(this.intersectsRange(e,true)){var al=this.cloneRange();
if(b.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1){al.setStart(e.startContainer,e.startOffset)
}if(b.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1){al.setEnd(e.endContainer,e.endOffset)
}return al
}else{throw new O("Ranges do not intersect")
}},containsNode:function(al,e){if(e){return this.intersectsNode(al,false)
}else{return this.compareNode(al)==k
}},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,b.getNodeLength(e))<=0
},containsRange:function(e){return this.intersection(e).equals(e)
},containsNodeText:function(an){var ao=this.cloneRange();
ao.selectNode(an);
var am=ao.getNodes([3]);
if(am.length>0){ao.setStart(am[0],0);
var e=am.pop();
ao.setEnd(e,e.length);
var al=this.containsRange(ao);
ao.detach();
return al
}else{return this.containsNodeContents(an)
}},createNodeIterator:function(e,al){h(this);
return new w(this,e,al)
},getNodes:function(e,al){h(this);
return p(this,e,al)
},getDocument:function(){return m(this)
},collapseBefore:function(e){C(this);
this.setEndBefore(e);
this.collapse(false)
},collapseAfter:function(e){C(this);
this.setStartAfter(e);
this.collapse(true)
},getName:function(){return"DomRange"
},equals:function(e){return aj.rangesEqual(this,e)
},inspect:function(){return z(this)
}};
function S(e){e.START_TO_START=l;
e.START_TO_END=y;
e.END_TO_END=af;
e.END_TO_START=Z;
e.NODE_BEFORE=s;
e.NODE_AFTER=v;
e.NODE_BEFORE_AND_AFTER=J;
e.NODE_INSIDE=k
}function G(e){S(e);
S(e.prototype)
}function q(e,al){return function(){h(this);
var ar=this.startContainer,aq=this.startOffset,am=this.commonAncestorContainer;
var ao=new g(this,true);
var ap,at;
if(ar!==am){ap=b.getClosestAncestorIn(ar,am,true);
at=W(ap);
ar=at.node;
aq=at.offset
}V(ao,aa);
ao.reset();
var an=e(ao);
ao.detach();
al(this,ar,aq,ar,aq);
return an
}
}function X(an,aq,e){function ap(at,ar){return function(au){C(this);
U(au,ae);
U(t(au),ac);
var av=(at?A:W)(au);
(ar?am:ao)(this,av.node,av.offset)
}
}function am(at,av,aw){var au=at.endContainer,ar=at.endOffset;
if(av!==at.startContainer||aw!==at.startOffset){if(t(av)!=t(au)||b.comparePoints(av,aw,au,ar)==1){au=av;
ar=aw
}aq(at,av,aw,au,ar)
}}function ao(ar,at,aw){var av=ar.startContainer,au=ar.startOffset;
if(at!==ar.endContainer||aw!==ar.endOffset){if(t(at)!=t(av)||b.comparePoints(at,aw,av,au)==-1){av=at;
au=aw
}aq(ar,av,au,at,aw)
}}function al(ar,at,au){if(at!==ar.startContainer||au!==ar.startOffset||at!==ar.endContainer||au!==ar.endOffset){aq(ar,at,au,at,au)
}}an.prototype=new ab();
i.util.extend(an.prototype,{setStart:function(ar,at){C(this);
r(ar,true);
ad(ar,at);
am(this,ar,at)
},setEnd:function(ar,at){C(this);
r(ar,true);
ad(ar,at);
ao(this,ar,at)
},setStartBefore:ap(true,true),setStartAfter:ap(false,true),setEndBefore:ap(true,false),setEndAfter:ap(false,false),collapse:function(ar){h(this);
if(ar){aq(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset)
}else{aq(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)
}},selectNodeContents:function(ar){C(this);
r(ar,true);
aq(this,ar,0,ar,b.getNodeLength(ar))
},selectNode:function(at){C(this);
r(at,false);
U(at,ae);
var au=A(at),ar=W(at);
aq(this,au.node,au.offset,ar.node,ar.offset)
},extractContents:q(Q,aq),deleteContents:q(n,aq),canSurroundContents:function(){h(this);
aa(this.startContainer);
aa(this.endContainer);
var ar=new g(this,true);
var at=(ar._first&&(x(ar._first,this))||(ar._last&&x(ar._last,this)));
ar.detach();
return !at
},detach:function(){e(this)
},splitBoundaries:function(){h(this);
var aw=this.startContainer,av=this.startOffset,at=this.endContainer,ar=this.endOffset;
var au=(aw===at);
if(b.isCharacterDataNode(at)&&ar>0&&ar<at.length){b.splitDataNode(at,ar)
}if(b.isCharacterDataNode(aw)&&av>0&&av<aw.length){aw=b.splitDataNode(aw,av);
if(au){ar-=av;
at=aw
}else{if(at==aw.parentNode&&ar>=b.getNodeIndex(aw)){ar++
}}av=0
}aq(this,aw,av,at,ar)
},normalizeBoundaries:function(){h(this);
var az=this.startContainer,au=this.startOffset,ay=this.endContainer,ar=this.endOffset;
var av=function(aC){var aB=aC.nextSibling;
if(aB&&aB.nodeType==aC.nodeType){ay=aC;
ar=aC.length;
aC.appendData(aB.data);
aB.parentNode.removeChild(aB)
}};
var aA=function(aD){var aC=aD.previousSibling;
if(aC&&aC.nodeType==aD.nodeType){az=aD;
var aB=aD.length;
au=aC.length;
aD.insertData(0,aC.data);
aC.parentNode.removeChild(aC);
if(az==ay){ar+=au;
ay=az
}else{if(ay==aD.parentNode){var aE=b.getNodeIndex(aD);
if(ar==aE){ay=aD;
ar=aB
}else{if(ar>aE){ar--
}}}}}};
var ax=true;
if(b.isCharacterDataNode(ay)){if(ay.length==ar){av(ay)
}}else{if(ar>0){var aw=ay.childNodes[ar-1];
if(aw&&b.isCharacterDataNode(aw)){av(aw)
}}ax=!this.collapsed
}if(ax){if(b.isCharacterDataNode(az)){if(au==0){aA(az)
}}else{if(au<az.childNodes.length){var at=az.childNodes[au];
if(at&&b.isCharacterDataNode(at)){aA(at)
}}}}else{az=ay;
au=ar
}aq(this,az,au,ay,ar)
},collapseToPoint:function(ar,at){C(this);
r(ar,true);
ad(ar,at);
al(this,ar,at)
}});
G(an)
}function N(e){e.collapsed=(e.startContainer===e.endContainer&&e.startOffset===e.endOffset);
e.commonAncestorContainer=e.collapsed?e.startContainer:b.getCommonAncestor(e.startContainer,e.endContainer)
}function D(am,ao,al,ap,an){var e=(am.startContainer!==ao||am.startOffset!==al);
var aq=(am.endContainer!==ap||am.endOffset!==an);
am.startContainer=ao;
am.startOffset=al;
am.endContainer=ap;
am.endOffset=an;
N(am);
u(am,"boundarychange",{startMoved:e,endMoved:aq})
}function ai(e){C(e);
e.startContainer=e.startOffset=e.endContainer=e.endOffset=null;
e.collapsed=e.commonAncestorContainer=null;
u(e,"detach",null);
e._listeners=null
}function aj(e){this.startContainer=e;
this.startOffset=0;
this.endContainer=e;
this.endOffset=0;
this._listeners={boundarychange:[],detach:[]};
N(this)
}X(aj,D,ai);
i.rangePrototype=ab.prototype;
aj.rangeProperties=L;
aj.RangeIterator=g;
aj.copyComparisonConstants=G;
aj.createPrototypeRange=X;
aj.inspect=z;
aj.getRangeDocument=m;
aj.rangesEqual=function(al,e){return al.startContainer===e.startContainer&&al.startOffset===e.startOffset&&al.endContainer===e.endContainer&&al.endOffset===e.endOffset
};
i.DomRange=aj;
i.RangeException=O
});
rangy.createModule("WrappedRange",function(i,d){i.requireModules(["DomUtil","DomRange"]);
var a;
var h=i.dom;
var b=h.DomPosition;
var j=i.DomRange;
function e(q){var o=q.parentElement();
var m=q.duplicate();
m.collapse(true);
var p=m.parentElement();
m=q.duplicate();
m.collapse(false);
var n=m.parentElement();
var l=(p==n)?p:h.getCommonAncestor(p,n);
return l==o?l:h.getCommonAncestor(o,l)
}function c(l){return l.compareEndPoints("StartToEnd",l)==0
}function f(z,w,n,s){var A=z.duplicate();
A.collapse(n);
var y=A.parentElement();
if(!h.isAncestorOf(w,y,true)){y=w
}if(!y.canHaveHTML){return new b(y.parentNode,h.getNodeIndex(y))
}var m=h.getDocument(y).createElement("span");
var x,u=n?"StartToStart":"StartToEnd";
var v,q,l,o;
do{y.insertBefore(m,m.previousSibling);
A.moveToElementText(m)
}while((x=A.compareEndPoints(u,z))>0&&m.previousSibling);
o=m.nextSibling;
if(x==-1&&o&&h.isCharacterDataNode(o)){A.setEndPoint(n?"EndToStart":"EndToEnd",z);
var r;
if(/[\r\n]/.test(o.data)){var t=A.duplicate();
var p=t.text.replace(/\r\n/g,"\r").length;
r=t.moveStart("character",p);
while((x=t.compareEndPoints("StartToEnd",t))==-1){r++;
t.moveStart("character",1)
}}else{r=A.text.length
}l=new b(o,r)
}else{v=(s||!n)&&m.previousSibling;
q=(s||n)&&m.nextSibling;
if(q&&h.isCharacterDataNode(q)){l=new b(q,0)
}else{if(v&&h.isCharacterDataNode(v)){l=new b(v,v.length)
}else{l=new b(y,h.getNodeIndex(m))
}}}m.parentNode.removeChild(m);
return l
}function k(l,n){var o,r,p=l.offset;
var s=h.getDocument(l.node);
var m,t,u=s.body.createTextRange();
var q=h.isCharacterDataNode(l.node);
if(q){o=l.node;
r=o.parentNode
}else{t=l.node.childNodes;
o=(p<t.length)?t[p]:null;
r=l.node
}m=s.createElement("span");
m.innerHTML="&#feff;";
if(o){r.insertBefore(m,o)
}else{r.appendChild(m)
}u.moveToElementText(m);
u.collapse(!n);
r.removeChild(m);
if(q){u[n?"moveStart":"moveEnd"]("character",p)
}return u
}if(i.features.implementsDomRange&&(!i.features.implementsTextRange||!i.config.preferTextRange)){(function(){var n;
var s=j.rangeProperties;
var v;
function l(w){var x=s.length,y;
while(x--){y=s[x];
w[y]=w.nativeRange[y]
}}function o(y,A,x,B,z){var w=(y.startContainer!==A||y.startOffset!=x);
var C=(y.endContainer!==B||y.endOffset!=z);
if(w||C){y.setEnd(B,z);
y.setStart(A,x)
}}function t(w){w.nativeRange.detach();
w.detached=true;
var x=s.length,y;
while(x--){y=s[x];
w[y]=null
}}var m;
a=function(w){if(!w){throw new Error("Range must be specified")
}this.nativeRange=w;
l(this)
};
j.createPrototypeRange(a,o,t);
n=a.prototype;
n.selectNode=function(w){this.nativeRange.selectNode(w);
l(this)
};
n.deleteContents=function(){this.nativeRange.deleteContents();
l(this)
};
n.extractContents=function(){var w=this.nativeRange.extractContents();
l(this);
return w
};
n.cloneContents=function(){return this.nativeRange.cloneContents()
};
n.surroundContents=function(w){this.nativeRange.surroundContents(w);
l(this)
};
n.collapse=function(w){this.nativeRange.collapse(w);
l(this)
};
n.cloneRange=function(){return new a(this.nativeRange.cloneRange())
};
n.refresh=function(){l(this)
};
n.toString=function(){return this.nativeRange.toString()
};
var r=document.createTextNode("test");
h.getBody(document).appendChild(r);
var p=document.createRange();
p.setStart(r,0);
p.setEnd(r,0);
try{p.setStart(r,1);
v=true;
n.setStart=function(w,x){this.nativeRange.setStart(w,x);
l(this)
};
n.setEnd=function(w,x){this.nativeRange.setEnd(w,x);
l(this)
};
m=function(w){return function(x){this.nativeRange[w](x);
l(this)
}
}
}catch(q){v=false;
n.setStart=function(x,y){try{this.nativeRange.setStart(x,y)
}catch(w){this.nativeRange.setEnd(x,y);
this.nativeRange.setStart(x,y)
}l(this)
};
n.setEnd=function(x,y){try{this.nativeRange.setEnd(x,y)
}catch(w){this.nativeRange.setStart(x,y);
this.nativeRange.setEnd(x,y)
}l(this)
};
m=function(w,x){return function(z){try{this.nativeRange[w](z)
}catch(y){this.nativeRange[x](z);
this.nativeRange[w](z)
}l(this)
}
}
}n.setStartBefore=m("setStartBefore","setEndBefore");
n.setStartAfter=m("setStartAfter","setEndAfter");
n.setEndBefore=m("setEndBefore","setStartBefore");
n.setEndAfter=m("setEndAfter","setStartAfter");
p.selectNodeContents(r);
if(p.startContainer==r&&p.endContainer==r&&p.startOffset==0&&p.endOffset==r.length){n.selectNodeContents=function(w){this.nativeRange.selectNodeContents(w);
l(this)
}
}else{n.selectNodeContents=function(w){this.setStart(w,0);
this.setEnd(w,j.getEndOffset(w))
}
}p.selectNodeContents(r);
p.setEnd(r,3);
var u=document.createRange();
u.selectNodeContents(r);
u.setEnd(r,4);
u.setStart(r,2);
if(p.compareBoundaryPoints(p.START_TO_END,u)==-1&p.compareBoundaryPoints(p.END_TO_START,u)==1){n.compareBoundaryPoints=function(x,w){w=w.nativeRange||w;
if(x==w.START_TO_END){x=w.END_TO_START
}else{if(x==w.END_TO_START){x=w.START_TO_END
}}return this.nativeRange.compareBoundaryPoints(x,w)
}
}else{n.compareBoundaryPoints=function(x,w){return this.nativeRange.compareBoundaryPoints(x,w.nativeRange||w)
}
}if(i.util.isHostMethod(p,"createContextualFragment")){n.createContextualFragment=function(w){return this.nativeRange.createContextualFragment(w)
}
}h.getBody(document).removeChild(r);
p.detach();
u.detach()
})();
i.createNativeRange=function(l){l=l||document;
return l.createRange()
}
}else{if(i.features.implementsTextRange){a=function(l){this.textRange=l;
this.refresh()
};
a.prototype=new j(document);
a.prototype.refresh=function(){var n,l;
var m=e(this.textRange);
if(c(this.textRange)){l=n=f(this.textRange,m,true,true)
}else{n=f(this.textRange,m,true,false);
l=f(this.textRange,m,false,false)
}this.setStart(n.node,n.offset);
this.setEnd(l.node,l.offset)
};
j.copyComparisonConstants(a);
var g=(function(){return this
})();
if(typeof g.Range=="undefined"){g.Range=a
}i.createNativeRange=function(l){l=l||document;
return l.body.createTextRange()
}
}}if(i.features.implementsTextRange){a.rangeToTextRange=function(l){if(l.collapsed){var o=k(new b(l.startContainer,l.startOffset),true);
return o
}else{var p=k(new b(l.startContainer,l.startOffset),true);
var n=k(new b(l.endContainer,l.endOffset),false);
var m=h.getDocument(l.startContainer).body.createTextRange();
m.setEndPoint("StartToStart",p);
m.setEndPoint("EndToEnd",n);
return m
}}
}a.prototype.getName=function(){return"WrappedRange"
};
i.WrappedRange=a;
i.createRange=function(l){l=l||document;
return new a(i.createNativeRange(l))
};
i.createRangyRange=function(l){l=l||document;
return new j(l)
};
i.createIframeRange=function(l){return i.createRange(h.getIframeDocument(l))
};
i.createIframeRangyRange=function(l){return i.createRangyRange(h.getIframeDocument(l))
};
i.addCreateMissingNativeApiListener(function(m){var l=m.document;
if(typeof l.createRange=="undefined"){l.createRange=function(){return i.createRange(this)
}
}l=m=null
})
});
rangy.createModule("WrappedSelection",function(g,d){g.requireModules(["DomUtil","DomRange","WrappedRange"]);
g.config.checkSelectionRanges=true;
var D="boolean",T="_rangySelection",c=g.dom,l=g.util,Q=g.DomRange,e=g.WrappedRange,N=g.DOMException,y=c.DomPosition,w,n,U="Control";
function m(W){return(W||window).getSelection()
}function q(W){return(W||window).document.selection
}var S=g.util.isHostMethod(window,"getSelection"),M=g.util.isHostObject(document,"selection");
var u=M&&(!S||g.config.preferTextRange);
if(u){w=q;
g.isSelectionValid=function(X){var Y=(X||window).document,W=Y.selection;
return(W.type!="None"||c.getDocument(W.createRange().parentElement())==Y)
}
}else{if(S){w=m;
g.isSelectionValid=function(){return true
}
}else{d.fail("Neither document.selection or window.getSelection() detected.")
}}g.getNativeSelection=w;
var L=w();
var B=g.createNativeRange(document);
var C=c.getBody(document);
var J=l.areHostObjects(L,["anchorNode","focusNode"]&&l.areHostProperties(L,["anchorOffset","focusOffset"]));
g.features.selectionHasAnchorAndFocus=J;
var p=l.isHostMethod(L,"extend");
g.features.selectionHasExtend=p;
var V=(typeof L.rangeCount=="number");
g.features.selectionHasRangeCount=V;
var P=false;
var O=true;
if(l.areHostMethods(L,["addRange","getRangeAt","removeAllRanges"])&&typeof L.rangeCount=="number"&&g.features.implementsDomRange){(function(){var Y=document.createElement("iframe");
C.appendChild(Y);
var ac=c.getIframeDocument(Y);
ac.open();
ac.write("<html><head></head><body>12</body></html>");
ac.close();
var aa=c.getIframeWindow(Y).getSelection();
var ad=ac.documentElement;
var Z=ad.lastChild,ab=Z.firstChild;
var X=ac.createRange();
X.setStart(ab,1);
X.collapse(true);
aa.addRange(X);
O=(aa.rangeCount==1);
aa.removeAllRanges();
var W=X.cloneRange();
X.setStart(ab,0);
W.setEnd(ab,2);
aa.addRange(X);
aa.addRange(W);
P=(aa.rangeCount==2);
X.detach();
W.detach();
C.removeChild(Y)
})()
}g.features.selectionSupportsMultipleRanges=P;
g.features.collapsedNonEditableSelectionsSupported=O;
var f=false,j;
if(C&&l.isHostMethod(C,"createControlRange")){j=C.createControlRange();
if(l.areHostProperties(j,["item","add"])){f=true
}}g.features.implementsControlRange=f;
if(J){n=function(W){return W.anchorNode===W.focusNode&&W.anchorOffset===W.focusOffset
}
}else{n=function(W){return W.rangeCount?W.getRangeAt(W.rangeCount-1).collapsed:false
}
}function b(Z,X,W){var Y=W?"end":"start",aa=W?"start":"end";
Z.anchorNode=X[Y+"Container"];
Z.anchorOffset=X[Y+"Offset"];
Z.focusNode=X[aa+"Container"];
Z.focusOffset=X[aa+"Offset"]
}function v(X){var W=X.nativeSelection;
X.anchorNode=W.anchorNode;
X.anchorOffset=W.anchorOffset;
X.focusNode=W.focusNode;
X.focusOffset=W.focusOffset
}function G(W){W.anchorNode=W.focusNode=null;
W.anchorOffset=W.focusOffset=0;
W.rangeCount=0;
W.isCollapsed=true;
W._ranges.length=0
}function I(W){var X;
if(W instanceof Q){X=W._selectionNativeRange;
if(!X){X=g.createNativeRange(c.getDocument(W.startContainer));
X.setEnd(W.endContainer,W.endOffset);
X.setStart(W.startContainer,W.startOffset);
W._selectionNativeRange=X;
W.attachListener("detach",function(){this._selectionNativeRange=null
})
}}else{if(W instanceof e){X=W.nativeRange
}else{if(g.features.implementsDomRange&&(W instanceof c.getWindow(W.startContainer).Range)){X=W
}}}return X
}function k(Y){if(!Y.length||Y[0].nodeType!=1){return false
}for(var X=1,W=Y.length;
X<W;
++X){if(!c.isAncestorOf(Y[0],Y[X])){return false
}}return true
}function K(X){var W=X.getNodes();
if(!k(W)){throw new Error("getSingleElementFromRange: range "+X.inspect()+" did not consist of a single element")
}return W[0]
}function F(W){return !!W&&typeof W.text!="undefined"
}function H(Y,X){var W=new e(X);
Y._ranges=[W];
b(Y,W,false);
Y.rangeCount=1;
Y.isCollapsed=W.collapsed
}function t(Z){Z._ranges.length=0;
if(Z.docSelection.type=="None"){G(Z)
}else{var Y=Z.docSelection.createRange();
if(F(Y)){H(Z,Y)
}else{Z.rangeCount=Y.length;
var W,aa=c.getDocument(Y.item(0));
for(var X=0;
X<Z.rangeCount;
++X){W=g.createRange(aa);
W.selectNode(Y.item(X));
Z._ranges.push(W)
}Z.isCollapsed=Z.rangeCount==1&&Z._ranges[0].collapsed;
b(Z,Z._ranges[Z.rangeCount-1],false)
}}}function x(X,aa){var Y=X.docSelection.createRange();
var W=K(aa);
var ae=c.getDocument(Y.item(0));
var ab=c.getBody(ae).createControlRange();
for(var Z=0,ac=Y.length;
Z<ac;
++Z){ab.add(Y.item(Z))
}try{ab.add(W)
}catch(ad){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")
}ab.select();
t(X)
}var o;
if(l.isHostMethod(L,"getRangeAt")){o=function(Y,W){try{return Y.getRangeAt(W)
}catch(X){return null
}}
}else{if(J){o=function(X){var Y=c.getDocument(X.anchorNode);
var W=g.createRange(Y);
W.setStart(X.anchorNode,X.anchorOffset);
W.setEnd(X.focusNode,X.focusOffset);
if(W.collapsed!==this.isCollapsed){W.setStart(X.focusNode,X.focusOffset);
W.setEnd(X.anchorNode,X.anchorOffset)
}return W
}
}}function A(W,Y,X){this.nativeSelection=W;
this.docSelection=Y;
this._ranges=[];
this.win=X;
this.refresh()
}g.getSelection=function(Y){Y=Y||window;
var X=Y[T];
var W=w(Y),Z=M?q(Y):null;
if(X){X.nativeSelection=W;
X.docSelection=Z;
X.refresh(Y)
}else{X=new A(W,Z,Y);
Y[T]=X
}return X
};
g.getIframeSelection=function(W){return g.getSelection(c.getIframeWindow(W))
};
var a=A.prototype;
function i(ab,W){var ac=c.getDocument(W[0].startContainer);
var Z=c.getBody(ac).createControlRange();
for(var Y=0,aa;
Y<rangeCount;
++Y){aa=K(W[Y]);
try{Z.add(aa)
}catch(X){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")
}}Z.select();
t(ab)
}if(!u&&J&&l.areHostMethods(L,["removeAllRanges","addRange"])){a.removeAllRanges=function(){this.nativeSelection.removeAllRanges();
G(this)
};
var h=function(Y,W){var Z=Q.getRangeDocument(W);
var X=g.createRange(Z);
X.collapseToPoint(W.endContainer,W.endOffset);
Y.nativeSelection.addRange(I(X));
Y.nativeSelection.extend(W.startContainer,W.startOffset);
Y.refresh()
};
if(V){a.addRange=function(X,W){if(f&&M&&this.docSelection.type==U){x(this,X)
}else{if(W&&p){h(this,X)
}else{var Y;
if(P){Y=this.rangeCount
}else{this.removeAllRanges();
Y=0
}this.nativeSelection.addRange(I(X));
this.rangeCount=this.nativeSelection.rangeCount;
if(this.rangeCount==Y+1){if(g.config.checkSelectionRanges){var Z=o(this.nativeSelection,this.rangeCount-1);
if(Z&&!Q.rangesEqual(Z,X)){X=new e(Z)
}}this._ranges[this.rangeCount-1]=X;
b(this,X,r(this.nativeSelection));
this.isCollapsed=n(this)
}else{this.refresh()
}}}}
}else{a.addRange=function(X,W){if(W&&p){h(this,X)
}else{this.nativeSelection.addRange(I(X));
this.refresh()
}}
}a.setRanges=function(X){if(f&&X.length>1){i(this,X)
}else{this.removeAllRanges();
for(var Y=0,W=X.length;
Y<W;
++Y){this.addRange(X[Y])
}}}
}else{if(l.isHostMethod(L,"empty")&&l.isHostMethod(B,"select")&&f&&u){a.removeAllRanges=function(){try{this.docSelection.empty();
if(this.docSelection.type!="None"){var Z;
if(this.anchorNode){Z=c.getDocument(this.anchorNode)
}else{if(this.docSelection.type==U){var X=this.docSelection.createRange();
if(X.length){Z=c.getDocument(X.item(0)).body.createTextRange()
}}}if(Z){var Y=Z.body.createTextRange();
Y.select();
this.docSelection.empty()
}}}catch(W){}G(this)
};
a.addRange=function(W){if(this.docSelection.type==U){x(this,W)
}else{e.rangeToTextRange(W).select();
this._ranges[0]=W;
this.rangeCount=1;
this.isCollapsed=this._ranges[0].collapsed;
b(this,W,false)
}};
a.setRanges=function(W){this.removeAllRanges();
var X=W.length;
if(X>1){i(this,W)
}else{if(X){this.addRange(W[0])
}}}
}else{d.fail("No means of selecting a Range or TextRange was found");
return false
}}a.getRangeAt=function(W){if(W<0||W>=this.rangeCount){throw new N("INDEX_SIZE_ERR")
}else{return this._ranges[W]
}};
var E;
if(u){E=function(X){var W;
if(g.isSelectionValid(X.win)){W=X.docSelection.createRange()
}else{W=c.getBody(X.win.document).createTextRange();
W.collapse(true)
}if(X.docSelection.type==U){t(X)
}else{if(F(W)){H(X,W)
}else{G(X)
}}}
}else{if(l.isHostMethod(L,"getRangeAt")&&typeof L.rangeCount=="number"){E=function(Y){if(f&&M&&Y.docSelection.type==U){t(Y)
}else{Y._ranges.length=Y.rangeCount=Y.nativeSelection.rangeCount;
if(Y.rangeCount){for(var X=0,W=Y.rangeCount;
X<W;
++X){Y._ranges[X]=new g.WrappedRange(Y.nativeSelection.getRangeAt(X))
}b(Y,Y._ranges[Y.rangeCount-1],r(Y.nativeSelection));
Y.isCollapsed=n(Y)
}else{G(Y)
}}}
}else{if(J&&typeof L.isCollapsed==D&&typeof B.collapsed==D&&g.features.implementsDomRange){E=function(Y){var W,X=Y.nativeSelection;
if(X.anchorNode){W=o(X,0);
Y._ranges=[W];
Y.rangeCount=1;
v(Y);
Y.isCollapsed=n(Y)
}else{G(Y)
}}
}else{d.fail("No means of obtaining a Range or TextRange from the user's selection was found");
return false
}}}a.refresh=function(X){var W=X?this._ranges.slice(0):null;
E(this);
if(X){var Y=W.length;
if(Y!=this._ranges.length){return false
}while(Y--){if(!Q.rangesEqual(W[Y],this._ranges[Y])){return false
}}return true
}};
var z=function(aa,Y){var X=aa.getAllRanges(),ab=false;
aa.removeAllRanges();
for(var Z=0,W=X.length;
Z<W;
++Z){if(ab||Y!==X[Z]){aa.addRange(X[Z])
}else{ab=true
}}if(!aa.rangeCount){G(aa)
}};
if(f){a.removeRange=function(aa){if(this.docSelection.type==U){var Y=this.docSelection.createRange();
var W=K(aa);
var ae=c.getDocument(Y.item(0));
var ac=c.getBody(ae).createControlRange();
var X,ad=false;
for(var Z=0,ab=Y.length;
Z<ab;
++Z){X=Y.item(Z);
if(X!==W||ad){ac.add(Y.item(Z))
}else{ad=true
}}ac.select();
t(this)
}else{z(this,aa)
}}
}else{a.removeRange=function(W){z(this,W)
}
}var r;
if(!u&&J&&g.features.implementsDomRange){r=function(X){var W=false;
if(X.anchorNode){W=(c.comparePoints(X.anchorNode,X.anchorOffset,X.focusNode,X.focusOffset)==1)
}return W
};
a.isBackwards=function(){return r(this)
}
}else{r=a.isBackwards=function(){return false
}
}a.toString=function(){var Y=[];
for(var X=0,W=this.rangeCount;
X<W;
++X){Y[X]=""+this._ranges[X]
}return Y.join("")
};
function R(X,W){if(X.anchorNode&&(c.getDocument(X.anchorNode)!==c.getDocument(W))){throw new N("WRONG_DOCUMENT_ERR")
}}a.collapse=function(X,Y){R(this,X);
var W=g.createRange(c.getDocument(X));
W.collapseToPoint(X,Y);
this.removeAllRanges();
this.addRange(W);
this.isCollapsed=true
};
a.collapseToStart=function(){if(this.rangeCount){var W=this._ranges[0];
this.collapse(W.startContainer,W.startOffset)
}else{throw new N("INVALID_STATE_ERR")
}};
a.collapseToEnd=function(){if(this.rangeCount){var W=this._ranges[this.rangeCount-1];
this.collapse(W.endContainer,W.endOffset)
}else{throw new N("INVALID_STATE_ERR")
}};
a.selectAllChildren=function(X){R(this,X);
var W=g.createRange(c.getDocument(X));
W.selectNodeContents(X);
this.removeAllRanges();
this.addRange(W)
};
a.deleteFromDocument=function(){if(f&&M&&this.docSelection.type==U){var aa=this.docSelection.createRange();
var Z;
while(aa.length){Z=aa.item(0);
aa.remove(Z);
Z.parentNode.removeChild(Z)
}this.refresh()
}else{if(this.rangeCount){var X=this.getAllRanges();
this.removeAllRanges();
for(var Y=0,W=X.length;
Y<W;
++Y){X[Y].deleteContents()
}this.addRange(X[W-1])
}}};
a.getAllRanges=function(){return this._ranges.slice(0)
};
a.setSingleRange=function(W){this.setRanges([W])
};
a.containsNode=function(Z,X){for(var Y=0,W=this._ranges.length;
Y<W;
++Y){if(this._ranges[Y].containsNode(Z,X)){return true
}}return false
};
a.toHtml=function(){var Z="";
if(this.rangeCount){var X=Q.getRangeDocument(this._ranges[0]).createElement("div");
for(var Y=0,W=this._ranges.length;
Y<W;
++Y){X.appendChild(this._ranges[Y].cloneContents())
}Z=X.innerHTML
}return Z
};
function s(ac){var ab=[];
var Z=new y(ac.anchorNode,ac.anchorOffset);
var X=new y(ac.focusNode,ac.focusOffset);
var Y=(typeof ac.getName=="function")?ac.getName():"Selection";
if(typeof ac.rangeCount!="undefined"){for(var aa=0,W=ac.rangeCount;
aa<W;
++aa){ab[aa]=Q.inspect(ac.getRangeAt(aa))
}}return"["+Y+"(Ranges: "+ab.join(", ")+")(anchor: "+Z.inspect()+", focus: "+X.inspect()+"]"
}a.getName=function(){return"WrappedSelection"
};
a.inspect=function(){return s(this)
};
a.detach=function(){this.win[T]=null;
this.win=this.anchorNode=this.focusNode=null
};
A.inspect=s;
g.Selection=A;
g.selectionPrototype=a;
g.addCreateMissingNativeApiListener(function(W){if(typeof W.getSelection=="undefined"){W.getSelection=function(){return g.getSelection(this)
}
}W=null
})
});
var Base=function(){};
Base.extend=function(b,e){var f=Base.prototype.extend;
Base._prototyping=true;
var d=new this;
f.call(d,b);
d.base=function(){};
delete Base._prototyping;
var c=d.constructor;
var a=d.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==a){this._constructing=true;
c.apply(this,arguments);
delete this._constructing
}else{if(arguments[0]!=null){return(arguments[0].extend||f).call(arguments[0],d)
}}}};
a.ancestor=this;
a.extend=this.extend;
a.forEach=this.forEach;
a.implement=this.implement;
a.prototype=d;
a.toString=this.toString;
a.valueOf=function(g){return(g=="object")?a:c.valueOf()
};
f.call(a,e);
if(typeof a.init=="function"){a.init()
}return a
};
Base.prototype={extend:function(b,h){if(arguments.length>1){var e=this[b];
if(e&&(typeof h=="function")&&(!e.valueOf||e.valueOf()!=h.valueOf())&&/\bbase\b/.test(h)){var a=h.valueOf();
h=function(){var k=this.base||Base.prototype.base;
this.base=e;
var i=a.apply(this,arguments);
this.base=k;
return i
};
h.valueOf=function(i){return(i=="object")?h:a
};
h.toString=Base.toString
}this[b]=h
}else{if(b){var g=Base.prototype.extend;
if(!Base._prototyping&&typeof this!="function"){g=this.extend||g
}var d={toSource:null};
var f=["constructor","toString","valueOf"];
var c=Base._prototyping?0:1;
while(j=f[c++]){if(b[j]!=d[j]){g.call(this,j,b[j])
}}for(var j in b){if(!d[j]){g.call(this,j,b[j])
}}}}return this
}};
Base=Base.extend({constructor:function(){this.extend(arguments[0])
}},{ancestor:Object,version:"1.1",forEach:function(a,d,c){for(var b in a){if(this.prototype[b]===undefined){d.call(c,a[b],b,a)
}}},implement:function(){for(var a=0;
a<arguments.length;
a++){if(typeof arguments[a]=="function"){arguments[a](this.prototype)
}else{this.prototype.extend(arguments[a])
}}return this
},toString:function(){return String(this.valueOf())
}});
wysihtml5.browser=(function(){var i=navigator.userAgent,d=document.createElement("div"),e=i.indexOf("MSIE")!==-1&&i.indexOf("Opera")===-1,b=i.indexOf("Gecko")!==-1&&i.indexOf("KHTML")===-1,f=i.indexOf("AppleWebKit/")!==-1,a=i.indexOf("Chrome/")!==-1,c=i.indexOf("Opera/")!==-1;
function h(j){return +((/ipad|iphone|ipod/.test(j)&&j.match(/ os (\d+).+? like mac os x/))||[,0])[1]
}function g(j){return +(j.match(/android (\d+)/)||[,0])[1]
}return{USER_AGENT:i,supported:function(){var l=this.USER_AGENT.toLowerCase(),n="contentEditable" in d,j=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,k=document.querySelector&&document.querySelectorAll,m=(this.isIos()&&h(l)<5)||(this.isAndroid()&&g(l)<4)||l.indexOf("opera mobi")!==-1||l.indexOf("hpwos/")!==-1;
return n&&j&&k&&!m
},isTouchDevice:function(){return this.supportsEvent("touchmove")
},isIos:function(){var j=this.USER_AGENT.toLowerCase();
return j.indexOf("webkit")!==-1&&j.indexOf("mobile")!==-1
},isAndroid:function(){return this.USER_AGENT.indexOf("Android")!==-1
},supportsSandboxedIframes:function(){return e
},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return !("querySelector" in document)
},displaysCaretInEmptyContentEditableCorrectly:function(){return e
},hasCurrentStyleProperty:function(){return"currentStyle" in d
},hasHistoryIssue:function(){return b
},insertsLineBreaksOnReturn:function(){return b
},supportsPlaceholderAttributeOn:function(j){return"placeholder" in j
},supportsEvent:function(j){return"on"+j in d||(function(){d.setAttribute("on"+j,"return;");
return typeof(d["on"+j])==="function"
})()
},supportsEventsInIframeCorrectly:function(){return !c
},supportsHTML5Tags:function(l){var k=l.createElement("div"),j="<article>foo</article>";
k.innerHTML=j;
return k.innerHTML.toLowerCase()===j
},supportsCommand:(function(){var k={formatBlock:e,insertUnorderedList:e||f,insertOrderedList:e||f};
var j={insertHTML:b};
return function(m,o){var p=k[o];
if(!p){try{return m.queryCommandSupported(o)
}catch(n){}try{return m.queryCommandEnabled(o)
}catch(l){return !!j[o]
}}return false
}
})(),doesAutoLinkingInContentEditable:function(){return e
},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")
},clearsContentEditableCorrectly:function(){return b||c||f
},supportsGetAttributeCorrectly:function(){var j=document.createElement("td");
return j.getAttribute("rowspan")!="1"
},canSelectImagesInContentEditable:function(){return b||e||c
},autoScrollsToCaret:function(){return !f
},autoClosesUnclosedTags:function(){var l=d.cloneNode(false),j,k;
l.innerHTML="<p><div></div>";
k=l.innerHTML.toLowerCase();
j=k==="<p></p><div></div>"||k==="<p><div></div></p>";
this.autoClosesUnclosedTags=function(){return j
};
return j
},supportsNativeGetElementsByClassName:function(){return String(document.getElementsByClassName).indexOf("[native code]")!==-1
},supportsSelectionModify:function(){return"getSelection" in window&&"modify" in window.getSelection()
},needsSpaceAfterLineBreak:function(){return c
},supportsSpeechApiOn:function(j){var k=i.match(/Chrome\/(\d+)/)||[,0];
return k[1]>=11&&("onwebkitspeechchange" in j||"speech" in j)
},crashesWhenDefineProperty:function(j){return e&&(j==="XMLHttpRequest"||j==="XDomainRequest")
},doesAsyncFocus:function(){return e
},hasProblemsSettingCaretAfterImg:function(){return e
},hasUndoInContextMenu:function(){return b||a||c
},hasInsertNodeIssue:function(){return c
},hasIframeFocusIssue:function(){return e
}}
})();
wysihtml5.lang.array=function(a){return{contains:function(d){if(a.indexOf){return a.indexOf(d)!==-1
}else{for(var b=0,c=a.length;
b<c;
b++){if(a[b]===d){return true
}}return false
}},without:function(b){b=wysihtml5.lang.array(b);
var d=[],c=0,e=a.length;
for(;
c<e;
c++){if(!b.contains(a[c])){d.push(a[c])
}}return d
},get:function(){var c=0,d=a.length,b=[];
for(;
c<d;
c++){b.push(a[c])
}return b
}}
};
wysihtml5.lang.Dispatcher=Base.extend({on:function(a,b){this.events=this.events||{};
this.events[a]=this.events[a]||[];
this.events[a].push(b);
return this
},off:function(b,d){this.events=this.events||{};
var c=0,a,e;
if(b){a=this.events[b]||[],e=[];
for(;
c<a.length;
c++){if(a[c]!==d&&d){e.push(a[c])
}}this.events[b]=e
}else{this.events={}
}return this
},fire:function(b,d){this.events=this.events||{};
var a=this.events[b]||[],c=0;
for(;
c<a.length;
c++){a[c].call(this,d)
}return this
},observe:function(){return this.on.apply(this,arguments)
},stopObserving:function(){return this.off.apply(this,arguments)
}});
wysihtml5.lang.object=function(a){return{merge:function(b){for(var c in b){a[c]=b[c]
}return this
},get:function(){return a
},clone:function(){var b={},c;
for(c in a){b[c]=a[c]
}return b
},isArray:function(){return Object.prototype.toString.call(a)==="[object Array]"
}}
};
(function(){var b=/^\s+/,a=/\s+$/;
wysihtml5.lang.string=function(c){c=String(c);
return{trim:function(){return c.replace(b,"").replace(a,"")
},interpolate:function(e){for(var d in e){c=this.replace("#{"+d+"}").by(e[d])
}return c
},replace:function(d){return{by:function(e){return c.split(d).join(e)
}}
}}
}
})();
(function(l){var j=l.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),k=/((https?:\/\/|www\.)[^\s<]{3,})/gi,e=/([^\w\/\-](,?))$/i,c=100,f={")":"(","]":"[","}":"{"};
function b(m){if(i(m)){return m
}if(m===m.ownerDocument.documentElement){m=m.ownerDocument.body
}return a(m)
}function g(m){return m.replace(k,function(p,o){var r=(o.match(e)||[])[1]||"",n=f[r];
o=o.replace(e,"");
if(o.split(n).length>o.split(r).length){o=o+r;
r=""
}var q=o,s=o;
if(o.length>c){s=s.substr(0,c)+"..."
}if(q.substr(0,4)==="www."){q="http://"+q
}return'<a href="'+q+'">'+s+"</a>"+r
})
}function d(n){var m=n._wysihtml5_tempElement;
if(!m){m=n._wysihtml5_tempElement=n.createElement("div")
}return m
}function h(o){var n=o.parentNode,m=d(n.ownerDocument);
m.innerHTML="<span></span>"+g(o.data);
m.removeChild(m.firstChild);
while(m.firstChild){n.insertBefore(m.firstChild,o)
}n.removeChild(o)
}function i(m){var n;
while(m.parentNode){m=m.parentNode;
n=m.nodeName;
if(j.contains(n)){return true
}else{if(n==="body"){return false
}}}return false
}function a(n){if(j.contains(n.nodeName)){return
}if(n.nodeType===l.TEXT_NODE&&n.data.match(k)){h(n);
return
}var p=l.lang.array(n.childNodes).get(),o=p.length,m=0;
for(;
m<o;
m++){a(p[m])
}return n
}l.dom.autoLink=b;
l.dom.autoLink.URL_REG_EXP=k
})(wysihtml5);
(function(b){var a=b.dom;
a.addClass=function(c,d){var e=c.classList;
if(e){return e.add(d)
}if(a.hasClass(c,d)){return
}c.className+=" "+d
};
a.removeClass=function(c,d){var e=c.classList;
if(e){return e.remove(d)
}c.className=c.className.replace(new RegExp("(^|\\s+)"+d+"(\\s+|$)")," ")
};
a.hasClass=function(c,d){var f=c.classList;
if(f){return f.contains(d)
}var e=c.className;
return(e.length>0&&(e==d||new RegExp("(^|\\s)"+d+"(\\s|$)").test(e)))
}
})(wysihtml5);
wysihtml5.dom.contains=(function(){var a=document.documentElement;
if(a.contains){return function(b,c){if(c.nodeType!==wysihtml5.ELEMENT_NODE){c=c.parentNode
}return b!==c&&b.contains(c)
}
}else{if(a.compareDocumentPosition){return function(b,c){return !!(b.compareDocumentPosition(c)&16)
}
}}})();
wysihtml5.dom.convertToList=(function(){function b(f,e){var d=f.createElement("li");
e.appendChild(d);
return d
}function c(e,d){return e.createElement(d)
}function a(f,n){if(f.nodeName==="UL"||f.nodeName==="OL"||f.nodeName==="MENU"){return f
}var p=f.ownerDocument,k=c(p,n),l=f.querySelectorAll("br"),j=l.length,r,q,d,m,h,s,g,o,e;
for(e=0;
e<j;
e++){m=l[e];
while((h=m.parentNode)&&h!==f&&h.lastChild===m){if(wysihtml5.dom.getStyle("display").from(h)==="block"){h.removeChild(m);
break
}wysihtml5.dom.insert(m).after(m.parentNode)
}}r=wysihtml5.lang.array(f.childNodes).get();
q=r.length;
for(e=0;
e<q;
e++){o=o||b(p,k);
d=r[e];
s=wysihtml5.dom.getStyle("display").from(d)==="block";
g=d.nodeName==="BR";
if(s){o=o.firstChild?b(p,k):o;
o.appendChild(d);
o=null;
continue
}if(g){o=o.firstChild?null:o;
continue
}o.appendChild(d)
}if(r.length===0){b(p,k)
}f.parentNode.replaceChild(k,f);
return k
}return a
})();
wysihtml5.dom.copyAttributes=function(a){return{from:function(b){return{to:function(c){var f,d=0,e=a.length;
for(;
d<e;
d++){f=a[d];
if(typeof(b[f])!=="undefined"&&b[f]!==""){c[f]=b[f]
}}return{andTo:arguments.callee}
}}
}}
};
(function(b){var d=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"];
var c=function(e){if(a(e)){return parseInt(b.getStyle("width").from(e),10)<e.offsetWidth
}return false
};
var a=function(f){var e=0,g=d.length;
for(;
e<g;
e++){if(b.getStyle(d[e]).from(f)==="border-box"){return d[e]
}}};
b.copyStyles=function(e){return{from:function(g){if(c(g)){e=wysihtml5.lang.array(e).without(d)
}var h="",j=e.length,f=0,k;
for(;
f<j;
f++){k=e[f];
h+=k+":"+b.getStyle(k).from(g)+";"
}return{to:function(i){b.setStyles(h).on(i);
return{andTo:arguments.callee}
}}
}}
}
})(wysihtml5.dom);
(function(a){a.dom.delegate=function(c,b,d,e){return a.dom.observe(c,d,function(g){var h=g.target,f=a.lang.array(c.querySelectorAll(b));
while(h&&h!==c){if(f.contains(h)){e.call(h,g);
break
}h=h.parentNode
}})
}
})(wysihtml5);
wysihtml5.dom.getAsDom=(function(){var a=function(g,f){var d=f.createElement("div");
d.style.display="none";
f.body.appendChild(d);
try{d.innerHTML=g
}catch(h){}f.body.removeChild(d);
return d
};
var c=function(e){if(e._wysihtml5_supportsHTML5Tags){return
}for(var d=0,f=b.length;
d<f;
d++){e.createElement(b[d])
}e._wysihtml5_supportsHTML5Tags=true
};
var b=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];
return function(f,e){e=e||document;
var d;
if(typeof(f)==="object"&&f.nodeType){d=e.createElement("div");
d.appendChild(f)
}else{if(wysihtml5.browser.supportsHTML5Tags(e)){d=e.createElement("div");
d.innerHTML=f
}else{c(e);
d=a(f,e)
}}return d
}
})();
wysihtml5.dom.getParentElement=(function(){function a(g,f){if(!f||!f.length){return true
}if(typeof(f)==="string"){return g===f
}else{return wysihtml5.lang.array(f).contains(g)
}}function c(f){return f.nodeType===wysihtml5.ELEMENT_NODE
}function b(f,g,h){var i=(f.className||"").match(h)||[];
if(!g){return !!i.length
}return i[i.length-1]===g
}function e(f,h,g){while(g--&&f&&f.nodeName!=="BODY"){if(a(f.nodeName,h)){return f
}f=f.parentNode
}return null
}function d(g,j,f,i,h){while(h--&&g&&g.nodeName!=="BODY"){if(c(g)&&a(g.nodeName,j)&&b(g,f,i)){return g
}g=g.parentNode
}return null
}return function(g,f,h){h=h||50;
if(f.className||f.classRegExp){return d(g,f.nodeName,f.className,f.classRegExp,h)
}else{return e(g,f.nodeName,h)
}}
})();
wysihtml5.dom.getStyle=(function(){var b={"float":("styleFloat" in document.createElement("div").style)?"styleFloat":"cssFloat"},c=/\-[a-z]/g;
function a(d){return d.replace(c,function(e){return e.charAt(1).toUpperCase()
})
}return function(d){return{from:function(j){if(j.nodeType!==wysihtml5.ELEMENT_NODE){return
}var o=j.ownerDocument,k=b[d]||a(d),g=j.style,h=j.currentStyle,p=g[k];
if(p){return p
}if(h){try{return h[k]
}catch(m){}}var l=o.defaultView||o.parentWindow,n=(d==="height"||d==="width")&&j.nodeName==="TEXTAREA",i,f;
if(l.getComputedStyle){if(n){i=g.overflow;
g.overflow="hidden"
}f=l.getComputedStyle(j,null).getPropertyValue(d);
if(n){g.overflow=i||""
}return f
}}}
}
})();
wysihtml5.dom.hasElementWithTagName=(function(){var c={},b=1;
function a(d){return d._wysihtml5_identifier||(d._wysihtml5_identifier=b++)
}return function(f,e){var d=a(f)+":"+e,g=c[d];
if(!g){g=c[d]=f.getElementsByTagName(e)
}return g.length>0
}
})();
(function(d){var c={},b=1;
function a(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=b++)
}d.dom.hasElementWithClassName=function(g,f){if(!d.browser.supportsNativeGetElementsByClassName()){return !!g.querySelector("."+f)
}var e=a(g)+":"+f,h=c[e];
if(!h){h=c[e]=g.getElementsByClassName(f)
}return h.length>0
}
})(wysihtml5);
wysihtml5.dom.insert=function(a){return{after:function(b){b.parentNode.insertBefore(a,b.nextSibling)
},before:function(b){b.parentNode.insertBefore(a,b)
},into:function(b){b.appendChild(a)
}}
};
wysihtml5.dom.insertCSS=function(a){a=a.join("\n");
return{into:function(e){var b=e.createElement("style");
b.type="text/css";
if(b.styleSheet){b.styleSheet.cssText=a
}else{b.appendChild(e.createTextNode(a))
}var d=e.querySelector("head link");
if(d){d.parentNode.insertBefore(b,d);
return
}else{var c=e.querySelector("head");
if(c){c.appendChild(b)
}}}}
};
wysihtml5.dom.observe=function(c,g,d){g=typeof(g)==="string"?[g]:g;
var f,a,b=0,e=g.length;
for(;
b<e;
b++){a=g[b];
if(c.addEventListener){c.addEventListener(a,d,false)
}else{f=function(h){if(!("target" in h)){h.target=h.srcElement
}h.preventDefault=h.preventDefault||function(){this.returnValue=false
};
h.stopPropagation=h.stopPropagation||function(){this.cancelBubble=true
};
d.call(c,h)
};
c.attachEvent("on"+a,f)
}}return{stop:function(){var h,j=0,k=g.length;
for(;
j<k;
j++){h=g[j];
if(c.removeEventListener){c.removeEventListener(h,d,false)
}else{c.detachEvent("on"+h,f)
}}}}
};
wysihtml5.dom.parse=(function(){var a={"1":e,"3":l},o="span",g=/\s+/,j={tags:{},classes:{}},n={};
function d(u,x,p,r){wysihtml5.lang.object(n).merge(j).merge(x).get();
p=p||u.ownerDocument||document;
var t=p.createDocumentFragment(),q=typeof(u)==="string",s,w,v;
if(q){s=wysihtml5.dom.getAsDom(u,p)
}else{s=u
}while(s.firstChild){v=s.firstChild;
s.removeChild(v);
w=f(v,r);
if(w){t.appendChild(w)
}}s.innerHTML="";
s.appendChild(t);
return q?wysihtml5.quirks.getCorrectInnerHTML(s):s
}function f(r,q){var w=r.nodeType,v=r.childNodes,u=v.length,p=a[w],s=0,x,t;
x=p&&p(r);
if(!x){return null
}for(s=0;
s<u;
s++){t=f(v[s],q);
if(t){x.appendChild(t)
}}if(q&&x.childNodes.length<=1&&x.nodeName.toLowerCase()===o&&!x.attributes.length){return x.firstChild
}return x
}function e(t){var s,r,q=n.tags,u=t.nodeName.toLowerCase(),p=t.scopeName;
if(t._wysihtml5){return null
}t._wysihtml5=1;
if(t.className==="wysihtml5-temp"){return null
}if(p&&p!="HTML"){u=p+":"+u
}if("outerHTML" in t){if(!wysihtml5.browser.autoClosesUnclosedTags()&&t.nodeName==="P"&&t.outerHTML.slice(-4).toLowerCase()!=="</p>"){u="div"
}}if(u in q){s=q[u];
if(s.remove){return null
}s=typeof(s)==="string"?{rename_tag:s}:s
}if(!s){s={}
}r=t.ownerDocument.createElement(s.rename_tag||u);
b(t,r,s);
t=null;
return r
}function b(F,p,x){var B={},N=x.set_class,D=x.add_class,I=x.set_attributes,w=x.check_attributes,v=n.classes,H=0,K=[],O=[],t=[],G=[],y,C,s,A,E,M,r;
if(I){B=wysihtml5.lang.object(I).clone()
}if(w){for(E in w){r=h[w[E]];
if(!r){continue
}M=r(i(F,E));
if(typeof(M)==="string"){B[E]=M
}}}if(N){K.push(N)
}if(D){for(E in D){r=k[D[E]];
if(!r){continue
}A=r(i(F,E));
if(typeof(A)==="string"){K.push(A)
}}}v["_wysihtml5-temp-placeholder"]=1;
G=F.getAttribute("class");
if(G){K=K.concat(G.split(g))
}y=K.length;
for(;
H<y;
H++){s=K[H];
O.push(s)
}C=O.length;
while(C--){s=O[C];
if(!wysihtml5.lang.array(t).contains(s)){t.unshift(s)
}}if(t.length){B["class"]=t.join(" ")
}var z=F.attributes;
var q=z.length;
for(H=0;
H<q;
H++){var u=z[H];
if(u){var L=u.name;
if(L!=="style"){B[L]=i(F,L)
}}}for(E in B){try{p.setAttribute(E,B[E])
}catch(J){}}if(B.src){if(typeof(B.width)!=="undefined"){p.setAttribute("width",B.width)
}if(typeof(B.height)!=="undefined"){p.setAttribute("height",B.height)
}}}var m=!wysihtml5.browser.supportsGetAttributeCorrectly();
function i(r,q){q=q.toLowerCase();
var t=r.nodeName;
if(t=="IMG"&&q=="src"&&c(r)===true){return r.src
}else{if(m&&"outerHTML" in r){var s=r.outerHTML.toLowerCase(),p=s.indexOf(" "+q+"=")!=-1;
return p?r.getAttribute(q):null
}else{return r.getAttribute(q)
}}}function c(p){try{return p.complete&&!p.mozMatchesSelector(":-moz-broken")
}catch(q){if(p.complete&&p.readyState==="complete"){return true
}}}function l(p){return p.ownerDocument.createTextNode(p.data)
}var h={url:(function(){var p=/^https?:\/\//i;
return function(q){if(!q||!q.match(p)){return null
}return q.replace(p,function(r){return r.toLowerCase()
})
}
})(),src:(function(){var p=/^(\/|https?:\/\/)/i;
return function(q){if(!q||!q.match(p)){return null
}return q.replace(p,function(r){return r.toLowerCase()
})
}
})(),href:(function(){var p=/^(\/|https?:\/\/|mailto:)/i;
return function(q){if(!q||!q.match(p)){return null
}return q.replace(p,function(r){return r.toLowerCase()
})
}
})(),alt:(function(){var p=/[^ a-z0-9_\-]/gi;
return function(q){if(!q){return""
}return q.replace(p,"")
}
})(),numbers:(function(){var p=/\D/g;
return function(q){q=(q||"").replace(p,"");
return q||null
}
})()};
var k={align_img:(function(){var p={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};
return function(q){return p[String(q).toLowerCase()]
}
})(),align_text:(function(){var p={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};
return function(q){return p[String(q).toLowerCase()]
}
})(),clear_br:(function(){var p={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};
return function(q){return p[String(q).toLowerCase()]
}
})(),size_font:(function(){var p={"1":"wysiwyg-font-size-xx-small","2":"wysiwyg-font-size-small","3":"wysiwyg-font-size-medium","4":"wysiwyg-font-size-large","5":"wysiwyg-font-size-x-large","6":"wysiwyg-font-size-xx-large","7":"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};
return function(q){return p[String(q).charAt(0)]
}
})()};
return d
})();
wysihtml5.dom.removeEmptyTextNodes=function(c){var b,e=wysihtml5.lang.array(c.childNodes).get(),d=e.length,a=0;
for(;
a<d;
a++){b=e[a];
if(b.nodeType===wysihtml5.TEXT_NODE&&b.data===""){b.parentNode.removeChild(b)
}}};
wysihtml5.dom.renameElement=function(a,b){var d=a.ownerDocument.createElement(b),c;
while(c=a.firstChild){d.appendChild(c)
}wysihtml5.dom.copyAttributes(["align","className"]).from(a).to(d);
a.parentNode.replaceChild(d,a);
return d
};
wysihtml5.dom.replaceWithChildNodes=function(b){if(!b.parentNode){return
}if(!b.firstChild){b.parentNode.removeChild(b);
return
}var a=b.ownerDocument.createDocumentFragment();
while(b.firstChild){a.appendChild(b.firstChild)
}b.parentNode.replaceChild(a,b);
b=a=null
};
(function(e){function c(f){return e.getStyle("display").from(f)==="block"
}function d(f){return f.nodeName==="BR"
}function b(g){var f=g.ownerDocument.createElement("br");
g.appendChild(f)
}function a(l,o){if(!l.nodeName.match(/^(MENU|UL|OL)$/)){return
}var p=l.ownerDocument,m=p.createDocumentFragment(),g=l.previousElementSibling||l.previousSibling,n,h,i,j,k,f;
if(o){if(g&&!c(g)){b(m)
}while(f=(l.firstElementChild||l.firstChild)){h=f.lastChild;
while(n=f.firstChild){i=n===h;
j=i&&!c(n)&&!d(n);
m.appendChild(n);
if(j){b(m)
}}f.parentNode.removeChild(f)
}}else{while(f=(l.firstElementChild||l.firstChild)){if(f.querySelector&&f.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6")){while(n=f.firstChild){m.appendChild(n)
}}else{k=p.createElement("p");
while(n=f.firstChild){k.appendChild(n)
}m.appendChild(k)
}f.parentNode.removeChild(f)
}}l.parentNode.replaceChild(m,l)
}e.resolveList=a
})(wysihtml5.dom);
(function(e){var d=document,c=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],b=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],a=["referrer","write","open","close"];
e.dom.Sandbox=Base.extend({constructor:function(g,f){this.callback=g||e.EMPTY_FUNCTION;
this.config=e.lang.object({}).merge(f).get();
this.iframe=this._createIframe()
},insertInto:function(f){if(typeof(f)==="string"){f=d.getElementById(f)
}f.appendChild(this.iframe)
},getIframe:function(){return this.iframe
},getWindow:function(){this._readyError()
},getDocument:function(){this._readyError()
},destroy:function(){var f=this.getIframe();
f.parentNode.removeChild(f)
},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")
},_createIframe:function(){var g=this,h=g.config.iframeSrc,f=d.createElement("iframe");
f.className="wysihtml5-sandbox";
e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(f);
if(h){f.src=h
}else{if(e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()){f.src="javascript:'<html></html>'"
}}f.onload=function(){f.onreadystatechange=f.onload=null;
g._onLoadIframe(f,!!h)
};
f.onreadystatechange=function(){if(/loaded|complete/.test(f.readyState)){f.onreadystatechange=f.onload=null;
g._onLoadIframe(f,!!h)
}};
return f
},_onLoadIframe:function(j,h){if(!e.dom.contains(d.documentElement,j)){return
}var l=this,f=j.contentWindow,m=j.contentWindow.document;
if(!h){m.open("text/html","replace");
m.write(this._getHtml({charset:d.characterSet||d.charset||"utf-8",stylesheets:this.config.stylesheets}));
m.close()
}this.getWindow=function(){return j.contentWindow
};
this.getDocument=function(){return j.contentWindow.document
};
f.onerror=function(n,o,i){throw new Error("wysihtml5.Sandbox: "+n,o,i)
};
if(!e.browser.supportsSandboxedIframes()){var g,k;
for(g=0,k=c.length;
g<k;
g++){this._unset(f,c[g])
}for(g=0,k=b.length;
g<k;
g++){this._unset(f,b[g],e.EMPTY_FUNCTION)
}for(g=0,k=a.length;
g<k;
g++){this._unset(m,a[g])
}this._unset(m,"cookie","",true)
}this.loaded=true;
setTimeout(function(){l.callback(l)
},0)
},_getHtml:function(j){var k=j.stylesheets,g="",f=0,h;
k=typeof(k)==="string"?[k]:k;
if(k){h=k.length;
for(;
f<h;
f++){g+='<link rel="stylesheet" href="'+k[f]+'">'
}}j.stylesheets=g;
return e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(j)
},_unset:function(g,i,h,k){try{g[i]=h
}catch(j){}try{g.__defineGetter__(i,function(){return h
})
}catch(j){}if(k){try{g.__defineSetter__(i,function(){})
}catch(j){}}if(!e.browser.crashesWhenDefineProperty(i)){try{var f={get:function(){return h
}};
if(k){f.set=function(){}
}Object.defineProperty(g,i,f)
}catch(j){}}}})
})(wysihtml5);
(function(){var a={className:"class"};
wysihtml5.dom.setAttributes=function(b){return{on:function(d){for(var c in b){d.setAttribute(a[c]||c,b[c])
}}}
}
})();
wysihtml5.dom.setStyles=function(a){return{on:function(c){var d=c.style;
if(typeof(a)==="string"){d.cssText+=";"+a;
return
}for(var b in a){if(b==="float"){d.cssFloat=a[b];
d.styleFloat=a[b]
}else{d[b]=a[b]
}}}}
};
(function(a){a.simulatePlaceholder=function(d,b,c){var e="placeholder",f=function(){if(b.hasPlaceholderSet()){b.clear()
}b.placeholderSet=false;
a.removeClass(b.element,e)
},g=function(){if(b.isEmpty()){b.placeholderSet=true;
b.setValue(c);
a.addClass(b.element,e)
}};
d.on("set_placeholder",g).on("unset_placeholder",f).on("focus:composer",f).on("paste:composer",f).on("blur:composer",g);
g()
}
})(wysihtml5.dom);
(function(b){var a=document.documentElement;
if("textContent" in a){b.setTextContent=function(c,d){c.textContent=d
};
b.getTextContent=function(c){return c.textContent
}
}else{if("innerText" in a){b.setTextContent=function(c,d){c.innerText=d
};
b.getTextContent=function(c){return c.innerText
}
}else{b.setTextContent=function(c,d){c.nodeValue=d
};
b.getTextContent=function(c){return c.nodeValue
}
}}})(wysihtml5.dom);
wysihtml5.quirks.cleanPastedHTML=(function(){var a={"a u":wysihtml5.dom.replaceWithChildNodes};
function b(l,m,d){m=m||a;
d=d||l.ownerDocument||document;
var h,e=typeof(l)==="string",c,k,n,g,f=0;
if(e){h=wysihtml5.dom.getAsDom(l,d)
}else{h=l
}for(g in m){k=h.querySelectorAll(g);
c=m[g];
n=k.length;
for(;
f<n;
f++){c(k[f])
}}k=l=m=null;
return e?h.innerHTML:h
}return b
})();
wysihtml5.quirks.ensureProperClearing=(function(){var a=function(){var b=this;
setTimeout(function(){var c=b.innerHTML.toLowerCase();
if(c=="<p>&nbsp;</p>"||c=="<p>&nbsp;</p><p>&nbsp;</p>"){b.innerHTML=""
}},0)
};
return function(b){wysihtml5.dom.observe(b.element,["cut","keydown"],a)
}
})();
(function(b){var a="%7E";
b.quirks.getCorrectInnerHTML=function(e){var j=e.innerHTML;
if(j.indexOf(a)===-1){return j
}var g=e.querySelectorAll("[href*='~'], [src*='~']"),c,h,f,d;
for(d=0,f=g.length;
d<f;
d++){c=g[d].href||g[d].src;
h=b.lang.string(c).replace("~").by(a);
j=b.lang.string(j).replace(h).by(c)
}return j
}
})(wysihtml5);
(function(b){var a="wysihtml5-quirks-redraw";
b.quirks.redraw=function(c){b.dom.addClass(c,a);
b.dom.removeClass(c,a);
try{var f=c.ownerDocument;
f.execCommand("italic",false,null);
f.execCommand("italic",false,null)
}catch(d){}}
})(wysihtml5);
(function(c){var b=c.dom;
function a(d){var e=0;
if(d.parentNode){do{e+=d.offsetTop||0;
d=d.offsetParent
}while(d)
}return e
}c.Selection=Base.extend({constructor:function(d){window.rangy.init();
this.editor=d;
this.composer=d.composer;
this.doc=this.composer.doc
},getBookmark:function(){var d=this.getRange();
return d&&d.cloneRange()
},setBookmark:function(d){if(!d){return
}this.setSelection(d)
},setBefore:function(e){var d=rangy.createRange(this.doc);
d.setStartBefore(e);
d.setEndBefore(e);
return this.setSelection(d)
},setAfter:function(e){var d=rangy.createRange(this.doc);
d.setStartAfter(e);
d.setEndAfter(e);
return this.setSelection(d)
},selectNode:function(d,k){var g=rangy.createRange(this.doc),j=d.nodeType===c.ELEMENT_NODE,m="canHaveHTML" in d?d.canHaveHTML:(d.nodeName!=="IMG"),i=j?d.innerHTML:d.data,f=(i===""||i===c.INVISIBLE_SPACE),l=b.getStyle("display").from(d),n=(l==="block"||l==="list-item");
if(f&&j&&m&&!k){try{d.innerHTML=c.INVISIBLE_SPACE
}catch(h){}}if(m){g.selectNodeContents(d)
}else{g.selectNode(d)
}if(m&&f&&j){g.collapse(n)
}else{if(m&&f){g.setStartAfter(d);
g.setEndAfter(d)
}}this.setSelection(g)
},getSelectedNode:function(e){var f,d;
if(e&&this.doc.selection&&this.doc.selection.type==="Control"){d=this.doc.selection.createRange();
if(d&&d.length){return d.item(0)
}}f=this.getSelection(this.doc);
if(f.focusNode===f.anchorNode){return f.focusNode
}else{d=this.getRange(this.doc);
return d?d.commonAncestorContainer:this.doc.body
}},executeAndRestore:function(f,s){var m=this.doc.body,j=s&&m.scrollTop,n=s&&m.scrollLeft,p="_wysihtml5-temp-placeholder",k='<span class="'+p+'">'+c.INVISIBLE_SPACE+"</span>",l=this.getRange(this.doc),d,g,i,h,r;
if(!l){f(m,m);
return
}if(c.browser.hasInsertNodeIssue()){this.doc.execCommand("insertHTML",false,k)
}else{h=l.createContextualFragment(k);
l.insertNode(h)
}try{f(l.startContainer,l.endContainer)
}catch(o){setTimeout(function(){throw o
},0)
}d=this.doc.querySelector("."+p);
if(d){r=rangy.createRange(this.doc);
i=d.nextSibling;
if(c.browser.hasInsertNodeIssue()&&i&&i.nodeName==="BR"){g=this.doc.createTextNode(c.INVISIBLE_SPACE);
b.insert(g).after(d);
r.setStartBefore(g);
r.setEndBefore(g)
}else{r.selectNode(d);
r.deleteContents()
}this.setSelection(r)
}else{m.focus()
}if(s){m.scrollTop=j;
m.scrollLeft=n
}try{d.parentNode.removeChild(d)
}catch(q){}},executeAndRestoreSimple:function(d){var h=this.getRange(),i=this.doc.body,p,f,g,l,j;
if(!h){d(i,i);
return
}l=h.getNodes([3]);
f=l[0]||h.startContainer;
g=l[l.length-1]||h.endContainer;
j={collapsed:h.collapsed,startContainer:f,startOffset:f===h.startContainer?h.startOffset:0,endContainer:g,endOffset:g===h.endContainer?h.endOffset:g.length};
try{d(h.startContainer,h.endContainer)
}catch(k){setTimeout(function(){throw k
},0)
}p=rangy.createRange(this.doc);
try{p.setStart(j.startContainer,j.startOffset)
}catch(o){}try{p.setEnd(j.endContainer,j.endOffset)
}catch(n){}try{this.setSelection(p)
}catch(m){}},set:function(e,f){var d=rangy.createRange(this.doc);
d.setStart(e,f||0);
this.setSelection(d)
},insertHTML:function(e){var d=rangy.createRange(this.doc),g=d.createContextualFragment(e),f=g.lastChild;
this.insertNode(g);
if(f){this.setAfter(f)
}},insertNode:function(e){var d=this.getRange();
if(d){d.insertNode(e)
}},surround:function(f){var d=this.getRange();
if(!d){return
}try{d.surroundContents(f);
this.selectNode(f)
}catch(g){f.appendChild(d.extractContents());
d.insertNode(f)
}},scrollIntoView:function(){var h=this.doc,e=5,g=h.documentElement.scrollHeight>h.documentElement.offsetHeight,d=h._wysihtml5ScrollIntoViewElement=h._wysihtml5ScrollIntoViewElement||(function(){var i=h.createElement("span");
i.innerHTML=c.INVISIBLE_SPACE;
return i
})(),f;
if(g){this.insertNode(d);
f=a(d);
d.parentNode.removeChild(d);
if(f>=(h.body.scrollTop+h.documentElement.offsetHeight-e)){h.body.scrollTop=f
}}},selectLine:function(){if(c.browser.supportsSelectionModify()){this._selectLine_W3C()
}else{if(this.doc.selection){this._selectLine_MSIE()
}}},_selectLine_W3C:function(){var e=this.doc.defaultView,d=e.getSelection();
d.modify("extend","left","lineboundary");
d.modify("extend","right","lineboundary")
},_selectLine_MSIE:function(){var l=this.doc.selection.createRange(),h=l.boundingTop,k=this.doc.body.scrollWidth,e,d,m,g,f;
if(!l.moveToPoint){return
}if(h===0){m=this.doc.createElement("span");
this.insertNode(m);
h=m.offsetTop;
m.parentNode.removeChild(m)
}h+=1;
for(g=-10;
g<k;
g+=2){try{l.moveToPoint(g,h);
break
}catch(o){}}e=h;
d=this.doc.selection.createRange();
for(f=k;
f>=0;
f--){try{d.moveToPoint(f,e);
break
}catch(n){}}l.setEndPoint("EndToEnd",d);
l.select()
},getText:function(){var d=this.getSelection();
return d?d.toString():""
},getNodes:function(d,f){var e=this.getRange();
if(e){return e.getNodes([d],f)
}else{return[]
}},getRange:function(){try{var e=this.getSelection();
return e&&e.rangeCount&&e.getRangeAt(0)
}catch(d){return false
}},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)
},setSelection:function(d){var f=this.doc.defaultView||this.doc.parentWindow,e=rangy.getSelection(f);
return e.setSingleRange(d)
}})
})(wysihtml5);
(function(n,j){var h="span";
var f=/\s+/g;
function d(q,o,p){if(!q.className){return false
}var r=q.className.match(p)||[];
return r[r.length-1]===o
}function i(q,o,p){if(q.className){l(q,p);
q.className+=" "+o
}else{q.className=o
}}function l(p,o){if(p.className){p.className=p.className.replace(o,"")
}}function m(p,o){return p.className.replace(f," ")==o.className.replace(f," ")
}function a(p){var o=p.parentNode;
while(p.firstChild){o.insertBefore(p.firstChild,p)
}o.removeChild(p)
}function e(u,s){if(u.attributes.length!=s.attributes.length){return false
}for(var t=0,o=u.attributes.length,r,p,q;
t<o;
++t){r=u.attributes[t];
q=r.name;
if(q!="class"){p=s.attributes.getNamedItem(q);
if(r.specified!=p.specified){return false
}if(r.specified&&r.nodeValue!==p.nodeValue){return false
}}}return true
}function c(o,p){if(j.dom.isCharacterDataNode(o)){if(p==0){return !!o.previousSibling
}else{if(p==o.length){return !!o.nextSibling
}else{return true
}}}return p>0&&p<o.childNodes.length
}function b(r,p,q){var o;
if(j.dom.isCharacterDataNode(p)){if(q==0){q=j.dom.getNodeIndex(p);
p=p.parentNode
}else{if(q==p.length){q=j.dom.getNodeIndex(p)+1;
p=p.parentNode
}else{o=j.dom.splitDataNode(p,q)
}}}if(!o){o=p.cloneNode(false);
if(o.id){o.removeAttribute("id")
}var s;
while((s=p.childNodes[q])){o.appendChild(s)
}j.dom.insertAfter(o,p)
}return(p==r)?o:b(r,o.parentNode,j.dom.getNodeIndex(o))
}function g(o){this.isElementMerge=(o.nodeType==n.ELEMENT_NODE);
this.firstTextNode=this.isElementMerge?o.lastChild:o;
this.textNodes=[this.firstTextNode]
}g.prototype={doMerge:function(){var t=[],s,q,r;
for(var p=0,o=this.textNodes.length;
p<o;
++p){s=this.textNodes[p];
q=s.parentNode;
t[p]=s.data;
if(p){q.removeChild(s);
if(!q.hasChildNodes()){q.parentNode.removeChild(q)
}}}this.firstTextNode.data=r=t.join("");
return r
},getLength:function(){var p=this.textNodes.length,o=0;
while(p--){o+=this.textNodes[p].length
}return o
},toString:function(){var q=[];
for(var p=0,o=this.textNodes.length;
p<o;
++p){q[p]="'"+this.textNodes[p].data+"'"
}return"[Merge("+q.join(",")+")]"
}};
function k(o,q,p,r){this.tagNames=o||[h];
this.cssClass=q||"";
this.similarClassRegExp=p;
this.normalize=r;
this.applyToAnyTagName=false
}k.prototype={getAncestorWithClass:function(p){var o;
while(p){o=this.cssClass?d(p,this.cssClass,this.similarClassRegExp):true;
if(p.nodeType==n.ELEMENT_NODE&&j.dom.arrayContains(this.tagNames,p.tagName.toLowerCase())&&o){return p
}p=p.parentNode
}return false
},postApply:function(A,w){var o=A[0],p=A[A.length-1];
var r=[],B;
var t=o,q=p;
var y=0,C=p.length;
var s,v;
for(var u=0,x=A.length;
u<x;
++u){s=A[u];
v=this.getAdjacentMergeableTextNode(s.parentNode,false);
if(v){if(!B){B=new g(v);
r.push(B)
}B.textNodes.push(s);
if(s===o){t=B.firstTextNode;
y=t.length
}if(s===p){q=B.firstTextNode;
C=B.getLength()
}}else{B=null
}}var z=this.getAdjacentMergeableTextNode(p.parentNode,true);
if(z){if(!B){B=new g(p);
r.push(B)
}B.textNodes.push(z)
}if(r.length){for(u=0,x=r.length;
u<x;
++u){r[u].doMerge()
}w.setStart(t,y);
w.setEnd(q,C)
}},getAdjacentMergeableTextNode:function(q,o){var s=(q.nodeType==n.TEXT_NODE);
var p=s?q.parentNode:q;
var t;
var r=o?"nextSibling":"previousSibling";
if(s){t=q[r];
if(t&&t.nodeType==n.TEXT_NODE){return t
}}else{t=p[r];
if(t&&this.areElementsMergeable(q,t)){return t[o?"firstChild":"lastChild"]
}}return null
},areElementsMergeable:function(p,o){return j.dom.arrayContains(this.tagNames,(p.tagName||"").toLowerCase())&&j.dom.arrayContains(this.tagNames,(o.tagName||"").toLowerCase())&&m(p,o)&&e(p,o)
},createContainer:function(p){var o=p.createElement(this.tagNames[0]);
if(this.cssClass){o.className=this.cssClass
}return o
},applyToTextNode:function(q){var p=q.parentNode;
if(p.childNodes.length==1&&j.dom.arrayContains(this.tagNames,p.tagName.toLowerCase())){if(this.cssClass){i(p,this.cssClass,this.similarClassRegExp)
}}else{var o=this.createContainer(j.dom.getDocument(q));
q.parentNode.insertBefore(o,q);
o.appendChild(q)
}},isRemovable:function(o){return j.dom.arrayContains(this.tagNames,o.tagName.toLowerCase())&&n.lang.string(o.className).trim()==this.cssClass
},undoToTextNode:function(r,p,q){if(!p.containsNode(q)){var o=p.cloneRange();
o.selectNode(q);
if(o.isPointInRange(p.endContainer,p.endOffset)&&c(p.endContainer,p.endOffset)){b(q,p.endContainer,p.endOffset);
p.setEndAfter(q)
}if(o.isPointInRange(p.startContainer,p.startOffset)&&c(p.startContainer,p.startOffset)){q=b(q,p.startContainer,p.startOffset)
}}if(this.similarClassRegExp){l(q,this.similarClassRegExp)
}if(this.isRemovable(q)){a(q)
}},applyToRange:function(p){var s=p.getNodes([n.TEXT_NODE]);
if(!s.length){try{var r=this.createContainer(p.endContainer.ownerDocument);
p.surroundContents(r);
this.selectNode(p,r);
return
}catch(t){}}p.splitBoundaries();
s=p.getNodes([n.TEXT_NODE]);
if(s.length){var u;
for(var q=0,o=s.length;
q<o;
++q){u=s[q];
if(!this.getAncestorWithClass(u)){this.applyToTextNode(u)
}}p.setStart(s[0],0);
u=s[s.length-1];
p.setEnd(u,u.length);
if(this.normalize){this.postApply(s,p)
}}},undoToRange:function(p){var s=p.getNodes([n.TEXT_NODE]),v,t;
if(s.length){p.splitBoundaries();
s=p.getNodes([n.TEXT_NODE])
}else{var u=p.endContainer.ownerDocument,r=u.createTextNode(n.INVISIBLE_SPACE);
p.insertNode(r);
p.selectNode(r);
s=[r]
}for(var q=0,o=s.length;
q<o;
++q){v=s[q];
t=this.getAncestorWithClass(v);
if(t){this.undoToTextNode(v,p,t)
}}if(o==1){this.selectNode(p,s[0])
}else{p.setStart(s[0],0);
v=s[s.length-1];
p.setEnd(v,v.length);
if(this.normalize){this.postApply(s,p)
}}},selectNode:function(p,s){var r=s.nodeType===n.ELEMENT_NODE,o="canHaveHTML" in s?s.canHaveHTML:true,q=r?s.innerHTML:s.data,u=(q===""||q===n.INVISIBLE_SPACE);
if(u&&r&&o){try{s.innerHTML=n.INVISIBLE_SPACE
}catch(t){}}p.selectNodeContents(s);
if(u&&r){p.collapse(false)
}else{if(u){p.setStartAfter(s);
p.setEndAfter(s)
}}},getTextSelectedByRange:function(s,o){var p=o.cloneRange();
p.selectNodeContents(s);
var q=p.intersection(o);
var r=q?q.toString():"";
p.detach();
return r
},isAppliedToRange:function(p){var s=[],r,t=p.getNodes([n.TEXT_NODE]);
if(!t.length){r=this.getAncestorWithClass(p.startContainer);
return r?[r]:false
}for(var q=0,o=t.length,u;
q<o;
++q){u=this.getTextSelectedByRange(t[q],p);
r=this.getAncestorWithClass(t[q]);
if(u!=""&&!r){return false
}else{s.push(r)
}}return s
},toggleRange:function(o){if(this.isAppliedToRange(o)){this.undoToRange(o)
}else{this.applyToRange(o)
}}};
n.selection.HTMLApplier=k
})(wysihtml5,rangy);
wysihtml5.Commands=Base.extend({constructor:function(a){this.editor=a;
this.composer=a.composer;
this.doc=this.composer.doc
},support:function(a){return wysihtml5.browser.supportsCommand(this.doc,a)
},exec:function(g,c){var f=wysihtml5.commands[g],b=wysihtml5.lang.array(arguments).get(),h=f&&f.exec,a=null;
this.editor.fire("beforecommand:composer");
if(h){b.unshift(this.composer);
a=h.apply(f,b)
}else{try{a=this.doc.execCommand(g,false,c)
}catch(d){}}this.editor.fire("aftercommand:composer");
return a
},state:function(f,a){var d=wysihtml5.commands[f],b=wysihtml5.lang.array(arguments).get(),g=d&&d.state;
if(g){b.unshift(this.composer);
return g.apply(d,b)
}else{try{return this.doc.queryCommandState(f)
}catch(c){return false
}}}});
wysihtml5.commands.bold={exec:function(a,b){return wysihtml5.commands.formatInline.exec(a,b,"b")
},state:function(a,b){return wysihtml5.commands.formatInline.state(a,b,"b")
}};
(function(f){var d,c="A",e=f.dom;
function a(h,n){var m=n.length,j=0,g,l,k;
for(;
j<m;
j++){g=n[j];
l=e.getParentElement(g,{nodeName:"code"});
k=e.getTextContent(g);
if(k.match(e.autoLink.URL_REG_EXP)&&!l){l=e.renameElement(g,"code")
}else{e.replaceWithChildNodes(g)
}}}function b(g,m){var u=g.doc,r="_wysihtml5-temp-"+(+new Date()),w=/non-matching-class/g,q=0,k,h,p,t,o,n,s,v,l;
f.commands.formatInline.exec(g,d,c,r,w);
h=u.querySelectorAll(c+"."+r);
k=h.length;
for(;
q<k;
q++){p=h[q];
p.removeAttribute("class");
for(l in m){p.setAttribute(l,m[l])
}}n=p;
if(k===1){s=e.getTextContent(p);
t=!!p.querySelector("*");
o=s===""||s===f.INVISIBLE_SPACE;
if(!t&&o){e.setTextContent(p,m.text||p.href);
v=u.createTextNode(" ");
g.selection.setAfter(p);
g.selection.insertNode(v);
n=v
}}g.selection.setAfter(n)
}f.commands.createLink={exec:function(g,j,i){var h=this.state(g,j);
if(h){g.selection.executeAndRestore(function(){a(g,h)
})
}else{i=typeof(i)==="object"?i:{href:i};
b(g,i)
}},state:function(g,h){return f.commands.formatInline.state(g,h,"A")
}}
})(wysihtml5);
(function(c){var b,a=/wysiwyg-font-size-[0-9a-z\-]+/g;
c.commands.fontSize={exec:function(d,f,e){return c.commands.formatInline.exec(d,f,"span","wysiwyg-font-size-"+e,a)
},state:function(d,f,e){return c.commands.formatInline.state(d,f,"span","wysiwyg-font-size-"+e,a)
},value:function(){return b
}}
})(wysihtml5);
(function(b){var a=/wysiwyg-color-[0-9a-z]+/g;
b.commands.foreColor={exec:function(d,e,c){return b.commands.formatInline.exec(d,e,"span","wysiwyg-color-"+c,a)
},state:function(d,e,c){return b.commands.formatInline.state(d,e,"span","wysiwyg-color-"+c,a)
}}
})(wysihtml5);
(function(p){var f=p.dom,g=["H1","H2","H3","H4","H5","H6","P","BLOCKQUOTE","DIV"];
function k(q,r,s){if(q.className){a(q,s);
q.className+=" "+r
}else{q.className=r
}}function a(q,r){q.className=q.className.replace(r,"")
}function m(q){return q.nodeType===p.TEXT_NODE&&!p.lang.string(q.data).trim()
}function b(r){var q=r.previousSibling;
while(q&&m(q)){q=q.previousSibling
}return q
}function n(q){var r=q.nextSibling;
while(r&&m(r)){r=r.nextSibling
}return r
}function c(r){var t=r.ownerDocument,s=n(r),q=b(r);
if(s&&!i(s)){r.parentNode.insertBefore(t.createElement("br"),s)
}if(q&&!i(q)){r.parentNode.insertBefore(t.createElement("br"),r)
}}function d(r){var s=n(r),q=b(r);
if(s&&j(s)){s.parentNode.removeChild(s)
}if(q&&j(q)){q.parentNode.removeChild(q)
}}function h(r){var q=r.lastChild;
if(q&&j(q)){q.parentNode.removeChild(q)
}}function j(q){return q.nodeName==="BR"
}function i(q){if(j(q)){return true
}if(f.getStyle("display").from(q)==="block"){return true
}return false
}function l(s,t,u,r){if(r){var q=f.observe(s,"DOMNodeInserted",function(w){var x=w.target,v;
if(x.nodeType!==p.ELEMENT_NODE){return
}v=f.getStyle("display").from(x);
if(v.substr(0,6)!=="inline"){x.className+=" "+r
}})
}s.execCommand(t,false,u);
if(q){q.stop()
}}function e(q,r){q.selection.selectLine();
q.selection.surround(r);
d(r);
h(r);
q.selection.selectNode(r,p.browser.displaysCaretInEmptyContentEditableCorrectly())
}function o(q){return !!p.lang.string(q.className).trim()
}p.commands.formatBlock={exec:function(r,s,w,v,z){var y=r.doc,u=this.state(r,s,w,v,z),x=r.config.useLineBreaks,q=x?"DIV":"P",t;
w=typeof(w)==="string"?w.toUpperCase():w;
if(u){r.selection.executeAndRestoreSimple(function(){if(z){a(u,z)
}var A=o(u);
if(!A&&(x||w==="P")){c(u);
f.replaceWithChildNodes(u)
}else{f.renameElement(u,w==="P"?"DIV":q)
}});
return
}if(w===null||p.lang.array(g).contains(w)){t=r.selection.getSelectedNode();
u=f.getParentElement(t,{nodeName:g});
if(u){r.selection.executeAndRestore(function(){if(w){u=f.renameElement(u,w)
}if(v){k(u,v,z)
}});
return
}}if(r.commands.support(s)){l(y,s,w||q,v);
return
}u=y.createElement(w||q);
if(v){u.className=v
}e(r,u)
},state:function(q,u,v,r,t){v=typeof(v)==="string"?v.toUpperCase():v;
var s=q.selection.getSelectedNode();
return f.getParentElement(s,{nodeName:v,className:r,classRegExp:t})
}}
})(wysihtml5);
(function(e){var c={strong:"b",em:"i",b:"strong",i:"em"},d={};
function b(g){var f=c[g];
return f?[g.toLowerCase(),f.toLowerCase()]:[g.toLowerCase()]
}function a(g,h,i){var f=g+":"+h;
if(!d[f]){d[f]=new e.selection.HTMLApplier(b(g),h,i,true)
}return d[f]
}e.commands.formatInline={exec:function(g,k,h,i,j){var f=g.selection.getRange();
if(!f){return false
}a(h,i,j).toggleRange(f);
g.selection.setSelection(f)
},state:function(g,l,h,i,j){var k=g.doc,m=c[h]||h,f;
if(!e.dom.hasElementWithTagName(k,h)&&!e.dom.hasElementWithTagName(k,m)){return false
}if(i&&!e.dom.hasElementWithClassName(k,i)){return false
}f=g.selection.getRange();
if(!f){return false
}return a(h,i,j).isAppliedToRange(f)
}}
})(wysihtml5);
wysihtml5.commands.insertHTML={exec:function(a,c,b){if(a.commands.support(c)){a.doc.execCommand(c,false,b)
}else{a.selection.insertHTML(b)
}},state:function(){return false
}};
(function(b){var a="IMG";
b.commands.insertImage={exec:function(c,k,f){f=typeof(f)==="object"?f:{src:f};
var h=c.doc,g=this.state(c),j,d,e;
if(g){c.selection.setBefore(g);
e=g.parentNode;
e.removeChild(g);
b.dom.removeEmptyTextNodes(e);
if(e.nodeName==="A"&&!e.firstChild){c.selection.setAfter(e);
e.parentNode.removeChild(e)
}b.quirks.redraw(c.element);
return
}g=h.createElement(a);
for(d in f){if(d==="className"){d="class"
}g.setAttribute(d,f[d])
}c.selection.insertNode(g);
if(b.browser.hasProblemsSettingCaretAfterImg()){j=h.createTextNode(b.INVISIBLE_SPACE);
c.selection.insertNode(j);
c.selection.setAfter(j)
}else{c.selection.setAfter(g)
}},state:function(d){var f=d.doc,e,g,c;
if(!b.dom.hasElementWithTagName(f,a)){return false
}e=d.selection.getSelectedNode();
if(!e){return false
}if(e.nodeName===a){return e
}if(e.nodeType!==b.ELEMENT_NODE){return false
}g=d.selection.getText();
g=b.lang.string(g).trim();
if(g){return false
}c=d.selection.getNodes(b.ELEMENT_NODE,function(h){return h.nodeName==="IMG"
});
if(c.length!==1){return false
}return c[0]
}}
})(wysihtml5);
(function(b){var a="<br>"+(b.browser.needsSpaceAfterLineBreak()?" ":"");
b.commands.insertLineBreak={exec:function(c,d){if(c.commands.support(d)){c.doc.execCommand(d,false,null);
if(!b.browser.autoScrollsToCaret()){c.selection.scrollIntoView()
}}else{c.commands.exec("insertHTML",a)
}},state:function(){return false
}}
})(wysihtml5);
wysihtml5.commands.insertOrderedList={exec:function(a,d){var i=a.doc,f=a.selection.getSelectedNode(),g=wysihtml5.dom.getParentElement(f,{nodeName:"OL"}),h=wysihtml5.dom.getParentElement(f,{nodeName:"UL"}),c="_wysihtml5-temp-"+new Date().getTime(),e,b;
if(!g&&!h&&a.commands.support(d)){i.execCommand(d,false,null);
return
}if(g){a.selection.executeAndRestore(function(){wysihtml5.dom.resolveList(g,a.config.useLineBreaks)
})
}else{if(h){a.selection.executeAndRestore(function(){wysihtml5.dom.renameElement(h,"ol")
})
}else{a.commands.exec("formatBlock","div",c);
b=i.querySelector("."+c);
e=b.innerHTML===""||b.innerHTML===wysihtml5.INVISIBLE_SPACE||b.innerHTML==="<br>";
a.selection.executeAndRestore(function(){g=wysihtml5.dom.convertToList(b,"ol")
});
if(e){a.selection.selectNode(g.querySelector("li"),true)
}}}},state:function(a){var b=a.selection.getSelectedNode();
return wysihtml5.dom.getParentElement(b,{nodeName:"OL"})
}};
wysihtml5.commands.insertUnorderedList={exec:function(a,d){var i=a.doc,f=a.selection.getSelectedNode(),g=wysihtml5.dom.getParentElement(f,{nodeName:"UL"}),h=wysihtml5.dom.getParentElement(f,{nodeName:"OL"}),c="_wysihtml5-temp-"+new Date().getTime(),e,b;
if(!g&&!h&&a.commands.support(d)){i.execCommand(d,false,null);
return
}if(g){a.selection.executeAndRestore(function(){wysihtml5.dom.resolveList(g,a.config.useLineBreaks)
})
}else{if(h){a.selection.executeAndRestore(function(){wysihtml5.dom.renameElement(h,"ul")
})
}else{a.commands.exec("formatBlock","div",c);
b=i.querySelector("."+c);
e=b.innerHTML===""||b.innerHTML===wysihtml5.INVISIBLE_SPACE||b.innerHTML==="<br>";
a.selection.executeAndRestore(function(){g=wysihtml5.dom.convertToList(b,"ul")
});
if(e){a.selection.selectNode(g.querySelector("li"),true)
}}}},state:function(a){var b=a.selection.getSelectedNode();
return wysihtml5.dom.getParentElement(b,{nodeName:"UL"})
}};
wysihtml5.commands.italic={exec:function(a,b){return wysihtml5.commands.formatInline.exec(a,b,"i")
},state:function(a,b){return wysihtml5.commands.formatInline.state(a,b,"i")
}};
(function(c){var b="wysiwyg-text-align-center",a=/wysiwyg-text-align-[0-9a-z]+/g;
c.commands.justifyCenter={exec:function(d,e){return c.commands.formatBlock.exec(d,"formatBlock",null,b,a)
},state:function(d,e){return c.commands.formatBlock.state(d,"formatBlock",null,b,a)
}}
})(wysihtml5);
(function(c){var b="wysiwyg-text-align-left",a=/wysiwyg-text-align-[0-9a-z]+/g;
c.commands.justifyLeft={exec:function(d,e){return c.commands.formatBlock.exec(d,"formatBlock",null,b,a)
},state:function(d,e){return c.commands.formatBlock.state(d,"formatBlock",null,b,a)
}}
})(wysihtml5);
(function(c){var b="wysiwyg-text-align-right",a=/wysiwyg-text-align-[0-9a-z]+/g;
c.commands.justifyRight={exec:function(d,e){return c.commands.formatBlock.exec(d,"formatBlock",null,b,a)
},state:function(d,e){return c.commands.formatBlock.state(d,"formatBlock",null,b,a)
}}
})(wysihtml5);
(function(c){var b="wysiwyg-text-align-justify",a=/wysiwyg-text-align-[0-9a-z]+/g;
c.commands.justifyFull={exec:function(d,e){return c.commands.formatBlock.exec(d,"formatBlock",null,b,a)
},state:function(d,e){return c.commands.formatBlock.state(d,"formatBlock",null,b,a)
}}
})(wysihtml5);
wysihtml5.commands.redo={exec:function(a){return a.undoManager.redo()
},state:function(a){return false
}};
wysihtml5.commands.underline={exec:function(a,b){return wysihtml5.commands.formatInline.exec(a,b,"u")
},state:function(a,b){return wysihtml5.commands.formatInline.state(a,b,"u")
}};
wysihtml5.commands.undo={exec:function(a){return a.undoManager.undo()
},state:function(a){return false
}};
(function(l){var g=90,j=89,k=8,b=46,a=25,i="data-wysihtml5-selection-node",c="data-wysihtml5-selection-offset",h='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+l.INVISIBLE_SPACE+"</span>",f='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+l.INVISIBLE_SPACE+"</span>",e=l.dom;
function d(n){var m;
while(m=n.querySelector("._wysihtml5-temp")){m.parentNode.removeChild(m)
}}l.UndoManager=l.lang.Dispatcher.extend({constructor:function(m){this.editor=m;
this.composer=m.composer;
this.element=this.composer.element;
this.position=0;
this.historyStr=[];
this.historyDom=[];
this.transact();
this._observe()
},_observe:function(){var p=this,r=this.composer.sandbox.getDocument(),m;
e.observe(this.element,"keydown",function(u){if(u.altKey||(!u.ctrlKey&&!u.metaKey)){return
}var v=u.keyCode,s=v===g&&!u.shiftKey,t=(v===g&&u.shiftKey)||(v===j);
if(s){p.undo();
u.preventDefault()
}else{if(t){p.redo();
u.preventDefault()
}}});
e.observe(this.element,"keydown",function(s){var t=s.keyCode;
if(t===m){return
}m=t;
if(t===k||t===b){p.transact()
}});
if(l.browser.hasUndoInContextMenu()){var n,o,q=function(){d(r);
clearInterval(n)
};
e.observe(this.element,"contextmenu",function(){q();
p.composer.selection.executeAndRestoreSimple(function(){if(p.element.lastChild){p.composer.selection.setAfter(p.element.lastChild)
}r.execCommand("insertHTML",false,h);
r.execCommand("insertHTML",false,f);
r.execCommand("undo",false,null)
});
n=setInterval(function(){if(r.getElementById("_wysihtml5-redo")){q();
p.redo()
}else{if(!r.getElementById("_wysihtml5-undo")){q();
p.undo()
}}},400);
if(!o){o=true;
e.observe(document,"mousedown",q);
e.observe(r,["mousedown","paste","cut","copy"],q)
}})
}this.editor.on("newword:composer",function(){p.transact()
}).on("beforecommand:composer",function(){p.transact()
})
},transact:function(){var u=this.historyStr[this.position-1],o=this.composer.getValue();
if(o===u){return
}var m=this.historyStr.length=this.historyDom.length=this.position;
if(m>a){this.historyStr.shift();
this.historyDom.shift();
this.position--
}this.position++;
var r=this.composer.selection.getRange(),n=r.startContainer||this.element,p=r.startOffset||0,q,s;
if(n.nodeType===l.ELEMENT_NODE){q=n
}else{q=n.parentNode;
s=this.getChildNodeIndex(q,n)
}q.setAttribute(c,p);
if(typeof(s)!=="undefined"){q.setAttribute(i,s)
}var t=this.element.cloneNode(!!o);
this.historyDom.push(t);
this.historyStr.push(o);
q.removeAttribute(c);
q.removeAttribute(i)
},undo:function(){this.transact();
if(!this.undoPossible()){return
}this.set(this.historyDom[--this.position-1]);
this.editor.fire("undo:composer")
},redo:function(){if(!this.redoPossible()){return
}this.set(this.historyDom[++this.position-1]);
this.editor.fire("redo:composer")
},undoPossible:function(){return this.position>1
},redoPossible:function(){return this.position<this.historyStr.length
},set:function(s){this.element.innerHTML="";
var n=0,r=s.childNodes,p=s.childNodes.length;
for(;
n<p;
n++){this.element.appendChild(r[n].cloneNode(true))
}var q,o,m;
if(s.hasAttribute(c)){q=s.getAttribute(c);
m=s.getAttribute(i);
o=this.element
}else{o=this.element.querySelector("["+c+"]")||this.element;
q=o.getAttribute(c);
m=o.getAttribute(i);
o.removeAttribute(c);
o.removeAttribute(i)
}if(m!==null){o=this.getChildNodeByIndex(o,+m)
}this.composer.selection.set(o,q)
},getChildNodeIndex:function(n,q){var m=0,p=n.childNodes,o=p.length;
for(;
m<o;
m++){if(p[m]===q){return m
}}},getChildNodeByIndex:function(n,m){return n.childNodes[m]
}})
})(wysihtml5);
wysihtml5.views.View=Base.extend({constructor:function(b,c,a){this.parent=b;
this.element=c;
this.config=a;
this._observeViewChange()
},_observeViewChange:function(){var a=this;
this.parent.on("beforeload",function(){a.parent.on("change_view",function(b){if(b===a.name){a.parent.currentView=a;
a.show();
setTimeout(function(){a.focus()
},0)
}else{a.hide()
}})
})
},focus:function(){if(this.element.ownerDocument.querySelector(":focus")===this.element){return
}try{this.element.focus()
}catch(a){}},hide:function(){this.element.style.display="none"
},show:function(){this.element.style.display=""
},disable:function(){this.element.setAttribute("disabled","disabled")
},enable:function(){this.element.removeAttribute("disabled")
}});
(function(c){var b=c.dom,a=c.browser;
c.views.Composer=c.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,f,d){this.base(e,f,d);
this.textarea=this.parent.textarea;
this._initSandbox()
},clear:function(){this.element.innerHTML=a.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK
},getValue:function(e){var d=this.isEmpty()?"":c.quirks.getCorrectInnerHTML(this.element);
if(e){d=this.parent.parse(d)
}d=c.lang.string(d).replace(c.INVISIBLE_SPACE).by("");
return d
},setValue:function(d,g){if(g){d=this.parent.parse(d)
}try{this.element.innerHTML=d
}catch(f){this.element.innerText=d
}},show:function(){this.iframe.style.display=this._displayStyle||"";
if(!this.textarea.element.disabled){this.disable();
this.enable()
}},hide:function(){this._displayStyle=b.getStyle("display").from(this.iframe);
if(this._displayStyle==="none"){this._displayStyle=null
}this.iframe.style.display="none"
},disable:function(){this.parent.fire("disable:composer");
this.element.removeAttribute("contentEditable")
},enable:function(){this.parent.fire("enable:composer");
this.element.setAttribute("contentEditable","true")
},focus:function(e){if(c.browser.doesAsyncFocus()&&this.hasPlaceholderSet()){this.clear()
}this.base();
var d=this.element.lastChild;
if(e&&d){if(d.nodeName==="BR"){this.selection.setBefore(this.element.lastChild)
}else{this.selection.setAfter(this.element.lastChild)
}}},getTextContent:function(){return b.getTextContent(this.element)
},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")&&this.placeholderSet
},isEmpty:function(){var d=this.element.innerHTML.toLowerCase();
return d===""||d==="<br>"||d==="<p></p>"||d==="<p><br></p>"||this.hasPlaceholderSet()
},_initSandbox:function(){var e=this;
this.sandbox=new b.Sandbox(function(){e._create()
},{iframeSrc:this.config.iframeSrc,stylesheets:this.config.stylesheets});
this.iframe=this.sandbox.getIframe();
var f=this.textarea.element;
b.insert(this.iframe).after(f);
if(f.form){var d=document.createElement("input");
d.type="hidden";
d.name="_wysihtml5_mode";
d.value=1;
b.insert(d).after(f)
}},_create:function(){var f=this;
this.doc=this.sandbox.getDocument();
this.element=this.doc.body;
this.textarea=this.parent.textarea;
this.element.innerHTML=this.textarea.getValue(true);
this.selection=new c.Selection(this.parent);
this.commands=new c.Commands(this.parent);
b.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element);
b.addClass(this.element,this.config.composerClassName);
if(this.config.style){this.style()
}this.observe();
var e=this.config.name;
if(e){b.addClass(this.element,e);
b.addClass(this.iframe,e)
}this.enable();
if(this.textarea.element.disabled){this.disable()
}var d=typeof(this.config.placeholder)==="string"?this.config.placeholder:this.textarea.element.getAttribute("placeholder");
if(d){b.simulatePlaceholder(this.parent,this,d)
}this.commands.exec("styleWithCSS",false);
this._initAutoLinking();
this._initObjectResizing();
this._initUndoManager();
this._initLineBreaking();
if((this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element)&&!a.isIos()){setTimeout(function(){f.focus(true)
},100)
}if(!a.clearsContentEditableCorrectly()){c.quirks.ensureProperClearing(this)
}if(this.initSync&&this.config.sync){this.initSync()
}this.textarea.hide();
this.parent.fire("beforeload").fire("load")
},_initAutoLinking:function(){var h=this,e=a.canDisableAutoLinking(),f=a.doesAutoLinkingInContentEditable();
if(e){this.commands.exec("autoUrlDetect",false)
}if(!this.config.autoLink){return
}if(!f||(f&&e)){this.parent.on("newword:composer",function(){if(b.getTextContent(h.element).match(b.autoLink.URL_REG_EXP)){h.selection.executeAndRestore(function(j,k){b.autoLink(k.parentNode)
})
}});
b.observe(this.element,"blur",function(){b.autoLink(h.element)
})
}var d=this.sandbox.getDocument().getElementsByTagName("a"),i=b.autoLink.URL_REG_EXP,g=function(j){var k=c.lang.string(b.getTextContent(j)).trim();
if(k.substr(0,4)==="www."){k="http://"+k
}return k
};
b.observe(this.element,"keydown",function(l){if(!d.length){return
}var m=h.selection.getSelectedNode(l.target.ownerDocument),k=b.getParentElement(m,{nodeName:"A"},4),j;
if(!k){return
}j=g(k);
setTimeout(function(){var n=g(k);
if(n===j){return
}if(n.match(i)){k.setAttribute("href",n)
}},0)
})
},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",true);
if(a.supportsEvent("resizeend")){var f=["width","height"],e=f.length,d=this.element;
b.observe(d,"resizeend",function(j){var l=j.target||j.srcElement,h=l.style,g=0,k;
if(l.nodeName!=="IMG"){return
}for(;
g<e;
g++){k=f[g];
if(h[k]){l.setAttribute(k,parseInt(h[k],10));
h[k]=""
}}c.quirks.redraw(d)
})
}},_initUndoManager:function(){this.undoManager=new c.UndoManager(this.parent)
},_initLineBreaking:function(){var f=this,e=["LI","P","H1","H2","H3","H4","H5","H6"],d=["UL","OL","MENU"];
function g(i){var h=b.getParentElement(i,{nodeName:["P","DIV"]},2);
if(h){f.selection.executeAndRestore(function(){if(f.config.useLineBreaks){b.replaceWithChildNodes(h)
}else{if(h.nodeName!=="P"){b.renameElement(h,"p")
}}})
}}if(!this.config.useLineBreaks){b.observe(this.element,["focus","keydown"],function(){if(f.isEmpty()){var h=f.doc.createElement("P");
f.element.innerHTML="";
f.element.appendChild(h);
if(!a.displaysCaretInEmptyContentEditableCorrectly()){h.innerHTML="<br>";
f.selection.setBefore(h.firstChild)
}else{f.selection.selectNode(h,true)
}}})
}b.observe(this.doc,"keydown",function(h){var i=h.keyCode;
if(h.shiftKey){return
}if(i!==c.ENTER_KEY&&i!==c.BACKSPACE_KEY){return
}var j=b.getParentElement(f.selection.getSelectedNode(),{nodeName:e},4);
if(j){setTimeout(function(){var l=f.selection.getSelectedNode(),k;
if(j.nodeName==="LI"){if(!l){return
}k=b.getParentElement(l,{nodeName:d},2);
if(!k){g(l)
}}if(i===c.ENTER_KEY&&j.nodeName.match(/^H[1-6]$/)){g(l)
}},0);
return
}if(f.config.useLineBreaks&&i===c.ENTER_KEY&&!c.browser.insertsLineBreaksOnReturn()){f.commands.exec("insertLineBreak");
h.preventDefault()
}})
}})
})(wysihtml5);
(function(i){var a=i.dom,e=document,c=window,d=e.createElement("div"),b=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],g=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],f=["body > *:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",i.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"];
var h=function(l){if(l.setActive){try{l.setActive()
}catch(n){}}else{var m=l.style,o=e.documentElement.scrollTop||e.body.scrollTop,k=e.documentElement.scrollLeft||e.body.scrollLeft,j={position:m.position,top:m.top,left:m.left,WebkitUserSelect:m.WebkitUserSelect};
a.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(l);
l.focus();
a.setStyles(j).on(l);
if(c.scrollTo){c.scrollTo(k,o)
}}};
i.views.Composer.prototype.style=function(){var n=this,m=e.querySelector(":focus"),q=this.textarea.element,j=q.hasAttribute("placeholder"),o=j&&q.getAttribute("placeholder"),k=q.style.display,p=q.disabled;
this.focusStylesHost=d.cloneNode(false);
this.blurStylesHost=d.cloneNode(false);
this.disabledStylesHost=d.cloneNode(false);
if(j){q.removeAttribute("placeholder")
}if(q===m){q.blur()
}q.disabled=false;
q.style.display="none";
a.copyStyles(g).from(q).to(this.iframe).andTo(this.blurStylesHost);
a.copyStyles(b).from(q).to(this.element).andTo(this.blurStylesHost);
a.insertCSS(f).into(this.element.ownerDocument);
q.disabled=true;
a.copyStyles(g).from(q).to(this.disabledStylesHost);
a.copyStyles(b).from(q).to(this.disabledStylesHost);
q.disabled=p;
h(q);
a.copyStyles(g).from(q).to(this.focusStylesHost);
a.copyStyles(b).from(q).to(this.focusStylesHost);
q.style.display=k;
a.copyStyles(["display"]).from(q).to(this.iframe);
var l=i.lang.array(g).without(["display"]);
if(m){m.focus()
}else{q.blur()
}if(j){q.setAttribute("placeholder",o)
}this.parent.on("focus:composer",function(){a.copyStyles(l).from(n.focusStylesHost).to(n.iframe);
a.copyStyles(b).from(n.focusStylesHost).to(n.element)
});
this.parent.on("blur:composer",function(){a.copyStyles(l).from(n.blurStylesHost).to(n.iframe);
a.copyStyles(b).from(n.blurStylesHost).to(n.element)
});
this.parent.observe("disable:composer",function(){a.copyStyles(l).from(n.disabledStylesHost).to(n.iframe);
a.copyStyles(b).from(n.disabledStylesHost).to(n.element)
});
this.parent.observe("enable:composer",function(){a.copyStyles(l).from(n.blurStylesHost).to(n.iframe);
a.copyStyles(b).from(n.blurStylesHost).to(n.element)
});
return this
}
})(wysihtml5);
(function(d){var c=d.dom,b=d.browser,a={"66":"bold","73":"italic","85":"underline"};
d.views.Composer.prototype.observe=function(){var i=this,k=this.getValue(),h=this.sandbox.getIframe(),g=this.element,f=b.supportsEventsInIframeCorrectly()?g:this.sandbox.getWindow(),e=["drop","paste"];
c.observe(h,"DOMNodeRemoved",function(){clearInterval(j);
i.parent.fire("destroy:composer")
});
var j=setInterval(function(){if(!c.contains(document.documentElement,h)){clearInterval(j);
i.parent.fire("destroy:composer")
}},250);
c.observe(f,"focus",function(){i.parent.fire("focus").fire("focus:composer");
setTimeout(function(){k=i.getValue()
},0)
});
c.observe(f,"blur",function(){if(k!==i.getValue()){i.parent.fire("change").fire("change:composer")
}i.parent.fire("blur").fire("blur:composer")
});
c.observe(g,"dragenter",function(){i.parent.fire("unset_placeholder")
});
c.observe(g,e,function(){setTimeout(function(){i.parent.fire("paste").fire("paste:composer")
},0)
});
c.observe(g,"keyup",function(m){var n=m.keyCode;
if(n===d.SPACE_KEY||n===d.ENTER_KEY){i.parent.fire("newword:composer")
}});
this.parent.on("paste:composer",function(){setTimeout(function(){i.parent.fire("newword:composer")
},0)
});
if(!b.canSelectImagesInContentEditable()){c.observe(g,"mousedown",function(m){var n=m.target;
if(n.nodeName==="IMG"){i.selection.selectNode(n);
m.preventDefault()
}})
}if(b.hasHistoryIssue()&&b.supportsSelectionModify()){c.observe(g,"keydown",function(n){if(!n.metaKey&&!n.ctrlKey){return
}var p=n.keyCode,o=g.ownerDocument.defaultView,m=o.getSelection();
if(p===37||p===39){if(p===37){m.modify("extend","left","lineboundary");
if(!n.shiftKey){m.collapseToStart()
}}if(p===39){m.modify("extend","right","lineboundary");
if(!n.shiftKey){m.collapseToEnd()
}}n.preventDefault()
}})
}c.observe(g,"keydown",function(m){var n=m.keyCode,o=a[n];
if((m.ctrlKey||m.metaKey)&&!m.altKey&&o){i.commands.exec(o);
m.preventDefault()
}});
c.observe(g,"keydown",function(n){var p=i.selection.getSelectedNode(true),o=n.keyCode,m;
if(p&&p.nodeName==="IMG"&&(o===d.BACKSPACE_KEY||o===d.DELETE_KEY)){m=p.parentNode;
m.removeChild(p);
if(m.nodeName==="A"&&!m.firstChild){m.parentNode.removeChild(m)
}setTimeout(function(){d.quirks.redraw(g)
},0);
n.preventDefault()
}});
if(b.hasIframeFocusIssue()){c.observe(this.iframe,"focus",function(){setTimeout(function(){if(i.doc.querySelector(":focus")!==i.element){i.focus()
}},0)
});
c.observe(this.element,"blur",function(){setTimeout(function(){i.selection.getSelection().removeAllRanges()
},0)
})
}var l={IMG:"Image: ",A:"Link: "};
c.observe(g,"mouseover",function(n){var o=n.target,q=o.nodeName,p;
if(q!=="A"&&q!=="IMG"){return
}var m=o.hasAttribute("title");
if(!m){p=l[q]+(o.getAttribute("href")||o.getAttribute("src"));
o.setAttribute("title",p)
}})
}
})(wysihtml5);
(function(b){var a=400;
b.views.Synchronizer=Base.extend({constructor:function(e,c,d){this.editor=e;
this.textarea=c;
this.composer=d;
this._observe()
},fromComposerToTextarea:function(c){this.textarea.setValue(b.lang.string(this.composer.getValue()).trim(),c)
},fromTextareaToComposer:function(d){var c=this.textarea.getValue();
if(c){this.composer.setValue(c,d)
}else{this.composer.clear();
this.editor.fire("set_placeholder")
}},sync:function(c){if(this.editor.currentView.name==="textarea"){this.fromTextareaToComposer(c)
}else{this.fromComposerToTextarea(c)
}},_observe:function(){var c,e=this,d=this.textarea.element.form,g=function(){c=setInterval(function(){e.fromComposerToTextarea()
},a)
},f=function(){clearInterval(c);
c=null
};
g();
if(d){b.dom.observe(d,"submit",function(){e.sync(true)
});
b.dom.observe(d,"reset",function(){setTimeout(function(){e.fromTextareaToComposer()
},0)
})
}this.editor.on("change_view",function(h){if(h==="composer"&&!c){e.fromTextareaToComposer(true);
g()
}else{if(h==="textarea"){e.fromComposerToTextarea(true);
f()
}}});
this.editor.on("destroy:composer",f)
}})
})(wysihtml5);
wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(b,c,a){this.base(b,c,a);
this._observe()
},clear:function(){this.element.value=""
},getValue:function(b){var a=this.isEmpty()?"":this.element.value;
if(b){a=this.parent.parse(a)
}return a
},setValue:function(a,b){if(b){a=this.parent.parse(a)
}this.element.value=a
},hasPlaceholderSet:function(){var d=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),a=this.element.getAttribute("placeholder")||null,b=this.element.value,c=!b;
return(d&&c)||(b===a)
},isEmpty:function(){return !wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()
},_observe:function(){var c=this.element,d=this.parent,a={focusin:"focus",focusout:"blur"},b=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];
d.on("beforeload",function(){wysihtml5.dom.observe(c,b,function(f){var e=a[f.type]||f.type;
d.fire(e).fire(e+":textarea")
});
wysihtml5.dom.observe(c,["paste","drop"],function(){setTimeout(function(){d.fire("paste").fire("paste:textarea")
},0)
})
})
}});
(function(f){var e=f.dom,a="wysihtml5-command-dialog-opened",d="input, select, textarea",b="[data-wysihtml5-dialog-field]",c="data-wysihtml5-dialog-field";
f.toolbar.Dialog=f.lang.Dispatcher.extend({constructor:function(h,g){this.link=h;
this.container=g
},_observe:function(){if(this._observed){return
}var k=this,l=function(n){var i=k._serialize();
if(i==k.elementToChange){k.fire("edit",i)
}else{k.fire("save",i)
}k.hide();
n.preventDefault();
n.stopPropagation()
};
e.observe(k.link,"click",function(){if(e.hasClass(k.link,a)){setTimeout(function(){k.hide()
},0)
}});
e.observe(this.container,"keydown",function(i){var n=i.keyCode;
if(n===f.ENTER_KEY){l(i)
}if(n===f.ESCAPE_KEY){k.hide()
}});
e.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",l);
e.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(i){k.fire("cancel");
k.hide();
i.preventDefault();
i.stopPropagation()
});
var h=this.container.querySelectorAll(d),g=0,j=h.length,m=function(){clearInterval(k.interval)
};
for(;
g<j;
g++){e.observe(h[g],"change",m)
}this._observed=true
},_serialize:function(){var k=this.elementToChange||{},g=this.container.querySelectorAll(b),j=g.length,h=0;
for(;
h<j;
h++){k[g[h].getAttribute(c)]=g[h].value;
if(k.setAttribute){k.setAttribute(g[h].getAttribute(c),g[h].value)
}}return k
},_interpolate:function(m){var l,o,k,n=document.querySelector(":focus"),g=this.container.querySelectorAll(b),j=g.length,h=0;
for(;
h<j;
h++){l=g[h];
if(l===n){continue
}if(m&&l.type==="hidden"){continue
}o=l.getAttribute(c);
k=this.elementToChange?(this.elementToChange.getAttribute(o)||""):l.defaultValue;
l.value=k
}},show:function(j){if(e.hasClass(this.link,a)){return
}var h=this,g=this.container.querySelector(d);
this.elementToChange=j;
this._observe();
this._interpolate();
if(j){this.interval=setInterval(function(){h._interpolate(true)
},500)
}e.addClass(this.link,a);
this.container.style.display="";
this.fire("show");
if(g&&!j){try{g.focus()
}catch(i){}}},hide:function(){clearInterval(this.interval);
this.elementToChange=null;
e.removeClass(this.link,a);
this.container.style.display="none";
this.fire("hide")
}})
})(wysihtml5);
(function(f){var e=f.dom;
var d={position:"relative"};
var c={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1};
var b={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"};
var a={"x-webkit-speech":"",speech:""};
f.toolbar.Speech=function(i,j){var h=document.createElement("input");
if(!f.browser.supportsSpeechApiOn(h)){j.style.display="none";
return
}var k=i.editor.textarea.element.getAttribute("lang");
if(k){a.lang=k
}var l=document.createElement("div");
f.lang.object(c).merge({width:j.offsetWidth+"px",height:j.offsetHeight+"px"});
e.insert(h).into(l);
e.insert(l).into(j);
e.setStyles(b).on(h);
e.setAttributes(a).on(h);
e.setStyles(c).on(l);
e.setStyles(d).on(j);
var g="onwebkitspeechchange" in h?"webkitspeechchange":"speechchange";
e.observe(h,g,function(){i.execCommand("insertText",h.value);
h.value=""
});
e.observe(h,"click",function(m){if(e.hasClass(j,"wysihtml5-command-disabled")){m.preventDefault()
}m.stopPropagation()
})
}
})(wysihtml5);
(function(f){var a="wysihtml5-command-disabled",b="wysihtml5-commands-disabled",c="wysihtml5-command-active",d="wysihtml5-action-active",e=f.dom;
f.toolbar.Toolbar=Base.extend({constructor:function(k,g){this.editor=k;
this.container=typeof(g)==="string"?document.getElementById(g):g;
this.composer=k.composer;
this._getLinks("command");
this._getLinks("action");
this._observe();
this.show();
var h=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),l=h.length,j=0;
for(;
j<l;
j++){new f.toolbar.Speech(this,h[j])
}},_getLinks:function(m){var q=this[m+"Links"]=f.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+m+"]")).get(),j=q.length,k=0,g=this[m+"Mapping"]={},n,p,h,o,l;
for(;
k<j;
k++){n=q[k];
h=n.getAttribute("data-wysihtml5-"+m);
o=n.getAttribute("data-wysihtml5-"+m+"-value");
p=this.container.querySelector("[data-wysihtml5-"+m+"-group='"+h+"']");
l=this._getDialog(n,h);
g[h+":"+o]={link:n,group:p,name:h,value:o,dialog:l,state:false}
}},_getDialog:function(k,l){var j=this,i=this.container.querySelector("[data-wysihtml5-dialog='"+l+"']"),h,g;
if(i){h=new f.toolbar.Dialog(k,i);
h.on("show",function(){g=j.composer.selection.getBookmark();
j.editor.fire("show:dialog",{command:l,dialogContainer:i,commandLink:k})
});
h.on("save",function(m){if(g){j.composer.selection.setBookmark(g)
}j._execCommand(l,m);
j.editor.fire("save:dialog",{command:l,dialogContainer:i,commandLink:k})
});
h.on("cancel",function(){j.editor.focus(false);
j.editor.fire("cancel:dialog",{command:l,dialogContainer:i,commandLink:k})
})
}return h
},execCommand:function(i,g){if(this.commandsDisabled){return
}var h=this.commandMapping[i+":"+g];
if(h&&h.dialog&&!h.state){h.dialog.show()
}else{this._execCommand(i,g)
}},_execCommand:function(h,g){this.editor.focus(false);
this.composer.commands.exec(h,g);
this._updateLinkStates()
},execAction:function(h){var g=this.editor;
if(h==="change_view"){if(g.currentView===g.textarea){g.fire("change_view","composer")
}else{g.fire("change_view","textarea")
}}},_observe:function(){var m=this,k=this.editor,g=this.container,h=this.commandLinks.concat(this.actionLinks),l=h.length,j=0;
for(;
j<l;
j++){e.setAttributes({href:"javascript:;",unselectable:"on"}).on(h[j])
}e.delegate(g,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(i){i.preventDefault()
});
e.delegate(g,"[data-wysihtml5-command]","click",function(o){var n=this,p=n.getAttribute("data-wysihtml5-command"),i=n.getAttribute("data-wysihtml5-command-value");
m.execCommand(p,i);
o.preventDefault()
});
e.delegate(g,"[data-wysihtml5-action]","click",function(i){var n=this.getAttribute("data-wysihtml5-action");
m.execAction(n);
i.preventDefault()
});
k.on("focus:composer",function(){m.bookmark=null;
clearInterval(m.interval);
m.interval=setInterval(function(){m._updateLinkStates()
},500)
});
k.on("blur:composer",function(){clearInterval(m.interval)
});
k.on("destroy:composer",function(){clearInterval(m.interval)
});
k.on("change_view",function(i){setTimeout(function(){m.commandsDisabled=(i!=="composer");
m._updateLinkStates();
if(m.commandsDisabled){e.addClass(g,b)
}else{e.removeClass(g,b)
}},0)
})
},_updateLinkStates:function(){var h=this.commandMapping,l=this.actionMapping,g,k,j,m;
for(g in h){m=h[g];
if(this.commandsDisabled){k=false;
e.removeClass(m.link,c);
if(m.group){e.removeClass(m.group,c)
}if(m.dialog){m.dialog.hide()
}}else{k=this.composer.commands.state(m.name,m.value);
if(f.lang.object(k).isArray()){k=k.length===1?k[0]:true
}e.removeClass(m.link,a);
if(m.group){e.removeClass(m.group,a)
}}if(m.state===k){continue
}m.state=k;
if(k){e.addClass(m.link,c);
if(m.group){e.addClass(m.group,c)
}if(m.dialog){if(typeof(k)==="object"){m.dialog.show(k)
}else{m.dialog.hide()
}}}else{e.removeClass(m.link,c);
if(m.group){e.removeClass(m.group,c)
}if(m.dialog){m.dialog.hide()
}}}for(g in l){j=l[g];
if(j.name==="change_view"){j.state=this.editor.currentView===this.editor.textarea;
if(j.state){e.addClass(j.link,d)
}else{e.removeClass(j.link,d)
}}}},show:function(){this.container.style.display=""
},hide:function(){this.container.style.display="none"
}})
})(wysihtml5);
(function(c){var b;
var a={name:b,style:true,toolbar:b,autoLink:true,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:c.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:true,stylesheets:[],placeholderText:b,supportTouchDevices:true};
c.Editor=c.lang.Dispatcher.extend({constructor:function(f,d){this.textareaElement=typeof(f)==="string"?document.getElementById(f):f;
this.config=c.lang.object({}).merge(a).merge(d).get();
this.textarea=new c.views.Textarea(this,this.textareaElement,this.config);
this.currentView=this.textarea;
this._isCompatible=c.browser.supported();
if(!this._isCompatible||(!this.config.supportTouchDevices&&c.browser.isTouchDevice())){var e=this;
setTimeout(function(){e.fire("beforeload").fire("load")
},0);
return
}c.dom.addClass(document.body,this.config.bodyClassName);
this.composer=new c.views.Composer(this,this.textareaElement,this.config);
this.currentView=this.composer;
if(typeof(this.config.parser)==="function"){this._initParser()
}this.on("beforeload",function(){this.synchronizer=new c.views.Synchronizer(this,this.textarea,this.composer);
if(this.config.toolbar){this.toolbar=new c.toolbar.Toolbar(this,this.config.toolbar)
}})
},isCompatible:function(){return this._isCompatible
},clear:function(){this.currentView.clear();
return this
},getValue:function(d){return this.currentView.getValue(d)
},setValue:function(d,e){this.fire("unset_placeholder");
if(!d){return this.clear()
}this.currentView.setValue(d,e);
return this
},focus:function(d){this.currentView.focus(d);
return this
},disable:function(){this.currentView.disable();
return this
},enable:function(){this.currentView.enable();
return this
},isEmpty:function(){return this.currentView.isEmpty()
},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()
},parse:function(d){var e=this.config.parser(d,this.config.parserRules,this.composer.sandbox.getDocument(),true);
if(typeof(d)==="object"){c.quirks.redraw(d)
}return e
},_initParser:function(){this.on("paste:composer",function(){var d=true,e=this;
e.composer.selection.executeAndRestore(function(){c.quirks.cleanPastedHTML(e.composer.element);
e.parse(e.composer.element)
},d)
})
}})
})(wysihtml5);(function(g,h,e){var c=g(h),m=h.document;
g.each(CSS_CLASS_GROUPS,function(){var s="cms-"+this.internalName;
var r=s+"-";
var q=new RegExp(r+"[0-9a-z-]+","g");
wysihtml5.commands[s]={exec:function(v,y,x){var u=x?g.parseJSON(x):{};
var t=u.tag||"span";
var w=t==="span"?"formatInline":"formatBlock";
return wysihtml5.commands[w].exec(v,y,t,r+u.internalName,q)
},state:function(v,y,x){var u=x?g.parseJSON(x):{};
var t=u.tag||"span";
var w=t==="span"?"formatInline":"formatBlock";
return wysihtml5.commands[w].state(v,y,t,r+u.internalName,q)
}}
});
var d=function(s){var t=g("<span/>",{"class":"rte-group","data-group-name":s});
var q=g("<span/>",{"class":"rte-group-label",text:s});
var r=g("<span/>",{"class":"rte-group-buttons"});
t.append(q);
t.append(r);
return t
};
var b=function(q,r){return g("<span/>",{"class":"rte-button rte-button-"+r,"data-wysihtml5-command":r,text:q})
};
var i=function(u){var x=g("<div/>",{"class":"rte-toolbar-container"});
var r=g("<div/>",{"class":"rte-toolbar"});
x.append(r);
var w=d("Font");
r.append(w);
w=w.find(".rte-group-buttons");
w.append(b("Bold","bold"));
w.append(b("Italic","italic"));
w.append(b("Underline","underline"));
w.append(b("Strike","strike"));
w.append(b("Superscript","superscript"));
w.append(b("Subscript","subscript"));
g.each(CSS_CLASS_GROUPS,function(){var y=d(this.displayName);
var z="cms-"+this.internalName;
if(this.dropDown){y.addClass("rte-group-dropDown")
}y.addClass("rte-group-cssClass");
y.addClass("rte-group-cssClass-"+this.internalName);
r.append(y);
y=y.find(".rte-group-buttons");
g.each(this.cssClasses,function(){var A=b(this.displayName,z);
A.attr("data-wysihtml5-command-value",JSON.stringify(this));
y.append(A)
})
});
if(!u){var t=d("Alignment");
r.append(t);
t=t.find(".rte-group-buttons");
t.append(b("Justify Left","textAlign").attr("data-wysihtml5-command-value","left"));
t.append(b("Justify Center","textAlign").attr("data-wysihtml5-command-value","center"));
t.append(b("Justify Right","textAlign").attr("data-wysihtml5-command-value","right"));
var q=d("List");
r.append(q);
q=q.find(".rte-group-buttons");
q.append(b("Unordered List","insertUnorderedList"));
q.append(b("Ordered List","insertOrderedList"));
q.append(b("Decrease Indent","outdent"));
q.append(b("Increase Insent","indent"))
}var v=d("Enhancement");
r.append(v);
v=v.find(".rte-group-buttons");
v.append(b("Link","createLink"));
if(!u){v.append(b("Add Enhancement","insertEnhancement"));
v.append(b("Add Marker","insertMarker"))
}var s=d("Misc");
r.append(s);
s=s.find(".rte-group-buttons");
s.append(g("<span/>",{"class":"rte-button rte-button-html","data-wysihtml5-action":"change_view",text:"HTML"}));
r.append(g('<div class="rte-dialog" data-wysihtml5-dialog="createLink" style="display: none;"> <label>URL: <input type="text" data-wysihtml5-dialog-field="href" value="http://"></label> <label>Window: <select data-wysihtml5-dialog-field="target"><option value="_self">Same</option><option value="_blank">New</option></select></label> <a data-wysihtml5-dialog-action="save">OK</a> <a data-wysihtml5-dialog-action="cancel">Cancel</a></div>'));
return x[0]
};
var p=function(q,r){return g("<span/>",{"class":"rte-button rte-button-"+r,"data-action":r,text:q})
};
var k=function(){var t=g("<div/>",{"class":"rte-enhancement"});
var q=g("<div/>",{"class":"rte-toolbar"});
t.append(q);
var s=d("Position");
q.append(s);
s.append(p("Move Left","moveLeft"));
s.append(p("Move Up","moveUp"));
s.append(p("Move Center","moveCenter"));
s.append(p("Move Down","moveDown"));
s.append(p("Move Right","moveRight"));
var r=d("Misc");
q.append(r);
r.append(g("<span/>",{"class":"rte-button rte-button-editEnhancement",html:g("<a/>",{href:CONTEXT_PATH+"/content/enhancement.jsp?id=",target:"contentEnhancement",text:"Edit"})}));
r.append(p("Remove","remove"));
t.append(g("<div/>",{"class":"rte-enhancement-label"}));
return t[0]
};
var l=function(){var r=g("<div/>",{"class":"rte-enhancement rte-marker"});
var q=g("<div/>",{"class":"rte-toolbar"});
r.append(q);
var t=d("Position");
q.append(t);
t.append(p("Move Up","moveUp"));
t.append(p("Move Down","moveDown"));
var s=d("Misc");
q.append(s);
s.append(g("<span/>",{"class":"rte-button rte-button-selectMarker",html:g("<a/>",{href:CONTEXT_PATH+"/content/marker.jsp",target:"contentEnhancement",text:"Select"})}));
s.append(p("Remove","remove"));
r.append(g("<div/>",{"class":"rte-enhancement-label"}));
return r[0]
};
var f=[];
var j=0;
var n=function(){++j;
return j
};
var a=wysihtml5.Editor.extend({constructor:function(u,s){var t=this;
var q=this.container=m.createElement("div");
q.className="rte-container";
u.parentNode.insertBefore(q,u);
if(typeof s.toolbar==="function"){s.toolbar=s.toolbar(s.useLineBreaks);
q.appendChild(s.toolbar)
}var r=this.overlay=m.createElement("div");
r.className="rte-overlay";
r.style.position="relative";
r.style.left="0px";
r.style.top="0px";
q.appendChild(r);
g(r).delegate("[data-action]","click",function(){var y=g(this);
var w=y.closest(".rte-enhancement").data("$rte-placeholder");
var x=y.attr("data-action");
if(x=="remove"){w.remove()
}else{if(x==="moveCenter"){w.removeAttr("data-alignment")
}else{if(x==="moveLeft"){w.attr("data-alignment","left")
}else{if(x==="moveRight"){w.attr("data-alignment","right")
}else{var v=w.offset().top;
if(x==="moveDown"){w.parents().andSelf().filter("body > *").next().after(w);
c.scrollTop(c.scrollTop()+w.offset().top-v)
}else{if(x==="moveUp"){w.parents().andSelf().filter("body > *").prev().before(w);
c.scrollTop(c.scrollTop()+w.offset().top-v)
}}}}}}t.updateOverlay();
return false
});
q.appendChild(u);
u.className+=" rte-textarea";
f[f.length]=this;
this.base(u,s);
this.observe("load",function(){var y=function(J,C,D,L){var M=J.childNodes;
if(J.childNodes){var K=M.length;
for(var F=0;
F<K;
++F){var B=M[F];
if(B&&B.tagName&&B.tagName===C&&wysihtml5.dom.hasClass(B,"enhancement")){var I=J.ownerDocument.createElement(D);
var H=B.attributes;
var G=H.length;
for(var E=0;
E<G;
++E){var A=H[E];
I.setAttribute(A.name,A.value)
}if(L){L(I)
}J.insertBefore(I,B);
J.removeChild(B)
}else{y(B,C,D,L)
}}}};
var v=this.textarea;
var z;
if(s.useLineBreaks&&!g(v.element).val()){g(v.element).val("<br>")
}v._originalGetValue=v.getValue;
v.getValue=function(C){var A=this._originalGetValue(C),B;
if(z===A){return A
}else{z=A;
B=wysihtml5.dom.getAsDom(A,this.element.ownerDocument);
y(B,"SPAN","BUTTON");
return B.innerHTML
}};
var x=this.composer;
var w;
x._originalGetValue=x.getValue;
x.getValue=function(B){var A=this._originalGetValue(B);
if(w===A){return A
}else{w=A;
dom=wysihtml5.dom.getAsDom(A,this.element.ownerDocument);
y(dom,"BUTTON","SPAN",function(C){C.innerHTML="Enhancement"
});
return dom.innerHTML
}};
x.setValue(v.getValue());
x.iframe.style.overflow="hidden";
x.iframe.contentDocument.body.style.overflow="hidden";
x.iframe.contentDocument.body.className+=" rte-loaded";
v.element.className+=" rte-source";
if(this!==f[0]){this.toolbar.hide()
}this.on("focus",function(){g(v.element).parentsUntil("form").addClass("state-focus");
g(v.element).trigger("input");
for(var A=0,B=f.length;
A<B;
++A){f[A].toolbar.hide()
}this.toolbar.show()
});
this.on("blur",function(){g(v.element).parentsUntil("form").removeClass("state-focus")
});
g(x.element).bind("keyup",function(){g(v.element).trigger("input")
});
setInterval(function(){t.updateOverlay()
},100)
})
},updateOverlay:function(){var u=this;
var r=this.textarea;
var t=this.overlay;
t.style.display=this.currentView===r?"none":"block";
var s=this.composer;
var v=s.iframe;
var w=v.contentWindow;
g(v).css("min-height",g(w.document.body).height()+(u.config.useLineBreaks?10:40));
g(w).scrollTop(0);
var q=g(t);
q.children().each(function(){g(this).data("rte-visited",false)
});
g(v.contentDocument.body).find("button.enhancement").each(function(){var z=g(this);
var E=z.data("rte-enhancementId");
if(!E){E=n();
z.data("rte-enhancementId",E)
}var D=g("#rte-enhancement-"+E);
var C=wysihtml5.dom.hasClass(z[0],"marker");
if(D.length===0){var y=u.config[C?"marker":"enhancement"]();
y.style.position="absolute";
y.setAttribute("id","rte-enhancement-"+E);
D=g(y);
D.data("$rte-placeholder",z);
q.append(D);
D.find(".rte-button-editEnhancement a").each(function(){var G=g(this),F=G.attr("href");
F=F.replace(/([?&])id=[^&]*/,"$1");
F+="&id="+z.attr("data-id");
G.attr("href",F)
})
}D.data("rte-visited",true);
var A=z.offset();
D.css({height:z.outerHeight(),left:A.left,top:A.top,width:z.outerWidth()});
var x=D.find(".rte-enhancement-label");
var B=z.attr("data-preview");
if(B){x.html(g("<figure/>",{html:g("<img/>",{src:B})}))
}else{x.text(z.attr("data-label")||"Empty "+(C?"Marker":"Enhancement"))
}});
q.children().each(function(){var x=g(this);
if(!x.data("rte-visited")){x.remove()
}})
}});
wysihtml5.commands.strike={exec:function(q,r){return wysihtml5.commands.formatInline.exec(q,r,"strike")
},state:function(q,r){return wysihtml5.commands.formatInline.state(q,r,"strike")
}};
var o=/cms-textAlign-[0-9a-z\-]+/g;
wysihtml5.commands.textAlign={exec:function(q,r,s){return wysihtml5.commands.formatBlock.exec(q,r,null,"cms-textAlign-"+s,o)
},state:function(q,r,s){return wysihtml5.commands.formatBlock.state(q,r,null,"cms-textAlign-"+s,o)
}};
delete wysihtml5.commands.insertImage;
wysihtml5.commands.insertEnhancement={exec:function(q,v,t){var u=q.doc;
var s=u.createElement("BUTTON");
if(t){for(var r in t){s.setAttribute(r,t[r])
}}s.setAttribute("class","enhancement");
g(q.selection.getSelectedNode()).closest("body > *").before(s)
},state:function(q){return false
}};
wysihtml5.commands.insertMarker={exec:function(q,v,t){var u=q.doc;
var s=u.createElement("BUTTON");
if(t){for(var r in t){s.setAttribute(r,t[r])
}}s.setAttribute("class","enhancement marker");
g(q.selection.getSelectedNode()).closest("body > *").before(s)
},state:function(q){return false
}};
g.plugin2("rte",{_defaultOptions:{enhancement:k,iframeSrc:CONTEXT_PATH+"/style/rte-content.jsp",marker:l,style:false,toolbar:i,useLineBreaks:false},_create:function(r){var q=g.extend(true,{},this.option());
if(g(r).attr("data-use-line-breaks")){q.useLineBreaks=true
}new a(r,q)
},enable:function(){var q=this[0];
if(q){g.each(f,function(){var r=this.textareaElement;
if(r&&g.contains(q,r)){this.enable()
}})
}return this
},enhancement:function(s){var t=this.$caller.closest(".rte-enhancement");
var r=t.data("$rte-placeholder");
if(r){g.each(s,function(v,w){var u="data-"+v;
if(w===null||w===e){r.removeAttr(u)
}else{r.attr(u,w)
}})
}var q=s.label;
if(q){t.find(".rte-enhancement-label").text(q)
}return this
}});
c.bind("resize.rte scroll.rte",g.throttle(100,function(){g.each(f,function(){var s=g(this.config.toolbar),q,r,v,u,t;
if(!s.is(":visible")){return
}if(s.closest(".rte-container").length===0){return
}q=g(".toolHeader");
r=q.offset().top+q.outerHeight()-(q.css("position")==="fixed"?c.scrollTop():0);
v=g(this.container);
u=v.offset().top;
t=c.scrollTop()+r;
if(t<u){v.css("padding-top",0);
s.removeClass("rte-toolbar-fixed");
s.attr("style",this._toolbarOldStyle);
this._toolbarOldStyle=null
}else{this._toolbarOldStyle=this._toolbarOldStyle||s.attr("style")||" ";
if(t<u+v.height()){v.css("padding-top",s.outerHeight());
s.addClass("rte-toolbarContainer-fixed");
s.css({left:s.offset().left,position:"fixed",top:r,width:s.width()})
}else{s.addClass("rte-toolbarContainer-fixed");
s.css({top:-10000,position:"fixed"})
}}})
}))
}(jQuery,window));(function(){function ff(fn,fm){try{for(var fl in fm){Object.defineProperty(fn.prototype,fl,{value:fm[fl],enumerable:false})
}}catch(fo){fn.prototype=fm
}}function fc(fl){var e=-1,fn=fl.length,fm=[];
while(++e<fn){fm.push(fl[e])
}return fm
}function aV(e){return Array.prototype.slice.call(e)
}function ae(){}function d4(e){return e
}function O(){return this
}function R(){return true
}function H(e){return typeof e==="function"?e:function(){return e
}
}function cE(fl,e,fm){return function(){var fn=fm.apply(e,arguments);
return arguments.length?fl:fn
}
}function eQ(e){return e!=null&&!isNaN(e)
}function dd(e){return e.length
}function cT(e){return e==null
}function bx(e){return e.trim().replace(/\s+/g," ")
}function d2(e){var fl=1;
while(e*fl%1){fl*=10
}return fl
}function cQ(){}function dg(e){function fn(){var fq=fm,fp=-1,fr=fq.length,fo;
while(++fp<fr){if(fo=fq[fp].on){fo.apply(this,arguments)
}}return e
}var fm=[],fl=new ae;
fn.on=function(fp,fr){var fo=fl.get(fp),fq;
if(arguments.length<2){return fo&&fo.on
}if(fo){fo.on=null;
fm=fm.slice(0,fq=fm.indexOf(fo)).concat(fm.slice(fq+1));
fl.remove(fp)
}if(fr){fm.push(fl.set(fp,{on:fr}))
}return e
};
return fn
}function cv(e,fl){return fl-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-fl))/Math.LN10):1)
}function aF(e){return e+""
}function bV(fn){var fl=fn.lastIndexOf("."),fm=fl>=0?fn.substring(fl):(fl=fn.length,""),e=[];
while(fl>0){e.push(fn.substring(fl-=3,fl+3))
}return e.reverse().join(",")+fm
}function cc(fm,fl){var e=Math.pow(10,Math.abs(8-fl)*3);
return{scale:fl>8?function(fn){return fn/e
}:function(fn){return fn*e
},symbol:fm}
}function dw(e){return function(fl){return fl<=0?0:fl>=1?1:e(fl)
}
}function v(e){return function(fl){return 1-e(1-fl)
}
}function ar(e){return function(fl){return 0.5*(fl<0.5?e(2*fl):2-e(2-2*fl))
}
}function bU(e){return e
}function ak(fl){return function(e){return Math.pow(e,fl)
}
}function dV(e){return 1-Math.cos(e*Math.PI/2)
}function dq(e){return Math.pow(2,10*(e-1))
}function cr(e){return 1-Math.sqrt(1-e*e)
}function L(e,fm){var fl;
if(arguments.length<2){fm=0.45
}if(arguments.length<1){e=1;
fl=fm/4
}else{fl=fm/(2*Math.PI)*Math.asin(1/e)
}return function(fn){return 1+e*Math.pow(2,10*-fn)*Math.sin((fn-fl)*2*Math.PI/fm)
}
}function ez(e){if(!e){e=1.70158
}return function(fl){return fl*fl*((e+1)*fl-e)
}
}function bd(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+0.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+0.9375:7.5625*(e-=2.625/2.75)*e+0.984375
}function e3(){d3.event.stopPropagation();
d3.event.preventDefault()
}function P(){var fm=d3.event,fl;
while(fl=fm.sourceEvent){fm=fl
}return fm
}function eK(fm){var e=new cQ,fl=0,fn=arguments.length;
while(++fl<fn){e[arguments[fl]]=dg(e)
}e.of=function(fp,fo){return function(fq){try{var fr=fq.sourceEvent=d3.event;
fq.target=fm;
d3.event=fq;
e[fq.type].apply(fp,fo)
}finally{d3.event=fr
}}
};
return e
}function n(e){var fn=[e.a,e.b],fl=[e.c,e.d],fp=dn(fn),fm=cW(fn,fl),fo=dn(aZ(fl,fn,-fm))||0;
if(fn[0]*fl[1]<fl[0]*fn[1]){fn[0]*=-1;
fn[1]*=-1;
fp*=-1;
fm*=-1
}this.rotate=(fp?Math.atan2(fn[1],fn[0]):Math.atan2(-fl[0],fl[1]))*cK;
this.translate=[e.e,e.f];
this.scale=[fp,fo];
this.skew=fo?Math.atan2(fm,fo)*cK:0
}function cW(fl,e){return fl[0]*e[0]+fl[1]*e[1]
}function dn(e){var fl=Math.sqrt(cW(e,e));
if(fl){e[0]/=fl;
e[1]/=fl
}return fl
}function aZ(fl,e,fm){fl[0]+=fm*e[0];
fl[1]+=fm*e[1];
return fl
}function dr(e){return e=="transform"?d3.interpolateTransform:d3.interpolate
}function eT(fl,e){e=e-(fl=+fl)?1/(e-fl):0;
return function(fm){return(fm-fl)*e
}
}function Z(fl,e){e=e-(fl=+fl)?1/(e-fl):0;
return function(fm){return Math.max(0,Math.min(1,(fm-fl)*e))
}
}function cz(fm,fl,e){return new c7(fm,fl,e)
}function c7(fm,fl,e){this.r=fm;
this.g=fl;
this.b=e
}function bn(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)
}function am(fp,fn,fq){var e=0,fm=0,fo=0,fs,fr,fl;
fs=/([a-z]+)\((.*)\)/i.exec(fp);
if(fs){fr=fs[2].split(",");
switch(fs[1]){case"hsl":return fq(parseFloat(fr[0]),parseFloat(fr[1])/100,parseFloat(fr[2])/100);
case"rgb":return fn(cU(fr[0]),cU(fr[1]),cU(fr[2]))
}}if(fl=S.get(fp)){return fn(fl.r,fl.g,fl.b)
}if(fp!=null&&fp.charAt(0)==="#"){if(fp.length===4){e=fp.charAt(1);
e+=e;
fm=fp.charAt(2);
fm+=fm;
fo=fp.charAt(3);
fo+=fo
}else{if(fp.length===7){e=fp.substring(1,3);
fm=fp.substring(3,5);
fo=fp.substring(5,7)
}}e=parseInt(e,16);
fm=parseInt(fm,16);
fo=parseInt(fo,16)
}return fn(e,fm,fo)
}function ec(e,fo,fq){var fm=Math.min(e/=255,fo/=255,fq/=255),fr=Math.max(e,fo,fq),fp=fr-fm,fn,fs,fl=(fr+fm)/2;
if(fp){fs=fl<0.5?fp/(fr+fm):fp/(2-fr-fm);
if(e==fr){fn=(fo-fq)/fp+(fo<fq?6:0)
}else{if(fo==fr){fn=(fq-e)/fp+2
}else{fn=(e-fo)/fp+4
}}fn*=60
}else{fs=fn=0
}return cJ(fn,fs,fl)
}function cm(fn,fm,fl){fn=b7(fn);
fm=b7(fm);
fl=b7(fl);
var e=d8((0.4124564*fn+0.3575761*fm+0.1804375*fl)/aC),fp=d8((0.2126729*fn+0.7151522*fm+0.072175*fl)/ay),fo=d8((0.0193339*fn+0.119192*fm+0.9503041*fl)/aw);
return bg(116*fp-16,500*(e-fp),200*(fp-fo))
}function b7(e){return(e/=255)<=0.04045?e/12.92:Math.pow((e+0.055)/1.055,2.4)
}function cU(fl){var e=parseFloat(fl);
return fl.charAt(fl.length-1)==="%"?Math.round(e*2.55):e
}function cJ(fm,fl,e){return new dp(fm,fl,e)
}function dp(fm,fl,e){this.h=fm;
this.s=fl;
this.l=e
}function aB(fp,fo,e){function fm(fr){if(fr>360){fr-=360
}else{if(fr<0){fr+=360
}}if(fr<60){return fn+(fl-fn)*fr/60
}if(fr<180){return fl
}if(fr<240){return fn+(fl-fn)*(240-fr)/60
}return fn
}function fq(fr){return Math.round(fm(fr)*255)
}var fn,fl;
fp=fp%360;
if(fp<0){fp+=360
}fo=fo<0?0:fo>1?1:fo;
e=e<0?0:e>1?1:e;
fl=e<=0.5?e*(1+fo):e+fo-e*fo;
fn=2*e-fl;
return cz(fq(fp+120),fq(fp),fq(fp-120))
}function aN(fl,fm,e){return new bl(fl,fm,e)
}function bl(fl,fm,e){this.h=fl;
this.c=fm;
this.l=e
}function aO(fl,fm,e){return bg(e,Math.cos(fl*=Math.PI/180)*fm,Math.sin(fl)*fm)
}function bg(fm,fl,e){return new bQ(fm,fl,e)
}function bQ(fm,fl,e){this.l=fm;
this.a=fl;
this.b=e
}function ab(fn,fm,fl){var fp=(fn+16)/116,e=fp+fm/500,fo=fp-fl/200;
e=eB(e)*aC;
fp=eB(fp)*ay;
fo=eB(fo)*aw;
return cz(c(3.2404542*e-1.5371385*fp-0.4985314*fo),c(-0.969266*e+1.8760108*fp+0.041556*fo),c(0.0556434*e-0.2040259*fp+1.0572252*fo))
}function em(fm,fl,e){return aN(Math.atan2(e,fl)/Math.PI*180,Math.sqrt(fl*fl+e*e),fm)
}function eB(e){return e>0.206893034?e*e*e:(e-4/29)/7.787037
}function d8(e){return e>0.008856?Math.pow(e,1/3):7.787037*e+4/29
}function c(e){return Math.round(255*(e<=0.00304?12.92*e:1.055*Math.pow(e,1/2.4)-0.055))
}function cl(e){cV(e,cj);
return e
}function t(e){return function(){return bZ(e,this)
}
}function bL(e){return function(){return dQ(e,this)
}
}function aJ(fm,fq){function fl(){this.removeAttribute(fm)
}function fr(){this.removeAttributeNS(fm.space,fm.local)
}function fp(){this.setAttribute(fm,fq)
}function fo(){this.setAttributeNS(fm.space,fm.local,fq)
}function e(){var fs=fq.apply(this,arguments);
if(fs==null){this.removeAttribute(fm)
}else{this.setAttribute(fm,fs)
}}function fn(){var fs=fq.apply(this,arguments);
if(fs==null){this.removeAttributeNS(fm.space,fm.local)
}else{this.setAttributeNS(fm.space,fm.local,fs)
}}fm=d3.ns.qualify(fm);
return fq==null?fm.local?fr:fl:typeof fq==="function"?fm.local?fn:e:fm.local?fo:fp
}function eq(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")
}function eh(fl,fn){function e(){var fp=-1;
while(++fp<fo){fl[fp](this,fn)
}}function fm(){var fq=-1,fp=fn.apply(this,arguments);
while(++fq<fo){fl[fq](this,fp)
}}fl=fl.trim().split(/\s+/).map(fd);
var fo=fl.length;
return typeof fn==="function"?fm:e
}function fd(e){var fl=eq(e);
return function(fo,fp){if(fq=fo.classList){return fp?fq.add(e):fq.remove(e)
}var fq=fo.className,fm=fq.baseVal!=null,fn=fm?fq.baseVal:fq;
if(fp){fl.lastIndex=0;
if(!fl.test(fn)){fn=bx(fn+" "+e);
if(fm){fq.baseVal=fn
}else{fo.className=fn
}}}else{if(fn){fn=bx(fn.replace(fl," "));
if(fm){fq.baseVal=fn
}else{fo.className=fn
}}}}
}function dE(fm,fp,fn){function fl(){this.style.removeProperty(fm)
}function fo(){this.style.setProperty(fm,fp,fn)
}function e(){var fq=fp.apply(this,arguments);
if(fq==null){this.style.removeProperty(fm)
}else{this.style.setProperty(fm,fq,fn)
}}return fp==null?fl:typeof fp==="function"?e:fo
}function e0(fl,fn){function e(){delete this[fl]
}function fm(){this[fl]=fn
}function fo(){var fp=fn.apply(this,arguments);
if(fp==null){delete this[fl]
}else{this[fl]=fp
}}return fn==null?e:typeof fn==="function"?fo:fm
}function B(e){return{__data__:e}
}function au(e){return function(){return a(this,e)
}
}function eo(e){if(!arguments.length){e=d3.ascending
}return function(fm,fl){return e(fm&&fm.__data__,fl&&fl.__data__)
}
}function j(fo,fp,e){function fm(){var fr=this[fl];
if(fr){this.removeEventListener(fo,fr,fr.$);
delete this[fl]
}}function fq(){function ft(fu){var fv=d3.event;
d3.event=fu;
fr[0]=fs.__data__;
try{fp.apply(fs,fr)
}finally{d3.event=fv
}}var fs=this,fr=arguments;
fm.call(this);
this.addEventListener(fo,this[fl]=ft,ft.$=e);
ft._=fp
}var fl="__on"+fo,fn=fo.indexOf(".");
if(fn>0){fo=fo.substring(0,fn)
}return fp?fq:fm
}function by(fl,fr){for(var fm=0,e=fl.length;
fm<e;
fm++){for(var fp=fl[fm],fn=0,fq=fp.length,fo;
fn<fq;
fn++){if(fo=fp[fn]){fr(fo,fn,fm)
}}}return fl
}function a0(e){cV(e,c4);
return e
}function er(e,fp,fn){cV(e,cC);
var fm=new ae,fl=d3.dispatch("start","end"),fo=aA;
e.id=fp;
e.time=fn;
e.tween=function(fq,fr){if(arguments.length<2){return fm.get(fq)
}if(fr==null){fm.remove(fq)
}else{fm.set(fq,fr)
}return e
};
e.ease=function(fq){if(!arguments.length){return fo
}fo=typeof fq==="function"?fq:d3.ease.apply(d3,arguments);
return e
};
e.each=function(fq,fr){if(arguments.length<2){return ce.call(e,fq)
}fl.on(fq,fr);
return e
};
d3.timer(function(fq){return by(e,function(fs,fv,fu){function fr(fC){if(fB.active>fp){return fA()
}fB.active=fp;
fm.forEach(function(fD,fE){if(fE=fE.call(fs,fy,fv)){fz.push(fE)
}});
fl.start.call(fs,fy,fv);
if(!fx(fC)){d3.timer(fx,0,fn)
}return 1
}function fx(fC){if(fB.active!==fp){return fA()
}var fD=(fC-fw)/ft,fE=fo(fD),fF=fz.length;
while(fF>0){fz[--fF].call(fs,fE)
}if(fD>=1){fA();
eI=fp;
fl.end.call(fs,fy,fv);
eI=0;
return 1
}}function fA(){if(!--fB.count){delete fs.__transition__
}return 1
}var fz=[],fw=fs.delay,ft=fs.duration,fB=(fs=fs.node).__transition__||(fs.__transition__={active:0,count:0}),fy=fs.__data__;
++fB.count;
fw<=fq?fr(fq):d3.timer(fr,fw,fn)
})
},0,fn);
return e
}function ce(fo){var fn=eI,fm=aA,e=c1,fl=eA;
eI=this.id;
aA=this.ease();
by(this,function(fr,fq,fp){c1=fr.delay;
eA=fr.duration;
fo.call(fr=fr.node,fr.__data__,fq,fp)
});
eI=fn;
aA=fm;
c1=e;
eA=fl;
return this
}function dY(fm,fl,e){return e!=""&&ej
}function di(e,fl){return d3.tween(e,dr(fl))
}function eS(){var e,fm=Date.now(),fn=a8;
while(fn){e=fm-fn.then;
if(e>=fn.delay){fn.flush=fn.callback(e)
}fn=fn.next
}var fl=c6()-fm;
if(fl>24){if(isFinite(fl)){clearTimeout(df);
df=setTimeout(eS,fl)
}bi=0
}else{bi=1;
eR(eS)
}}function c6(){var fl=null,e=a8,fm=Infinity;
while(e){if(e.flush){e=fl?fl.next=e.next:a8=e.next
}else{fm=Math.min(fm,e.then+e.delay);
e=(fl=e).next
}}return fm
}function an(fn,fq){var fo=fn.ownerSVGElement||fn;
if(fo.createSVGPoint){var fl=fo.createSVGPoint();
if(bv<0&&(window.scrollX||window.scrollY)){fo=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);
var fm=fo[0][0].getScreenCTM();
bv=!(fm.f||fm.e);
fo.remove()
}if(bv){fl.x=fq.pageX;
fl.y=fq.pageY
}else{fl.x=fq.clientX;
fl.y=fq.clientY
}fl=fl.matrixTransform(fn.getScreenCTM().inverse());
return[fl.x,fl.y]
}var fp=fn.getBoundingClientRect();
return[fq.clientX-fp.left-fn.clientLeft,fq.clientY-fp.top-fn.clientTop]
}function ad(){}function cA(fl){var fm=fl[0],e=fl[fl.length-1];
return fm<e?[fm,e]:[e,fm]
}function ao(e){return e.rangeExtent?e.rangeExtent():cA(e.range())
}function d1(fq,fo){var fp=0,fn=fq.length-1,fm=fq[fp],fl=fq[fn],e;
if(fl<fm){e=fp,fp=fn,fn=e;
e=fm,fm=fl,fl=e
}if(fo=fo(fl-fm)){fq[fp]=fo.floor(fm);
fq[fn]=fo.ceil(fl)
}return fq
}function cO(){return Math
}function cw(fp,fn,fo,fr){function e(){var fs=Math.min(fp.length,fn.length)>2?C:ac,ft=fr?Z:eT;
fm=fs(fp,fn,ft,fo);
fl=fs(fn,fp,ft,d3.interpolate);
return fq
}function fq(fs){return fm(fs)
}var fm,fl;
fq.invert=function(fs){return fl(fs)
};
fq.domain=function(fs){if(!arguments.length){return fp
}fp=fs.map(Number);
return e()
};
fq.range=function(fs){if(!arguments.length){return fn
}fn=fs;
return e()
};
fq.rangeRound=function(fs){return fq.range(fs).interpolate(d3.interpolateRound)
};
fq.clamp=function(fs){if(!arguments.length){return fr
}fr=fs;
return e()
};
fq.interpolate=function(fs){if(!arguments.length){return fo
}fo=fs;
return e()
};
fq.ticks=function(fs){return c0(fp,fs)
};
fq.tickFormat=function(fs){return da(fp,fs)
};
fq.nice=function(){d1(fp,ah);
return e()
};
fq.copy=function(){return cw(fp,fn,fo,fr)
};
return e()
}function dS(fl,e){return d3.rebind(fl,e,"range","rangeRound","interpolate","clamp")
}function ah(e){e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1);
return e&&{floor:function(fl){return Math.floor(fl/e)*e
},ceil:function(fl){return Math.ceil(fl/e)*e
}}
}function q(fp,e){var fm=cA(fp),fl=fm[1]-fm[0],fo=Math.pow(10,Math.floor(Math.log(fl/e)/Math.LN10)),fn=e/fl*fo;
if(fn<=0.15){fo*=10
}else{if(fn<=0.35){fo*=5
}else{if(fn<=0.75){fo*=2
}}}fm[0]=Math.ceil(fm[0]/fo)*fo;
fm[1]=Math.floor(fm[1]/fo)*fo+fo*0.5;
fm[2]=fo;
return fm
}function c0(fl,e){return d3.range.apply(d3,q(fl,e))
}function da(fl,e){return d3.format(",."+Math.max(0,-Math.floor(Math.log(q(fl,e)[2])/Math.LN10+0.01))+"f")
}function ac(fo,e,fp,fm){var fl=fp(fo[0],fo[1]),fn=fm(e[0],e[1]);
return function(fq){return fn(fl(fq))
}
}function C(fq,fl,fr,fo){var fn=[],fp=[],fm=0,e=Math.min(fq.length,fl.length)-1;
if(fq[e]<fq[0]){fq=fq.slice().reverse();
fl=fl.slice().reverse()
}while(++fm<=e){fn.push(fr(fq[fm-1],fq[fm]));
fp.push(fo(fl[fm-1],fl[fm]))
}return function(fs){var ft=d3.bisect(fq,fs,1,e)-1;
return fp[ft](fn[ft](fs))
}
}function el(e,fl){function fn(fo){return e(fl(fo))
}var fm=fl.pow;
fn.invert=function(fo){return fm(e.invert(fo))
};
fn.domain=function(fo){if(!arguments.length){return e.domain().map(fm)
}fl=fo[0]<0?dW:dT;
fm=fl.pow;
e.domain(fo.map(fl));
return fn
};
fn.nice=function(){e.domain(d1(e.domain(),cO));
return fn
};
fn.ticks=function(){var ft=cA(e.domain()),fu=[];
if(ft.every(isFinite)){var fs=Math.floor(ft[0]),fr=Math.ceil(ft[1]),fq=fm(ft[0]),fp=fm(ft[1]);
if(fl===dW){fu.push(fm(fs));
for(;
fs++<fr;
){for(var fo=9;
fo>0;
fo--){fu.push(fm(fs)*fo)
}}}else{for(;
fs<fr;
fs++){for(var fo=1;
fo<10;
fo++){fu.push(fm(fs)*fo)
}}fu.push(fm(fs))
}for(fs=0;
fu[fs]<fq;
fs++){}for(fr=fu.length;
fu[fr-1]>fp;
fr--){}fu=fu.slice(fs,fr)
}return fu
};
fn.tickFormat=function(fs,fr){if(arguments.length<2){fr=b0
}if(arguments.length<1){return fr
}var fo=Math.max(0.1,fs/fn.ticks().length),fp=fl===dW?(fq=-1e-12,Math.floor):(fq=1e-12,Math.ceil),fq;
return function(ft){return ft/fm(fp(fl(ft)+fq))<=fo?fr(ft):""
}
};
fn.copy=function(){return el(e.copy(),fl)
};
return dS(fn,e)
}function dT(e){return Math.log(e<0?0:e)/Math.LN10
}function dW(e){return -Math.log(e>0?0:-e)/Math.LN10
}function d9(e,fm){function fo(fp){return e(fl(fp))
}var fl=dI(fm),fn=dI(1/fm);
fo.invert=function(fp){return fn(e.invert(fp))
};
fo.domain=function(fp){if(!arguments.length){return e.domain().map(fn)
}e.domain(fp.map(fl));
return fo
};
fo.ticks=function(fp){return c0(fo.domain(),fp)
};
fo.tickFormat=function(fp){return da(fo.domain(),fp)
};
fo.nice=function(){return fo.domain(d1(fo.domain(),ah))
};
fo.exponent=function(fp){if(!arguments.length){return fm
}var fq=fo.domain();
fl=dI(fm=fp);
fn=dI(1/fm);
return fo.domain(fq)
};
fo.copy=function(){return d9(e.copy(),fm)
};
return dS(fo,e)
}function dI(fl){return function(e){return e<0?-Math.pow(-e,fl):Math.pow(e,fl)
}
}function bj(fp,fm){function fq(fr){return e[((fo.get(fr)||fo.set(fr,fp.push(fr)))-1)%e.length]
}function fl(fs,fr){return d3.range(fp.length).map(function(ft){return fs+fr*ft
})
}var fo,e,fn;
fq.domain=function(fr){if(!arguments.length){return fp
}fp=[];
fo=new ae;
var ft=-1,fu=fr.length,fs;
while(++ft<fu){if(!fo.has(fs=fr[ft])){fo.set(fs,fp.push(fs))
}}return fq[fm.t].apply(fq,fm.a)
};
fq.range=function(fr){if(!arguments.length){return e
}e=fr;
fn=0;
fm={t:"range",a:arguments};
return fq
};
fq.rangePoints=function(fr,fu){if(arguments.length<2){fu=0
}var fv=fr[0],fs=fr[1],ft=(fs-fv)/(Math.max(1,fp.length-1)+fu);
e=fl(fp.length<2?(fv+fs)/2:fv+ft*fu/2,ft);
fn=0;
fm={t:"rangePoints",a:arguments};
return fq
};
fq.rangeBands=function(fs,fw,fr){if(arguments.length<2){fw=0
}if(arguments.length<3){fr=fw
}var ft=fs[1]<fs[0],fx=fs[ft-0],fu=fs[1-ft],fv=(fu-fx)/(fp.length-fw+2*fr);
e=fl(fx+fv*fr,fv);
if(ft){e.reverse()
}fn=fv*(1-fw);
fm={t:"rangeBands",a:arguments};
return fq
};
fq.rangeRoundBands=function(fs,fx,fr){if(arguments.length<2){fx=0
}if(arguments.length<3){fr=fx
}var fu=fs[1]<fs[0],fy=fs[fu-0],fv=fs[1-fu],fw=Math.floor((fv-fy)/(fp.length-fx+2*fr)),ft=fv-fy-(fp.length-fx)*fw;
e=fl(fy+Math.round(ft/2),fw);
if(fu){e.reverse()
}fn=Math.round(fw*(1-fx));
fm={t:"rangeRoundBands",a:arguments};
return fq
};
fq.rangeBand=function(){return fn
};
fq.rangeExtent=function(){return cA(fm.a[0])
};
fq.copy=function(){return bj(fp,fm)
};
return fq.domain(fp)
}function w(fm,fl){function e(){var fp=0,fr=fm.length,fq=fl.length;
fn=[];
while(++fp<fq){fn[fp-1]=d3.quantile(fm,fp/fq)
}return fo
}function fo(fp){if(isNaN(fp=+fp)){return NaN
}return fl[d3.bisect(fn,fp)]
}var fn;
fo.domain=function(fp){if(!arguments.length){return fm
}fm=fp.filter(function(fq){return !isNaN(fq)
}).sort(d3.ascending);
return e()
};
fo.range=function(fp){if(!arguments.length){return fl
}fl=fp;
return e()
};
fo.quantiles=function(){return fn
};
fo.copy=function(){return w(fm,fl)
};
return e()
}function b9(fo,fm,fl){function fq(fr){return fl[Math.max(0,Math.min(fn,Math.floor(fp*(fr-fo))))]
}function e(){fp=fl.length/(fm-fo);
fn=fl.length-1;
return fq
}var fp,fn;
fq.domain=function(fr){if(!arguments.length){return[fo,fm]
}fo=+fr[0];
fm=+fr[fr.length-1];
return e()
};
fq.range=function(fr){if(!arguments.length){return fl
}fl=fr;
return e()
};
fq.copy=function(){return b9(fo,fm,fl)
};
return e()
}function dO(fl,e){function fm(fn){return e[d3.bisect(fl,fn)]
}fm.domain=function(fn){if(!arguments.length){return fl
}fl=fn;
return fm
};
fm.range=function(fn){if(!arguments.length){return e
}e=fn;
return fm
};
fm.copy=function(){return dO(fl,e)
};
return fm
}function cP(fl){function e(fm){return +fm
}e.invert=e;
e.domain=e.range=function(fm){if(!arguments.length){return fl
}fl=fm.map(e);
return e
};
e.ticks=function(fm){return c0(fl,fm)
};
e.tickFormat=function(fm){return da(fl,fm)
};
e.copy=function(){return cP(fl)
};
return e
}function aP(e){return e.innerRadius
}function bD(e){return e.outerRadius
}function dX(e){return e.startAngle
}function V(e){return e.endAngle
}function c9(fl){function fm(fv){function fA(){fz.push("M",fn(fl(fC),fo))
}var fz=[],fC=[],fw=-1,fs=fv.length,fB,fu=H(e),ft=H(fr);
while(++fw<fs){if(fq.call(this,fB=fv[fw],fw)){fC.push([+fu.call(this,fB,fw),+ft.call(this,fB,fw)])
}else{if(fC.length){fA();
fC=[]
}}}if(fC.length){fA()
}return fz.length?fz.join(""):null
}var e=ev,fr=eu,fq=R,fn=e9,fp=fn.key,fo=0.7;
fm.x=function(fs){if(!arguments.length){return e
}e=fs;
return fm
};
fm.y=function(fs){if(!arguments.length){return fr
}fr=fs;
return fm
};
fm.defined=function(fs){if(!arguments.length){return fq
}fq=fs;
return fm
};
fm.interpolate=function(fs){if(!arguments.length){return fp
}if(typeof fs==="function"){fp=fn=fs
}else{fp=(fn=a9.get(fs)||e9).key
}return fm
};
fm.tension=function(fs){if(!arguments.length){return fo
}fo=fs;
return fm
};
return fm
}function ev(e){return e[0]
}function eu(e){return e[1]
}function e9(e){return e.join("L")
}function M(e){return e9(e)+"Z"
}function aG(fl){var e=0,fo=fl.length,fn=fl[0],fm=[fn[0],",",fn[1]];
while(++e<fo){fm.push("V",(fn=fl[e])[1],"H",fn[0])
}return fm.join("")
}function eV(fl){var e=0,fo=fl.length,fn=fl[0],fm=[fn[0],",",fn[1]];
while(++e<fo){fm.push("H",(fn=fl[e])[0],"V",fn[1])
}return fm.join("")
}function a6(fl,e){return fl.length<4?e9(fl):fl[1]+bI(fl.slice(1,fl.length-1),a1(fl,e))
}function r(fl,e){return fl.length<3?e9(fl):fl[0]+bI((fl.push(fl[0]),fl),a1([fl[fl.length-2]].concat(fl,[fl[1]]),e))
}function ci(fm,fl,e){return fm.length<3?e9(fm):fm[0]+bI(fm,a1(fm,fl))
}function bI(fq,fp){if(fp.length<1||fq.length!=fp.length&&fq.length!=fp.length+2){return e9(fq)
}var fr=fq.length!=fp.length,fu="",fs=fq[0],e=fq[1],fo=fp[0],ft=fo,fm=1;
if(fr){fu+="Q"+(e[0]-fo[0]*2/3)+","+(e[1]-fo[1]*2/3)+","+e[0]+","+e[1];
fs=fq[1];
fm=2
}if(fp.length>1){ft=fp[1];
e=fq[fm];
fm++;
fu+="C"+(fs[0]+fo[0])+","+(fs[1]+fo[1])+","+(e[0]-ft[0])+","+(e[1]-ft[1])+","+e[0]+","+e[1];
for(var fl=2;
fl<fp.length;
fl++,fm++){e=fq[fm];
ft=fp[fl];
fu+="S"+(e[0]-ft[0])+","+(e[1]-ft[1])+","+e[0]+","+e[1]
}}if(fr){var fn=fq[fm];
fu+="Q"+(e[0]+ft[0]*2/3)+","+(e[1]+ft[1]*2/3)+","+fn[0]+","+fn[1]
}return fu
}function a1(fq,fo){var fm=[],fn=(1-fo)/2,fs,fr=fq[0],fp=fq[1],fl=1,e=fq.length;
while(++fl<e){fs=fr;
fr=fp;
fp=fq[fl];
fm.push([fn*(fp[0]-fs[0]),fn*(fp[1]-fs[1])])
}return fm
}function de(fr){if(fr.length<3){return e9(fr)
}var fm=1,fl=fr.length,fn=fr[0],e=fn[0],fp=fn[1],fq=[e,e,e,(fn=fr[1])[0]],fo=[fp,fp,fp,fn[1]],fs=[e,",",fp];
aW(fs,fq,fo);
while(++fm<fl){fn=fr[fm];
fq.shift();
fq.push(fn[0]);
fo.shift();
fo.push(fn[1]);
aW(fs,fq,fo)
}fm=-1;
while(++fm<2){fq.shift();
fq.push(fn[0]);
fo.shift();
fo.push(fn[1]);
aW(fs,fq,fo)
}return fs.join("")
}function aD(fn){if(fn.length<4){return e9(fn)
}var fp=[],fm=-1,fq=fn.length,fo,fl=[0],e=[0];
while(++fm<3){fo=fn[fm];
fl.push(fo[0]);
e.push(fo[1])
}fp.push(d6(eM,fl)+","+d6(eM,e));
--fm;
while(++fm<fq){fo=fn[fm];
fl.shift();
fl.push(fo[0]);
e.shift();
e.push(fo[1]);
aW(fp,fl,e)
}return fp.join("")
}function bB(fo){var fq,fn=-1,fr=fo.length,e=fr+4,fp,fm=[],fl=[];
while(++fn<4){fp=fo[fn%fr];
fm.push(fp[0]);
fl.push(fp[1])
}fq=[d6(eM,fm),",",d6(eM,fl)];
--fn;
while(++fn<e){fp=fo[fn%fr];
fm.shift();
fm.push(fp[0]);
fl.shift();
fl.push(fp[1]);
aW(fq,fm,fl)
}return fq.join("")
}function bC(fq,fp){var fm=fq.length-1;
if(fm){var fl=fq[0][0],fo=fq[0][1],ft=fq[fm][0]-fl,fs=fq[fm][1]-fo,fn=-1,e,fr;
while(++fn<=fm){e=fq[fn];
fr=fn/fm;
e[0]=fp*e[0]+(1-fp)*(fl+fr*ft);
e[1]=fp*e[1]+(1-fp)*(fo+fr*fs)
}}return de(fq)
}function d6(fl,e){return fl[0]*e[0]+fl[1]*e[1]+fl[2]*e[2]+fl[3]*e[3]
}function aW(fl,e,fm){fl.push("C",d6(eO,e),",",d6(eO,fm),",",d6(eN,e),",",d6(eN,fm),",",d6(eM,e),",",d6(eM,fm))
}function fg(fl,e){return(e[1]-fl[1])/(e[0]-fl[0])
}function cs(fn){var fm=0,fl=fn.length-1,e=[],fq=fn[0],fp=fn[1],fo=e[0]=fg(fq,fp);
while(++fm<fl){e[fm]=(fo+(fo=fg(fq=fp,fp=fn[fm+1])))/2
}e[fm]=fo;
return e
}function Y(fr){var fo=[],fn,fq,fp,fs,e=cs(fr),fm=-1,fl=fr.length-1;
while(++fm<fl){fn=fg(fr[fm],fr[fm+1]);
if(Math.abs(fn)<0.000001){e[fm]=e[fm+1]=0
}else{fq=e[fm]/fn;
fp=e[fm+1]/fn;
fs=fq*fq+fp*fp;
if(fs>9){fs=fn*3/Math.sqrt(fs);
e[fm]=fs*fq;
e[fm+1]=fs*fp
}}}fm=-1;
while(++fm<=fl){fs=(fr[Math.min(fl,fm+1)][0]-fr[Math.max(0,fm-1)][0])/(6*(1+e[fm]*e[fm]));
fo.push([fs||0,e[fm]*fs||0])
}return fo
}function bX(e){return e.length<3?e9(e):e[0]+bI(e,Y(e))
}function E(fn){var e,fm=-1,fp=fn.length,fo,fl;
while(++fm<fp){e=fn[fm];
fo=e[0];
fl=e[1]+e1;
e[0]=fo*Math.cos(fl);
e[1]=fo*Math.sin(fl)
}return fn
}function fi(fo){function e(fA){function fD(){fC.push("M",fp(fo(fJ),ft),fq,fr(fo(fw.reverse()),ft),"Z")
}var fC=[],fw=[],fJ=[],fB=-1,fx=fA.length,fE,fz=H(fm),fI=H(fu),fy=fm===fl?function(){return fG
}:H(fl),fH=fu===fs?function(){return fF
}:H(fs),fG,fF;
while(++fB<fx){if(fn.call(this,fE=fA[fB],fB)){fw.push([fG=+fz.call(this,fE,fB),fF=+fI.call(this,fE,fB)]);
fJ.push([+fy.call(this,fE,fB),+fH.call(this,fE,fB)])
}else{if(fw.length){fD();
fw=[];
fJ=[]
}}}if(fw.length){fD()
}return fC.length?fC.join(""):null
}var fm=ev,fl=ev,fu=0,fs=eu,fn=R,fp=e9,fv=fp.key,fr=fp,fq="L",ft=0.7;
e.x=function(fw){if(!arguments.length){return fl
}fm=fl=fw;
return e
};
e.x0=function(fw){if(!arguments.length){return fm
}fm=fw;
return e
};
e.x1=function(fw){if(!arguments.length){return fl
}fl=fw;
return e
};
e.y=function(fw){if(!arguments.length){return fs
}fu=fs=fw;
return e
};
e.y0=function(fw){if(!arguments.length){return fu
}fu=fw;
return e
};
e.y1=function(fw){if(!arguments.length){return fs
}fs=fw;
return e
};
e.defined=function(fw){if(!arguments.length){return fn
}fn=fw;
return e
};
e.interpolate=function(fw){if(!arguments.length){return fv
}if(typeof fw==="function"){fv=fp=fw
}else{fv=(fp=a9.get(fw)||e9).key
}fr=fp.reverse||fp;
fq=fp.closed?"M":"L";
return e
};
e.tension=function(fw){if(!arguments.length){return ft
}ft=fw;
return e
};
return e
}function W(e){return e.source
}function af(e){return e.target
}function y(e){return e.radius
}function eg(e){return e.startAngle
}function cB(e){return e.endAngle
}function l(e){return[e.x,e.y]
}function m(e){return function(){var fn=e.apply(this,arguments),fm=fn[0],fl=fn[1]+e1;
return[fm*Math.cos(fl),fm*Math.sin(fl)]
}
}function c5(){return 64
}function al(){return"circle"
}function ba(e){var fl=Math.sqrt(e/Math.PI);
return"M0,"+fl+"A"+fl+","+fl+" 0 1,1 0,"+-fl+"A"+fl+","+fl+" 0 1,1 0,"+fl+"Z"
}function dk(fl,e){fl.attr("transform",function(fm){return"translate("+e(fm)+",0)"
})
}function dj(e,fl){e.attr("transform",function(fm){return"translate(0,"+fl(fm)+")"
})
}function bF(fm,fq,fl){fr=[];
if(fl&&fq.length>1){var ft=cA(fm.domain()),fr,fo=-1,e=fq.length,fp=(fq[1]-fq[0])/++fl,fn,fs;
while(++fo<e){for(fn=fl;
--fn>0;
){if((fs=+fq[fo]-fn*fp)>=ft[0]){fr.push(fs)
}}}for(--fo,fn=0;
++fn<fl&&(fs=+fq[fo]+fn*fp)<ft[1];
){fr.push(fs)
}}return fr
}function bp(){if(!cp){cp=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode
}var fm=d3.event,fn;
try{cp.scrollTop=1000;
cp.dispatchEvent(fm);
fn=1000-cp.scrollTop
}catch(fl){fn=fm.wheelDelta||-fm.detail*5
}return fn
}function cL(fn){var fp=fn.source,e=fn.target,fo=dD(fp,e),fm=[fp];
while(fp!==fo){fp=fp.parent;
fm.push(fp)
}var fl=fm.length;
while(e!==fo){fm.splice(fl,0,e);
e=e.parent
}return fm
}function dm(fm){var fl=[],e=fm.parent;
while(e!=null){fl.push(fm);
fm=e;
e=e.parent
}fl.push(fm);
return fl
}function dD(fn,fl){if(fn===fl){return fn
}var fm=dm(fn),e=dm(fl),fo=fm.pop(),fp=e.pop(),fq=null;
while(fo===fp){fq=fo;
fo=fm.pop();
fp=e.pop()
}return fq
}function p(e){e.fixed|=2
}function cu(e){e.fixed&=1
}function bo(e){e.fixed|=4
}function cx(e){e.fixed&=3
}function ee(ft,fo,fs){var fp=0,fm=0;
ft.charge=0;
if(!ft.leaf){var e=ft.nodes,fl=e.length,fq=-1,fr;
while(++fq<fl){fr=e[fq];
if(fr==null){continue
}ee(fr,fo,fs);
ft.charge+=fr.charge;
fp+=fr.charge*fr.cx;
fm+=fr.charge*fr.cy
}}if(ft.point){if(!ft.leaf){ft.point.x+=Math.random()-0.5;
ft.point.y+=Math.random()-0.5
}var fn=fo*fs[ft.point.index];
ft.charge+=ft.pointCharge=fn;
fp+=fn*ft.point.x;
fm+=fn*ft.point.y
}ft.cx=fp/ft.charge;
ft.cy=fm/ft.charge
}function dF(e){return 20
}function bk(e){return 1
}function U(e){return e.x
}function T(e){return e.y
}function dz(fl,e,fm){fl.y0=e;
fl.y=fm
}function aX(e){return d3.range(e.length)
}function dy(fn){var fl=-1,e=fn[0].length,fm=[];
while(++fl<e){fm[fl]=0
}return fm
}function a2(fp){var fn=1,fm=0,fl=fp[0][1],e,fo=fp.length;
for(;
fn<fo;
++fn){if((e=fp[fn][1])>fl){fm=fn;
fl=e
}}return fm
}function b2(e){return e.reduce(dx,0)
}function dx(e,fl){return e+fl[1]
}function eU(fl,e){return g(fl,Math.ceil(Math.log(e.length)/Math.LN2+1))
}function g(fn,fp){var fm=-1,fl=+fn[0],e=(fn[1]-fl)/fp,fo=[];
while(++fm<=fp){fo[fm]=e*fm+fl
}return fo
}function aE(e){return[d3.min(e),d3.max(e)]
}function ea(fl,e){d3.rebind(fl,e,"sort","children","value");
fl.links=eb;
fl.nodes=function(fm){h=true;
return(fl.nodes=fl)(fm)
};
return fl
}function av(e){return e.children
}function e5(e){return e.value
}function cg(fl,e){return e.value-fl.value
}function eb(e){return d3.merge(e.map(function(fl){return(fl.children||[]).map(function(fm){return{source:fl,target:fm}
})
}))
}function cF(fl,e){return fl.value-e.value
}function aY(fl,e){var fm=fl._pack_next;
fl._pack_next=e;
e._pack_prev=fl;
e._pack_next=fm;
fm._pack_prev=e
}function az(fl,e){fl._pack_next=e;
e._pack_prev=fl
}function cy(fm,e){var fn=e.x-fm.x,fl=e.y-fm.y,fo=fm.r+e.r;
return fo*fo-fn*fn-fl*fl>0.001
}function J(fv){function fm(fE){fz=Math.min(fE.x-fE.r,fz);
fD=Math.max(fE.x+fE.r,fD);
e=Math.min(fE.y-fE.r,e);
fo=Math.max(fE.y+fE.r,fo)
}if(!(fu=fv.children)||!(ft=fu.length)){return
}var fu,fz=Infinity,fD=-Infinity,e=Infinity,fo=-Infinity,fC,fB,fA,fy,fx,fw,ft;
fu.forEach(aj);
fC=fu[0];
fC.x=-fC.r;
fC.y=0;
fm(fC);
if(ft>1){fB=fu[1];
fB.x=fB.r;
fB.y=0;
fm(fB);
if(ft>2){fA=fu[2];
ax(fC,fB,fA);
fm(fA);
aY(fC,fA);
fC._pack_prev=fA;
aY(fA,fB);
fB=fC._pack_next;
for(fy=3;
fy<ft;
fy++){ax(fC,fB,fA=fu[fy]);
var fl=0,fp=1,fn=1;
for(fx=fB._pack_next;
fx!==fB;
fx=fx._pack_next,fp++){if(cy(fx,fA)){fl=1;
break
}}if(fl==1){for(fw=fC._pack_prev;
fw!==fx._pack_prev;
fw=fw._pack_prev,fn++){if(cy(fw,fA)){break
}}}if(fl){if(fp<fn||fp==fn&&fB.r<fC.r){az(fC,fB=fx)
}else{az(fC=fw,fB)
}fy--
}else{aY(fC,fA);
fB=fA;
fm(fA)
}}}}var fr=(fz+fD)/2,fq=(e+fo)/2,fs=0;
for(fy=0;
fy<ft;
fy++){fA=fu[fy];
fA.x-=fr;
fA.y-=fq;
fs=Math.max(fs,fA.r+Math.sqrt(fA.x*fA.x+fA.y*fA.y))
}fv.r=fs;
fu.forEach(cM)
}function aj(e){e._pack_next=e._pack_prev=e
}function cM(e){delete e._pack_next;
delete e._pack_prev
}function dl(fo,e,fq,fl){var fn=fo.children;
fo.x=e+=fl*fo.x;
fo.y=fq+=fl*fo.y;
fo.r*=fl;
if(fn){var fm=-1,fp=fn.length;
while(++fm<fp){dl(fn[fm],e,fq,fl)
}}}function ax(fo,fm,e){var fq=fo.r+e.r,ft=fm.x-fo.x,fr=fm.y-fo.y;
if(fq&&(ft||fr)){var fs=fm.r+e.r,fp=ft*ft+fr*fr;
fs*=fs;
fq*=fq;
var fn=0.5+(fq-fs)/(2*fp),fl=Math.sqrt(Math.max(0,2*fs*(fq+fp)-(fq-=fp)*fq-fs*fs))/(2*fp);
e.x=fo.x+fn*ft+fl*fr;
e.y=fo.y+fn*fr-fl*ft
}else{e.x=fo.x+fq;
e.y=fo.y
}}function aK(e){return 1+d3.max(e,function(fl){return fl.y
})
}function aL(e){return e.reduce(function(fl,fm){return fl+fm.x
},0)/e.length
}function cH(fl){var e=fl.children;
return e&&e.length?cH(e[0]):fl
}function ca(fl){var e=fl.children,fm;
return e&&(fm=e.length)?ca(e[fm-1]):fl
}function b4(fl,e){return fl.parent==e.parent?1:2
}function fb(fl){var e=fl.children;
return e&&e.length?e[0]:fl._tree.thread
}function aa(fl){var e=fl.children,fm;
return e&&(fm=e.length)?e[fm-1]:fl._tree.thread
}function co(fm,fn){var fl=fm.children;
if(fl&&(fo=fl.length)){var fp,fo,e=-1;
while(++e<fo){if(fn(fp=co(fl[e],fn),fm)>0){fm=fp
}}}return fm
}function bJ(fl,e){return fl.x-e.x
}function aR(fl,e){return e.x-fl.x
}function x(fl,e){return fl.depth-e.depth
}function eZ(fl,fm){function e(fr,fq){var fp=fr.children;
if(fp&&(fs=fp.length)){var ft,fo=null,fn=-1,fs;
while(++fn<fs){ft=fp[fn];
e(ft,fo);
fo=ft
}}fm(fr,fq)
}e(fl,null)
}function b6(fn){var e=0,fp=0,fm=fn.children,fl=fm.length,fo;
while(--fl>=0){fo=fm[fl]._tree;
fo.prelim+=e;
fo.mod+=e;
e+=fo.shift+(fp+=fo.change)
}}function fe(fl,fm,e){fl=fl._tree;
fm=fm._tree;
var fn=e/(fm.number-fl.number);
fl.change+=fn;
fm.change-=fn;
fm.shift+=e;
fm.prelim+=e;
fm.mod+=e
}function dL(e,fm,fl){return e._tree.ancestor.parent==fm.parent?e._tree.ancestor:fl
}function c8(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}
}function ap(fn,fo){var e=fn.x+fo[3],fp=fn.y+fo[0],fm=fn.dx-fo[1]-fo[3],fl=fn.dy-fo[0]-fo[2];
if(fm<0){e+=fm/2;
fm=0
}if(fl<0){fp+=fl/2;
fl=0
}return{x:e,y:fp,dx:fm,dy:fl}
}function cI(fm,fr){function fq(fs,ft){d3.text(fs,fr,function(fu){ft(fu&&fq.parse(fu))
})
}function fl(fs){return fs.map(e).join(fm)
}function e(fs){return fo.test(fs)?'"'+fs.replace(/\"/g,'""')+'"':fs
}var fp=new RegExp("\r\n|["+fm+"\r\n]","g"),fo=new RegExp('["'+fm+"\n]"),fn=fm.charCodeAt(0);
fq.parse=function(fs){var ft;
return fq.parseRows(fs,function(fy,fw){if(fw){var fx={},fv=-1,fu=ft.length;
while(++fv<fu){fx[ft[fv]]=fy[fv]
}return fx
}else{ft=fy;
return null
}})
};
fq.parseRows=function(fz,fw){function fu(){if(fp.lastIndex>=fz.length){return fv
}if(fx){fx=false;
return ft
}var fD=fp.lastIndex;
if(fz.charCodeAt(fD)===34){var fE=fD;
while(fE++<fz.length){if(fz.charCodeAt(fE)===34){if(fz.charCodeAt(fE+1)!==34){break
}fE++
}}fp.lastIndex=fE+2;
var fF=fz.charCodeAt(fE+1);
if(fF===13){fx=true;
if(fz.charCodeAt(fE+2)===10){fp.lastIndex++
}}else{if(fF===10){fx=true
}}return fz.substring(fD+1,fE).replace(/""/g,'"')
}var fC=fp.exec(fz);
if(fC){fx=fC[0].charCodeAt(0)!==fn;
return fz.substring(fD,fC.index)
}fp.lastIndex=fz.length;
return fz.substring(fD)
}var ft={},fv={},fB=[],fs=0,fA,fx;
fp.lastIndex=0;
while((fA=fu())!==fv){var fy=[];
while(fA!==ft&&fA!==fv){fy.push(fA);
fA=fu()
}if(fw&&!(fy=fw(fy,fs++))){continue
}fB.push(fy)
}return fB
};
fq.format=function(fs){return fs.map(fl).join("\n")
};
return fq
}function dv(fl,e){return function(fm){return fm&&fl.hasOwnProperty(fm.type)?fl[fm.type](fm):e
}
}function A(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+ +2*e+"z"
}function bW(fl,e){if(ek.hasOwnProperty(fl.type)){ek[fl.type](fl,e)
}}function e4(fl,e){bW(fl.geometry,e)
}function dU(fn,fm){for(var e=fn.features,fl=0,fo=e.length;
fl<fo;
fl++){bW(e[fl].geometry,fm)
}}function dc(fn,fm){for(var e=fn.geometries,fl=0,fo=e.length;
fl<fo;
fl++){bW(e[fl],fm)
}}function d0(fn,fm){for(var e=fn.coordinates,fl=0,fo=e.length;
fl<fo;
fl++){fm.apply(null,e[fl])
}}function ef(fq,fp){for(var fm=fq.coordinates,fo=0,fr=fm.length;
fo<fr;
fo++){for(var fl=fm[fo],fn=0,e=fl.length;
fn<e;
fn++){fp.apply(null,fl[fn])
}}}function e2(fq,fp){for(var fm=fq.coordinates,fo=0,fr=fm.length;
fo<fr;
fo++){for(var fl=fm[fo][0],fn=0,e=fl.length;
fn<e;
fn++){fp.apply(null,fl[fn])
}}}function eP(fl,e){e.apply(null,fl.coordinates)
}function bw(fn,fm){for(var e=fn.coordinates[0],fl=0,fo=e.length;
fl<fo;
fl++){fm.apply(null,e[fl])
}}function bT(e){return e.source
}function bY(e){return e.target
}function a4(){function ft(fB){var fE=Math.sin(fB*=fu)*fp,fA=Math.sin(fu-fB)*fp,fz=fA*fs+fE*fr,fD=fA*fl+fE*e,fC=fA*fx+fE*fv;
return[Math.atan2(fD,fz)/cN,Math.atan2(fC,Math.sqrt(fz*fz+fD*fD))/cN]
}var fn,fy,fq,fx,fs,fl,fm,fw,fo,fv,fr,e,fu,fp;
ft.distance=function(){if(fu==null){fp=1/Math.sin(fu=Math.acos(Math.max(-1,Math.min(1,fx*fv+fq*fo*Math.cos(fm-fn)))))
}return fu
};
ft.source=function(fz){var fA=Math.cos(fn=fz[0]*cN),fB=Math.sin(fn);
fq=Math.cos(fy=fz[1]*cN);
fx=Math.sin(fy);
fs=fq*fA;
fl=fq*fB;
fu=null;
return ft
};
ft.target=function(fA){var fz=Math.cos(fm=fA[0]*cN),fB=Math.sin(fm);
fo=Math.cos(fw=fA[1]*cN);
fv=Math.sin(fw);
fr=fo*fz;
e=fo*fB;
fu=null;
return ft
};
return ft
}function fj(fl,e){var fm=a4().source(fl).target(e);
fm.distance();
return fm
}function k(fl){var e=0,fm=0;
while(true){if(fl(e,fm)){return[e,fm]
}if(e===0){e=fm+1;
fm=0
}else{e=e-1;
fm=fm+1
}}}function cb(fn,fm,fl,fu){var fv,ft,fs,fr,fq,fp,fo;
fv=fu[fn];
ft=fv[0];
fs=fv[1];
fv=fu[fm];
fr=fv[0];
fq=fv[1];
fv=fu[fl];
fp=fv[0];
fo=fv[1];
return(fo-fs)*(fr-ft)-(fq-fs)*(fp-ft)>0
}function u(fm,fl,e){return(e[0]-fl[0])*(fm[1]-fl[1])<(e[1]-fl[1])*(fm[0]-fl[0])
}function d5(fx,fw,fA,fz){var fv=fx[0],fu=fw[0],ft=fA[0],fr=fz[0],fn=fx[1],fm=fw[1],fl=fA[1],e=fz[1],fB=fv-ft,fo=fu-fv,fC=fr-ft,fp=fn-fl,fy=fm-fn,fq=e-fl,fs=(fC*fp-fq*fB)/(fq*fo-fC*fy);
return[fv+fs*fo,fn+fs*fy]
}function es(fp,fn){var fD={list:fp.map(function(e,fF){return{index:fF,x:e[0],y:e[1]}
}).sort(function(fF,e){return fF.y<e.y?-1:fF.y>e.y?1:fF.x<e.x?-1:fF.x>e.x?1:0
}),bottomSite:null};
var fm={list:[],leftEnd:null,rightEnd:null,init:function(){fm.leftEnd=fm.createHalfEdge(null,"l");
fm.rightEnd=fm.createHalfEdge(null,"l");
fm.leftEnd.r=fm.rightEnd;
fm.rightEnd.l=fm.leftEnd;
fm.list.unshift(fm.leftEnd,fm.rightEnd)
},createHalfEdge:function(fF,e){return{edge:fF,side:e,vertex:null,l:null,r:null}
},insert:function(fF,e){e.l=fF;
e.r=fF.r;
fF.r.l=e;
fF.r=e
},leftBound:function(fF){var e=fm.leftEnd;
do{e=e.r
}while(e!=fm.rightEnd&&fC.rightOf(e,fF));
e=e.l;
return e
},del:function(e){e.l.r=e.r;
e.r.l=e.l;
e.edge=null
},right:function(e){return e.r
},left:function(e){return e.l
},leftRegion:function(e){return e.edge==null?fD.bottomSite:e.edge.region[e.side]
},rightRegion:function(e){return e.edge==null?fD.bottomSite:e.edge.region[b1[e.side]]
}};
var fC={bisect:function(fI,fG){var fH={region:{l:fI,r:fG},ep:{l:null,r:null}};
var fF=fG.x-fI.x,e=fG.y-fI.y,fK=fF>0?fF:-fF,fJ=e>0?e:-e;
fH.c=fI.x*fF+fI.y*e+(fF*fF+e*e)*0.5;
if(fK>fJ){fH.a=1;
fH.b=e/fF;
fH.c/=fF
}else{fH.b=1;
fH.a=fF/e;
fH.c/=e
}return fH
},intersect:function(fI,fH){var fN=fI.edge,fM=fH.edge;
if(!fN||!fM||fN.region.r==fM.region.r){return null
}var fL=fN.a*fM.b-fN.b*fM.a;
if(Math.abs(fL)<1e-10){return null
}var fG=(fN.c*fM.b-fM.c*fN.b)/fL,fQ=(fM.c*fN.a-fN.c*fM.a)/fL,fP=fN.region.r,fK=fM.region.r,fF,fJ;
if(fP.y<fK.y||fP.y==fK.y&&fP.x<fK.x){fF=fI;
fJ=fN
}else{fF=fH;
fJ=fM
}var fO=fG>=fJ.region.r.x;
if(fO&&fF.side==="l"||!fO&&fF.side==="r"){return null
}return{x:fG,y:fQ}
},rightOf:function(fK,fF){var fO=fK.edge,fI=fO.region.r,fR=fF.x>fI.x;
if(fR&&fK.side==="l"){return 1
}if(!fR&&fK.side==="r"){return 0
}if(fO.a===1){var fQ=fF.y-fI.y,fG=fF.x-fI.x,fL=0,fP=0;
if(!fR&&fO.b<0||fR&&fO.b>=0){fP=fL=fQ>=fO.b*fG
}else{fP=fF.x+fF.y*fO.b>fO.c;
if(fO.b<0){fP=!fP
}if(!fP){fL=1
}}if(!fL){var fS=fI.x-fO.region.l.x;
fP=fO.b*(fG*fG-fQ*fQ)<fS*fQ*(1+2*fG/fS+fO.b*fO.b);
if(fO.b<0){fP=!fP
}}}else{var fH=fO.c-fO.a*fF.x,fN=fF.y-fH,fM=fF.x-fI.x,fJ=fH-fI.y;
fP=fN*fN>fM*fM+fJ*fJ
}return fK.side==="l"?fP:!fP
},endPoint:function(fG,fF,e){fG.ep[fF]=e;
if(!fG.ep[b1[fF]]){return
}fn(fG)
},distance:function(fH,fG){var fF=fH.x-fG.x,e=fH.y-fG.y;
return Math.sqrt(fF*fF+e*e)
}};
var fl={list:[],insert:function(fJ,fF,fK){fJ.vertex=fF;
fJ.ystar=fF.y+fK;
for(var fG=0,fI=fl.list,e=fI.length;
fG<e;
fG++){var fH=fI[fG];
if(fJ.ystar>fH.ystar||fJ.ystar==fH.ystar&&fF.x>fH.vertex.x){continue
}else{break
}}fI.splice(fG,0,fJ)
},del:function(fH){for(var fG=0,fF=fl.list,e=fF.length;
fG<e&&fF[fG]!=fH;
++fG){}fF.splice(fG,1)
},empty:function(){return fl.list.length===0
},nextEvent:function(fH){for(var fG=0,fF=fl.list,e=fF.length;
fG<e;
++fG){if(fF[fG]==fH){return fF[fG+1]
}}return null
},min:function(){var e=fl.list[0];
return{x:e.vertex.x,y:e.ystar}
},extractMin:function(){return fl.list.shift()
}};
fm.init();
fD.bottomSite=fD.list.shift();
var fE=fD.list.shift(),fr;
var fw,ft,fo,fA,fq;
var fu,fv,fB,fx,fs;
var fz,fy;
while(true){if(!fl.empty()){fr=fl.min()
}if(fE&&(fl.empty()||fE.y<fr.y||fE.y==fr.y&&fE.x<fr.x)){fw=fm.leftBound(fE);
ft=fm.right(fw);
fu=fm.rightRegion(fw);
fz=fC.bisect(fu,fE);
fq=fm.createHalfEdge(fz,"l");
fm.insert(fw,fq);
fx=fC.intersect(fw,fq);
if(fx){fl.del(fw);
fl.insert(fw,fx,fC.distance(fx,fE))
}fw=fq;
fq=fm.createHalfEdge(fz,"r");
fm.insert(fw,fq);
fx=fC.intersect(fq,ft);
if(fx){fl.insert(fq,fx,fC.distance(fx,fE))
}fE=fD.list.shift()
}else{if(!fl.empty()){fw=fl.extractMin();
fo=fm.left(fw);
ft=fm.right(fw);
fA=fm.right(ft);
fu=fm.leftRegion(fw);
fv=fm.rightRegion(ft);
fs=fw.vertex;
fC.endPoint(fw.edge,fw.side,fs);
fC.endPoint(ft.edge,ft.side,fs);
fm.del(fw);
fl.del(ft);
fm.del(ft);
fy="l";
if(fu.y>fv.y){fB=fu;
fu=fv;
fv=fB;
fy="r"
}fz=fC.bisect(fu,fv);
fq=fm.createHalfEdge(fz,fy);
fm.insert(fo,fq);
fC.endPoint(fz,b1[fy],fs);
fx=fC.intersect(fo,fq);
if(fx){fl.del(fo);
fl.insert(fo,fx,fC.distance(fx,fu))
}fx=fC.intersect(fq,fA);
if(fx){fl.insert(fq,fx,fC.distance(fx,fu))
}}else{break
}}}for(fw=fm.right(fm.leftEnd);
fw!=fm.rightEnd;
fw=fm.right(fw)){fn(fw.edge)
}}function dB(){return{leaf:true,nodes:[],point:null}
}function bA(fo,fn,fl,fs,e,fq){if(!fo(fn,fl,fs,e,fq)){var fr=(fl+e)*0.5,fp=(fs+fq)*0.5,fm=fn.nodes;
if(fm[0]){bA(fo,fm[0],fl,fs,fr,fp)
}if(fm[1]){bA(fo,fm[1],fr,fs,e,fp)
}if(fm[2]){bA(fo,fm[2],fl,fp,fr,fq)
}if(fm[3]){bA(fo,fm[3],fr,fp,e,fq)
}}}function F(e){return{x:e[0],y:e[1]}
}function eD(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])
}function cZ(e){return e.substring(0,3)
}function cq(fn,fs,fq,fo){var fr,e,fp=0,fl=fs.length,fm=fq.length;
while(fp<fl){if(fo>=fm){return -1
}fr=fs.charCodeAt(fp++);
if(fr==37){e=e8[fs.charAt(fp++)];
if(!e||(fo=e(fn,fq,fo))<0){return -1
}}else{if(fr!=fq.charCodeAt(fo++)){return -1
}}}return fo
}function bz(e){return new RegExp("^(?:"+e.map(d3.requote).join("|")+")","i")
}function ex(fm){var fl=new ae,e=-1,fn=fm.length;
while(++e<fn){fl.set(fm[e].toLowerCase(),e)
}return fl
}function eC(fl,e,fm){dC.lastIndex=0;
var fn=dC.exec(e.substring(fm));
return fn?fm+=fn[0].length:-1
}function bu(fl,e,fm){eY.lastIndex=0;
var fn=eY.exec(e.substring(fm));
return fn?fm+=fn[0].length:-1
}function aq(fl,e,fm){cX.lastIndex=0;
var fn=cX.exec(e.substring(fm));
return fn?(fl.m=c3.get(fn[0].toLowerCase()),fm+=fn[0].length):-1
}function cY(fl,e,fm){eF.lastIndex=0;
var fn=eF.exec(e.substring(fm));
return fn?(fl.m=dt.get(fn[0].toLowerCase()),fm+=fn[0].length):-1
}function cD(fl,e,fm){return cq(fl,ed.c.toString(),e,fm)
}function fk(fl,e,fm){return cq(fl,ed.x.toString(),e,fm)
}function ei(fl,e,fm){return cq(fl,ed.X.toString(),e,fm)
}function aM(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+4));
return fn?(fl.y=+fn[0],fm+=fn[0].length):-1
}function D(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+2));
return fn?(fl.y=bM(+fn[0]),fm+=fn[0].length):-1
}function bM(e){return e+(e>68?1900:2000)
}function en(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+2));
return fn?(fl.m=fn[0]-1,fm+=fn[0].length):-1
}function a5(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+2));
return fn?(fl.d=+fn[0],fm+=fn[0].length):-1
}function ai(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+2));
return fn?(fl.H=+fn[0],fm+=fn[0].length):-1
}function bG(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+2));
return fn?(fl.M=+fn[0],fm+=fn[0].length):-1
}function ck(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+2));
return fn?(fl.S=+fn[0],fm+=fn[0].length):-1
}function ey(fl,e,fm){dP.lastIndex=0;
var fn=dP.exec(e.substring(fm,fm+3));
return fn?(fl.L=+fn[0],fm+=fn[0].length):-1
}function eX(fl,e,fm){var fn=d.get(e.substring(fm,fm+=2).toLowerCase());
return fn==null?-1:(fl.p=fn,fm)
}function dK(fo){var fn=fo.getTimezoneOffset(),fm=fn>0?"-":"+",fl=~~(Math.abs(fn)/60),e=Math.abs(fn)%60;
return fm+aU(fl)+aU(e)
}function b3(e){return e.toISOString()
}function bK(fp,e,fl){function fs(ft){var fv=fp(ft),fu=fn(fv,1);
return ft-fv<fu-ft?fv:fu
}function fr(ft){e(ft=fp(new dA(ft-1)),1);
return ft
}function fn(fu,ft){e(fu=new dA(+fu),ft);
return fu
}function fo(fv,fu,ft){var fw=fr(fv),fx=[];
if(ft>1){while(fw<fu){if(!(fl(fw)%ft)){fx.push(new Date(+fw))
}e(fw,1)
}}else{while(fw<fu){fx.push(new Date(+fw)),e(fw,1)
}}return fx
}function fm(fw,fv,fu){try{dA=eD;
var ft=new eD;
ft._=fw;
return fo(ft,fv,fu)
}finally{dA=Date
}}fp.floor=fp;
fp.round=fs;
fp.ceil=fr;
fp.offset=fn;
fp.range=fo;
var fq=fp.utc=ch(fp);
fq.floor=fq;
fq.round=ch(fs);
fq.ceil=ch(fr);
fq.offset=ch(fn);
fq.range=fm;
return fp
}function ch(e){return function(fm,fl){try{dA=eD;
var fn=new eD;
fn._=fm;
return e(fn,fl)._
}finally{dA=Date
}}
}function aH(e,fl,fm){function fn(fo){return e(fo)
}fn.invert=function(fo){return dN(e.invert(fo))
};
fn.domain=function(fo){if(!arguments.length){return e.domain().map(dN)
}e.domain(fo);
return fn
};
fn.nice=function(fo){return fn.domain(d1(fn.domain(),function(){return fo
}))
};
fn.ticks=function(fo,fp){var fs=dH(fn.domain());
if(typeof fo!=="function"){var fr=fs[1]-fs[0],ft=fr/fo,fq=d3.bisect(db,ft);
if(fq==db.length){return fl.year(fs,fo)
}if(!fq){return e.ticks(fo).map(dN)
}if(Math.log(ft/db[fq-1])<Math.log(db[fq]/ft)){--fq
}fo=fl[fq];
fp=fo[1];
fo=fo[0].range
}return fo(fs[0],new Date(+fs[1]+1),fp)
};
fn.tickFormat=function(){return fm
};
fn.copy=function(){return aH(e.copy(),fl,fm)
};
return d3.rebind(fn,e,"range","rangeRound","interpolate","clamp")
}function dH(fl){var fm=fl[0],e=fl[fl.length-1];
return fm<e?[fm,e]:[e,fm]
}function dN(e){return new Date(e)
}function bH(e){return function(fl){var fm=e.length-1,fn=e[fm];
while(!fn[1](fl)){fn=e[--fm]
}return fn[0](fl)
}
}function cn(fl){var e=new Date(fl,0,1);
e.setFullYear(fl);
return e
}function eE(fm){var fn=fm.getFullYear(),fl=cn(fn),e=cn(fn+1);
return fn+(fm-fl)/(e-fl)
}function bP(fl){var e=new Date(Date.UTC(fl,0,1));
e.setUTCFullYear(fl);
return e
}function dZ(fm){var fn=fm.getUTCFullYear(),fl=bP(fn),e=bP(fn+1);
return fn+(fm-fl)/(e-fl)
}if(!Date.now){Date.now=function(){return +(new Date)
}
}try{document.createElement("div").style.setProperty("opacity",0,"")
}catch(ds){var b5=CSSStyleDeclaration.prototype,ep=b5.setProperty;
b5.setProperty=function(e,fm,fl){ep.call(this,e,fm+"",fl)
}
}d3={version:"2.10.2"};
var cd=aV;
try{cd(document.documentElement.childNodes)[0].nodeType
}catch(eJ){cd=fc
}var cV=[].__proto__?function(fl,e){fl.__proto__=e
}:function(fm,e){for(var fl in e){fm[fl]=e[fl]
}};
d3.map=function(e){var fm=new ae;
for(var fl in e){fm.set(fl,e[fl])
}return fm
};
ff(ae,{has:function(e){return fh+e in this
},get:function(e){return this[fh+e]
},set:function(e,fl){return this[fh+e]=fl
},remove:function(e){e=fh+e;
return e in this&&delete this[e]
},keys:function(){var e=[];
this.forEach(function(fl){e.push(fl)
});
return e
},values:function(){var e=[];
this.forEach(function(fl,fm){e.push(fm)
});
return e
},entries:function(){var e=[];
this.forEach(function(fl,fm){e.push({key:fl,value:fm})
});
return e
},forEach:function(fl){for(var e in this){if(e.charCodeAt(0)===b8){fl.call(this,e.substring(1),this[e])
}}}});
var fh="\0",b8=fh.charCodeAt(0);
d3.functor=H;
d3.rebind=function(fm,fl){var e=1,fo=arguments.length,fn;
while(++e<fo){fm[fn=arguments[e]]=cE(fm,fl,fl[fn])
}return fm
};
d3.ascending=function(fl,e){return fl<e?-1:fl>e?1:fl>=e?0:NaN
};
d3.descending=function(fl,e){return e<fl?-1:e>fl?1:e>=fl?0:NaN
};
d3.mean=function(fq,fo){var fp=fq.length,fl,e=0,fn=-1,fm=0;
if(arguments.length===1){while(++fn<fp){if(eQ(fl=fq[fn])){e+=(fl-e)/++fm
}}}else{while(++fn<fp){if(eQ(fl=fo.call(fq,fq[fn],fn))){e+=(fl-e)/++fm
}}}return fm?e:undefined
};
d3.median=function(fl,e){if(arguments.length>1){fl=fl.map(e)
}fl=fl.filter(eQ);
return fl.length?d3.quantile(fl.sort(d3.ascending),0.5):undefined
};
d3.min=function(fp,fn){var fm=-1,fo=fp.length,fl,e;
if(arguments.length===1){while(++fm<fo&&((fl=fp[fm])==null||fl!=fl)){fl=undefined
}while(++fm<fo){if((e=fp[fm])!=null&&fl>e){fl=e
}}}else{while(++fm<fo&&((fl=fn.call(fp,fp[fm],fm))==null||fl!=fl)){fl=undefined
}while(++fm<fo){if((e=fn.call(fp,fp[fm],fm))!=null&&fl>e){fl=e
}}}return fl
};
d3.max=function(fp,fn){var fm=-1,fo=fp.length,fl,e;
if(arguments.length===1){while(++fm<fo&&((fl=fp[fm])==null||fl!=fl)){fl=undefined
}while(++fm<fo){if((e=fp[fm])!=null&&e>fl){fl=e
}}}else{while(++fm<fo&&((fl=fn.call(fp,fp[fm],fm))==null||fl!=fl)){fl=undefined
}while(++fm<fo){if((e=fn.call(fp,fp[fm],fm))!=null&&e>fl){fl=e
}}}return fl
};
d3.extent=function(fq,fn){var fm=-1,fp=fq.length,fl,e,fo;
if(arguments.length===1){while(++fm<fp&&((fl=fo=fq[fm])==null||fl!=fl)){fl=fo=undefined
}while(++fm<fp){if((e=fq[fm])!=null){if(fl>e){fl=e
}if(fo<e){fo=e
}}}}else{while(++fm<fp&&((fl=fo=fn.call(fq,fq[fm],fm))==null||fl!=fl)){fl=undefined
}while(++fm<fp){if((e=fn.call(fq,fq[fm],fm))!=null){if(fl>e){fl=e
}if(fo<e){fo=e
}}}}return[fl,fo]
};
d3.random={normal:function(fl,e){var fm=arguments.length;
if(fm<2){e=1
}if(fm<1){fl=0
}return function(){var fn,fp,fo;
do{fn=Math.random()*2-1;
fp=Math.random()*2-1;
fo=fn*fn+fp*fp
}while(!fo||fo>1);
return fl+e*fn*Math.sqrt(-2*Math.log(fo)/fo)
}
},logNormal:function(fl,e){var fn=arguments.length;
if(fn<2){e=1
}if(fn<1){fl=0
}var fm=d3.random.normal();
return function(){return Math.exp(fl+e*fm())
}
},irwinHall:function(e){return function(){for(var fm=0,fl=0;
fl<e;
fl++){fm+=Math.random()
}return fm/e
}
}};
d3.sum=function(fp,fn){var fm=0,fo=fp.length,e,fl=-1;
if(arguments.length===1){while(++fl<fo){if(!isNaN(e=+fp[fl])){fm+=e
}}}else{while(++fl<fo){if(!isNaN(e=+fn.call(fp,fp[fl],fl))){fm+=e
}}}return fm
};
d3.quantile=function(fm,fq){var fn=(fm.length-1)*fq+1,fo=Math.floor(fn),fl=fm[fo-1],fp=fn-fo;
return fp?fl+fp*(fm[fo]-fl):fl
};
d3.transpose=function(e){return d3.zip.apply(d3,e)
};
d3.zip=function(){if(!(fp=arguments.length)){return[]
}for(var fn=-1,e=d3.min(arguments,dd),fm=new Array(e);
++fn<e;
){for(var fl=-1,fp,fo=fm[fn]=new Array(fp);
++fl<fp;
){fo[fl]=arguments[fl][fn]
}}return fm
};
d3.bisector=function(e){return{left:function(fm,fl,fp,fo){if(arguments.length<3){fp=0
}if(arguments.length<4){fo=fm.length
}while(fp<fo){var fn=fp+fo>>>1;
if(e.call(fm,fm[fn],fn)<fl){fp=fn+1
}else{fo=fn
}}return fp
},right:function(fm,fl,fp,fo){if(arguments.length<3){fp=0
}if(arguments.length<4){fo=fm.length
}while(fp<fo){var fn=fp+fo>>>1;
if(fl<e.call(fm,fm[fn],fn)){fo=fn
}else{fp=fn+1
}}return fp
}}
};
var d7=d3.bisector(function(e){return e
});
d3.bisectLeft=d7.left;
d3.bisect=d3.bisectRight=d7.right;
d3.first=function(fp,fn){var fm=0,fo=fp.length,fl=fp[0],e;
if(arguments.length===1){fn=d3.ascending
}while(++fm<fo){if(fn.call(fp,fl,e=fp[fm])>0){fl=e
}}return fl
};
d3.last=function(fp,fn){var fm=0,fo=fp.length,fl=fp[0],e;
if(arguments.length===1){fn=d3.ascending
}while(++fm<fo){if(fn.call(fp,fl,e=fp[fm])<=0){fl=e
}}return fl
};
d3.nest=function(){function fp(fy,fw){if(fw>=fm.length){return fo?fo.call(fn,fy):fl?fy.sort(fl):fy
}var fx=-1,fs=fy.length,fA=fm[fw++],fv,fu,ft=new ae,fz,fr={};
while(++fx<fs){if(fz=ft.get(fv=fA(fu=fy[fx]))){fz.push(fu)
}else{ft.set(fv,[fu])
}}ft.forEach(function(fC,fB){fr[fC]=fp(fB,fw)
});
return fr
}function e(fu,fv){if(fv>=fm.length){return fu
}var fr=[],fs=fq[fv++],ft;
for(ft in fu){fr.push({key:ft,values:e(fu[ft],fv)})
}if(fs){fr.sort(function(fx,fw){return fs(fx.key,fw.key)
})
}return fr
}var fn={},fm=[],fq=[],fl,fo;
fn.map=function(fr){return fp(fr,0)
};
fn.entries=function(fr){return e(fp(fr,0),0)
};
fn.key=function(fr){fm.push(fr);
return fn
};
fn.sortKeys=function(fr){fq[fm.length-1]=fr;
return fn
};
fn.sortValues=function(fr){fl=fr;
return fn
};
fn.rollup=function(fr){fo=fr;
return fn
};
return fn
};
d3.keys=function(fm){var fl=[];
for(var e in fm){fl.push(e)
}return fl
};
d3.values=function(fm){var e=[];
for(var fl in fm){e.push(fm[fl])
}return e
};
d3.entries=function(fm){var e=[];
for(var fl in fm){e.push({key:fl,value:fm[fl]})
}return e
};
d3.permute=function(fo,fl){var e=[],fm=-1,fn=fl.length;
while(++fm<fn){e[fm]=fo[fl[fm]]
}return e
};
d3.merge=function(e){return Array.prototype.concat.apply([],e)
};
d3.split=function(fq,fo){var fn=[],e=[],fm,fl=-1,fp=fq.length;
if(arguments.length<2){fo=cT
}while(++fl<fp){if(fo.call(e,fm=fq[fl],fl)){e=[]
}else{if(!e.length){fn.push(e)
}e.push(fm)
}}return fn
};
d3.range=function(fq,fo,fp){if(arguments.length<3){fp=1;
if(arguments.length<2){fo=fq;
fq=0
}}if((fo-fq)/fp===Infinity){throw new Error("infinite range")
}var fl=[],e=d2(Math.abs(fp)),fn=-1,fm;
fq*=e,fo*=e,fp*=e;
if(fp<0){while((fm=fq+fp*++fn)>fo){fl.push(fm/e)
}}else{while((fm=fq+fp*++fn)<fo){fl.push(fm/e)
}}return fl
};
d3.requote=function(e){return e.replace(bR,"\\$&")
};
var bR=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;
d3.round=function(e,fl){return fl?Math.round(e*(fl=Math.pow(10,fl)))/fl:Math.round(e)
};
d3.xhr=function(e,fm,fn){var fl=new XMLHttpRequest;
if(arguments.length<3){fn=fm,fm=null
}else{if(fm&&fl.overrideMimeType){fl.overrideMimeType(fm)
}}fl.open("GET",e,true);
if(fm){fl.setRequestHeader("Accept",fm)
}fl.onreadystatechange=function(){if(fl.readyState===4){var fo=fl.status;
fn(!fo&&fl.response||fo>=200&&fo<300||fo===304?fl:null)
}};
fl.send(null)
};
d3.text=function(e,fm,fn){function fl(fo){fn(fo&&fo.responseText)
}if(arguments.length<3){fn=fm;
fm=null
}d3.xhr(e,fm,fl)
};
d3.json=function(e,fl){d3.text(e,"application/json",function(fm){fl(fm?JSON.parse(fm):null)
})
};
d3.html=function(e,fl){d3.text(e,"text/html",function(fn){if(fn!=null){var fm=document.createRange();
fm.selectNode(document.body);
fn=fm.createContextualFragment(fn)
}fl(fn)
})
};
d3.xml=function(e,fm,fn){function fl(fo){fn(fo&&fo.responseXML)
}if(arguments.length<3){fn=fm;
fm=null
}d3.xhr(e,fm,fl)
};
var ct={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};
d3.ns={prefix:ct,qualify:function(e){var fl=e.indexOf(":"),fm=e;
if(fl>=0){fm=e.substring(0,fl);
e=e.substring(fl+1)
}return ct.hasOwnProperty(fm)?{space:ct[fm],local:e}:e
}};
d3.dispatch=function(){var e=new cQ,fl=-1,fm=arguments.length;
while(++fl<fm){e[arguments[fl]]=dg(e)
}return e
};
cQ.prototype.on=function(fm,fn){var fl=fm.indexOf("."),e="";
if(fl>0){e=fm.substring(fl+1);
fm=fm.substring(0,fl)
}return arguments.length<2?this[fm].on(e):this[fm].on(e,fn)
};
d3.format=function(fs){var fp=bq.exec(fs),fu=fp[1]||" ",fl=fp[3]||"",fn=fp[5],e=+fp[6],fv=fp[7],fq=fp[8],fr=fp[9],fm=1,ft="",fo=false;
if(fq){fq=+fq.substring(1)
}if(fn){fu="0";
if(fv){e-=Math.floor((e-1)/4)
}}switch(fr){case"n":fv=true;
fr="g";
break;
case"%":fm=100;
ft="%";
fr="f";
break;
case"p":fm=100;
ft="%";
fr="r";
break;
case"d":fo=true;
fq=0;
break;
case"s":fm=-1;
fr="r";
break
}if(fr=="r"&&!fq){fr="g"
}fr=s.get(fr)||aF;
return function(fz){if(fo&&fz%1){return""
}var fw=fz<0&&(fz=-fz)?"-":fl;
if(fm<0){var fy=d3.formatPrefix(fz,fq);
fz=fy.scale(fz);
ft=fy.symbol
}else{fz*=fm
}fz=fr(fz,fq);
if(fn){var fx=fz.length+fw.length;
if(fx<e){fz=(new Array(e-fx+1)).join(fu)+fz
}if(fv){fz=bV(fz)
}fz=fw+fz
}else{if(fv){fz=bV(fz)
}fz=fw+fz;
var fx=fz.length;
if(fx<e){fz=(new Array(e-fx+1)).join(fu)+fz
}}return fz+ft
}
};
var bq=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/;
var s=d3.map({g:function(e,fl){return e.toPrecision(fl)
},e:function(e,fl){return e.toExponential(fl)
},f:function(e,fl){return e.toFixed(fl)
},r:function(e,fl){return d3.round(e,fl=cv(e,fl)).toFixed(Math.max(0,Math.min(20,fl)))
}});
var bm=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(cc);
d3.formatPrefix=function(fm,e){var fl=0;
if(fm){if(fm<0){fm*=-1
}if(e){fm=d3.round(fm,cv(fm,e))
}fl=1+Math.floor(1e-12+Math.log(fm)/Math.LN10);
fl=Math.max(-24,Math.min(24,Math.floor((fl<=0?fl+1:fl-1)/3)*3))
}return bm[8+fl/3]
};
var a3=ak(2),z=ak(3),eL=function(){return bU
};
var N=d3.map({linear:eL,poly:ak,quad:function(){return a3
},cubic:function(){return z
},sin:function(){return dV
},exp:function(){return dq
},circle:function(){return cr
},elastic:L,back:ez,bounce:function(){return bd
}});
var i=d3.map({"in":bU,out:v,"in-out":ar,"out-in":function(e){return ar(v(e))
}});
d3.ease=function(fl){var fn=fl.indexOf("-"),fm=fn>=0?fl.substring(0,fn):fl,e=fn>=0?fl.substring(fn+1):"in";
fm=N.get(fm)||eL;
e=i.get(e)||bU;
return dw(e(fm.apply(null,Array.prototype.slice.call(arguments,1))))
};
d3.event=null;
d3.transform=function(e){var fl=document.createElementNS(d3.ns.prefix.svg,"g");
return(d3.transform=function(fm){fl.setAttribute("transform",fm);
var fn=fl.transform.baseVal.consolidate();
return new n(fn?fn.matrix:dR)
})(e)
};
n.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"
};
var cK=180/Math.PI,dR={a:1,b:0,c:0,d:1,e:0,f:0};
d3.interpolate=function(fl,e){var fm=d3.interpolators.length,fn;
while(--fm>=0&&!(fn=d3.interpolators[fm](fl,e))){}return fn
};
d3.interpolateNumber=function(fl,e){e-=fl;
return function(fm){return fl+e*fm
}
};
d3.interpolateRound=function(fl,e){e-=fl;
return function(fm){return Math.round(fl+e*fm)
}
};
d3.interpolateString=function(fr,fq){var fn,fp,fo,ft=0,fs=0,fu=[],e=[],fm,fl;
dG.lastIndex=0;
for(fp=0;
fn=dG.exec(fq);
++fp){if(fn.index){fu.push(fq.substring(ft,fs=fn.index))
}e.push({i:fu.length,x:fn[0]});
fu.push(null);
ft=dG.lastIndex
}if(ft<fq.length){fu.push(fq.substring(ft))
}for(fp=0,fm=e.length;
(fn=dG.exec(fr))&&fp<fm;
++fp){fl=e[fp];
if(fl.x==fn[0]){if(fl.i){if(fu[fl.i+1]==null){fu[fl.i-1]+=fl.x;
fu.splice(fl.i,1);
for(fo=fp+1;
fo<fm;
++fo){e[fo].i--
}}else{fu[fl.i-1]+=fl.x+fu[fl.i+1];
fu.splice(fl.i,2);
for(fo=fp+1;
fo<fm;
++fo){e[fo].i-=2
}}}else{if(fu[fl.i+1]==null){fu[fl.i]=fl.x
}else{fu[fl.i]=fl.x+fu[fl.i+1];
fu.splice(fl.i+1,1);
for(fo=fp+1;
fo<fm;
++fo){e[fo].i--
}}}e.splice(fp,1);
fm--;
fp--
}else{fl.x=d3.interpolateNumber(parseFloat(fn[0]),parseFloat(fl.x))
}}while(fp<fm){fl=e.pop();
if(fu[fl.i+1]==null){fu[fl.i]=fl.x
}else{fu[fl.i]=fl.x+fu[fl.i+1];
fu.splice(fl.i+1,1)
}fm--
}if(fu.length===1){return fu[0]==null?e[0].x:function(){return fq
}
}return function(fv){for(fp=0;
fp<fm;
++fp){fu[(fl=e[fp]).i]=fl.x(fv)
}return fu.join("")
}
};
d3.interpolateTransform=function(fx,fw){var fy=[],fl=[],fp,fo=d3.transform(fx),fn=d3.transform(fw),ft=fo.translate,fs=fn.translate,fm=fo.rotate,e=fn.rotate,fr=fo.skew,fq=fn.skew,fv=fo.scale,fu=fn.scale;
if(ft[0]!=fs[0]||ft[1]!=fs[1]){fy.push("translate(",null,",",null,")");
fl.push({i:1,x:d3.interpolateNumber(ft[0],fs[0])},{i:3,x:d3.interpolateNumber(ft[1],fs[1])})
}else{if(fs[0]||fs[1]){fy.push("translate("+fs+")")
}else{fy.push("")
}}if(fm!=e){if(fm-e>180){e+=360
}else{if(e-fm>180){fm+=360
}}fl.push({i:fy.push(fy.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(fm,e)})
}else{if(e){fy.push(fy.pop()+"rotate("+e+")")
}}if(fr!=fq){fl.push({i:fy.push(fy.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(fr,fq)})
}else{if(fq){fy.push(fy.pop()+"skewX("+fq+")")
}}if(fv[0]!=fu[0]||fv[1]!=fu[1]){fp=fy.push(fy.pop()+"scale(",null,",",null,")");
fl.push({i:fp-4,x:d3.interpolateNumber(fv[0],fu[0])},{i:fp-2,x:d3.interpolateNumber(fv[1],fu[1])})
}else{if(fu[0]!=1||fu[1]!=1){fy.push(fy.pop()+"scale("+fu+")")
}}fp=fl.length;
return function(fA){var fz=-1,fB;
while(++fz<fp){fy[(fB=fl[fz]).i]=fB.x(fA)
}return fy.join("")
}
};
d3.interpolateRgb=function(fl,e){fl=d3.rgb(fl);
e=d3.rgb(e);
var fn=fl.r,fm=fl.g,fq=fl.b,fp=e.r-fn,fo=e.g-fm,fr=e.b-fq;
return function(fs){return"#"+bn(Math.round(fn+fp*fs))+bn(Math.round(fm+fo*fs))+bn(Math.round(fq+fr*fs))
}
};
d3.interpolateHsl=function(fm,e){fm=d3.hsl(fm);
e=d3.hsl(e);
var fr=fm.h,fq=fm.s,fn=fm.l,fp=e.h-fr,fo=e.s-fq,fl=e.l-fn;
if(fp>180){fp-=360
}else{if(fp<-180){fp+=360
}}return function(fs){return aB(fr+fp*fs,fq+fo*fs,fn+fl*fs)+""
}
};
d3.interpolateLab=function(fl,e){fl=d3.lab(fl);
e=d3.lab(e);
var fo=fl.l,fn=fl.a,fm=fl.b,fr=e.l-fo,fq=e.a-fn,fp=e.b-fm;
return function(fs){return ab(fo+fr*fs,fn+fq*fs,fm+fp*fs)+""
}
};
d3.interpolateHcl=function(fm,e){fm=d3.hcl(fm);
e=d3.hcl(e);
var fl=fm.h,fo=fm.c,fq=fm.l,fn=e.h-fl,fp=e.c-fo,fr=e.l-fq;
if(fn>180){fn-=360
}else{if(fn<-180){fn+=360
}}return function(fs){return aO(fl+fn*fs,fo+fp*fs,fq+fr*fs)+""
}
};
d3.interpolateArray=function(fo,fm){var fl=[],fr=[],fn=fo.length,e=fm.length,fq=Math.min(fo.length,fm.length),fp;
for(fp=0;
fp<fq;
++fp){fl.push(d3.interpolate(fo[fp],fm[fp]))
}for(;
fp<fn;
++fp){fr[fp]=fo[fp]
}for(;
fp<e;
++fp){fr[fp]=fm[fp]
}return function(fs){for(fp=0;
fp<fq;
++fp){fr[fp]=fl[fp](fs)
}return fr
}
};
d3.interpolateObject=function(fl,e){var fn={},fo={},fm;
for(fm in fl){if(fm in e){fn[fm]=dr(fm)(fl[fm],e[fm])
}else{fo[fm]=fl[fm]
}}for(fm in e){if(!(fm in fl)){fo[fm]=e[fm]
}}return function(fp){for(fm in fn){fo[fm]=fn[fm](fp)
}return fo
}
};
var dG=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;
d3.interpolators=[d3.interpolateObject,function(fl,e){return e instanceof Array&&d3.interpolateArray(fl,e)
},function(fl,e){return(typeof fl==="string"||typeof e==="string")&&d3.interpolateString(fl+"",e+"")
},function(fl,e){return(typeof e==="string"?S.has(e)||/^(#|rgb\(|hsl\()/.test(e):e instanceof c7||e instanceof dp)&&d3.interpolateRgb(fl,e)
},function(fl,e){return !isNaN(fl=+fl)&&!isNaN(e=+e)&&d3.interpolateNumber(fl,e)
}];
d3.rgb=function(fm,fl,e){return arguments.length===1?fm instanceof c7?cz(fm.r,fm.g,fm.b):am(""+fm,cz,aB):cz(~~fm,~~fl,~~e)
};
c7.prototype.brighter=function(fl){fl=Math.pow(0.7,arguments.length?fl:1);
var fo=this.r,fn=this.g,e=this.b,fm=30;
if(!fo&&!fn&&!e){return cz(fm,fm,fm)
}if(fo&&fo<fm){fo=fm
}if(fn&&fn<fm){fn=fm
}if(e&&e<fm){e=fm
}return cz(Math.min(255,Math.floor(fo/fl)),Math.min(255,Math.floor(fn/fl)),Math.min(255,Math.floor(e/fl)))
};
c7.prototype.darker=function(e){e=Math.pow(0.7,arguments.length?e:1);
return cz(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))
};
c7.prototype.hsl=function(){return ec(this.r,this.g,this.b)
};
c7.prototype.toString=function(){return"#"+bn(this.r)+bn(this.g)+bn(this.b)
};
var S=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});
S.forEach(function(e,fl){S.set(e,am(fl,cz,aB))
});
d3.hsl=function(fm,fl,e){return arguments.length===1?fm instanceof dp?cJ(fm.h,fm.s,fm.l):am(""+fm,ec,cJ):cJ(+fm,+fl,+e)
};
dp.prototype.brighter=function(e){e=Math.pow(0.7,arguments.length?e:1);
return cJ(this.h,this.s,this.l/e)
};
dp.prototype.darker=function(e){e=Math.pow(0.7,arguments.length?e:1);
return cJ(this.h,this.s,e*this.l)
};
dp.prototype.rgb=function(){return aB(this.h,this.s,this.l)
};
dp.prototype.toString=function(){return this.rgb().toString()
};
d3.hcl=function(fl,fm,e){return arguments.length===1?fl instanceof bl?aN(fl.h,fl.c,fl.l):fl instanceof bQ?em(fl.l,fl.a,fl.b):em((fl=cm((fl=d3.rgb(fl)).r,fl.g,fl.b)).l,fl.a,fl.b):aN(+fl,+fm,+e)
};
bl.prototype.brighter=function(e){return aN(this.h,this.c,Math.min(100,this.l+aI*(arguments.length?e:1)))
};
bl.prototype.darker=function(e){return aN(this.h,this.c,Math.max(0,this.l-aI*(arguments.length?e:1)))
};
bl.prototype.rgb=function(){return aO(this.h,this.c,this.l).rgb()
};
bl.prototype.toString=function(){return this.rgb()+""
};
d3.lab=function(fm,fl,e){return arguments.length===1?fm instanceof bQ?bg(fm.l,fm.a,fm.b):fm instanceof bl?aO(fm.l,fm.c,fm.h):cm((fm=d3.rgb(fm)).r,fm.g,fm.b):bg(+fm,+fl,+e)
};
var aI=18;
var aC=0.95047,ay=1,aw=1.08883;
bQ.prototype.brighter=function(e){return bg(Math.min(100,this.l+aI*(arguments.length?e:1)),this.a,this.b)
};
bQ.prototype.darker=function(e){return bg(Math.max(0,this.l-aI*(arguments.length?e:1)),this.a,this.b)
};
bQ.prototype.rgb=function(){return ab(this.l,this.a,this.b)
};
bQ.prototype.toString=function(){return this.rgb()+""
};
var bZ=function(e,fl){return fl.querySelector(e)
},dQ=function(e,fl){return fl.querySelectorAll(e)
},cG=document.documentElement,b=cG.matchesSelector||cG.webkitMatchesSelector||cG.mozMatchesSelector||cG.msMatchesSelector||cG.oMatchesSelector,a=function(fl,e){return b.call(fl,e)
};
if(typeof Sizzle==="function"){bZ=function(e,fl){return Sizzle(e,fl)[0]||null
};
dQ=function(e,fl){return Sizzle.uniqueSort(Sizzle(e,fl))
};
a=Sizzle.matchesSelector
}var cj=[];
d3.selection=function(){return et
};
d3.selection.prototype=cj;
cj.select=function(fp){var fm=[],ft,e,fs,fn;
if(typeof fp!=="function"){fp=t(fp)
}for(var fq=-1,fo=this.length;
++fq<fo;
){fm.push(ft=[]);
ft.parentNode=(fs=this[fq]).parentNode;
for(var fr=-1,fl=fs.length;
++fr<fl;
){if(fn=fs[fr]){ft.push(e=fp.call(fn,fn.__data__,fr));
if(e&&"__data__" in fn){e.__data__=fn.__data__
}}else{ft.push(null)
}}}return cl(fm)
};
cj.selectAll=function(fo){var fl=[],fs,fm;
if(typeof fo!=="function"){fo=bL(fo)
}for(var fp=-1,fn=this.length;
++fp<fn;
){for(var fr=this[fp],fq=-1,e=fr.length;
++fq<e;
){if(fm=fr[fq]){fl.push(fs=cd(fo.call(fm,fm.__data__,fq)));
fs.parentNode=fm
}}}return cl(fl)
};
cj.attr=function(e,fm){if(arguments.length<2){if(typeof e==="string"){var fl=this.node();
e=d3.ns.qualify(e);
return e.local?fl.getAttributeNS(e.space,e.local):fl.getAttribute(e)
}for(fm in e){this.each(aJ(fm,e[fm]))
}return this
}return this.each(aJ(e,fm))
};
cj.classed=function(e,fn){if(arguments.length<2){if(typeof e==="string"){var fm=this.node(),fo=(e=e.trim().split(/^|\s+/g)).length,fl=-1;
if(fn=fm.classList){while(++fl<fo){if(!fn.contains(e[fl])){return false
}}}else{fn=fm.className;
if(fn.baseVal!=null){fn=fn.baseVal
}while(++fl<fo){if(!eq(e[fl]).test(fn)){return false
}}}return true
}for(fn in e){this.each(eh(fn,e[fn]))
}return this
}return this.each(eh(e,fn))
};
cj.style=function(e,fm,fl){var fn=arguments.length;
if(fn<3){if(typeof e!=="string"){if(fn<2){fm=""
}for(fl in e){this.each(dE(fl,e[fl],fm))
}return this
}if(fn<2){return window.getComputedStyle(this.node(),null).getPropertyValue(e)
}fl=""
}return this.each(dE(e,fm,fl))
};
cj.property=function(e,fl){if(arguments.length<2){if(typeof e==="string"){return this.node()[e]
}for(fl in e){this.each(e0(fl,e[fl]))
}return this
}return this.each(e0(e,fl))
};
cj.text=function(e){return arguments.length<1?this.node().textContent:this.each(typeof e==="function"?function(){var fl=e.apply(this,arguments);
this.textContent=fl==null?"":fl
}:e==null?function(){this.textContent=""
}:function(){this.textContent=e
})
};
cj.html=function(e){return arguments.length<1?this.node().innerHTML:this.each(typeof e==="function"?function(){var fl=e.apply(this,arguments);
this.innerHTML=fl==null?"":fl
}:e==null?function(){this.innerHTML=""
}:function(){this.innerHTML=e
})
};
cj.append=function(fl){function e(){return this.appendChild(document.createElementNS(this.namespaceURI,fl))
}function fm(){return this.appendChild(document.createElementNS(fl.space,fl.local))
}fl=d3.ns.qualify(fl);
return this.select(fl.local?fm:e)
};
cj.insert=function(e,fm){function fl(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),bZ(fm,this))
}function fn(){return this.insertBefore(document.createElementNS(e.space,e.local),bZ(fm,this))
}e=d3.ns.qualify(e);
return this.select(e.local?fn:fl)
};
cj.remove=function(){return this.each(function(){var e=this.parentNode;
if(e){e.removeChild(this)
}})
};
cj.data=function(fr,ft){function fp(fG,fy){var fB,fv=fG.length,fx=fy.length,fE=Math.min(fv,fx),fD=Math.max(fv,fx),fI=[],fF=[],fC=[],fw,fu;
if(ft){var fJ=new ae,fH=[],fA,fz=fy.length;
for(fB=-1;
++fB<fv;
){fA=ft.call(fw=fG[fB],fw.__data__,fB);
if(fJ.has(fA)){fC[fz++]=fw
}else{fJ.set(fA,fw)
}fH.push(fA)
}for(fB=-1;
++fB<fx;
){fA=ft.call(fy,fu=fy[fB],fB);
if(fJ.has(fA)){fI[fB]=fw=fJ.get(fA);
fw.__data__=fu;
fF[fB]=fC[fB]=null
}else{fF[fB]=B(fu);
fI[fB]=fC[fB]=null
}fJ.remove(fA)
}for(fB=-1;
++fB<fv;
){if(fJ.has(fH[fB])){fC[fB]=fG[fB]
}}}else{for(fB=-1;
++fB<fE;
){fw=fG[fB];
fu=fy[fB];
if(fw){fw.__data__=fu;
fI[fB]=fw;
fF[fB]=fC[fB]=null
}else{fF[fB]=B(fu);
fI[fB]=fC[fB]=null
}}for(;
fB<fx;
++fB){fF[fB]=B(fy[fB]);
fI[fB]=fC[fB]=null
}for(;
fB<fD;
++fB){fC[fB]=fG[fB];
fF[fB]=fI[fB]=null
}}fF.update=fI;
fF.parentNode=fI.parentNode=fC.parentNode=fG.parentNode;
fq.push(fF);
fn.push(fI);
e.push(fC)
}var fo=-1,fl=this.length,fs,fm;
if(!arguments.length){fr=new Array(fl=(fs=this[0]).length);
while(++fo<fl){if(fm=fs[fo]){fr[fo]=fm.__data__
}}return fr
}var fq=a0([]),fn=cl([]),e=cl([]);
if(typeof fr==="function"){while(++fo<fl){fp(fs=this[fo],fr.call(fs,fs.parentNode.__data__,fo))
}}else{while(++fo<fl){fp(fs=this[fo],fr)
}}fn.enter=function(){return fq
};
fn.exit=function(){return e
};
return fn
};
cj.datum=cj.map=function(e){return arguments.length<1?this.property("__data__"):this.property("__data__",e)
};
cj.filter=function(e){var fm=[],fs,fr,fn;
if(typeof e!=="function"){e=au(e)
}for(var fp=0,fo=this.length;
fp<fo;
fp++){fm.push(fs=[]);
fs.parentNode=(fr=this[fp]).parentNode;
for(var fq=0,fl=fr.length;
fq<fl;
fq++){if((fn=fr[fq])&&e.call(fn,fn.__data__,fq)){fs.push(fn)
}}}return cl(fm)
};
cj.order=function(){for(var fl=-1,e=this.length;
++fl<e;
){for(var fp=this[fl],fm=fp.length-1,fn=fp[fm],fo;
--fm>=0;
){if(fo=fp[fm]){if(fn&&fn!==fo.nextSibling){fn.parentNode.insertBefore(fo,fn)
}fn=fo
}}}return this
};
cj.sort=function(fl){fl=eo.apply(this,arguments);
for(var fm=-1,e=this.length;
++fm<e;
){this[fm].sort(fl)
}return this.order()
};
cj.on=function(fl,fm,e){var fn=arguments.length;
if(fn<3){if(typeof fl!=="string"){if(fn<2){fm=false
}for(e in fl){this.each(j(e,fl[e],fm))
}return this
}if(fn<2){return(fn=this.node()["__on"+fl])&&fn._
}e=false
}return this.each(j(fl,fm,e))
};
cj.each=function(e){return by(this,function(fn,fm,fl){e.call(fn,fn.__data__,fm,fl)
})
};
cj.call=function(e){e.apply(this,(arguments[0]=this,arguments));
return this
};
cj.empty=function(){return !this.node()
};
cj.node=function(fq){for(var fl=0,e=this.length;
fl<e;
fl++){for(var fo=this[fl],fm=0,fp=fo.length;
fm<fp;
fm++){var fn=fo[fm];
if(fn){return fn
}}}return null
};
cj.transition=function(){var fl=[],fm,fp;
for(var fn=-1,e=this.length;
++fn<e;
){fl.push(fm=[]);
for(var fq=this[fn],fo=-1,fr=fq.length;
++fo<fr;
){fm.push((fp=fq[fo])?{node:fp,delay:c1,duration:eA}:null)
}}return er(fl,eI||++eW,Date.now())
};
var et=cl([[document]]);
et[0].parentNode=cG;
d3.select=function(e){return typeof e==="string"?et.select(e):cl([[e]])
};
d3.selectAll=function(e){return typeof e==="string"?et.selectAll(e):cl([cd(e)])
};
var c4=[];
d3.selection.enter=a0;
d3.selection.enter.prototype=c4;
c4.append=cj.append;
c4.insert=cj.insert;
c4.empty=cj.empty;
c4.node=cj.node;
c4.select=function(fp){var fm=[],fu,e,fs,ft,fo;
for(var fq=-1,fn=this.length;
++fq<fn;
){fs=(ft=this[fq]).update;
fm.push(fu=[]);
fu.parentNode=ft.parentNode;
for(var fr=-1,fl=ft.length;
++fr<fl;
){if(fo=ft[fr]){fu.push(fs[fr]=e=fp.call(ft.parentNode,fo.__data__,fr));
e.__data__=fo.__data__
}else{fu.push(null)
}}}return cl(fm)
};
var cC=[],eW=0,eI=0,f=0,ew=250,dh=d3.ease("cubic-in-out"),c1=f,eA=ew,aA=dh;
cC.call=cj.call;
d3.transition=function(e){return arguments.length?eI?e.transition():e:et.transition()
};
d3.transition.prototype=cC;
cC.select=function(fp){var fm=[],ft,e,fn;
if(typeof fp!=="function"){fp=t(fp)
}for(var fq=-1,fo=this.length;
++fq<fo;
){fm.push(ft=[]);
for(var fs=this[fq],fr=-1,fl=fs.length;
++fr<fl;
){if((fn=fs[fr])&&(e=fp.call(fn.node,fn.node.__data__,fr))){if("__data__" in fn.node){e.__data__=fn.node.__data__
}ft.push({node:e,delay:fn.delay,duration:fn.duration})
}else{ft.push(null)
}}}return er(fm,this.id,this.time).ease(this.ease())
};
cC.selectAll=function(fq){var fn=[],fv,e,fo;
if(typeof fq!=="function"){fq=bL(fq)
}for(var fs=-1,fp=this.length;
++fs<fp;
){for(var fu=this[fs],ft=-1,fm=fu.length;
++ft<fm;
){if(fo=fu[ft]){e=fq.call(fo.node,fo.node.__data__,ft);
fn.push(fv=[]);
for(var fr=-1,fl=e.length;
++fr<fl;
){fv.push({node:e[fr],delay:fo.delay,duration:fo.duration})
}}}}return er(fn,this.id,this.time).ease(this.ease())
};
cC.filter=function(e){var fm=[],fs,fr,fn;
if(typeof e!=="function"){e=au(e)
}for(var fp=0,fo=this.length;
fp<fo;
fp++){fm.push(fs=[]);
for(var fr=this[fp],fq=0,fl=fr.length;
fq<fl;
fq++){if((fn=fr[fq])&&e.call(fn.node,fn.node.__data__,fq)){fs.push(fn)
}}}return er(fm,this.id,this.time).ease(this.ease())
};
cC.attr=function(e,fl){if(arguments.length<2){for(fl in e){this.attrTween(fl,di(e[fl],fl))
}return this
}return this.attrTween(e,di(fl,e))
};
cC.attrTween=function(e,fm){function fn(fr,fp){var fq=fm.call(this,fr,fp,this.getAttribute(fl));
return fq===ej?(this.removeAttribute(fl),null):fq&&function(fs){this.setAttribute(fl,fq(fs))
}
}function fo(fr,fp){var fq=fm.call(this,fr,fp,this.getAttributeNS(fl.space,fl.local));
return fq===ej?(this.removeAttributeNS(fl.space,fl.local),null):fq&&function(fs){this.setAttributeNS(fl.space,fl.local,fq(fs))
}
}var fl=d3.ns.qualify(e);
return this.tween("attr."+e,fl.local?fo:fn)
};
cC.style=function(e,fm,fl){var fn=arguments.length;
if(fn<3){if(typeof e!=="string"){if(fn<2){fm=""
}for(fl in e){this.styleTween(fl,di(e[fl],fl),fm)
}return this
}fl=""
}return this.styleTween(e,di(fm,e),fl)
};
cC.styleTween=function(e,fm,fl){if(arguments.length<3){fl=""
}return this.tween("style."+e,function(fp,fn){var fo=fm.call(this,fp,fn,window.getComputedStyle(this,null).getPropertyValue(e));
return fo===ej?(this.style.removeProperty(e),null):fo&&function(fq){this.style.setProperty(e,fo(fq),fl)
}
})
};
cC.text=function(e){return this.tween("text",function(fm,fl){this.textContent=typeof e==="function"?e.call(this,fm,fl):e
})
};
cC.remove=function(){return this.each("end.transition",function(){var e;
if(!this.__transition__&&(e=this.parentNode)){e.removeChild(this)
}})
};
cC.delay=function(e){return by(this,typeof e==="function"?function(fn,fm,fl){fn.delay=e.call(fn=fn.node,fn.__data__,fm,fl)|0
}:(e=e|0,function(fl){fl.delay=e
}))
};
cC.duration=function(e){return by(this,typeof e==="function"?function(fn,fm,fl){fn.duration=Math.max(1,e.call(fn=fn.node,fn.__data__,fm,fl)|0)
}:(e=Math.max(1,e|0),function(fl){fl.duration=e
}))
};
cC.transition=function(){return this.select(O)
};
d3.tween=function(e,fl){function fn(fr,fq,fo){var fp=e.call(this,fr,fq);
return fp==null?fo!=""&&ej:fo!=fp&&fl(fo,fp)
}function fm(fq,fp,fo){return fo!=e&&fl(fo,e)
}return typeof e==="function"?fn:e==null?dY:(e+="",fm)
};
var ej={};
var a8=null,bi,df;
d3.timer=function(fp,e,fo){var fn=false,fm,fl=a8;
if(arguments.length<3){if(arguments.length<2){e=0
}else{if(!isFinite(e)){return
}}fo=Date.now()
}while(fl){if(fl.callback===fp){fl.then=fo;
fl.delay=e;
fn=true;
break
}fm=fl;
fl=fl.next
}if(!fn){a8={callback:fp,then:fo,delay:e,next:a8}
}if(!bi){df=clearTimeout(df);
bi=1;
eR(eS)
}};
d3.timer.flush=function(){var e,fl=Date.now(),fm=a8;
while(fm){e=fl-fm.then;
if(!fm.delay){fm.flush=fm.callback(e)
}fm=fm.next
}c6()
};
var eR=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)
};
d3.mouse=function(e){return an(e,P())
};
var bv=/WebKit/.test(navigator.userAgent)?-1:0;
d3.touches=function(e,fl){if(arguments.length<2){fl=P().touches
}return fl?cd(fl).map(function(fn){var fm=an(e,fn);
fm.identifier=fn.identifier;
return fm
}):[]
};
d3.scale={};
d3.scale.linear=function(){return cw([0,1],[0,1],d3.interpolate,false)
};
d3.scale.log=function(){return el(d3.scale.linear(),dT)
};
var b0=d3.format(".0e");
dT.pow=function(e){return Math.pow(10,e)
};
dW.pow=function(e){return -Math.pow(10,-e)
};
d3.scale.pow=function(){return d9(d3.scale.linear(),1)
};
d3.scale.sqrt=function(){return d3.scale.pow().exponent(0.5)
};
d3.scale.ordinal=function(){return bj([],{t:"range",a:[[]]})
};
d3.scale.category10=function(){return d3.scale.ordinal().range(bs)
};
d3.scale.category20=function(){return d3.scale.ordinal().range(bc)
};
d3.scale.category20b=function(){return d3.scale.ordinal().range(eH)
};
d3.scale.category20c=function(){return d3.scale.ordinal().range(eG)
};
var bs=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];
var bc=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];
var eH=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"];
var eG=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];
d3.scale.quantile=function(){return w([],[])
};
d3.scale.quantize=function(){return b9(0,1,[0,1])
};
d3.scale.threshold=function(){return dO([0.5],[0,1])
};
d3.scale.identity=function(){return cP([0,1])
};
d3.svg={};
d3.svg.arc=function(){function fm(){var fs=fo.apply(this,arguments),fr=fn.apply(this,arguments),fq=fl.apply(this,arguments)+e1,fp=e.apply(this,arguments)+e1,fy=(fp<fq&&(fy=fq,fq=fp,fp=fy),fp-fq),fv=fy<Math.PI?"0":"1",fu=Math.cos(fq),fx=Math.sin(fq),ft=Math.cos(fp),fw=Math.sin(fp);
return fy>=e6?fs?"M0,"+fr+"A"+fr+","+fr+" 0 1,1 0,"+-fr+"A"+fr+","+fr+" 0 1,1 0,"+fr+"M0,"+fs+"A"+fs+","+fs+" 0 1,0 0,"+-fs+"A"+fs+","+fs+" 0 1,0 0,"+fs+"Z":"M0,"+fr+"A"+fr+","+fr+" 0 1,1 0,"+-fr+"A"+fr+","+fr+" 0 1,1 0,"+fr+"Z":fs?"M"+fr*fu+","+fr*fx+"A"+fr+","+fr+" 0 "+fv+",1 "+fr*ft+","+fr*fw+"L"+fs*ft+","+fs*fw+"A"+fs+","+fs+" 0 "+fv+",0 "+fs*fu+","+fs*fx+"Z":"M"+fr*fu+","+fr*fx+"A"+fr+","+fr+" 0 "+fv+",1 "+fr*ft+","+fr*fw+"L0,0Z"
}var fo=aP,fn=bD,fl=dX,e=V;
fm.innerRadius=function(fp){if(!arguments.length){return fo
}fo=H(fp);
return fm
};
fm.outerRadius=function(fp){if(!arguments.length){return fn
}fn=H(fp);
return fm
};
fm.startAngle=function(fp){if(!arguments.length){return fl
}fl=H(fp);
return fm
};
fm.endAngle=function(fp){if(!arguments.length){return e
}e=H(fp);
return fm
};
fm.centroid=function(){var fq=(fo.apply(this,arguments)+fn.apply(this,arguments))/2,fp=(fl.apply(this,arguments)+e.apply(this,arguments))/2+e1;
return[Math.cos(fp)*fq,Math.sin(fp)*fq]
};
return fm
};
var e1=-Math.PI/2,e6=2*Math.PI-0.000001;
d3.svg.line=function(){return c9(d4)
};
var a9=d3.map({linear:e9,"linear-closed":M,"step-before":aG,"step-after":eV,basis:de,"basis-open":aD,"basis-closed":bB,bundle:bC,cardinal:ci,"cardinal-open":a6,"cardinal-closed":r,monotone:bX});
a9.forEach(function(e,fl){fl.key=e;
fl.closed=/-closed$/.test(e)
});
var eO=[0,2/3,1/3,0],eN=[0,1/3,2/3,0],eM=[0,1/6,2/3,1/6];
d3.svg.line.radial=function(){var e=c9(E);
e.radius=e.x,delete e.x;
e.angle=e.y,delete e.y;
return e
};
aG.reverse=eV;
eV.reverse=aG;
d3.svg.area=function(){return fi(d4)
};
d3.svg.area.radial=function(){var e=fi(E);
e.radius=e.x,delete e.x;
e.innerRadius=e.x0,delete e.x0;
e.outerRadius=e.x1,delete e.x1;
e.angle=e.y,delete e.y;
e.startAngle=e.y0,delete e.y0;
e.endAngle=e.y1,delete e.y1;
return e
};
d3.svg.chord=function(){function fp(fx,fv){var fw=ft(this,e,fx,fv),fu=ft(this,fs,fx,fv);
return"M"+fw.p0+fl(fw.r,fw.p1,fw.a1-fw.a0)+(fm(fw,fu)?fo(fw.r,fw.p1,fw.r,fw.p0):fo(fw.r,fw.p1,fu.r,fu.p0)+fl(fu.r,fu.p1,fu.a1-fu.a0)+fo(fu.r,fu.p1,fw.r,fw.p0))+"Z"
}function ft(fx,fA,fB,fy){var fw=fA.call(fx,fB,fy),fz=fq.call(fx,fw,fy),fv=fr.call(fx,fw,fy)+e1,fu=fn.call(fx,fw,fy)+e1;
return{r:fz,a0:fv,a1:fu,p0:[fz*Math.cos(fv),fz*Math.sin(fv)],p1:[fz*Math.cos(fu),fz*Math.sin(fu)]}
}function fm(fv,fu){return fv.a0==fu.a0&&fv.a1==fu.a1
}function fl(fv,fw,fu){return"A"+fv+","+fv+" 0 "+ +(fu>Math.PI)+",1 "+fw
}function fo(fv,fx,fu,fw){return"Q 0,0 "+fw
}var e=W,fs=af,fq=y,fr=dX,fn=V;
fp.radius=function(fu){if(!arguments.length){return fq
}fq=H(fu);
return fp
};
fp.source=function(fu){if(!arguments.length){return e
}e=H(fu);
return fp
};
fp.target=function(fu){if(!arguments.length){return fs
}fs=H(fu);
return fp
};
fp.startAngle=function(fu){if(!arguments.length){return fr
}fr=H(fu);
return fp
};
fp.endAngle=function(fu){if(!arguments.length){return fn
}fn=H(fu);
return fp
};
return fp
};
d3.svg.diagonal=function(){function fl(fs,fp){var ft=fm.call(this,fs,fp),fq=fn.call(this,fs,fp),fo=(ft.y+fq.y)/2,fr=[ft,{x:ft.x,y:fo},{x:fq.x,y:fo},fq];
fr=fr.map(e);
return"M"+fr[0]+"C"+fr[1]+" "+fr[2]+" "+fr[3]
}var fm=W,fn=af,e=l;
fl.source=function(fo){if(!arguments.length){return fm
}fm=H(fo);
return fl
};
fl.target=function(fo){if(!arguments.length){return fn
}fn=H(fo);
return fl
};
fl.projection=function(fo){if(!arguments.length){return e
}e=fo;
return fl
};
return fl
};
d3.svg.diagonal.radial=function(){var fm=d3.svg.diagonal(),e=l,fl=fm.projection;
fm.projection=function(fn){return arguments.length?fl(m(e=fn)):e
};
return fm
};
d3.svg.mouse=d3.mouse;
d3.svg.touches=d3.touches;
d3.svg.symbol=function(){function fm(fo,fn){return(e7.get(fl.call(this,fo,fn))||ba)(e.call(this,fo,fn))
}var fl=al,e=c5;
fm.type=function(fn){if(!arguments.length){return fl
}fl=H(fn);
return fm
};
fm.size=function(fn){if(!arguments.length){return e
}e=H(fn);
return fm
};
return fm
};
var e7=d3.map({circle:ba,cross:function(e){var fl=Math.sqrt(e/5)/2;
return"M"+-3*fl+","+-fl+"H"+-fl+"V"+-3*fl+"H"+fl+"V"+-fl+"H"+3*fl+"V"+fl+"H"+fl+"V"+3*fl+"H"+-fl+"V"+fl+"H"+-3*fl+"Z"
},diamond:function(e){var fl=Math.sqrt(e/(2*bf)),fm=fl*bf;
return"M0,"+-fl+"L"+fm+",0 0,"+fl+" "+-fm+",0Z"
},square:function(e){var fl=Math.sqrt(e)/2;
return"M"+-fl+","+-fl+"L"+fl+","+-fl+" "+fl+","+fl+" "+-fl+","+fl+"Z"
},"triangle-down":function(e){var fm=Math.sqrt(e/a7),fl=fm*a7/2;
return"M0,"+fl+"L"+fm+","+-fl+" "+-fm+","+-fl+"Z"
},"triangle-up":function(e){var fm=Math.sqrt(e/a7),fl=fm*a7/2;
return"M0,"+-fl+"L"+fm+","+fl+" "+-fm+","+fl+"Z"
}});
d3.svg.symbolTypes=e7.keys();
var a7=Math.sqrt(3),bf=Math.tan(30*Math.PI/180);
d3.svg.axis=function(){function fm(fv){fv.each(function(){var fS=d3.select(this);
var fU=fo==null?fn.ticks?fn.ticks.apply(fn,ft):fn.domain():fo,fL=fs==null?fn.tickFormat?fn.tickFormat.apply(fn,ft):String:fs;
var fB=bF(fn,fU,fr),fA=fS.selectAll(".minor").data(fB,String),fO=fA.enter().insert("line","g").attr("class","tick minor").style("opacity",0.000001),fM=d3.transition(fA.exit()).style("opacity",0.000001).remove(),fx=d3.transition(fA).style("opacity",1);
var fQ=fS.selectAll("g").data(fU,String),fI=fQ.enter().insert("g","path").style("opacity",0.000001),fK=d3.transition(fQ.exit()).style("opacity",0.000001).remove(),fD=d3.transition(fQ).style("opacity",1),fw;
var fH=ao(fn),fJ=fS.selectAll(".domain").data([0]),fy=fJ.enter().append("path").attr("class","domain"),fV=d3.transition(fJ);
var fN=fn.copy(),fP=this.__chart__||fN;
this.__chart__=fN;
fI.append("line").attr("class","tick");
fI.append("text");
var fz=fI.select("line"),fT=fD.select("line"),fG=fQ.select("text").text(fL),fC=fI.select("text"),fR=fD.select("text");
switch(fq){case"bottom":fw=dk;
fO.attr("y2",e);
fx.attr("x2",0).attr("y2",e);
fz.attr("y2",fp);
fC.attr("y",Math.max(fp,0)+fu);
fT.attr("x2",0).attr("y2",fp);
fR.attr("x",0).attr("y",Math.max(fp,0)+fu);
fG.attr("dy",".71em").attr("text-anchor","middle");
fV.attr("d","M"+fH[0]+","+fl+"V0H"+fH[1]+"V"+fl);
break;
case"top":fw=dk;
fO.attr("y2",-e);
fx.attr("x2",0).attr("y2",-e);
fz.attr("y2",-fp);
fC.attr("y",-(Math.max(fp,0)+fu));
fT.attr("x2",0).attr("y2",-fp);
fR.attr("x",0).attr("y",-(Math.max(fp,0)+fu));
fG.attr("dy","0em").attr("text-anchor","middle");
fV.attr("d","M"+fH[0]+","+-fl+"V0H"+fH[1]+"V"+-fl);
break;
case"left":fw=dj;
fO.attr("x2",-e);
fx.attr("x2",-e).attr("y2",0);
fz.attr("x2",-fp);
fC.attr("x",-(Math.max(fp,0)+fu));
fT.attr("x2",-fp).attr("y2",0);
fR.attr("x",-(Math.max(fp,0)+fu)).attr("y",0);
fG.attr("dy",".32em").attr("text-anchor","end");
fV.attr("d","M"+-fl+","+fH[0]+"H0V"+fH[1]+"H"+-fl);
break;
case"right":fw=dj;
fO.attr("x2",e);
fx.attr("x2",e).attr("y2",0);
fz.attr("x2",fp);
fC.attr("x",Math.max(fp,0)+fu);
fT.attr("x2",fp).attr("y2",0);
fR.attr("x",Math.max(fp,0)+fu).attr("y",0);
fG.attr("dy",".32em").attr("text-anchor","start");
fV.attr("d","M"+fl+","+fH[0]+"H0V"+fH[1]+"H"+fl);
break
}if(fn.ticks){fI.call(fw,fP);
fD.call(fw,fN);
fK.call(fw,fN);
fO.call(fw,fP);
fx.call(fw,fN);
fM.call(fw,fN)
}else{var fF=fN.rangeBand()/2,fE=function(fW){return fN(fW)+fF
};
fI.call(fw,fE);
fD.call(fw,fE)
}})
}var fn=d3.scale.linear(),fq="bottom",fp=6,e=6,fl=6,fu=3,ft=[10],fo=null,fs,fr=0;
fm.scale=function(fv){if(!arguments.length){return fn
}fn=fv;
return fm
};
fm.orient=function(fv){if(!arguments.length){return fq
}fq=fv;
return fm
};
fm.ticks=function(){if(!arguments.length){return ft
}ft=arguments;
return fm
};
fm.tickValues=function(fv){if(!arguments.length){return fo
}fo=fv;
return fm
};
fm.tickFormat=function(fv){if(!arguments.length){return fs
}fs=fv;
return fm
};
fm.tickSize=function(fv,fy,fw){if(!arguments.length){return fp
}var fx=arguments.length-1;
fp=+fv;
e=fx>1?+fy:fp;
fl=fx>0?+arguments[fx]:fp;
return fm
};
fm.tickPadding=function(fv){if(!arguments.length){return fu
}fu=+fv;
return fm
};
fm.tickSubdivide=function(fv){if(!arguments.length){return fr
}fr=+fv;
return fm
};
return fm
};
d3.svg.brush=function(){function fo(fv){fv.each(function(){var fy=d3.select(this),fx=fy.selectAll(".background").data([0]),fw=fy.selectAll(".extent").data([0]),fA=fy.selectAll(".resize").data(fr,String),fz;
fy.style("pointer-events","all").on("mousedown.brush",fs).on("touchstart.brush",fs);
fx.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");
fw.enter().append("rect").attr("class","extent").style("cursor","move");
fA.enter().append("g").attr("class",function(fB){return"resize "+fB
}).style("cursor",function(fB){return cS[fB]
}).append("rect").attr("x",function(fB){return/[ew]$/.test(fB)?-3:null
}).attr("y",function(fB){return/^[ns]/.test(fB)?-3:null
}).attr("width",6).attr("height",6).style("visibility","hidden");
fA.style("display",fo.empty()?"none":null);
fA.exit().remove();
if(fq){fz=ao(fq);
fx.attr("x",fz[0]).attr("width",fz[1]-fz[0]);
fn(fy)
}if(fp){fz=ao(fp);
fx.attr("y",fz[0]).attr("height",fz[1]-fz[0]);
fm(fy)
}fu(fy)
})
}function fu(fv){fv.selectAll(".resize").attr("transform",function(fw){return"translate("+ft[+/e$/.test(fw)][0]+","+ft[+/^s/.test(fw)][1]+")"
})
}function fn(fv){fv.select(".extent").attr("x",ft[0][0]);
fv.selectAll(".extent,.n>rect,.s>rect").attr("width",ft[1][0]-ft[0][0])
}function fm(fv){fv.select(".extent").attr("y",ft[0][1]);
fv.selectAll(".extent,.e>rect,.w>rect").attr("height",ft[1][1]-ft[0][1])
}function fs(){function fD(){var fP=d3.event.changedTouches;
return fP?d3.touches(fO,fP)[0]:d3.mouse(fO)
}function fE(){if(d3.event.keyCode==32){if(!fG){fM=null;
fN[0]-=ft[1][0];
fN[1]-=ft[1][1];
fG=2
}e3()
}}function fz(){if(d3.event.keyCode==32&&fG==2){fN[0]+=ft[1][0];
fN[1]+=ft[1][1];
fG=0;
e3()
}}function fB(){var fP=fD(),fQ=false;
if(fx){fP[0]+=fx[0];
fP[1]+=fx[1]
}if(!fG){if(d3.event.altKey){if(!fM){fM=[(ft[0][0]+ft[1][0])/2,(ft[0][1]+ft[1][1])/2]
}fN[0]=ft[+(fP[0]<fM[0])][0];
fN[1]=ft[+(fP[1]<fM[1])][1]
}else{fM=null
}}if(fH&&fy(fP,fq,0)){fn(fJ);
fQ=true
}if(fF&&fy(fP,fp,1)){fm(fJ);
fQ=true
}if(fQ){fu(fJ);
fC({type:"brush",mode:fG?"move":"resize"})
}}function fy(fX,fR,fT){var fU=ao(fR),fQ=fU[0],fP=fU[1],fV=fN[fT],fY=ft[1][fT]-ft[0][fT],fS,fW;
if(fG){fQ-=fV;
fP-=fY+fV
}fS=Math.max(fQ,Math.min(fP,fX[fT]));
if(fG){fW=(fS+=fV)+fY
}else{if(fM){fV=Math.max(fQ,Math.min(fP,2*fM[fT]-fS))
}if(fV<fS){fW=fS;
fS=fV
}else{fW=fV
}}if(ft[0][fT]!==fS||ft[1][fT]!==fW){fl=null;
ft[0][fT]=fS;
ft[1][fT]=fW;
return true
}}function fv(){fB();
fJ.style("pointer-events","all").selectAll(".resize").style("display",fo.empty()?"none":null);
d3.select("body").style("cursor",null);
fA.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);
fC({type:"brushend"});
e3()
}var fO=this,fw=d3.select(d3.event.target),fC=e.of(fO,arguments),fJ=d3.select(fO),fL=fw.datum(),fH=!/^(n|s)$/.test(fL)&&fq,fF=!/^(e|w)$/.test(fL)&&fp,fG=fw.classed("extent"),fM,fN=fD(),fx;
var fA=d3.select(window).on("mousemove.brush",fB).on("mouseup.brush",fv).on("touchmove.brush",fB).on("touchend.brush",fv).on("keydown.brush",fE).on("keyup.brush",fz);
if(fG){fN[0]=ft[0][0]-fN[0];
fN[1]=ft[0][1]-fN[1]
}else{if(fL){var fK=+/w$/.test(fL),fI=+/^n/.test(fL);
fx=[ft[1-fK][0]-fN[0],ft[1-fI][1]-fN[1]];
fN[0]=ft[fK][0];
fN[1]=ft[fI][1]
}else{if(d3.event.altKey){fM=fN.slice()
}}}fJ.style("pointer-events","none").selectAll(".resize").style("display",null);
d3.select("body").style("cursor",fw.style("cursor"));
fC({type:"brushstart"});
fB();
e3()
}var e=eK(fo,"brushstart","brush","brushend"),fq=null,fp=null,fr=X[0],ft=[[0,0],[0,0]],fl;
fo.x=function(fv){if(!arguments.length){return fq
}fq=fv;
fr=X[!fq<<1|!fp];
return fo
};
fo.y=function(fv){if(!arguments.length){return fp
}fp=fv;
fr=X[!fq<<1|!fp];
return fo
};
fo.extent=function(fA){var fx,fv,fz,fy,fw;
if(!arguments.length){fA=fl||ft;
if(fq){fx=fA[0][0],fv=fA[1][0];
if(!fl){fx=ft[0][0],fv=ft[1][0];
if(fq.invert){fx=fq.invert(fx),fv=fq.invert(fv)
}if(fv<fx){fw=fx,fx=fv,fv=fw
}}}if(fp){fz=fA[0][1],fy=fA[1][1];
if(!fl){fz=ft[0][1],fy=ft[1][1];
if(fp.invert){fz=fp.invert(fz),fy=fp.invert(fy)
}if(fy<fz){fw=fz,fz=fy,fy=fw
}}}return fq&&fp?[[fx,fz],[fv,fy]]:fq?[fx,fv]:fp&&[fz,fy]
}fl=[[0,0],[0,0]];
if(fq){fx=fA[0],fv=fA[1];
if(fp){fx=fx[0],fv=fv[0]
}fl[0][0]=fx,fl[1][0]=fv;
if(fq.invert){fx=fq(fx),fv=fq(fv)
}if(fv<fx){fw=fx,fx=fv,fv=fw
}ft[0][0]=fx|0,ft[1][0]=fv|0
}if(fp){fz=fA[0],fy=fA[1];
if(fq){fz=fz[1],fy=fy[1]
}fl[0][1]=fz,fl[1][1]=fy;
if(fp.invert){fz=fp(fz),fy=fp(fy)
}if(fy<fz){fw=fz,fz=fy,fy=fw
}ft[0][1]=fz|0,ft[1][1]=fy|0
}return fo
};
fo.clear=function(){fl=null;
ft[0][0]=ft[0][1]=ft[1][0]=ft[1][1]=0;
return fo
};
fo.empty=function(){return fq&&ft[0][0]===ft[1][0]||fp&&ft[0][1]===ft[1][1]
};
return d3.rebind(fo,e,"on")
};
var cS={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};
var X=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];
d3.behavior={};
d3.behavior.drag=function(){function fm(){this.on("mousedown.drag",fl).on("touchstart.drag",fl)
}function fl(){function fw(){var fA=fq.parentNode;
return fx?d3.touches(fA).filter(function(fB){return fB.identifier===fx
})[0]:d3.mouse(fA)
}function fy(){if(!fq.parentNode){return fo()
}var fC=fw(),fB=fC[0]-fr[0],fA=fC[1]-fr[1];
fs|=fB|fA;
fr=fC;
e3();
fv({type:"drag",x:fC[0]+fp[0],y:fC[1]+fp[1],dx:fB,dy:fA})
}function fo(){fv({type:"dragend"});
if(fs){e3();
if(d3.event.target===fu){ft.on("click.drag",fz,true)
}}ft.on(fx?"touchmove.drag-"+fx:"mousemove.drag",null).on(fx?"touchend.drag-"+fx:"mouseup.drag",null)
}function fz(){e3();
ft.on("click.drag",null)
}var fq=this,fv=fn.of(fq,arguments),fu=d3.event.target,fx=d3.event.touches&&d3.event.changedTouches[0].identifier,fp,fr=fw(),fs=0;
var ft=d3.select(window).on(fx?"touchmove.drag-"+fx:"mousemove.drag",fy).on(fx?"touchend.drag-"+fx:"mouseup.drag",fo,true);
if(e){fp=e.apply(fq,arguments);
fp=[fp.x-fr[0],fp.y-fr[1]]
}else{fp=[0,0]
}if(!fx){e3()
}fv({type:"dragstart"})
}var fn=eK(fm,"drag","dragstart","dragend"),e=null;
fm.origin=function(fo){if(!arguments.length){return e
}e=fo;
return fm
};
return d3.rebind(fm,fn,"on")
};
d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",fw).on("mousewheel.zoom",fu).on("mousemove.zoom",fD).on("DOMMouseScroll.zoom",fu).on("dblclick.zoom",fs).on("touchstart.zoom",fB).on("touchmove.zoom",ft).on("touchend.zoom",fB)
}function fl(fH){return[(fH[0]-fr[0])/fG,(fH[1]-fr[1])/fG]
}function fv(fH){return[fH[0]*fG+fr[0],fH[1]*fG+fr[1]]
}function fq(fH){fG=Math.max(fm[0],Math.min(fm[1],fH))
}function fE(fI,fH){fH=fv(fH);
fr[0]+=fI[0]-fH[0];
fr[1]+=fI[1]-fH[1]
}function fF(fH){if(fz){fz.domain(fA.range().map(function(fI){return(fI-fr[0])/fG
}).map(fA.invert))
}if(fn){fn.domain(fo.range().map(function(fI){return(fI-fr[1])/fG
}).map(fo.invert))
}d3.event.preventDefault();
fH({type:"zoom",scale:fG,translate:fr})
}function fw(){function fJ(){fL=1;
fE(d3.mouse(fK),fH);
fF(fN)
}function fI(){if(fL){e3()
}fO.on("mousemove.zoom",null).on("mouseup.zoom",null);
if(fL&&d3.event.target===fM){fO.on("click.zoom",fP,true)
}}function fP(){e3();
fO.on("click.zoom",null)
}var fK=this,fN=fx.of(fK,arguments),fM=d3.event.target,fL=0,fO=d3.select(window).on("mousemove.zoom",fJ).on("mouseup.zoom",fI),fH=fl(d3.mouse(fK));
window.focus();
e3()
}function fu(){if(!fC){fC=fl(d3.mouse(this))
}fq(Math.pow(2,bp()*0.002)*fG);
fE(d3.mouse(this),fC);
fF(fx.of(this,arguments))
}function fD(){fC=null
}function fs(){var fI=d3.mouse(this),fH=fl(fI);
fq(d3.event.shiftKey?fG/2:fG*2);
fE(fI,fH);
fF(fx.of(this,arguments))
}function fB(){var fK=d3.touches(this),fI=Date.now();
fy=fG;
fC={};
fK.forEach(function(fL){fC[fL.identifier]=fl(fL)
});
e3();
if(fK.length===1){if(fI-fp<500){var fJ=fK[0],fH=fl(fK[0]);
fq(fG*2);
fE(fJ,fH);
fF(fx.of(this,arguments))
}fp=fI
}}function ft(){var fJ=d3.touches(this),fL=fJ[0],fI=fC[fL.identifier];
if(fK=fJ[1]){var fK,fH=fC[fK.identifier];
fL=[(fL[0]+fK[0])/2,(fL[1]+fK[1])/2];
fI=[(fI[0]+fH[0])/2,(fI[1]+fH[1])/2];
fq(d3.event.scale*fy)
}fE(fL,fI);
fp=null;
fF(fx.of(this,arguments))
}var fr=[0,0],fC,fG=1,fy,fm=dJ,fx=eK(e,"zoom"),fA,fz,fo,fn,fp;
e.translate=function(fH){if(!arguments.length){return fr
}fr=fH.map(Number);
return e
};
e.scale=function(fH){if(!arguments.length){return fG
}fG=+fH;
return e
};
e.scaleExtent=function(fH){if(!arguments.length){return fm
}fm=fH==null?dJ:fH.map(Number);
return e
};
e.x=function(fH){if(!arguments.length){return fz
}fz=fH;
fA=fH.copy();
return e
};
e.y=function(fH){if(!arguments.length){return fn
}fn=fH;
fo=fH.copy();
return e
};
return d3.rebind(e,fx,"on")
};
var cp,dJ=[0,Infinity];
d3.layout={};
d3.layout.bundle=function(){return function(e){var fm=[],fl=-1,fn=e.length;
while(++fl<fn){fm.push(cL(e[fl]))
}return fm
}
};
d3.layout.chord=function(){function ft(){var fz={},fC=[],fK=d3.range(fm),fG=[],fA,fI,fy,fD,fB;
fq=[];
fn=[];
fA=0,fD=-1;
while(++fD<fm){fI=0,fB=-1;
while(++fB<fm){fI+=fu[fD][fB]
}fC.push(fI);
fG.push(d3.range(fm));
fA+=fI
}if(e){fK.sort(function(fM,fL){return e(fC[fM],fC[fL])
})
}if(fl){fG.forEach(function(fM,fL){fM.sort(function(fO,fN){return fl(fu[fL][fO],fu[fL][fN])
})
})
}fA=(2*Math.PI-fs*fm)/fA;
fI=0,fD=-1;
while(++fD<fm){fy=fI,fB=-1;
while(++fB<fm){var fH=fK[fD],fF=fG[fH][fB],fJ=fu[fH][fF],fx=fI,fw=fI+=fJ*fA;
fz[fH+"-"+fF]={index:fH,subindex:fF,startAngle:fx,endAngle:fw,value:fJ}
}fn[fH]={index:fH,startAngle:fy,endAngle:fI,value:(fI-fy)/fA};
fI+=fs
}fD=-1;
while(++fD<fm){fB=fD-1;
while(++fB<fm){var fv=fz[fD+"-"+fB],fE=fz[fB+"-"+fD];
if(fv.value||fE.value){fq.push(fv.value<fE.value?{source:fE,target:fv}:{source:fv,target:fE})
}}}if(fo){fr()
}}function fr(){fq.sort(function(fw,fv){return fo((fw.source.value+fw.target.value)/2,(fv.source.value+fv.target.value)/2)
})
}var fp={},fq,fn,fu,fm,fs=0,e,fl,fo;
fp.matrix=function(fv){if(!arguments.length){return fu
}fm=(fu=fv)&&fu.length;
fq=fn=null;
return fp
};
fp.padding=function(fv){if(!arguments.length){return fs
}fs=fv;
fq=fn=null;
return fp
};
fp.sortGroups=function(fv){if(!arguments.length){return e
}e=fv;
fq=fn=null;
return fp
};
fp.sortSubgroups=function(fv){if(!arguments.length){return fl
}fl=fv;
fq=null;
return fp
};
fp.sortChords=function(fv){if(!arguments.length){return fo
}fo=fv;
if(fq){fr()
}return fp
};
fp.chords=function(){if(!fq){ft()
}return fq
};
fp.groups=function(){if(!fn){ft()
}return fn
};
return fp
};
d3.layout.force=function(){function fz(fD){return function(fK,fF,fJ,fE,fI){if(fK.point!==fD){var fM=fK.cx-fD.x,fL=fK.cy-fD.y,fH=1/Math.sqrt(fM*fM+fL*fL);
if((fE-fF)*fH<fs){var fG=fK.charge*fH*fH;
fD.px-=fM*fG;
fD.py-=fL*fG;
return true
}if(fK.point&&isFinite(fH)){var fG=fK.pointCharge*fH*fH;
fD.px-=fM*fG;
fD.py-=fL*fG
}}return !fK.charge
}
}function fv(fD){fD.px=d3.event.x;
fD.py=d3.event.y;
fl.resume()
}var fl={},fy=d3.dispatch("start","tick","end"),fu=[1,1],fA,fo,fr=0.9,fC=dF,fn=bk,fx=-30,fp=0.1,fs=0.8,fB,fw=[],fm=[],fq,e,ft;
fl.tick=function(){if((fo*=0.99)<0.005){fy.end({type:"end",alpha:fo=0});
return true
}var fF=fw.length,fG=fm.length,fD,fJ,fE,fN,fM,fH,fI,fL,fK;
for(fJ=0;
fJ<fG;
++fJ){fE=fm[fJ];
fN=fE.source;
fM=fE.target;
fL=fM.x-fN.x;
fK=fM.y-fN.y;
if(fH=fL*fL+fK*fK){fH=fo*e[fJ]*((fH=Math.sqrt(fH))-fq[fJ])/fH;
fL*=fH;
fK*=fH;
fM.x-=fL*(fI=fN.weight/(fM.weight+fN.weight));
fM.y-=fK*fI;
fN.x+=fL*(fI=1-fI);
fN.y+=fK*fI
}}if(fI=fo*fp){fL=fu[0]/2;
fK=fu[1]/2;
fJ=-1;
if(fI){while(++fJ<fF){fE=fw[fJ];
fE.x+=(fL-fE.x)*fI;
fE.y+=(fK-fE.y)*fI
}}}if(fx){ee(fD=d3.geom.quadtree(fw),fo,ft);
fJ=-1;
while(++fJ<fF){if(!(fE=fw[fJ]).fixed){fD.visit(fz(fE))
}}}fJ=-1;
while(++fJ<fF){fE=fw[fJ];
if(fE.fixed){fE.x=fE.px;
fE.y=fE.py
}else{fE.x-=(fE.px-(fE.px=fE.x))*fr;
fE.y-=(fE.py-(fE.py=fE.y))*fr
}}fy.tick({type:"tick",alpha:fo})
};
fl.nodes=function(fD){if(!arguments.length){return fw
}fw=fD;
return fl
};
fl.links=function(fD){if(!arguments.length){return fm
}fm=fD;
return fl
};
fl.size=function(fD){if(!arguments.length){return fu
}fu=fD;
return fl
};
fl.linkDistance=function(fD){if(!arguments.length){return fC
}fC=H(fD);
return fl
};
fl.distance=fl.linkDistance;
fl.linkStrength=function(fD){if(!arguments.length){return fn
}fn=H(fD);
return fl
};
fl.friction=function(fD){if(!arguments.length){return fr
}fr=fD;
return fl
};
fl.charge=function(fD){if(!arguments.length){return fx
}fx=typeof fD==="function"?fD:+fD;
return fl
};
fl.gravity=function(fD){if(!arguments.length){return fp
}fp=fD;
return fl
};
fl.theta=function(fD){if(!arguments.length){return fs
}fs=fD;
return fl
};
fl.alpha=function(fD){if(!arguments.length){return fo
}if(fo){if(fD>0){fo=fD
}else{fo=0
}}else{if(fD>0){fy.start({type:"start",alpha:fo=fD});
d3.timer(fl.tick)
}}return fl
};
fl.start=function(){function fJ(fS,fR){var fQ=fL(fH),fP=-1,fO=fQ.length,fN;
while(++fP<fO){if(!isNaN(fN=fQ[fP][fS])){return fN
}}return Math.random()*fR
}function fL(){if(!fM){fM=[];
for(fG=0;
fG<fE;
++fG){fM[fG]=[]
}for(fG=0;
fG<fF;
++fG){var fN=fm[fG];
fM[fN.source.index].push(fN.target);
fM[fN.target.index].push(fN.source)
}}return fM[fH]
}var fH,fG,fE=fw.length,fF=fm.length,fK=fu[0],fI=fu[1],fM,fD;
for(fH=0;
fH<fE;
++fH){(fD=fw[fH]).index=fH;
fD.weight=0
}fq=[];
e=[];
for(fH=0;
fH<fF;
++fH){fD=fm[fH];
if(typeof fD.source=="number"){fD.source=fw[fD.source]
}if(typeof fD.target=="number"){fD.target=fw[fD.target]
}fq[fH]=fC.call(this,fD,fH);
e[fH]=fn.call(this,fD,fH);
++fD.source.weight;
++fD.target.weight
}for(fH=0;
fH<fE;
++fH){fD=fw[fH];
if(isNaN(fD.x)){fD.x=fJ("x",fK)
}if(isNaN(fD.y)){fD.y=fJ("y",fI)
}if(isNaN(fD.px)){fD.px=fD.x
}if(isNaN(fD.py)){fD.py=fD.y
}}ft=[];
if(typeof fx==="function"){for(fH=0;
fH<fE;
++fH){ft[fH]=+fx.call(this,fw[fH],fH)
}}else{for(fH=0;
fH<fE;
++fH){ft[fH]=fx
}}return fl.resume()
};
fl.resume=function(){return fl.alpha(0.1)
};
fl.stop=function(){return fl.alpha(0)
};
fl.drag=function(){if(!fA){fA=d3.behavior.drag().origin(d4).on("dragstart",p).on("drag",fv).on("dragend",cu)
}this.on("mouseover.force",bo).on("mouseout.force",cx).call(fA)
};
return d3.rebind(fl,fy,"on")
};
d3.layout.partition=function(){function e(fr,fv,fx,fw){var fp=fr.children;
fr.x=fv;
fr.y=fr.depth*fw;
fr.dx=fx;
fr.dy=fw;
if(fp&&(fq=fp.length)){var fs=-1,fq,fu,ft;
fx=fr.value?fx/fr.value:0;
while(++fs<fq){e(fu=fp[fs],fv,ft=fu.value*fx,fw);
fv+=ft
}}}function fo(fr){var fq=fr.children,fs=0;
if(fq&&(ft=fq.length)){var fp=-1,ft;
while(++fp<ft){fs=Math.max(fs,fo(fq[fp]))
}}return 1+fs
}function fm(fr,fq){var fp=fl.call(this,fr,fq);
e(fp[0],0,fn[0],fn[1]/fo(fp[0]));
return fp
}var fl=d3.layout.hierarchy(),fn=[1,1];
fm.size=function(fp){if(!arguments.length){return fn
}fn=fp;
return fm
};
return ea(fm,fl)
};
d3.layout.pie=function(){function e(fv,ft){var fr=fv.map(function(fx,fw){return +fo.call(e,fx,fw)
});
var fp=+(typeof fm==="function"?fm.apply(this,arguments):fm);
var fq=((typeof fl==="function"?fl.apply(this,arguments):fl)-fm)/d3.sum(fr);
var fs=d3.range(fv.length);
if(fn!=null){fs.sort(fn===K?function(fx,fw){return fr[fw]-fr[fx]
}:function(fx,fw){return fn(fv[fx],fv[fw])
})
}var fu=[];
fs.forEach(function(fw){var fx;
fu[fw]={data:fv[fw],value:fx=fr[fw],startAngle:fp,endAngle:fp+=fx*fq}
});
return fu
}var fo=Number,fn=K,fm=0,fl=2*Math.PI;
e.value=function(fp){if(!arguments.length){return fo
}fo=fp;
return e
};
e.sort=function(fp){if(!arguments.length){return fn
}fn=fp;
return e
};
e.startAngle=function(fp){if(!arguments.length){return fm
}fm=fp;
return e
};
e.endAngle=function(fp){if(!arguments.length){return fl
}fl=fp;
return e
};
return e
};
var K={};
d3.layout.stack=function(){function fm(fy,fA){var fz=fy.map(function(fD,fC){return fn.call(fm,fD,fC)
});
var fB=fz.map(function(fD,fC){return fD.map(function(fE,fF){return[e.call(fm,fE,fF),fq.call(fm,fE,fF)]
})
});
var fv=fl.call(fm,fB,fA);
fz=d3.permute(fz,fv);
fB=d3.permute(fB,fv);
var fu=fp.call(fm,fB,fA);
var fs=fz.length,ft=fz[0].length,fx,fw,fr;
for(fw=0;
fw<ft;
++fw){fo.call(fm,fz[0][fw],fr=fu[fw],fB[0][fw][1]);
for(fx=1;
fx<fs;
++fx){fo.call(fm,fz[fx][fw],fr+=fB[fx-1][fw][1],fB[fx][fw][1])
}}return fy
}var fn=d4,fl=aX,fp=dy,fo=dz,e=U,fq=T;
fm.values=function(fr){if(!arguments.length){return fn
}fn=fr;
return fm
};
fm.order=function(fr){if(!arguments.length){return fl
}fl=typeof fr==="function"?fr:at.get(fr)||aX;
return fm
};
fm.offset=function(fr){if(!arguments.length){return fp
}fp=typeof fr==="function"?fr:Q.get(fr)||dy;
return fm
};
fm.x=function(fr){if(!arguments.length){return e
}e=fr;
return fm
};
fm.y=function(fr){if(!arguments.length){return fq
}fq=fr;
return fm
};
fm.out=function(fr){if(!arguments.length){return fo
}fo=fr;
return fm
};
return fm
};
var at=d3.map({"inside-out":function(fo){var fm=fo.length,fp,fn,ft=fo.map(a2),fq=fo.map(b2),fr=d3.range(fm).sort(function(fw,fv){return ft[fw]-ft[fv]
}),fs=0,e=0,fu=[],fl=[];
for(fp=0;
fp<fm;
++fp){fn=fr[fp];
if(fs<e){fs+=fq[fn];
fu.push(fn)
}else{e+=fq[fn];
fl.push(fn)
}}return fl.reverse().concat(fu)
},reverse:function(e){return d3.range(e.length).reverse()
},"default":aX});
var Q=d3.map({silhouette:function(fo){var fl=fo.length,fm=fo[0].length,fq=[],fr=0,fp,fn,e,fs=[];
for(fn=0;
fn<fm;
++fn){for(fp=0,e=0;
fp<fl;
fp++){e+=fo[fp][fn][1]
}if(e>fr){fr=e
}fq.push(e)
}for(fn=0;
fn<fm;
++fn){fs[fn]=(fr-fq[fn])/2
}return fs
},wiggle:function(fq){var fl=fq.length,fu=fq[0],fm=fu.length,fs=0,fr,fp,fo,fx,fw,ft,fy,e,fn,fv=[];
fv[0]=e=fn=0;
for(fp=1;
fp<fm;
++fp){for(fr=0,fx=0;
fr<fl;
++fr){fx+=fq[fr][fp][1]
}for(fr=0,fw=0,fy=fu[fp][0]-fu[fp-1][0];
fr<fl;
++fr){for(fo=0,ft=(fq[fr][fp][1]-fq[fr][fp-1][1])/(2*fy);
fo<fr;
++fo){ft+=(fq[fo][fp][1]-fq[fo][fp-1][1])/fy
}fw+=ft*fq[fr][fp][1]
}fv[fp]=e-=fx?fw/fx*fy:0;
if(e<fn){fn=e
}}for(fp=0;
fp<fm;
++fp){fv[fp]-=fn
}return fv
},expand:function(fp){var fr=fp.length,e=fp[0].length,fl=1/fr,fn,fm,fq,fo=[];
for(fm=0;
fm<e;
++fm){for(fn=0,fq=0;
fn<fr;
fn++){fq+=fp[fn][fm][1]
}if(fq){for(fn=0;
fn<fr;
fn++){fp[fn][fm][1]/=fq
}}else{for(fn=0;
fn<fr;
fn++){fp[fn][fm][1]=fl
}}}for(fm=0;
fm<e;
++fm){fo[fm]=0
}return fo
},zero:dy});
d3.layout.histogram=function(){function fo(fs,ft){var fy=[],fw=fs.map(fl,this),fu=e.call(this,fw,ft),fx=fm.call(this,fu,fw,ft),fz,ft=-1,fp=fw.length,fq=fx.length-1,fr=fn?1:1/fp,fv;
while(++ft<fq){fz=fy[ft]=[];
fz.dx=fx[ft+1]-(fz.x=fx[ft]);
fz.y=0
}if(fq>0){ft=-1;
while(++ft<fp){fv=fw[ft];
if(fv>=fu[0]&&fv<=fu[1]){fz=fy[d3.bisect(fx,fv,1,fq)-1];
fz.y+=fr;
fz.push(fs[ft])
}}}return fy
}var fn=true,fl=Number,e=aE,fm=eU;
fo.value=function(fp){if(!arguments.length){return fl
}fl=fp;
return fo
};
fo.range=function(fp){if(!arguments.length){return e
}e=H(fp);
return fo
};
fo.bins=function(fp){if(!arguments.length){return fm
}fm=typeof fp==="number"?function(fq){return g(fq,fp)
}:H(fp);
return fo
};
fo.frequency=function(fp){if(!arguments.length){return fn
}fn=!!fp;
return fo
};
return fo
};
d3.layout.hierarchy=function(){function fn(fv,fu,fq){var fy=fl.call(e,fv,fu),fs=h?fv:{data:fv};
fs.depth=fu;
fq.push(fs);
if(fy&&(fr=fy.length)){var fw=-1,fr,fz=fs.children=[],fA=0,ft=fu+1,fx;
while(++fw<fr){fx=fn(fy[fw],ft,fq);
fx.parent=fs;
fz.push(fx);
fA+=fx.value
}if(fm){fz.sort(fm)
}if(fo){fs.value=fA
}}else{if(fo){fs.value=+fo.call(e,fv,fu)||0
}}return fs
}function fp(fu,fv){var ft=fu.children,fq=0;
if(ft&&(fw=ft.length)){var fs=-1,fw,fr=fv+1;
while(++fs<fw){fq+=fp(ft[fs],fr)
}}else{if(fo){fq=+fo.call(e,h?fu:fu.data,fv)||0
}}if(fo){fu.value=fq
}return fq
}function e(fr){var fq=[];
fn(fr,0,fq);
return fq
}var fm=cg,fl=av,fo=e5;
e.sort=function(fq){if(!arguments.length){return fm
}fm=fq;
return e
};
e.children=function(fq){if(!arguments.length){return fl
}fl=fq;
return e
};
e.value=function(fq){if(!arguments.length){return fo
}fo=fq;
return e
};
e.revalue=function(fq){fp(fq,0);
return fq
};
return e
};
var h=false;
d3.layout.pack=function(){function fm(fv,fs){var fr=e.call(this,fv,fs),fp=fr[0];
fp.x=0;
fp.y=0;
eZ(fp,function(fw){fw.r=Math.sqrt(fw.value)
});
eZ(fp,J);
var fo=fl[0],ft=fl[1],fq=Math.max(2*fp.r/fo,2*fp.r/ft);
if(fn>0){var fu=fn*fq/2;
eZ(fp,function(fw){fw.r+=fu
});
eZ(fp,J);
eZ(fp,function(fw){fw.r-=fu
});
fq=Math.max(2*fp.r/fo,2*fp.r/ft)
}dl(fp,fo/2,ft/2,1/fq);
return fr
}var e=d3.layout.hierarchy().sort(cF),fn=0,fl=[1,1];
fm.size=function(fo){if(!arguments.length){return fl
}fl=fo;
return fm
};
fm.padding=function(fo){if(!arguments.length){return fn
}fn=+fo;
return fm
};
return ea(fm,e)
};
d3.layout.cluster=function(){function e(fv,fs){var fo=fl.call(this,fv,fs),fw=fo[0],fx,fy=0,fu,ft;
eZ(fw,function(fB){var fA=fB.children;
if(fA&&fA.length){fB.x=aL(fA);
fB.y=aK(fA)
}else{fB.x=fx?fy+=fn(fB,fx):0;
fB.y=0;
fx=fB
}});
var fr=cH(fw),fz=ca(fw),fq=fr.x-fn(fr,fz)/2,fp=fz.x+fn(fz,fr)/2;
eZ(fw,function(fA){fA.x=(fA.x-fq)/(fp-fq)*fm[0];
fA.y=(1-(fw.y?fA.y/fw.y:1))*fm[1]
});
return fo
}var fl=d3.layout.hierarchy().sort(null).value(null),fn=b4,fm=[1,1];
e.separation=function(fo){if(!arguments.length){return fn
}fn=fo;
return e
};
e.size=function(fo){if(!arguments.length){return fm
}fm=fo;
return e
};
return ea(e,fl)
};
d3.layout.tree=function(){function e(fv,ft){function fu(fF,fB){var fD=fF.children,fI=fF._tree;
if(fD&&(fE=fD.length)){var fE,fK=fD[0],fJ,fH=fK,fC,fG=-1;
while(++fG<fE){fC=fD[fG];
fu(fC,fJ);
fH=fo(fC,fJ,fH);
fJ=fC
}b6(fF);
var fL=0.5*(fK._tree.prelim+fC._tree.prelim);
if(fB){fI.prelim=fB._tree.prelim+fn(fF,fB);
fI.mod=fI.prelim-fL
}else{fI.prelim=fL
}}else{if(fB){fI.prelim=fB._tree.prelim+fn(fF,fB)
}}}function fw(fE,fB){fE.x=fE._tree.prelim+fB;
var fD=fE.children;
if(fD&&(fF=fD.length)){var fC=-1,fF;
fB+=fE._tree.mod;
while(++fC<fF){fw(fD[fC],fB)
}}}function fo(fF,fB,fI){if(fB){var fE=fF,fD=fF,fH=fB,fG=fF.parent.children[0],fK=fE._tree.mod,fJ=fD._tree.mod,fM=fH._tree.mod,fL=fG._tree.mod,fC;
while(fH=aa(fH),fE=fb(fE),fH&&fE){fG=fb(fG);
fD=aa(fD);
fD._tree.ancestor=fF;
fC=fH._tree.prelim+fM-fE._tree.prelim-fK+fn(fH,fE);
if(fC>0){fe(dL(fH,fF,fI),fF,fC);
fK+=fC;
fJ+=fC
}fM+=fH._tree.mod;
fK+=fE._tree.mod;
fL+=fG._tree.mod;
fJ+=fD._tree.mod
}if(fH&&!aa(fD)){fD._tree.thread=fH;
fD._tree.mod+=fM-fJ
}if(fE&&!fb(fG)){fG._tree.thread=fE;
fG._tree.mod+=fK-fL;
fI=fF
}}return fI
}var fp=fl.call(this,fv,ft),fx=fp[0];
eZ(fx,function(fC,fB){fC._tree={ancestor:fC,prelim:0,mod:0,change:0,shift:0,number:fB?fB._tree.number+1:0}
});
fu(fx);
fw(fx,-fx._tree.prelim);
var fs=co(fx,aR),fA=co(fx,bJ),fz=co(fx,x),fr=fs.x-fn(fs,fA)/2,fq=fA.x+fn(fA,fs)/2,fy=fz.depth||1;
eZ(fx,function(fB){fB.x=(fB.x-fr)/(fq-fr)*fm[0];
fB.y=fB.depth/fy*fm[1];
delete fB._tree
});
return fp
}var fl=d3.layout.hierarchy().sort(null).value(null),fn=b4,fm=[1,1];
e.separation=function(fo){if(!arguments.length){return fn
}fn=fo;
return e
};
e.size=function(fo){if(!arguments.length){return fm
}fm=fo;
return e
};
return ea(e,fl)
};
d3.layout.treemap=function(){function fl(fA,fy){var fz=-1,fD=fA.length,fC,fB;
while(++fz<fD){fB=(fC=fA[fz]).value*(fy<0?0:fy);
fC.area=isNaN(fB)||fB<=0?0:fB
}}function fm(fC){var fz=fC.children;
if(fz&&fz.length){var fF=e(fC),fH=[],fE=fz.slice(),fy,fD=Infinity,fB,fG=Math.min(fF.dx,fF.dy),fA;
fl(fE,fF.dx*fF.dy/fC.value);
fH.area=0;
while((fA=fE.length)>0){fH.push(fy=fE[fA-1]);
fH.area+=fy.area;
if((fB=fn(fH,fG))<=fD){fE.pop();
fD=fB
}else{fH.area-=fH.pop().area;
fo(fH,fG,fF,false);
fG=Math.min(fF.dx,fF.dy);
fH.length=fH.area=0;
fD=Infinity
}}if(fH.length){fo(fH,fG,fF,true);
fH.length=fH.area=0
}fz.forEach(fm)
}}function fx(fB){var fy=fB.children;
if(fy&&fy.length){var fA=e(fB),fz=fy.slice(),fD,fC=[];
fl(fz,fA.dx*fA.dy/fB.value);
fC.area=0;
while(fD=fz.pop()){fC.push(fD);
fC.area+=fD.area;
if(fD.z!=null){fo(fC,fD.z?fA.dx:fA.dy,fA,!fz.length);
fC.length=fC.area=0
}}fy.forEach(fx)
}}function fn(fD,fz){var fB=fD.area,fC,fF=0,fy=Infinity,fA=-1,fE=fD.length;
while(++fA<fE){if(!(fC=fD[fA].area)){continue
}if(fC<fy){fy=fC
}if(fC>fF){fF=fC
}}fB*=fB;
fz*=fz;
return fB?Math.max(fz*fF*fq/fB,fB/(fz*fy*fq)):Infinity
}function fo(fH,fG,fC,fF){var fA=-1,fz=fH.length,fD=fC.x,fB=fC.y,fE=fG?fv(fH.area/fG):0,fy;
if(fG==fC.dx){if(fF||fE>fC.dy){fE=fC.dy
}while(++fA<fz){fy=fH[fA];
fy.x=fD;
fy.y=fB;
fy.dy=fE;
fD+=fy.dx=Math.min(fC.x+fC.dx-fD,fE?fv(fy.area/fE):0)
}fy.z=true;
fy.dx+=fC.x+fC.dx-fD;
fC.y+=fE;
fC.dy-=fE
}else{if(fF||fE>fC.dx){fE=fC.dx
}while(++fA<fz){fy=fH[fA];
fy.x=fD;
fy.y=fB;
fy.dx=fE;
fB+=fy.dy=Math.min(fC.y+fC.dy-fB,fE?fv(fy.area/fE):0)
}fy.z=false;
fy.dy+=fC.y+fC.dy-fB;
fC.x+=fE;
fC.dx-=fE
}}function fu(fA){var fz=fp||fr(fA),fy=fz[0];
fy.x=0;
fy.y=0;
fy.dx=fw[0];
fy.dy=fw[1];
if(fp){fr.revalue(fy)
}fl([fy],fy.dx*fy.dy/fy.value);
(fp?fx:fm)(fy);
if(ft){fp=fz
}return fz
}var fr=d3.layout.hierarchy(),fv=Math.round,fw=[1,1],fs=null,e=c8,ft=false,fp,fq=0.5*(1+Math.sqrt(5));
fu.size=function(fy){if(!arguments.length){return fw
}fw=fy;
return fu
};
fu.padding=function(fy){function fB(fC){var fD=fy.call(fu,fC,fC.depth);
return fD==null?c8(fC):ap(fC,typeof fD==="number"?[fD,fD,fD,fD]:fD)
}function fA(fC){return ap(fC,fy)
}if(!arguments.length){return fs
}var fz;
e=(fs=fy)==null?c8:(fz=typeof fy)==="function"?fB:fz==="number"?(fy=[fy,fy,fy,fy],fA):fA;
return fu
};
fu.round=function(fy){if(!arguments.length){return fv!=Number
}fv=fy?Math.round:Number;
return fu
};
fu.sticky=function(fy){if(!arguments.length){return ft
}ft=fy;
fp=null;
return fu
};
fu.ratio=function(fy){if(!arguments.length){return fq
}fq=fy;
return fu
};
return ea(fu,fr)
};
d3.csv=cI(",","text/csv");
d3.tsv=cI("	","text/tab-separated-values");
d3.geo={};
var cN=Math.PI/180;
d3.geo.azimuthal=function(){function fm(fE){var fu=fE[0]*cN-e,fD=fE[1]*cN,fy=Math.cos(fu),ft=Math.sin(fu),fw=Math.cos(fD),fC=Math.sin(fD),fv=fp!=="orthographic"?fq*fC+fo*fw*fy:null,fz,fx=fp==="stereographic"?1/(1+fv):fp==="gnomonic"?1/fv:fp==="equidistant"?(fz=Math.acos(fv),fz?fz/Math.sin(fz):0):fp==="equalarea"?Math.sqrt(2/(1+fv)):1,fB=fx*fw*ft,fA=fx*(fq*fw*fy-fo*fC);
return[fn*fB+fl[0],fn*fA+fl[1]]
}var fp="orthographic",fs,fn=200,fl=[480,250],e,fr,fo,fq;
fm.invert=function(fw){var ft=(fw[0]-fl[0])/fn,fz=(fw[1]-fl[1])/fn,fu=Math.sqrt(ft*ft+fz*fz),fy=fp==="stereographic"?2*Math.atan(fu):fp==="gnomonic"?Math.atan(fu):fp==="equidistant"?fu:fp==="equalarea"?2*Math.asin(0.5*fu):Math.asin(fu),fv=Math.sin(fy),fx=Math.cos(fy);
return[(e+Math.atan2(ft*fv,fu*fo*fx+fz*fq*fv))/cN,Math.asin(fx*fq-(fu?fz*fv*fo/fu:0))/cN]
};
fm.mode=function(ft){if(!arguments.length){return fp
}fp=ft+"";
return fm
};
fm.origin=function(ft){if(!arguments.length){return fs
}fs=ft;
e=fs[0]*cN;
fr=fs[1]*cN;
fo=Math.cos(fr);
fq=Math.sin(fr);
return fm
};
fm.scale=function(ft){if(!arguments.length){return fn
}fn=+ft;
return fm
};
fm.translate=function(ft){if(!arguments.length){return fl
}fl=[+ft[0],+ft[1]];
return fm
};
return fm.origin([0,0])
};
d3.geo.albers=function(){function fm(fw){var fu=fn*(cN*fw[0]-fr),fv=Math.sqrt(fl-2*fn*Math.sin(cN*fw[1]))/fn;
return[fp*fv*Math.sin(fu)+fo[0],fp*(fv*Math.cos(fu)-ft)+fo[1]]
}function e(){var fv=cN*fq[0],fu=cN*fq[1],fy=cN*fs[1],fw=Math.sin(fv),fx=Math.cos(fv);
fr=cN*fs[0];
fn=0.5*(fw+Math.sin(fu));
fl=fx*fx+2*fn*fw;
ft=Math.sqrt(fl-2*fn*Math.sin(fy))/fn;
return fm
}var fs=[-98,38],fq=[29.5,45.5],fp=1000,fo=[480,250],fr,fn,fl,ft;
fm.invert=function(fx){var fu=(fx[0]-fo[0])/fp,fz=(fx[1]-fo[1])/fp,fy=ft+fz,fv=Math.atan2(fu,fy),fw=Math.sqrt(fu*fu+fy*fy);
return[(fr+fv/fn)/cN,Math.asin((fl-fw*fw*fn*fn)/(2*fn))/cN]
};
fm.origin=function(fu){if(!arguments.length){return fs
}fs=[+fu[0],+fu[1]];
return e()
};
fm.parallels=function(fu){if(!arguments.length){return fq
}fq=[+fu[0],+fu[1]];
return e()
};
fm.scale=function(fu){if(!arguments.length){return fp
}fp=+fu;
return fm
};
fm.translate=function(fu){if(!arguments.length){return fo
}fo=[+fu[0],+fu[1]];
return fm
};
return e()
};
d3.geo.albersUsa=function(){function fm(fr){var fq=fr[0],fp=fr[1];
return(fp>50?fo:fq<-140?fn:fp<21?fl:e)(fr)
}var e=d3.geo.albers();
var fo=d3.geo.albers().origin([-160,60]).parallels([55,65]);
var fn=d3.geo.albers().origin([-160,20]).parallels([8,18]);
var fl=d3.geo.albers().origin([-60,10]).parallels([8,18]);
fm.scale=function(fp){if(!arguments.length){return e.scale()
}e.scale(fp);
fo.scale(fp*0.6);
fn.scale(fp);
fl.scale(fp*1.5);
return fm.translate(e.translate())
};
fm.translate=function(fq){if(!arguments.length){return e.translate()
}var fp=e.scale()/1000,fs=fq[0],fr=fq[1];
e.translate(fq);
fo.translate([fs-400*fp,fr+170*fp]);
fn.translate([fs-190*fp,fr+200*fp]);
fl.translate([fs+580*fp,fr+430*fp]);
return fm
};
return fm.scale(e.scale())
};
d3.geo.bonne=function(){function fq(fu){var fr=fu[0]*cN-e,fv=fu[1]*cN-fn;
if(fm){var ft=fl+fm-fv,fs=fr*Math.cos(fv)/ft;
fr=ft*Math.sin(fs);
fv=ft*Math.cos(fs)-fl
}else{fr*=Math.cos(fv);
fv*=-1
}return[fp*fr+fo[0],fp*fv+fo[1]]
}var fp=200,fo=[480,250],e,fn,fm,fl;
fq.invert=function(ft){var fr=(ft[0]-fo[0])/fp,fv=(ft[1]-fo[1])/fp;
if(fm){var fu=fl+fv,fs=Math.sqrt(fr*fr+fu*fu);
fv=fl+fm-fs;
fr=e+fs*Math.atan2(fr,fu)/Math.cos(fv)
}else{fv*=-1;
fr/=Math.cos(fv)
}return[fr/cN,fv/cN]
};
fq.parallel=function(fr){if(!arguments.length){return fm/cN
}fl=1/Math.tan(fm=fr*cN);
return fq
};
fq.origin=function(fr){if(!arguments.length){return[e/cN,fn/cN]
}e=fr[0]*cN;
fn=fr[1]*cN;
return fq
};
fq.scale=function(fr){if(!arguments.length){return fp
}fp=+fr;
return fq
};
fq.translate=function(fr){if(!arguments.length){return fo
}fo=[+fr[0],+fr[1]];
return fq
};
return fq.origin([0,0]).parallel(45)
};
d3.geo.equirectangular=function(){function e(fo){var fn=fo[0]/360,fp=-fo[1]/360;
return[fm*fn+fl[0],fm*fp+fl[1]]
}var fm=500,fl=[480,250];
e.invert=function(fo){var fn=(fo[0]-fl[0])/fm,fp=(fo[1]-fl[1])/fm;
return[360*fn,-360*fp]
};
e.scale=function(fn){if(!arguments.length){return fm
}fm=+fn;
return e
};
e.translate=function(fn){if(!arguments.length){return fl
}fl=[+fn[0],+fn[1]];
return e
};
return e
};
d3.geo.mercator=function(){function e(fo){var fn=fo[0]/360,fp=-(Math.log(Math.tan(Math.PI/4+fo[1]*cN/2))/cN)/360;
return[fm*fn+fl[0],fm*Math.max(-0.5,Math.min(0.5,fp))+fl[1]]
}var fm=500,fl=[480,250];
e.invert=function(fo){var fn=(fo[0]-fl[0])/fm,fp=(fo[1]-fl[1])/fm;
return[360*fn,2*Math.atan(Math.exp(-360*fp*cN))/cN-90]
};
e.scale=function(fn){if(!arguments.length){return fm
}fm=+fn;
return e
};
e.translate=function(fn){if(!arguments.length){return fl
}fl=[+fn[0],+fn[1]];
return e
};
return e
};
d3.geo.path=function(){function fu(fy,fx){if(typeof fr==="function"){fv=A(fr.apply(this,arguments))
}fl(fy);
var fw=fp.length?fp.join(""):null;
fp=[];
return fw
}function fs(fw){return fq(fw).join(",")
}function fo(fy){var fx=fn(fy[0]),fw=0,fz=fy.length;
while(++fw<fz){fx-=fn(fy[fw])
}return fx
}function fm(fE){var fC=d3.geom.polygon(fE[0].map(fq)),fw=fC.area(),fx=fC.centroid(fw<0?(fw*=-1,1):-1),fD=fx[0],fB=fx[1],fA=fw,fz=0,fy=fE.length;
while(++fz<fy){fC=d3.geom.polygon(fE[fz].map(fq));
fw=fC.area();
fx=fC.centroid(fw<0?(fw*=-1,1):-1);
fD-=fx[0];
fB-=fx[1];
fA-=fw
}return[fD,fB,6*fA]
}function fn(fw){return Math.abs(d3.geom.polygon(fw.map(fq)).area())
}var fr=4.5,fv=A(fr),fq=d3.geo.albersUsa(),fp=[];
var fl=dv({FeatureCollection:function(fy){var fx=fy.features,fw=-1,fz=fx.length;
while(++fw<fz){fp.push(fl(fx[fw].geometry))
}},Feature:function(fw){fl(fw.geometry)
},Point:function(fw){fp.push("M",fs(fw.coordinates),fv)
},MultiPoint:function(fy){var fx=fy.coordinates,fw=-1,fz=fx.length;
while(++fw<fz){fp.push("M",fs(fx[fw]),fv)
}},LineString:function(fy){var fx=fy.coordinates,fw=-1,fz=fx.length;
fp.push("M");
while(++fw<fz){fp.push(fs(fx[fw]),"L")
}fp.pop()
},MultiLineString:function(fB){var fA=fB.coordinates,fz=-1,fC=fA.length,fx,fy,fw;
while(++fz<fC){fx=fA[fz];
fy=-1;
fw=fx.length;
fp.push("M");
while(++fy<fw){fp.push(fs(fx[fy]),"L")
}fp.pop()
}},Polygon:function(fB){var fA=fB.coordinates,fz=-1,fC=fA.length,fx,fy,fw;
while(++fz<fC){fx=fA[fz];
fy=-1;
if((fw=fx.length-1)>0){fp.push("M");
while(++fy<fw){fp.push(fs(fx[fy]),"L")
}fp[fp.length-1]="Z"
}}},MultiPolygon:function(fx){var fF=fx.coordinates,fE=-1,fy=fF.length,fB,fD,fz,fC,fA,fw;
while(++fE<fy){fB=fF[fE];
fD=-1;
fz=fB.length;
while(++fD<fz){fC=fB[fD];
fA=-1;
if((fw=fC.length-1)>0){fp.push("M");
while(++fA<fw){fp.push(fs(fC[fA]),"L")
}fp[fp.length-1]="Z"
}}}},GeometryCollection:function(fy){var fx=fy.geometries,fw=-1,fz=fx.length;
while(++fw<fz){fp.push(fl(fx[fw]))
}}});
var e=fu.area=dv({FeatureCollection:function(fz){var fy=0,fx=fz.features,fw=-1,fA=fx.length;
while(++fw<fA){fy+=e(fx[fw])
}return fy
},Feature:function(fw){return e(fw.geometry)
},Polygon:function(fw){return fo(fw.coordinates)
},MultiPolygon:function(fz){var fx=0,fy=fz.coordinates,fw=-1,fA=fy.length;
while(++fw<fA){fx+=fo(fy[fw])
}return fx
},GeometryCollection:function(fz){var fy=0,fx=fz.geometries,fw=-1,fA=fx.length;
while(++fw<fA){fy+=e(fx[fw])
}return fy
}},0);
var ft=fu.centroid=dv({Feature:function(fw){return ft(fw.geometry)
},Polygon:function(fx){var fw=fm(fx.coordinates);
return[fw[0]/fw[2],fw[1]/fw[2]]
},MultiPolygon:function(fx){var fw=0,fE=fx.coordinates,fy,fD=0,fC=0,fB=0,fA=-1,fz=fE.length;
while(++fA<fz){fy=fm(fE[fA]);
fD+=fy[0];
fC+=fy[1];
fB+=fy[2]
}return[fD/fB,fC/fB]
}});
fu.projection=function(fw){fq=fw;
return fu
};
fu.pointRadius=function(fw){if(typeof fw==="function"){fr=fw
}else{fr=+fw;
fv=A(fr)
}return fu
};
return fu
};
d3.geo.bounds=function(fm){var fo=Infinity,e=Infinity,fl=-Infinity,fn=-Infinity;
bW(fm,function(fp,fq){if(fp<fo){fo=fp
}if(fp>fl){fl=fp
}if(fq<e){e=fq
}if(fq>fn){fn=fq
}});
return[[fo,e],[fl,fn]]
};
var ek={Feature:e4,FeatureCollection:dU,GeometryCollection:dc,LineString:d0,MultiLineString:ef,MultiPoint:d0,MultiPolygon:e2,Point:eP,Polygon:bw};
d3.geo.circle=function(){function fl(){}function fn(ft){return fm.distance(ft)<fr
}function fo(fy){var fx=-1,fv=fy.length,fw=[],fB,fA,fz,fu,ft;
while(++fx<fv){ft=fm.distance(fz=fy[fx]);
if(ft<fr){if(fA){fw.push(fj(fA,fz)((fu-fr)/(fu-ft)))
}fw.push(fz);
fB=fA=null
}else{fA=fz;
if(!fB&&fw.length){fw.push(fj(fw[fw.length-1],fA)((fr-fu)/(ft-fu)));
fB=fA
}}fu=ft
}fB=fy[0];
fA=fw[0];
if(fA&&fz[0]===fB[0]&&fz[1]===fB[1]&&!(fz[0]===fA[0]&&fz[1]===fA[1])){fw.push(fA)
}return e(fw)
}function e(fz){var fx=0,fA=fz.length,fw,ft,fu=fA?[fz[0]]:fz,fy,fv=fm.source();
while(++fx<fA){fy=fm.source(fz[fx-1])(fz[fx]).coordinates;
for(fw=0,ft=fy.length;
++fw<ft;
){fu.push(fy[fw])
}}fm.source(fv);
return fu
}var fs=[0,0],fp=90-0.01,fr=fp*cN,fm=d3.geo.greatArc().source(fs).target(d4);
fl.clip=function(ft){if(typeof fs==="function"){fm.source(fs.apply(this,arguments))
}return fq(ft)||null
};
var fq=dv({FeatureCollection:function(fu){var ft=fu.features.map(fq).filter(d4);
return ft&&(fu=Object.create(fu),fu.features=ft,fu)
},Feature:function(fu){var ft=fq(fu.geometry);
return ft&&(fu=Object.create(fu),fu.geometry=ft,fu)
},Point:function(ft){return fn(ft.coordinates)&&ft
},MultiPoint:function(fu){var ft=fu.coordinates.filter(fn);
return ft.length&&{type:fu.type,coordinates:ft}
},LineString:function(fu){var ft=fo(fu.coordinates);
return ft.length&&(fu=Object.create(fu),fu.coordinates=ft,fu)
},MultiLineString:function(fu){var ft=fu.coordinates.map(fo).filter(function(fv){return fv.length
});
return ft.length&&(fu=Object.create(fu),fu.coordinates=ft,fu)
},Polygon:function(fu){var ft=fu.coordinates.map(fo);
return ft[0].length&&(fu=Object.create(fu),fu.coordinates=ft,fu)
},MultiPolygon:function(fu){var ft=fu.coordinates.map(function(fv){return fv.map(fo)
}).filter(function(fv){return fv[0].length
});
return ft.length&&(fu=Object.create(fu),fu.coordinates=ft,fu)
},GeometryCollection:function(fu){var ft=fu.geometries.map(fq).filter(d4);
return ft.length&&(fu=Object.create(fu),fu.geometries=ft,fu)
}});
fl.origin=function(ft){if(!arguments.length){return fs
}fs=ft;
if(typeof fs!=="function"){fm.source(fs)
}return fl
};
fl.angle=function(ft){if(!arguments.length){return fp
}fr=(fp=+ft)*cN;
return fl
};
return d3.rebind(fl,fm,"precision")
};
d3.geo.greatArc=function(){function fl(){var fu=fl.distance.apply(this,arguments),fr=0,fs=e/fu,ft=[fq];
while((fr+=fs)<1){ft.push(fm(fr))
}ft.push(fp);
return{type:"LineString",coordinates:ft}
}var fn=bT,fq,fo=bY,fp,e=6*cN,fm=a4();
fl.distance=function(){if(typeof fn==="function"){fm.source(fq=fn.apply(this,arguments))
}if(typeof fo==="function"){fm.target(fp=fo.apply(this,arguments))
}return fm.distance()
};
fl.source=function(fr){if(!arguments.length){return fn
}fn=fr;
if(typeof fn!=="function"){fm.source(fq=fn)
}return fl
};
fl.target=function(fr){if(!arguments.length){return fo
}fo=fr;
if(typeof fo!=="function"){fm.target(fp=fo)
}return fl
};
fl.precision=function(fr){if(!arguments.length){return e/cN
}e=fr*cN;
return fl
};
return fl
};
d3.geo.greatCircle=d3.geo.circle;
d3.geom={};
d3.geom.contour=function(e,fl){var ft=fl||k(e),fp=[],fr=ft[0],fq=ft[1],fu=0,fs=0,fn=NaN,fm=NaN,fo=0;
do{fo=0;
if(e(fr-1,fq-1)){fo+=1
}if(e(fr,fq-1)){fo+=2
}if(e(fr-1,fq)){fo+=4
}if(e(fr,fq)){fo+=8
}if(fo===6){fu=fm===-1?-1:1;
fs=0
}else{if(fo===9){fu=0;
fs=fn===1?-1:1
}else{fu=bO[fo];
fs=bN[fo]
}}if(fu!=fn&&fs!=fm){fp.push([fr,fq]);
fn=fu;
fm=fs
}fr+=fu;
fq+=fs
}while(ft[0]!=fr||ft[1]!=fq);
return fp
};
var bO=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],bN=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];
d3.geom.hull=function(ft){if(ft.length<3){return[]
}var fs=ft.length,fo=fs-1,fz=[],fv=[],fq,fp,fr=0,fn,fx,fl,fu,fA,fy,fw,fm;
for(fq=1;
fq<fs;
++fq){if(ft[fq][1]<ft[fr][1]){fr=fq
}else{if(ft[fq][1]==ft[fr][1]){fr=ft[fq][0]<ft[fr][0]?fq:fr
}}}for(fq=0;
fq<fs;
++fq){if(fq===fr){continue
}fx=ft[fq][1]-ft[fr][1];
fn=ft[fq][0]-ft[fr][0];
fz.push({angle:Math.atan2(fx,fn),index:fq})
}fz.sort(function(fC,fB){return fC.angle-fB.angle
});
fw=fz[0].angle;
fy=fz[0].index;
fA=0;
for(fq=1;
fq<fo;
++fq){fp=fz[fq].index;
if(fw==fz[fq].angle){fn=ft[fy][0]-ft[fr][0];
fx=ft[fy][1]-ft[fr][1];
fl=ft[fp][0]-ft[fr][0];
fu=ft[fp][1]-ft[fr][1];
if(fn*fn+fx*fx>=fl*fl+fu*fu){fz[fq].index=-1
}else{fz[fA].index=-1;
fw=fz[fq].angle;
fA=fq;
fy=fp
}}else{fw=fz[fq].angle;
fA=fq;
fy=fp
}}fv.push(fr);
for(fq=0,fp=0;
fq<2;
++fp){if(fz[fp].index!==-1){fv.push(fz[fp].index);
fq++
}}fm=fv.length;
for(;
fp<fo;
++fp){if(fz[fp].index===-1){continue
}while(!cb(fv[fm-2],fv[fm-1],fz[fp].index,ft)){--fm
}fv[fm++]=fz[fp].index
}var e=[];
for(fq=0;
fq<fm;
++fq){e.push(ft[fv[fq]])
}return e
};
d3.geom.polygon=function(e){e.area=function(){var fn=0,fo=e.length,fm=e[fo-1][0]*e[0][1],fl=e[fo-1][1]*e[0][0];
while(++fn<fo){fm+=e[fn-1][0]*e[fn][1];
fl+=e[fn-1][1]*e[fn][0]
}return(fl-fm)*0.5
};
e.centroid=function(fo){var fp=-1,fs=e.length,fm=0,fr=0,fn,fl=e[fs-1],fq;
if(!arguments.length){fo=-1/(6*e.area())
}while(++fp<fs){fn=fl;
fl=e[fp];
fq=fn[0]*fl[1]-fl[0]*fn[1];
fm+=(fn[0]+fl[0])*fq;
fr+=(fn[1]+fl[1])*fq
}return[fm*fo,fr*fo]
};
e.clip=function(fr){var ft,fo=-1,fl=e.length,fn,fm,fu=e[fl-1],fs,fq,fp;
while(++fo<fl){ft=fr.slice();
fr.length=0;
fs=e[fo];
fq=ft[(fm=ft.length)-1];
fn=-1;
while(++fn<fm){fp=ft[fn];
if(u(fp,fu,fs)){if(!u(fq,fu,fs)){fr.push(d5(fq,fp,fu,fs))
}fr.push(fp)
}else{if(u(fq,fu,fs)){fr.push(d5(fq,fp,fu,fs))
}}fq=fp
}fu=fs
}return fr
};
return e
};
d3.geom.voronoi=function(fl){var e=fl.map(function(){return[]
});
es(fl,function(fo){var fu,ft,fn,fm,fr,fp;
if(fo.a===1&&fo.b>=0){fu=fo.ep.r;
ft=fo.ep.l
}else{fu=fo.ep.l;
ft=fo.ep.r
}if(fo.a===1){fr=fu?fu.y:-1000000;
fn=fo.c-fo.b*fr;
fp=ft?ft.y:1000000;
fm=fo.c-fo.b*fp
}else{fn=fu?fu.x:-1000000;
fr=fo.c-fo.a*fn;
fm=ft?ft.x:1000000;
fp=fo.c-fo.a*fm
}var fs=[fn,fr],fq=[fm,fp];
e[fo.region.l.index].push(fs,fq);
e[fo.region.r.index].push(fs,fq)
});
return e.map(function(fo,fn){var fm=fl[fn][0],fp=fl[fn][1];
fo.forEach(function(fq){fq.angle=Math.atan2(fq[0]-fm,fq[1]-fp)
});
return fo.sort(function(fr,fq){return fr.angle-fq.angle
}).filter(function(fr,fq){return !fq||fr.angle-fo[fq-1].angle>1e-10
})
})
};
var b1={l:"r",r:"l"};
d3.geom.delaunay=function(fl){var e=fl.map(function(){return[]
}),fm=[];
es(fl,function(fn){e[fn.region.l.index].push(fl[fn.region.r.index])
});
e.forEach(function(fs,fr){var fp=fl[fr],fo=fp[0],ft=fp[1];
fs.forEach(function(fu){fu.angle=Math.atan2(fu[0]-fo,fu[1]-ft)
});
fs.sort(function(fv,fu){return fv.angle-fu.angle
});
for(var fq=0,fn=fs.length-1;
fq<fn;
fq++){fm.push([fp,fs[fq],fs[fq+1]])
}});
return fm
};
d3.geom.quadtree=function(ft,fm,fs,e,fr){function fu(fD,fC,fz,fB,fy,fA){if(isNaN(fC.x)||isNaN(fC.y)){return
}if(fD.leaf){var fx=fD.point;
if(fx){if(Math.abs(fx.x-fC.x)+Math.abs(fx.y-fC.y)<0.01){fp(fD,fC,fz,fB,fy,fA)
}else{fD.point=null;
fp(fD,fx,fz,fB,fy,fA);
fp(fD,fC,fz,fB,fy,fA)
}}else{fD.point=fC
}}else{fp(fD,fC,fz,fB,fy,fA)
}}function fp(fB,fz,fA,fG,fy,fE){var fF=(fA+fy)*0.5,fD=(fG+fE)*0.5,fH=fz.x>=fF,fx=fz.y>=fD,fC=(fx<<1)+fH;
fB.leaf=false;
fB=fB.nodes[fC]||(fB.nodes[fC]=dB());
if(fH){fA=fF
}else{fy=fF
}if(fx){fG=fD
}else{fE=fD
}fu(fB,fz,fA,fG,fy,fE)
}var fl,fo=-1,fn=ft.length;
if(fn&&isNaN(ft[0].x)){ft=ft.map(F)
}if(arguments.length<5){if(arguments.length===3){fr=e=fs;
fs=fm
}else{fm=fs=Infinity;
e=fr=-Infinity;
while(++fo<fn){fl=ft[fo];
if(fl.x<fm){fm=fl.x
}if(fl.y<fs){fs=fl.y
}if(fl.x>e){e=fl.x
}if(fl.y>fr){fr=fl.y
}}var fw=e-fm,fv=fr-fs;
if(fw>fv){fr=fs+fw
}else{e=fm+fv
}}}var fq=dB();
fq.add=function(fx){fu(fq,fx,fm,fs,e,fr)
};
fq.visit=function(fx){bA(fx,fq,fm,fs,e,fr)
};
ft.forEach(fq.add);
return fq
};
d3.time={};
var dA=Date,o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
eD.prototype={getDate:function(){return this._.getUTCDate()
},getDay:function(){return this._.getUTCDay()
},getFullYear:function(){return this._.getUTCFullYear()
},getHours:function(){return this._.getUTCHours()
},getMilliseconds:function(){return this._.getUTCMilliseconds()
},getMinutes:function(){return this._.getUTCMinutes()
},getMonth:function(){return this._.getUTCMonth()
},getSeconds:function(){return this._.getUTCSeconds()
},getTime:function(){return this._.getTime()
},getTimezoneOffset:function(){return 0
},valueOf:function(){return this._.valueOf()
},setDate:function(){dM.setUTCDate.apply(this._,arguments)
},setDay:function(){dM.setUTCDay.apply(this._,arguments)
},setFullYear:function(){dM.setUTCFullYear.apply(this._,arguments)
},setHours:function(){dM.setUTCHours.apply(this._,arguments)
},setMilliseconds:function(){dM.setUTCMilliseconds.apply(this._,arguments)
},setMinutes:function(){dM.setUTCMinutes.apply(this._,arguments)
},setMonth:function(){dM.setUTCMonth.apply(this._,arguments)
},setSeconds:function(){dM.setUTCSeconds.apply(this._,arguments)
},setTime:function(){dM.setTime.apply(this._,arguments)
}};
var dM=Date.prototype;
var G="%a %b %e %H:%M:%S %Y",cR="%m/%d/%y",bS="%H:%M:%S";
var be=o,bE=be.map(cZ),bh=["January","February","March","April","May","June","July","August","September","October","November","December"],ag=bh.map(cZ);
d3.time.format=function(e){function fl(fp){var fo=[],fq=-1,fn=0,fs,fr;
while(++fq<fm){if(e.charCodeAt(fq)==37){fo.push(e.substring(fn,fq),(fr=ed[fs=e.charAt(++fq)])?fr(fp):fs);
fn=fq+1
}}fo.push(e.substring(fn,fq));
return fo.join("")
}var fm=e.length;
fl.parse=function(fo){var fq={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},fp=cq(fq,e,fo,0);
if(fp!=fo.length){return null
}if("p" in fq){fq.H=fq.H%12+fq.p*12
}var fn=new dA;
fn.setFullYear(fq.y,fq.m,fq.d);
fn.setHours(fq.H,fq.M,fq.S,fq.L);
return fn
};
fl.toString=function(){return e
};
return fl
};
var aU=d3.format("02d"),aT=d3.format("03d"),aS=d3.format("04d"),aQ=d3.format("2d");
var eY=bz(be),dC=bz(bE),eF=bz(bh),dt=ex(bh),cX=bz(ag),c3=ex(ag);
var ed={a:function(e){return bE[e.getDay()]
},A:function(e){return be[e.getDay()]
},b:function(e){return ag[e.getMonth()]
},B:function(e){return bh[e.getMonth()]
},c:d3.time.format(G),d:function(e){return aU(e.getDate())
},e:function(e){return aQ(e.getDate())
},H:function(e){return aU(e.getHours())
},I:function(e){return aU(e.getHours()%12||12)
},j:function(e){return aT(1+d3.time.dayOfYear(e))
},L:function(e){return aT(e.getMilliseconds())
},m:function(e){return aU(e.getMonth()+1)
},M:function(e){return aU(e.getMinutes())
},p:function(e){return e.getHours()>=12?"PM":"AM"
},S:function(e){return aU(e.getSeconds())
},U:function(e){return aU(d3.time.sundayOfYear(e))
},w:function(e){return e.getDay()
},W:function(e){return aU(d3.time.mondayOfYear(e))
},x:d3.time.format(cR),X:d3.time.format(bS),y:function(e){return aU(e.getFullYear()%100)
},Y:function(e){return aS(e.getFullYear()%10000)
},Z:dK,"%":function(e){return"%"
}};
var e8={a:eC,A:bu,b:aq,B:cY,c:cD,d:a5,e:a5,H:ai,I:ai,L:ey,m:en,M:bG,p:eX,S:ck,x:fk,X:ei,y:D,Y:aM};
var dP=/^\s*\d+/;
var d=d3.map({am:0,pm:1});
d3.time.format.utc=function(fl){function fm(fn){try{dA=eD;
var fo=new dA;
fo._=fn;
return e(fo)
}finally{dA=Date
}}var e=d3.time.format(fl);
fm.parse=function(fo){try{dA=eD;
var fn=e.parse(fo);
return fn&&fn._
}finally{dA=Date
}};
fm.toString=e.toString;
return fm
};
var cf=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");
d3.time.format.iso=Date.prototype.toISOString?b3:cf;
b3.parse=function(fl){var e=new Date(fl);
return isNaN(e)?null:e
};
b3.toString=cf.toString;
d3.time.second=bK(function(e){return new dA(Math.floor(e/1000)*1000)
},function(e,fl){e.setTime(e.getTime()+Math.floor(fl)*1000)
},function(e){return e.getSeconds()
});
d3.time.seconds=d3.time.second.range;
d3.time.seconds.utc=d3.time.second.utc.range;
d3.time.minute=bK(function(e){return new dA(Math.floor(e/60000)*60000)
},function(e,fl){e.setTime(e.getTime()+Math.floor(fl)*60000)
},function(e){return e.getMinutes()
});
d3.time.minutes=d3.time.minute.range;
d3.time.minutes.utc=d3.time.minute.utc.range;
d3.time.hour=bK(function(e){var fl=e.getTimezoneOffset()/60;
return new dA((Math.floor(e/3600000-fl)+fl)*3600000)
},function(e,fl){e.setTime(e.getTime()+Math.floor(fl)*3600000)
},function(e){return e.getHours()
});
d3.time.hours=d3.time.hour.range;
d3.time.hours.utc=d3.time.hour.utc.range;
d3.time.day=bK(function(fl){var e=new dA(1970,0);
e.setFullYear(fl.getFullYear(),fl.getMonth(),fl.getDate());
return e
},function(e,fl){e.setDate(e.getDate()+fl)
},function(e){return e.getDate()-1
});
d3.time.days=d3.time.day.range;
d3.time.days.utc=d3.time.day.utc.range;
d3.time.dayOfYear=function(e){var fl=d3.time.year(e);
return Math.floor((e-fl-(e.getTimezoneOffset()-fl.getTimezoneOffset())*60000)/86400000)
};
o.forEach(function(fl,fm){fl=fl.toLowerCase();
fm=7-fm;
var e=d3.time[fl]=bK(function(fn){(fn=d3.time.day(fn)).setDate(fn.getDate()-(fn.getDay()+fm)%7);
return fn
},function(fn,fo){fn.setDate(fn.getDate()+Math.floor(fo)*7)
},function(fo){var fn=d3.time.year(fo).getDay();
return Math.floor((d3.time.dayOfYear(fo)+(fn+fm)%7)/7)-(fn!==fm)
});
d3.time[fl+"s"]=e.range;
d3.time[fl+"s"].utc=e.utc.range;
d3.time[fl+"OfYear"]=function(fo){var fn=d3.time.year(fo).getDay();
return Math.floor((d3.time.dayOfYear(fo)+(fn+fm)%7)/7)
}
});
d3.time.week=d3.time.sunday;
d3.time.weeks=d3.time.sunday.range;
d3.time.weeks.utc=d3.time.sunday.utc.range;
d3.time.weekOfYear=d3.time.sundayOfYear;
d3.time.month=bK(function(e){e=d3.time.day(e);
e.setDate(1);
return e
},function(e,fl){e.setMonth(e.getMonth()+fl)
},function(e){return e.getMonth()
});
d3.time.months=d3.time.month.range;
d3.time.months.utc=d3.time.month.utc.range;
d3.time.year=bK(function(e){e=d3.time.day(e);
e.setMonth(0,1);
return e
},function(e,fl){e.setFullYear(e.getFullYear()+fl)
},function(e){return e.getFullYear()
});
d3.time.years=d3.time.year.range;
d3.time.years.utc=d3.time.year.utc.range;
var db=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000];
var bt=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]];
var du=[[d3.time.format("%Y"),function(e){return true
}],[d3.time.format("%B"),function(e){return e.getMonth()
}],[d3.time.format("%b %d"),function(e){return e.getDate()!=1
}],[d3.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1
}],[d3.time.format("%I %p"),function(e){return e.getHours()
}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()
}],[d3.time.format(":%S"),function(e){return e.getSeconds()
}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()
}]];
var br=d3.scale.linear(),I=bH(du);
bt.year=function(fl,e){return br.domain(fl.map(eE)).ticks(e).map(cn)
};
d3.time.scale=function(){return aH(d3.scale.linear(),bt,I)
};
var fa=bt.map(function(e){return[e[0].utc,e[1]]
});
var bb=[[d3.time.format.utc("%Y"),function(e){return true
}],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()
}],[d3.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1
}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1
}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()
}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()
}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()
}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()
}]];
var c2=bH(bb);
fa.year=function(fl,e){return br.domain(fl.map(dZ)).ticks(e).map(bP)
};
d3.time.scale.utc=function(){return aH(d3.scale.linear(),fa,c2)
}
})();(function(){var c=window.nv||{};
c.version="0.0.1a";
c.dev=true;
window.nv=c;
c.tooltip={};
c.utils={};
c.models={};
c.charts={};
c.graphs=[];
c.logs={};
c.dispatch=d3.dispatch("render_start","render_end");
if(c.dev){c.dispatch.on("render_start",function(f){c.logs.startTime=+new Date()
});
c.dispatch.on("render_end",function(f){c.logs.endTime=+new Date();
c.logs.totalTime=c.logs.endTime-c.logs.startTime;
c.log("total",c.logs.totalTime)
})
}c.log=function(){if(c.dev&&console.log&&console.log.apply){console.log.apply(console,arguments)
}else{if(c.dev&&console.log&&Function.prototype.bind){var e=Function.prototype.bind.call(console.log,console);
e.apply(console,arguments)
}}return arguments[arguments.length-1]
};
c.render=function d(e){e=e||1;
c.render.active=true;
c.dispatch.render_start();
setTimeout(function(){var g,h;
for(var f=0;
f<e&&(h=c.render.queue[f]);
f++){g=h.generate();
if(typeof h.callback==typeof(Function)){h.callback(g)
}c.graphs.push(g)
}c.render.queue.splice(0,f);
if(c.render.queue.length){setTimeout(arguments.callee,0)
}else{c.render.active=false;
c.dispatch.render_end()
}},0)
};
c.render.active=false;
c.render.queue=[];
c.addGraph=function(e){if(typeof arguments[0]===typeof(Function)){e={generate:arguments[0],callback:arguments[1]}
}c.render.queue.push(e);
if(!c.render.active){c.render()
}};
c.identity=function(e){return e
};
c.strip=function(e){return e.replace(/(\s|&)/g,"")
};
function b(f,e){return(new Date(e,f+1,0)).getDate()
}function a(g,f,e){return function(l,j,i){var m=g(l),n=[];
if(m<l){f(m)
}if(i>1){while(m<j){var h=new Date(+m);
if((e(h)%i===0)){n.push(h)
}f(m)
}}else{while(m<j){n.push(new Date(+m));
f(m)
}}return n
}
}d3.time.monthEnd=function(e){return new Date(e.getFullYear(),e.getMonth(),0)
};
d3.time.monthEnds=a(d3.time.monthEnd,function(e){e.setUTCDate(e.getUTCDate()+1);
e.setDate(b(e.getMonth()+1,e.getFullYear()))
},function(e){return e.getMonth()
});
(function(){var e=window.nv.tooltip={};
e.show=function(l,v,j,t,p,y){var q=document.createElement("div");
q.className="nvtooltip "+(y?y:"xy-tooltip");
j=j||"s";
t=t||20;
var o=p;
if(!p||p.tagName.match(/g|svg/i)){o=document.getElementsByTagName("body")[0]
}q.innerHTML=v;
q.style.left=0;
q.style.top=0;
q.style.opacity=0;
o.appendChild(q);
var s=parseInt(q.offsetHeight),u=parseInt(q.offsetWidth),z=c.utils.windowSize().width,n=c.utils.windowSize().height,g=window.scrollY,w=window.scrollX,i,r;
n=window.innerWidth>=document.body.scrollWidth?n:n-16;
z=window.innerHeight>=document.body.scrollHeight?z:z-16;
var m=function(A){var B=r;
do{if(!isNaN(A.offsetTop)){B+=(A.offsetTop)
}}while(A=A.offsetParent);
return B
};
var x=function(A){var B=i;
do{if(!isNaN(A.offsetLeft)){B+=(A.offsetLeft)
}}while(A=A.offsetParent);
return B
};
switch(j){case"e":i=l[0]-u-t;
r=l[1]-(s/2);
var f=x(q);
var h=m(q);
if(f<w){i=l[0]+t>w?l[0]+t:w-f+i
}if(h<g){r=g-h+r
}if(h+s>g+n){r=g+n-h+r-s
}break;
case"w":i=l[0]+t;
r=l[1]-(s/2);
if(f+u>z){i=l[0]-u-t
}if(h<g){r=g+5
}if(h+s>g+n){r=g-s-5
}break;
case"n":i=l[0]-(u/2)-5;
r=l[1]+t;
var f=x(q);
var h=m(q);
if(f<w){i=w+5
}if(f+u>z){i=i-u/2+5
}if(h+s>g+n){r=g+n-h+r-s
}break;
case"s":i=l[0]-(u/2);
r=l[1]-s-t;
var f=x(q);
var h=m(q);
if(f<w){i=w+5
}if(f+u>z){i=i-u/2+5
}if(g>h){r=g
}break
}q.style.left=i+"px";
q.style.top=r+"px";
q.style.opacity=1;
q.style.position="absolute";
q.style.pointerEvents="none";
return q
};
e.cleanup=function(){var f=document.getElementsByClassName("nvtooltip");
var g=[];
while(f.length){g.push(f[0]);
f[0].style.transitionDelay="0 !important";
f[0].style.opacity=0;
f[0].className="nvtooltip-pending-removal"
}setTimeout(function(){while(g.length){var h=g.pop();
h.parentNode.removeChild(h)
}},500)
}
})();
c.utils.windowSize=function(){var e={width:640,height:480};
if(document.body&&document.body.offsetWidth){e.width=document.body.offsetWidth;
e.height=document.body.offsetHeight
}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){e.width=document.documentElement.offsetWidth;
e.height=document.documentElement.offsetHeight
}if(window.innerWidth&&window.innerHeight){e.width=window.innerWidth;
e.height=window.innerHeight
}return(e)
};
c.utils.windowResize=function(e){var f=window.onresize;
window.onresize=function(g){if(typeof f=="function"){f(g)
}e(g)
}
};
c.utils.getColor=function(e){if(!arguments.length){return c.utils.defaultColor()
}if(Object.prototype.toString.call(e)==="[object Array]"){return function(g,f){return g.color||e[f%e.length]
}
}else{return e
}};
c.utils.defaultColor=function(){var e=d3.scale.category20().range();
return function(g,f){return g.color||e[f%e.length]
}
};
c.utils.customTheme=function(h,f,g){f=f||function(i){return i.key
};
g=g||d3.scale.category20().range();
var e=g.length;
return function(l,i){var j=f(l);
if(!e){e=g.length
}if(typeof h[j]!=="undefined"){return(typeof h[j]==="function")?h[j]():h[j]
}else{return g[--e]
}}
};
c.utils.pjax=function(e,f){d3.selectAll(e).on("click",function(){history.pushState(this.href,this.textContent,this.href);
g(this.href);
d3.event.preventDefault()
});
function g(h){d3.html(h,function(i){var j=d3.select(f).node();
j.parentNode.replaceChild(d3.select(i).select(f).node(),j);
c.utils.pjax(e,f)
})
}d3.select(window).on("popstate",function(){if(d3.event.state){g(d3.event.state)
}})
};
c.utils.calcApproxTextWidth=function(e){if(e instanceof d3.selection){var g=parseInt(e.style("font-size").replace("px",""));
var f=e.text().length;
return f*g*0.5
}return 0
};
c.models.axis=function(){var j=d3.svg.axis();
var n={top:0,right:0,bottom:0,left:0},g=75,t=60,m=d3.scale.linear(),o=null,i=true,l=true,f=0,h=true,p=false,e=false,s=null;
j.scale(m).orient("bottom").tickFormat(function(u){return u
});
var q;
function r(u){u.each(function(G){var x=d3.select(this);
var z=x.selectAll("g.nv-wrap.nv-axis").data([G]);
var C=z.enter().append("g").attr("class","nvd3 nv-wrap nv-axis");
var v=C.append("g");
var I=z.select("g");
if(s!==null){j.ticks(s)
}else{if(j.orient()=="top"||j.orient()=="bottom"){j.ticks(Math.abs(m.range()[1]-m.range()[0])/100)
}}d3.transition(I).call(j);
q=q||j.scale();
var B=j.tickFormat();
if(B==null){B=q.tickFormat()
}var A=I.selectAll("text.nv-axislabel").data([o||null]);
A.exit().remove();
switch(j.orient()){case"top":A.enter().append("text").attr("class","nv-axislabel");
var K=(m.range().length==2)?m.range()[1]:(m.range()[m.range().length-1]+(m.range()[1]-m.range()[0]));
A.attr("text-anchor","middle").attr("y",0).attr("x",K/2);
if(i){var H=z.selectAll("g.nv-axisMaxMin").data(m.domain());
H.enter().append("g").attr("class","nv-axisMaxMin").append("text");
H.exit().remove();
H.attr("transform",function(L,w){return"translate("+m(L)+",0)"
}).select("text").attr("dy","0em").attr("y",-j.tickPadding()).attr("text-anchor","middle").text(function(M,L){var w=B(M);
return(""+w).match("NaN")?"":w
});
d3.transition(H).attr("transform",function(L,w){return"translate("+m.range()[w]+",0)"
})
}break;
case"bottom":var F=36;
var y=30;
var D=I.selectAll("g").select("text");
if(f%360){D.each(function(M,w){var L=this.getBBox().width;
if(L>y){y=L
}});
var J=Math.abs(Math.sin(f*Math.PI/180));
var F=(J?J*y:y)+30;
D.attr("transform",function(M,L,w){return"rotate("+f+" 0,0)"
}).attr("text-anchor",f%360>0?"start":"end")
}A.enter().append("text").attr("class","nv-axislabel");
var K=(m.range().length==2)?m.range()[1]:(m.range()[m.range().length-1]+(m.range()[1]-m.range()[0]));
A.attr("text-anchor","middle").attr("y",F).attr("x",K/2);
if(i){var H=z.selectAll("g.nv-axisMaxMin").data([m.domain()[0],m.domain()[m.domain().length-1]]);
H.enter().append("g").attr("class","nv-axisMaxMin").append("text");
H.exit().remove();
H.attr("transform",function(L,w){return"translate("+(m(L)+(e?m.rangeBand()/2:0))+",0)"
}).select("text").attr("dy",".71em").attr("y",j.tickPadding()).attr("transform",function(M,L,w){return"rotate("+f+" 0,0)"
}).attr("text-anchor",f?(f%360>0?"start":"end"):"middle").text(function(M,L){var w=B(M);
return(""+w).match("NaN")?"":w
});
d3.transition(H).attr("transform",function(L,w){return"translate("+(m(L)+(e?m.rangeBand()/2:0))+",0)"
})
}if(p){D.attr("transform",function(L,w){return"translate(0,"+(w%2==0?"0":"12")+")"
})
}break;
case"right":A.enter().append("text").attr("class","nv-axislabel");
A.attr("text-anchor",h?"middle":"begin").attr("transform",h?"rotate(90)":"").attr("y",h?(-Math.max(n.right,g)+12):-10).attr("x",h?(m.range()[0]/2):j.tickPadding());
if(i){var H=z.selectAll("g.nv-axisMaxMin").data(m.domain());
H.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);
H.exit().remove();
H.attr("transform",function(L,w){return"translate(0,"+m(L)+")"
}).select("text").attr("dy",".32em").attr("y",0).attr("x",j.tickPadding()).attr("text-anchor","start").text(function(M,L){var w=B(M);
return(""+w).match("NaN")?"":w
});
d3.transition(H).attr("transform",function(L,w){return"translate(0,"+m.range()[w]+")"
}).select("text").style("opacity",1)
}break;
case"left":A.enter().append("text").attr("class","nv-axislabel");
A.attr("text-anchor",h?"middle":"end").attr("transform",h?"rotate(-90)":"").attr("y",h?(-Math.max(n.left,g)+12):-10).attr("x",h?(-m.range()[0]/2):-j.tickPadding());
if(i){var H=z.selectAll("g.nv-axisMaxMin").data(m.domain());
H.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);
H.exit().remove();
H.attr("transform",function(L,w){return"translate(0,"+q(L)+")"
}).select("text").attr("dy",".32em").attr("y",0).attr("x",-j.tickPadding()).attr("text-anchor","end").text(function(M,L){var w=B(M);
return(""+w).match("NaN")?"":w
});
d3.transition(H).attr("transform",function(L,w){return"translate(0,"+m.range()[w]+")"
}).select("text").style("opacity",1)
}break
}A.text(function(w){return w
});
if(i&&(j.orient()==="left"||j.orient()==="right")){I.selectAll("g").each(function(L,w){d3.select(this).select("text").attr("opacity",1);
if(m(L)<m.range()[1]+10||m(L)>m.range()[0]-10){if(L>1e-10||L<-1e-10){d3.select(this).attr("opacity",0)
}d3.select(this).select("text").attr("opacity",0)
}});
if(m.domain()[0]==m.domain()[1]&&m.domain()[0]==0){z.selectAll("g.nv-axisMaxMin").style("opacity",function(L,w){return !w?1:0
})
}}if(i&&(j.orient()==="top"||j.orient()==="bottom")){var E=[];
z.selectAll("g.nv-axisMaxMin").each(function(M,w){try{if(w){E.push(m(M)-this.getBBox().width-4)
}else{E.push(m(M)+this.getBBox().width+4)
}}catch(L){if(w){E.push(m(M)-4)
}else{E.push(m(M)+4)
}}});
I.selectAll("g").each(function(L,w){if(m(L)<E[0]||m(L)>E[1]){if(L>1e-10||L<-1e-10){d3.select(this).remove()
}else{d3.select(this).select("text").remove()
}}})
}if(l){I.selectAll("line.tick").filter(function(w){return !parseFloat(Math.round(w*100000)/1000000)
}).classed("zero",true)
}q=m.copy()
});
return r
}r.axis=j;
d3.rebind(r,j,"orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat");
d3.rebind(r,m,"domain","range","rangeBand","rangeBands");
r.margin=function(u){if(!arguments.length){return n
}n.top=typeof u.top!="undefined"?u.top:n.top;
n.right=typeof u.right!="undefined"?u.right:n.right;
n.bottom=typeof u.bottom!="undefined"?u.bottom:n.bottom;
n.left=typeof u.left!="undefined"?u.left:n.left;
return r
};
r.width=function(u){if(!arguments.length){return g
}g=u;
return r
};
r.ticks=function(u){if(!arguments.length){return s
}s=u;
return r
};
r.height=function(u){if(!arguments.length){return t
}t=u;
return r
};
r.axisLabel=function(u){if(!arguments.length){return o
}o=u;
return r
};
r.showMaxMin=function(u){if(!arguments.length){return i
}i=u;
return r
};
r.highlightZero=function(u){if(!arguments.length){return l
}l=u;
return r
};
r.scale=function(u){if(!arguments.length){return m
}m=u;
j.scale(m);
e=typeof m.rangeBands==="function";
d3.rebind(r,m,"domain","range","rangeBand","rangeBands");
return r
};
r.rotateYLabel=function(u){if(!arguments.length){return h
}h=u;
return r
};
r.rotateLabels=function(u){if(!arguments.length){return f
}f=u;
return r
};
r.staggerLabels=function(u){if(!arguments.length){return p
}p=u;
return r
};
return r
};
c.models.historicalBar=function(){var i={top:0,right:0,bottom:0,left:0},g=960,v=500,f=Math.floor(Math.random()*10000),r=d3.scale.linear(),q=d3.scale.linear(),u=function(w){return w.x
},t=function(w){return w.y
},l=[],j=[0],m=false,s=true,h=c.utils.defaultColor(),o,e,n=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");
function p(w){w.each(function(E){var H=g-i.left-i.right,A=v-i.top-i.bottom,y=d3.select(this);
r.domain(o||d3.extent(E[0].values.map(u).concat(l)));
if(m){r.range([H*0.5/E[0].values.length,H*(E[0].values.length-0.5)/E[0].values.length])
}else{r.range([0,H])
}q.domain(e||d3.extent(E[0].values.map(t).concat(j))).range([A,0]);
if(r.domain()[0]===r.domain()[1]||q.domain()[0]===q.domain()[1]){singlePoint=true
}if(r.domain()[0]===r.domain()[1]){r.domain()[0]?r.domain([r.domain()[0]-r.domain()[0]*0.01,r.domain()[1]+r.domain()[1]*0.01]):r.domain([-1,1])
}if(q.domain()[0]===q.domain()[1]){q.domain()[0]?q.domain([q.domain()[0]+q.domain()[0]*0.01,q.domain()[1]-q.domain()[1]*0.01]):q.domain([-1,1])
}var z=y.selectAll("g.nv-wrap.nv-bar").data([E[0].values]);
var C=z.enter().append("g").attr("class","nvd3 nv-wrap nv-bar");
var B=C.append("defs");
var x=C.append("g");
var F=z.select("g");
x.append("g").attr("class","nv-bars");
z.attr("transform","translate("+i.left+","+i.top+")");
y.on("click",function(J,I){n.chartClick({data:J,index:I,pos:d3.event,id:f})
});
B.append("clipPath").attr("id","nv-chart-clip-path-"+f).append("rect");
z.select("#nv-chart-clip-path-"+f+" rect").attr("width",H).attr("height",A);
F.attr("clip-path",s?"url(#nv-chart-clip-path-"+f+")":"");
var G=z.select(".nv-bars").selectAll(".nv-bar").data(function(I){return I
});
G.exit().remove();
var D=G.enter().append("rect").attr("x",0).attr("y",function(J,I){return q(Math.max(0,t(J,I)))
}).attr("height",function(J,I){return Math.abs(q(t(J,I))-q(0))
}).on("mouseover",function(J,I){d3.select(this).classed("hover",true);
n.elementMouseover({point:J,series:E[0],pos:[r(u(J,I)),q(t(J,I))],pointIndex:I,seriesIndex:0,e:d3.event})
}).on("mouseout",function(J,I){d3.select(this).classed("hover",false);
n.elementMouseout({point:J,series:E[0],pointIndex:I,seriesIndex:0,e:d3.event})
}).on("click",function(J,I){n.elementClick({value:t(J,I),data:J,index:I,pos:[r(u(J,I)),q(t(J,I))],e:d3.event,id:f});
d3.event.stopPropagation()
}).on("dblclick",function(J,I){n.elementDblClick({value:t(J,I),data:J,index:I,pos:[r(u(J,I)),q(t(J,I))],e:d3.event,id:f});
d3.event.stopPropagation()
});
G.attr("fill",function(J,I){return h(J,I)
}).attr("class",function(K,J,I){return(t(K,J)<0?"nv-bar negative":"nv-bar positive")+" nv-bar-"+I+"-"+J
}).attr("transform",function(J,I){return"translate("+(r(u(J,I))-H/E[0].values.length*0.45)+",0)"
}).attr("width",(H/E[0].values.length)*0.9);
d3.transition(G).attr("y",function(J,I){return t(J,I)<0?q(0):q(0)-q(t(J,I))<1?q(0)-1:q(t(J,I))
}).attr("height",function(J,I){return Math.max(Math.abs(q(t(J,I))-q(0)),1)
})
});
return p
}p.dispatch=n;
p.x=function(w){if(!arguments.length){return u
}u=w;
return p
};
p.y=function(w){if(!arguments.length){return t
}t=w;
return p
};
p.margin=function(w){if(!arguments.length){return i
}i.top=typeof w.top!="undefined"?w.top:i.top;
i.right=typeof w.right!="undefined"?w.right:i.right;
i.bottom=typeof w.bottom!="undefined"?w.bottom:i.bottom;
i.left=typeof w.left!="undefined"?w.left:i.left;
return p
};
p.width=function(w){if(!arguments.length){return g
}g=w;
return p
};
p.height=function(w){if(!arguments.length){return v
}v=w;
return p
};
p.xScale=function(w){if(!arguments.length){return r
}r=w;
return p
};
p.yScale=function(w){if(!arguments.length){return q
}q=w;
return p
};
p.xDomain=function(w){if(!arguments.length){return o
}o=w;
return p
};
p.yDomain=function(w){if(!arguments.length){return e
}e=w;
return p
};
p.forceX=function(w){if(!arguments.length){return l
}l=w;
return p
};
p.forceY=function(w){if(!arguments.length){return j
}j=w;
return p
};
p.padData=function(w){if(!arguments.length){return m
}m=w;
return p
};
p.clipEdge=function(w){if(!arguments.length){return s
}s=w;
return p
};
p.color=function(w){if(!arguments.length){return h
}h=c.utils.getColor(w);
return p
};
p.id=function(w){if(!arguments.length){return f
}f=w;
return p
};
return p
};
c.models.bullet=function(){var j={top:0,right:0,bottom:0,left:0},m="left",p=false,f=function(s){return s.ranges
},l=function(s){return s.markers
},e=function(s){return s.measures
},n=[0],g=380,r=30,h=null,i=c.utils.getColor(["#1f77b4"]),o=d3.dispatch("elementMouseover","elementMouseout");
function q(s){s.each(function(N,J){var t=g-j.left-j.right,u=r-j.top-j.bottom,G=d3.select(this);
var O=f.call(this,N,J).slice().sort(d3.descending),H=l.call(this,N,J).slice().sort(d3.descending),F=e.call(this,N,J).slice().sort(d3.descending);
var L=d3.scale.linear().domain(d3.extent(d3.merge([n,O]))).range(p?[t,0]:[0,t]);
var M=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(L.range());
this.__chart__=L;
var w=d3.min(O),y=d3.max(O),v=O[1];
var A=G.selectAll("g.nv-wrap.nv-bullet").data([N]);
var x=A.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet");
var I=x.append("g");
var K=A.select("g");
I.append("rect").attr("class","nv-range nv-rangeMax");
I.append("rect").attr("class","nv-range nv-rangeAvg");
I.append("rect").attr("class","nv-range nv-rangeMin");
I.append("rect").attr("class","nv-measure");
I.append("path").attr("class","nv-markerTriangle");
A.attr("transform","translate("+j.left+","+j.top+")");
var E=function(P){return Math.abs(M(P)-M(0))
},C=function(P){return Math.abs(L(P)-L(0))
};
var D=function(P){return P<0?M(P):M(0)
},B=function(P){return P<0?L(P):L(0)
};
K.select("rect.nv-rangeMax").attr("height",u).attr("width",C(y>0?y:w)).attr("x",B(y>0?y:w)).datum(y>0?y:w);
K.select("rect.nv-rangeAvg").attr("height",u).attr("width",C(v)).attr("x",B(v)).datum(v);
K.select("rect.nv-rangeMin").attr("height",u).attr("width",C(y)).attr("x",B(y)).attr("width",C(y>0?w:y)).attr("x",B(y>0?w:y)).datum(y>0?w:y);
K.select("rect.nv-measure").style("fill",i).attr("height",u/3).attr("y",u/3).attr("width",F<0?L(0)-L(F[0]):L(F[0])-L(0)).attr("x",B(F)).on("mouseover",function(){o.elementMouseover({value:F[0],label:"Current",pos:[L(F[0]),u/2]})
}).on("mouseout",function(){o.elementMouseout({value:F[0],label:"Current"})
});
var z=u/6;
if(H[0]){K.selectAll("path.nv-markerTriangle").attr("transform",function(P){return"translate("+L(H[0])+","+(u/2)+")"
}).attr("d","M0,"+z+"L"+z+","+(-z)+" "+(-z)+","+(-z)+"Z").on("mouseover",function(){o.elementMouseover({value:H[0],label:"Previous",pos:[L(H[0]),u/2]})
}).on("mouseout",function(){o.elementMouseout({value:H[0],label:"Previous"})
})
}else{K.selectAll("path.nv-markerTriangle").remove()
}A.selectAll(".nv-range").on("mouseover",function(R,Q){var P=!Q?"Maximum":Q==1?"Mean":"Minimum";
o.elementMouseover({value:R,label:P,pos:[L(R),u/2]})
}).on("mouseout",function(R,Q){var P=!Q?"Maximum":Q==1?"Mean":"Minimum";
o.elementMouseout({value:R,label:P})
})
});
return q
}q.dispatch=o;
q.orient=function(s){if(!arguments.length){return m
}m=s;
p=m=="right"||m=="bottom";
return q
};
q.ranges=function(s){if(!arguments.length){return f
}f=s;
return q
};
q.markers=function(s){if(!arguments.length){return l
}l=s;
return q
};
q.measures=function(s){if(!arguments.length){return e
}e=s;
return q
};
q.forceX=function(s){if(!arguments.length){return n
}n=s;
return q
};
q.width=function(s){if(!arguments.length){return g
}g=s;
return q
};
q.height=function(s){if(!arguments.length){return r
}r=s;
return q
};
q.margin=function(s){if(!arguments.length){return j
}j.top=typeof s.top!="undefined"?s.top:j.top;
j.right=typeof s.right!="undefined"?s.right:j.right;
j.bottom=typeof s.bottom!="undefined"?s.bottom:j.bottom;
j.left=typeof s.left!="undefined"?s.left:j.left;
return q
};
q.tickFormat=function(s){if(!arguments.length){return h
}h=s;
return q
};
q.color=function(s){if(!arguments.length){return i
}i=c.utils.getColor(s);
return q
};
return q
};
c.models.bulletChart=function(){var e=c.models.bullet();
var m="left",o=false,j={top:5,right:40,bottom:20,left:120},g=function(v){return v.ranges
},l=function(v){return v.markers
},f=function(v){return v.measures
},h=null,t=55,i=null,q=true,u=function(w,v,B,A,z){return"<h3>"+v+"</h3><p>"+B+"</p>"
},s="No Data Available.",n=d3.dispatch("tooltipShow","tooltipHide");
var r=function(z,v){var y=z.pos[0]+(v.offsetLeft||0)+j.left,x=z.pos[1]+(v.offsetTop||0)+j.top,w=u(z.key,z.label,z.value,z,p);
c.tooltip.show([y,x],w,z.value<0?"e":"w",null,v)
};
function p(v){v.each(function(Q,K){var G=d3.select(this);
var w=(h||parseInt(G.style("width"))||960)-j.left-j.right,x=t-j.top-j.bottom,A=this;
p.update=function(){p(v)
};
p.container=this;
if(!Q||!g.call(this,Q,K)){var C=G.selectAll(".nv-noData").data([s]);
C.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
C.attr("x",j.left+w/2).attr("y",18+j.top+x/2).text(function(U){return U
});
return p
}else{G.selectAll(".nv-noData").remove()
}var T=g.call(this,Q,K).slice().sort(d3.descending),I=l.call(this,Q,K).slice().sort(d3.descending),E=f.call(this,Q,K).slice().sort(d3.descending);
var B=G.selectAll("g.nv-wrap.nv-bulletChart").data([Q]);
var y=B.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart");
var J=y.append("g");
var N=B.select("g");
J.append("g").attr("class","nv-bulletWrap");
J.append("g").attr("class","nv-titles");
B.attr("transform","translate("+j.left+","+j.top+")");
var O=d3.scale.linear().domain([0,Math.max(T[0],I[0],E[0])]).range(o?[w,0]:[0,w]);
var P=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(O.range());
this.__chart__=O;
var F=function(U){return Math.abs(P(U)-P(0))
},D=function(U){return Math.abs(O(U)-O(0))
};
var S=J.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(t-j.top-j.bottom)/2+")");
S.append("text").attr("class","nv-title").text(function(U){return U.title
});
S.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(U){return U.subtitle
});
e.width(w).height(x);
var R=N.select(".nv-bulletWrap");
d3.transition(R).call(e);
var M=i||O.tickFormat(w/100);
var L=N.selectAll("g.nv-tick").data(O.ticks(w/50),function(U){return this.textContent||M(U)
});
var H=L.enter().append("g").attr("class","nv-tick").attr("transform",function(U){return"translate("+P(U)+",0)"
}).style("opacity",0.000001);
H.append("line").attr("y1",x).attr("y2",x*7/6);
H.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",x*7/6).text(M);
var z=d3.transition(L).attr("transform",function(U){return"translate("+O(U)+",0)"
}).style("opacity",1);
z.select("line").attr("y1",x).attr("y2",x*7/6);
z.select("text").attr("y",x*7/6);
d3.transition(L.exit()).attr("transform",function(U){return"translate("+O(U)+",0)"
}).style("opacity",0.000001).remove();
n.on("tooltipShow",function(U){U.key=Q.title;
if(q){r(U,A.parentNode)
}})
});
d3.timer.flush();
return p
}e.dispatch.on("elementMouseover.tooltip",function(v){n.tooltipShow(v)
});
e.dispatch.on("elementMouseout.tooltip",function(v){n.tooltipHide(v)
});
n.on("tooltipHide",function(){if(q){c.tooltip.cleanup()
}});
p.dispatch=n;
p.bullet=e;
d3.rebind(p,e,"color");
p.orient=function(v){if(!arguments.length){return m
}m=v;
o=m=="right"||m=="bottom";
return p
};
p.ranges=function(v){if(!arguments.length){return g
}g=v;
return p
};
p.markers=function(v){if(!arguments.length){return l
}l=v;
return p
};
p.measures=function(v){if(!arguments.length){return f
}f=v;
return p
};
p.width=function(v){if(!arguments.length){return h
}h=v;
return p
};
p.height=function(v){if(!arguments.length){return t
}t=v;
return p
};
p.margin=function(v){if(!arguments.length){return j
}j.top=typeof v.top!="undefined"?v.top:j.top;
j.right=typeof v.right!="undefined"?v.right:j.right;
j.bottom=typeof v.bottom!="undefined"?v.bottom:j.bottom;
j.left=typeof v.left!="undefined"?v.left:j.left;
return p
};
p.tickFormat=function(v){if(!arguments.length){return i
}i=v;
return p
};
p.tooltips=function(v){if(!arguments.length){return q
}q=v;
return p
};
p.tooltipContent=function(v){if(!arguments.length){return u
}u=v;
return p
};
p.noData=function(v){if(!arguments.length){return s
}s=v;
return p
};
return p
};
c.models.cumulativeLineChart=function(){var f=c.models.line(),r=c.models.axis(),e=c.models.axis(),h=c.models.legend(),v=c.models.legend();
var z={top:30,right:30,bottom:50,left:60},D=c.utils.defaultColor(),C=null,A=null,E=true,g=true,F=true,q=true,n=function(J,I,M,L,K){return"<h3>"+J+"</h3><p>"+M+" at "+I+"</p>"
},t,s,B=f.id(),m={index:0,rescaleY:q},o=null,l="No Data Available.",i=function(x){return x.average
},H=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");
r.orient("bottom").tickPadding(7);
e.orient("left");
var u=d3.scale.linear(),p={i:0,x:0};
var j=function(N,J){var M=N.pos[0]+(J.offsetLeft||0),L=N.pos[1]+(J.offsetTop||0),I=r.tickFormat()(f.x()(N.point,N.pointIndex)),O=e.tickFormat()(f.y()(N.point,N.pointIndex)),K=n(N.series.key,I,O,N,w);
c.tooltip.show([M,L],K,null,null,J)
};
function w(x){x.each(function(ac){var Q=d3.select(this).classed("nv-chart-"+B,true),N=this;
var I=(C||parseInt(Q.style("width"))||960)-z.left-z.right,K=(A||parseInt(Q.style("height"))||400)-z.top-z.bottom;
w.update=function(){w(x)
};
w.container=this;
m.disabled=ac.map(function(ae){return !!ae.disabled
});
if(!o){var ad;
o={};
for(ad in m){if(m[ad] instanceof Array){o[ad]=m[ad].slice(0)
}else{o[ad]=m[ad]
}}}var ab=d3.behavior.drag().on("dragstart",Z).on("drag",aa).on("dragend",V);
function Z(af,ae){d3.select(w.container).style("cursor","ew-resize")
}function aa(af,ae){p.x=d3.event.x;
p.i=Math.round(u.invert(p.x));
T()
}function V(af,ae){d3.select(w.container).style("cursor","auto");
m.index=p.i;
H.stateChange(m)
}if(!ac||!ac.length||!ac.filter(function(ae){return ae.values.length
}).length){var P=Q.selectAll(".nv-noData").data([l]);
P.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
P.attr("x",z.left+I/2).attr("y",z.top+K/2).text(function(ae){return ae
});
return w
}else{Q.selectAll(".nv-noData").remove()
}t=f.xScale();
s=f.yScale();
if(!q){var J=ac.filter(function(ae){return !ae.disabled
}).map(function(ag,af){var ae=d3.extent(ag.values,f.y());
if(ae[0]<-0.95){ae[0]=-0.95
}return[(ae[0]-ae[1])/(1+ae[1]),(ae[1]-ae[0])/(1+ae[0])]
});
var L=[d3.min(J,function(ae){return ae[0]
}),d3.max(J,function(ae){return ae[1]
})];
f.yDomain(L)
}else{f.yDomain(null)
}u.domain([0,ac[0].values.length-1]).range([0,I]).clamp(true);
var ac=G(p.i,ac);
var O=Q.selectAll("g.nv-wrap.nv-cumulativeLine").data([ac]);
var S=O.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g");
var Y=O.select("g");
S.append("g").attr("class","nv-x nv-axis");
S.append("g").attr("class","nv-y nv-axis");
S.append("g").attr("class","nv-background");
S.append("g").attr("class","nv-linesWrap");
S.append("g").attr("class","nv-avgLinesWrap");
S.append("g").attr("class","nv-legendWrap");
S.append("g").attr("class","nv-controlsWrap");
if(E){h.width(I);
Y.select(".nv-legendWrap").datum(ac).call(h);
if(z.top!=h.height()){z.top=h.height();
K=(A||parseInt(Q.style("height"))||400)-z.top-z.bottom
}Y.select(".nv-legendWrap").attr("transform","translate(0,"+(-z.top)+")")
}if(F){var M=[{key:"Re-scale y-axis",disabled:!q}];
v.width(140).color(["#444","#444","#444"]);
Y.select(".nv-controlsWrap").datum(M).attr("transform","translate(0,"+(-z.top)+")").call(v)
}O.attr("transform","translate("+z.left+","+z.top+")");
var y=ac.filter(function(ae){return ae.tempDisabled
});
O.select(".tempDisabled").remove();
if(y.length){O.append("text").attr("class","tempDisabled").attr("x",I/2).attr("y","-.71em").style("text-anchor","end").text(y.map(function(ae){return ae.key
}).join(", ")+" values cannot be calculated for this time period.")
}S.select(".nv-background").append("rect");
Y.select(".nv-background rect").attr("width",I).attr("height",K);
f.y(function(ae){return ae.display.y
}).width(I).height(K).color(ac.map(function(af,ae){return af.color||D(af,ae)
}).filter(function(af,ae){return !ac[ae].disabled&&!ac[ae].tempDisabled
}));
var U=Y.select(".nv-linesWrap").datum(ac.filter(function(ae){return !ae.disabled&&!ae.tempDisabled
}));
U.call(f);
ac.forEach(function(af,ae){af.seriesIndex=ae
});
var X=ac.filter(function(ae){return !ae.disabled&&!!i(ae)
});
var W=Y.select(".nv-avgLinesWrap").selectAll("line").data(X,function(ae){return ae.key
});
W.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(af,ae){return f.color()(af,af.seriesIndex)
}).attr("x1",0).attr("x2",I).attr("y1",function(ae){return s(i(ae))
}).attr("y2",function(ae){return s(i(ae))
});
W.attr("x1",0).attr("x2",I).attr("y1",function(ae){return s(i(ae))
}).attr("y2",function(ae){return s(i(ae))
});
W.exit().remove();
var R=U.selectAll(".nv-indexLine").data([p]);
R.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",0.5).call(ab);
R.attr("transform",function(ae){return"translate("+u(ae.i)+",0)"
}).attr("height",K);
r.scale(t).ticks(Math.min(ac[0].values.length,I/70)).tickSize(-K,0);
Y.select(".nv-x.nv-axis").attr("transform","translate(0,"+s.range()[0]+")");
d3.transition(Y.select(".nv-x.nv-axis")).call(r);
e.scale(s).ticks(K/36).tickSize(-I,0);
d3.transition(Y.select(".nv-y.nv-axis")).call(e);
function T(){R.data([p]);
w.update()
}Y.select(".nv-background rect").on("click",function(){p.x=d3.mouse(this)[0];
p.i=Math.round(u.invert(p.x));
m.index=p.i;
H.stateChange(m);
T()
});
f.dispatch.on("elementClick",function(ae){p.i=ae.pointIndex;
p.x=u(p.i);
m.index=p.i;
H.stateChange(m);
T()
});
v.dispatch.on("legendClick",function(af,ae){af.disabled=!af.disabled;
q=!af.disabled;
m.rescaleY=q;
H.stateChange(m);
x.call(w)
});
h.dispatch.on("legendClick",function(af,ae){af.disabled=!af.disabled;
if(!ac.filter(function(ag){return !ag.disabled
}).length){ac.map(function(ag){ag.disabled=false;
O.selectAll(".nv-series").classed("disabled",false);
return ag
})
}m.disabled=ac.map(function(ag){return !!ag.disabled
});
H.stateChange(m);
x.call(w)
});
H.on("tooltipShow",function(ae){if(g){j(ae,N.parentNode)
}});
H.on("changeState",function(ae){if(typeof ae.disabled!=="undefined"){ac.forEach(function(ag,af){ag.disabled=ae.disabled[af]
});
m.disabled=ae.disabled
}if(typeof ae.index!=="undefined"){p.i=ae.index;
p.x=u(p.i);
m.index=ae.index;
R.data([p])
}if(typeof ae.rescaleY!=="undefined"){q=ae.rescaleY
}x.call(w)
})
});
return w
}f.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+z.left,x.pos[1]+z.top];
H.tooltipShow(x)
});
f.dispatch.on("elementMouseout.tooltip",function(x){H.tooltipHide(x)
});
H.on("tooltipHide",function(){if(g){c.tooltip.cleanup()
}});
w.dispatch=H;
w.lines=f;
w.legend=h;
w.xAxis=r;
w.yAxis=e;
d3.rebind(w,f,"defined","isArea","x","y","size","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id");
w.margin=function(x){if(!arguments.length){return z
}z.top=typeof x.top!="undefined"?x.top:z.top;
z.right=typeof x.right!="undefined"?x.right:z.right;
z.bottom=typeof x.bottom!="undefined"?x.bottom:z.bottom;
z.left=typeof x.left!="undefined"?x.left:z.left;
return w
};
w.width=function(x){if(!arguments.length){return C
}C=x;
return w
};
w.height=function(x){if(!arguments.length){return A
}A=x;
return w
};
w.color=function(x){if(!arguments.length){return D
}D=c.utils.getColor(x);
h.color(D);
return w
};
w.rescaleY=function(x){if(!arguments.length){return q
}q=x;
return q
};
w.showControls=function(x){if(!arguments.length){return F
}F=x;
return w
};
w.showLegend=function(x){if(!arguments.length){return E
}E=x;
return w
};
w.tooltips=function(x){if(!arguments.length){return g
}g=x;
return w
};
w.tooltipContent=function(x){if(!arguments.length){return n
}n=x;
return w
};
w.state=function(x){if(!arguments.length){return m
}m=x;
return w
};
w.defaultState=function(x){if(!arguments.length){return o
}o=x;
return w
};
w.noData=function(x){if(!arguments.length){return l
}l=x;
return w
};
w.average=function(x){if(!arguments.length){return i
}i=x;
return w
};
function G(x,y){return y.map(function(I,K){if(!I.values){return I
}var J=f.y()(I.values[x],x);
if(J<-0.95){I.tempDisabled=true;
return I
}I.tempDisabled=false;
I.values=I.values.map(function(L,M){L.display={y:(f.y()(L,M)-J)/(1+J)};
return L
});
return I
})
}return w
};
c.models.discreteBar=function(){var l={top:0,right:0,bottom:0,left:0},o=960,m=500,n=Math.floor(Math.random()*10000),i=d3.scale.ordinal(),h=d3.scale.linear(),t=function(x){return x.x
},s=function(x){return x.y
},f=[0],r=c.utils.defaultColor(),v=false,g=d3.format(",.2f"),q,p,z=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),w="discreteBar";
var u,e;
function j(x){x.each(function(H){var K=o-l.left-l.right,D=m-l.top-l.bottom,A=d3.select(this);
H=H.map(function(M,L){M.values=M.values.map(function(N){N.series=L;
return N
});
return M
});
var C=(q&&p)?[]:H.map(function(L){return L.values.map(function(N,M){return{x:t(N,M),y:s(N,M),y0:N.y0}
})
});
i.domain(q||d3.merge(C).map(function(L){return L.x
})).rangeBands([0,K],0.1);
h.domain(p||d3.extent(d3.merge(C).map(function(L){return L.y
}).concat(f)));
if(v){h.range([D-(h.domain()[0]<0?12:0),h.domain()[1]>0?12:0])
}else{h.range([D,0])
}u=u||i;
e=e||h.copy().range([h(0),h(0)]);
var B=A.selectAll("g.nv-wrap.nv-discretebar").data([H]);
var F=B.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar");
var y=F.append("g");
var I=B.select("g");
y.append("g").attr("class","nv-groups");
B.attr("transform","translate("+l.left+","+l.top+")");
var E=B.select(".nv-groups").selectAll(".nv-group").data(function(L){return L
},function(L){return L.key
});
E.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);
d3.transition(E.exit()).style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();
E.attr("class",function(M,L){return"nv-group nv-series-"+L
}).classed("hover",function(L){return L.hover
});
d3.transition(E).style("stroke-opacity",1).style("fill-opacity",0.75);
var J=E.selectAll("g.nv-bar").data(function(L){return L.values
});
J.exit().remove();
var G=J.enter().append("g").attr("transform",function(N,M,L){return"translate("+(i(t(N,M))+i.rangeBand()*0.05)+", "+h(0)+")"
}).on("mouseover",function(M,L){d3.select(this).classed("hover",true);
z.elementMouseover({value:s(M,L),point:M,series:H[M.series],pos:[i(t(M,L))+(i.rangeBand()*(M.series+0.5)/H.length),h(s(M,L))],pointIndex:L,seriesIndex:M.series,e:d3.event})
}).on("mouseout",function(M,L){d3.select(this).classed("hover",false);
z.elementMouseout({value:s(M,L),point:M,series:H[M.series],pointIndex:L,seriesIndex:M.series,e:d3.event})
}).on("click",function(M,L){z.elementClick({value:s(M,L),point:M,series:H[M.series],pos:[i(t(M,L))+(i.rangeBand()*(M.series+0.5)/H.length),h(s(M,L))],pointIndex:L,seriesIndex:M.series,e:d3.event});
d3.event.stopPropagation()
}).on("dblclick",function(M,L){z.elementDblClick({value:s(M,L),point:M,series:H[M.series],pos:[i(t(M,L))+(i.rangeBand()*(M.series+0.5)/H.length),h(s(M,L))],pointIndex:L,seriesIndex:M.series,e:d3.event});
d3.event.stopPropagation()
});
G.append("rect").attr("height",0).attr("width",i.rangeBand()*0.9/H.length);
if(v){G.append("text").attr("text-anchor","middle");
J.select("text").attr("x",i.rangeBand()*0.9/2).attr("y",function(M,L){return s(M,L)<0?h(s(M,L))-h(0)+12:-4
}).text(function(M,L){return g(s(M,L))
})
}else{J.selectAll("text").remove()
}J.attr("class",function(M,L){return s(M,L)<0?"nv-bar negative":"nv-bar positive"
}).style("fill",function(M,L){return M.color||r(M,L)
}).style("stroke",function(M,L){return M.color||r(M,L)
}).select("rect").attr("class",w).attr("width",i.rangeBand()*0.9/H.length);
d3.transition(J).attr("transform",function(O,L){var N=i(t(O,L))+i.rangeBand()*0.05,M=s(O,L)<0?h(0):h(0)-h(s(O,L))<1?h(0)-1:h(s(O,L));
return"translate("+N+", "+M+")"
}).select("rect").attr("height",function(M,L){return Math.max(Math.abs(h(s(M,L))-h(0))||1)
});
u=i.copy();
e=h.copy()
});
return j
}j.dispatch=z;
j.x=function(x){if(!arguments.length){return t
}t=x;
return j
};
j.y=function(x){if(!arguments.length){return s
}s=x;
return j
};
j.margin=function(x){if(!arguments.length){return l
}l.top=typeof x.top!="undefined"?x.top:l.top;
l.right=typeof x.right!="undefined"?x.right:l.right;
l.bottom=typeof x.bottom!="undefined"?x.bottom:l.bottom;
l.left=typeof x.left!="undefined"?x.left:l.left;
return j
};
j.width=function(x){if(!arguments.length){return o
}o=x;
return j
};
j.height=function(x){if(!arguments.length){return m
}m=x;
return j
};
j.xScale=function(x){if(!arguments.length){return i
}i=x;
return j
};
j.yScale=function(x){if(!arguments.length){return h
}h=x;
return j
};
j.xDomain=function(x){if(!arguments.length){return q
}q=x;
return j
};
j.yDomain=function(x){if(!arguments.length){return p
}p=x;
return j
};
j.forceY=function(x){if(!arguments.length){return f
}f=x;
return j
};
j.color=function(x){if(!arguments.length){return r
}r=c.utils.getColor(x);
return j
};
j.id=function(x){if(!arguments.length){return n
}n=x;
return j
};
j.showValues=function(x){if(!arguments.length){return v
}v=x;
return j
};
j.valueFormat=function(x){if(!arguments.length){return g
}g=x;
return j
};
j.rectClass=function(x){if(!arguments.length){return w
}w=x;
return j
};
return j
};
c.models.discreteBarChart=function(){var s=c.models.discreteBar(),g=c.models.axis(),e=c.models.axis();
var h={top:15,right:10,bottom:50,left:60},f=null,t=null,i=c.utils.getColor(),j=false,n=true,u=function(w,v,B,A,z){return"<h3>"+v+"</h3><p>"+B+"</p>"
},p,o,r="No Data Available.",l=d3.dispatch("tooltipShow","tooltipHide","beforeUpdate");
g.orient("bottom").highlightZero(false).showMaxMin(false).tickFormat(function(v){return v
});
e.orient("left").tickFormat(d3.format(",.1f"));
var q=function(C,w){var B=C.pos[0]+(w.offsetLeft||0),A=C.pos[1]+(w.offsetTop||0),v=g.tickFormat()(s.x()(C.point,C.pointIndex)),D=e.tickFormat()(s.y()(C.point,C.pointIndex)),z=u(C.series.key,v,D,C,m);
c.tooltip.show([B,A],z,C.value<0?"n":"s",null,w)
};
function m(v){v.each(function(D){var x=d3.select(this),G=this;
var H=(f||parseInt(x.style("width"))||960)-h.left-h.right,B=(t||parseInt(x.style("height"))||400)-h.top-h.bottom;
m.update=function(){l.beforeUpdate();
v.transition().call(m)
};
m.container=this;
if(!D||!D.length||!D.filter(function(I){return I.values.length
}).length){var y=x.selectAll(".nv-noData").data([r]);
y.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
y.attr("x",h.left+H/2).attr("y",h.top+B/2).text(function(I){return I
});
return m
}else{x.selectAll(".nv-noData").remove()
}p=s.xScale();
o=s.yScale();
var z=x.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([D]);
var w=z.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g");
var A=w.append("defs");
var E=z.select("g");
w.append("g").attr("class","nv-x nv-axis");
w.append("g").attr("class","nv-y nv-axis");
w.append("g").attr("class","nv-barsWrap");
E.attr("transform","translate("+h.left+","+h.top+")");
s.width(H).height(B);
var F=E.select(".nv-barsWrap").datum(D.filter(function(I){return !I.disabled
}));
d3.transition(F).call(s);
A.append("clipPath").attr("id","nv-x-label-clip-"+s.id()).append("rect");
E.select("#nv-x-label-clip-"+s.id()+" rect").attr("width",p.rangeBand()*(j?2:1)).attr("height",16).attr("x",-p.rangeBand()/(j?1:2));
g.scale(p).ticks(H/100).tickSize(-B,0);
E.select(".nv-x.nv-axis").attr("transform","translate(0,"+(o.range()[0]+((s.showValues()&&o.domain()[0]<0)?16:0))+")");
E.select(".nv-x.nv-axis").transition().duration(0).call(g);
var C=E.select(".nv-x.nv-axis").selectAll("g");
if(j){C.selectAll("text").attr("transform",function(K,J,I){return"translate(0,"+(I%2==0?"5":"17")+")"
})
}e.scale(o).ticks(B/36).tickSize(-H,0);
d3.transition(E.select(".nv-y.nv-axis")).call(e);
l.on("tooltipShow",function(I){if(n){q(I,G.parentNode)
}})
});
return m
}s.dispatch.on("elementMouseover.tooltip",function(v){v.pos=[v.pos[0]+h.left,v.pos[1]+h.top];
l.tooltipShow(v)
});
s.dispatch.on("elementMouseout.tooltip",function(v){l.tooltipHide(v)
});
l.on("tooltipHide",function(){if(n){c.tooltip.cleanup()
}});
m.dispatch=l;
m.discretebar=s;
m.xAxis=g;
m.yAxis=e;
d3.rebind(m,s,"x","y","xDomain","yDomain","forceX","forceY","id","showValues","valueFormat");
m.margin=function(v){if(!arguments.length){return h
}h.top=typeof v.top!="undefined"?v.top:h.top;
h.right=typeof v.right!="undefined"?v.right:h.right;
h.bottom=typeof v.bottom!="undefined"?v.bottom:h.bottom;
h.left=typeof v.left!="undefined"?v.left:h.left;
return m
};
m.width=function(v){if(!arguments.length){return f
}f=v;
return m
};
m.height=function(v){if(!arguments.length){return t
}t=v;
return m
};
m.color=function(v){if(!arguments.length){return i
}i=c.utils.getColor(v);
s.color(i);
return m
};
m.staggerLabels=function(v){if(!arguments.length){return j
}j=v;
return m
};
m.tooltips=function(v){if(!arguments.length){return n
}n=v;
return m
};
m.tooltipContent=function(v){if(!arguments.length){return u
}u=v;
return m
};
m.noData=function(v){if(!arguments.length){return r
}r=v;
return m
};
return m
};
c.models.distribution=function(){var h={top:0,right:0,bottom:0,left:0},e=400,o=8,f="x",l=function(p){return p[f]
},i=c.utils.defaultColor(),g=d3.scale.linear(),j;
var m;
function n(p){p.each(function(u){var v=e-(f==="x"?h.left+h.right:h.top+h.bottom),y=f=="x"?"y":"x",r=d3.select(this);
m=m||g;
var s=r.selectAll("g.nv-distribution").data([u]);
var t=s.enter().append("g").attr("class","nvd3 nv-distribution");
var q=t.append("g");
var w=s.select("g");
s.attr("transform","translate("+h.left+","+h.top+")");
var z=w.selectAll("g.nv-dist").data(function(A){return A
},function(A){return A.key
});
z.enter().append("g");
z.attr("class",function(B,A){return"nv-dist nv-series-"+A
}).style("stroke",function(B,A){return i(B,A)
});
var x=z.selectAll("line.nv-dist"+f).data(function(A){return A.values
});
x.enter().append("line").attr(f+"1",function(B,A){return m(l(B,A))
}).attr(f+"2",function(B,A){return m(l(B,A))
});
d3.transition(z.exit().selectAll("line.nv-dist"+f)).attr(f+"1",function(B,A){return g(l(B,A))
}).attr(f+"2",function(B,A){return g(l(B,A))
}).style("stroke-opacity",0).remove();
x.attr("class",function(B,A){return"nv-dist"+f+" nv-dist"+f+"-"+A
}).attr(y+"1",0).attr(y+"2",o);
d3.transition(x).attr(f+"1",function(B,A){return g(l(B,A))
}).attr(f+"2",function(B,A){return g(l(B,A))
});
m=g.copy()
});
return n
}n.margin=function(p){if(!arguments.length){return h
}h.top=typeof p.top!="undefined"?p.top:h.top;
h.right=typeof p.right!="undefined"?p.right:h.right;
h.bottom=typeof p.bottom!="undefined"?p.bottom:h.bottom;
h.left=typeof p.left!="undefined"?p.left:h.left;
return n
};
n.width=function(p){if(!arguments.length){return e
}e=p;
return n
};
n.axis=function(p){if(!arguments.length){return f
}f=p;
return n
};
n.size=function(p){if(!arguments.length){return o
}o=p;
return n
};
n.getData=function(p){if(!arguments.length){return l
}l=d3.functor(p);
return n
};
n.scale=function(p){if(!arguments.length){return g
}g=p;
return n
};
n.color=function(p){if(!arguments.length){return i
}i=c.utils.getColor(p);
return n
};
return n
};
c.models.indentedTree=function(){var i={top:0,right:0,bottom:0,left:0},g=960,t=500,j=c.utils.defaultColor(),f=Math.floor(Math.random()*10000),m=true,u=false,s="No Data Available.",n=20,h=[{key:"key",label:"Name",type:"text"}],q=null,e="images/grey-plus.png",l="images/grey-minus.png",o=d3.dispatch("elementClick","elementDblclick","elementMouseover","elementMouseout");
var r=0;
function p(v){v.each(function(L){var M=1,A=d3.select(this);
var B=d3.layout.tree().children(function(O){return O.values
}).size([t,n]);
p.update=function(){A.transition().duration(600).call(p)
};
if(!L[0]){L[0]={key:s}
}var D=B.nodes(L[0]);
var z=d3.select(this).selectAll("div").data([[D]]);
var x=z.enter().append("div").attr("class","nvd3 nv-wrap nv-indentedtree");
var N=x.append("table");
var I=z.select("table").attr("width","100%").attr("class",q);
if(m){var H=N.append("thead");
var K=H.append("tr");
h.forEach(function(O){K.append("th").attr("width",O.width?O.width:"10%").style("text-align",O.type=="numeric"?"right":"left").append("span").text(O.label)
})
}var w=I.selectAll("tbody").data(function(O){return O
});
w.enter().append("tbody");
M=d3.max(D,function(O){return O.depth
});
B.size([t,M*n]);
var F=w.selectAll("tr").data(function(O){return O.filter(function(P){return(u&&!P.children)?u(P):true
})
},function(P,O){return P.id||(P.id||++r)
});
F.exit().remove();
F.select("img.nv-treeicon").attr("src",J).classed("folded",C);
var y=F.enter().append("tr");
h.forEach(function(P,O){var Q=y.append("td").style("padding-left",function(R){return(O?0:R.depth*n+12+(J(R)?0:16))+"px"
},"important").style("text-align",P.type=="numeric"?"right":"left");
if(O==0){Q.append("img").classed("nv-treeicon",true).classed("nv-folded",C).attr("src",J).style("width","14px").style("height","14px").style("padding","0 1px").style("display",function(R){return J(R)?"inline-block":"none"
}).on("click",E)
}Q.append("span").attr("class",d3.functor(P.classes)).text(function(R){return P.format?P.format(R):(R[P.key]||"-")
});
if(P.showCount){Q.append("span").attr("class","nv-childrenCount");
F.selectAll("span.nv-childrenCount").text(function(R){return((R.values&&R.values.length)||(R._values&&R._values.length))?"("+((R.values&&(R.values.filter(function(S){return u?u(S):true
}).length))||(R._values&&R._values.filter(function(S){return u?u(S):true
}).length)||0)+")":""
})
}if(P.click){Q.select("span").on("click",P.click)
}});
F.order().on("click",function(O){o.elementClick({row:this,data:O,pos:[O.x,O.y]})
}).on("dblclick",function(O){o.elementDblclick({row:this,data:O,pos:[O.x,O.y]})
}).on("mouseover",function(O){o.elementMouseover({row:this,data:O,pos:[O.x,O.y]})
}).on("mouseout",function(O){o.elementMouseout({row:this,data:O,pos:[O.x,O.y]})
});
function E(Q,P,O){d3.event.stopPropagation();
if(d3.event.shiftKey&&!O){d3.event.shiftKey=false;
Q.values&&Q.values.forEach(function(R){if(R.values||R._values){E(R,0,true)
}});
return true
}if(!G(Q)){return true
}if(Q.values){Q._values=Q.values;
Q.values=null
}else{Q.values=Q._values;
Q._values=null
}p.update()
}function J(O){return(O._values&&O._values.length)?e:(O.values&&O.values.length)?l:""
}function C(O){return(O._values&&O._values.length)
}function G(P){var O=P.values||P._values;
return(O&&O.length)
}});
return p
}p.margin=function(v){if(!arguments.length){return i
}i.top=typeof v.top!="undefined"?v.top:i.top;
i.right=typeof v.right!="undefined"?v.right:i.right;
i.bottom=typeof v.bottom!="undefined"?v.bottom:i.bottom;
i.left=typeof v.left!="undefined"?v.left:i.left;
return p
};
p.width=function(v){if(!arguments.length){return g
}g=v;
return p
};
p.height=function(v){if(!arguments.length){return t
}t=v;
return p
};
p.color=function(v){if(!arguments.length){return j
}j=c.utils.getColor(v);
scatter.color(j);
return p
};
p.id=function(v){if(!arguments.length){return f
}f=v;
return p
};
p.header=function(v){if(!arguments.length){return m
}m=v;
return p
};
p.noData=function(v){if(!arguments.length){return s
}s=v;
return p
};
p.filterZero=function(v){if(!arguments.length){return u
}u=v;
return p
};
p.columns=function(v){if(!arguments.length){return h
}h=v;
return p
};
p.tableClass=function(v){if(!arguments.length){return q
}q=v;
return p
};
p.iconOpen=function(v){if(!arguments.length){return e
}e=v;
return p
};
p.iconClose=function(v){if(!arguments.length){return l
}l=v;
return p
};
return p
};
c.models.legend=function(){var l={top:5,right:0,bottom:5,left:0},j=400,e=20,h=function(n){return n.key
},f=c.utils.defaultColor(),m=true,g=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout");
function i(n){n.each(function(G){var o=j-l.left-l.right,z=d3.select(this);
var x=z.selectAll("g.nv-legend").data([G]);
var D=x.enter().append("g").attr("class","nvd3 nv-legend").append("g");
var F=x.select("g");
x.attr("transform","translate("+l.left+","+l.top+")");
var y=F.selectAll(".nv-series").data(function(H){return H
});
var s=y.enter().append("g").attr("class","nv-series").on("mouseover",function(I,H){g.legendMouseover(I,H)
}).on("mouseout",function(I,H){g.legendMouseout(I,H)
}).on("click",function(I,H){g.legendClick(I,H)
}).on("dblclick",function(I,H){g.legendDblclick(I,H)
});
s.append("circle").style("stroke-width",2).attr("r",5);
s.append("text").attr("text-anchor","start").attr("dy",".32em").attr("dx","8");
y.classed("disabled",function(H){return H.disabled
});
y.exit().remove();
y.select("circle").style("fill",function(I,H){return I.color||f(I,H)
}).style("stroke",function(I,H){return I.color||f(I,H)
});
y.select("text").text(h);
if(m){var r=[];
y.each(function(K,J){var I=d3.select(this).select("text");
var H=I.node().getComputedTextLength()||c.utils.calcApproxTextWidth(I);
r.push(H+28)
});
var v=0;
var C=0;
var A=[];
while(C<o&&v<r.length){A[v]=r[v];
C+=r[v++]
}while(C>o&&v>1){A=[];
v--;
for(k=0;
k<r.length;
k++){if(r[k]>(A[k%v]||0)){A[k%v]=r[k]
}}C=A.reduce(function(I,J,H,K){return I+J
})
}var p=[];
for(var E=0,w=0;
E<v;
E++){p[E]=w;
w+=A[E]
}y.attr("transform",function(I,H){return"translate("+p[H%v]+","+(5+Math.floor(H/v)*20)+")"
});
F.attr("transform","translate("+(j-l.right-C)+","+l.top+")");
e=l.top+l.bottom+(Math.ceil(r.length/v)*20)
}else{var t=5,u=5,B=0,q;
y.attr("transform",function(J,H){var I=d3.select(this).select("text").node().getComputedTextLength()+28;
q=u;
if(j<l.left+l.right+q+I){u=q=5;
t+=20
}u+=I;
if(u>B){B=u
}return"translate("+q+","+t+")"
});
F.attr("transform","translate("+(j-l.right-B)+","+l.top+")");
e=l.top+l.bottom+t+15
}});
return i
}i.dispatch=g;
i.margin=function(n){if(!arguments.length){return l
}l.top=typeof n.top!="undefined"?n.top:l.top;
l.right=typeof n.right!="undefined"?n.right:l.right;
l.bottom=typeof n.bottom!="undefined"?n.bottom:l.bottom;
l.left=typeof n.left!="undefined"?n.left:l.left;
return i
};
i.width=function(n){if(!arguments.length){return j
}j=n;
return i
};
i.height=function(n){if(!arguments.length){return e
}e=n;
return i
};
i.key=function(n){if(!arguments.length){return h
}h=n;
return i
};
i.color=function(n){if(!arguments.length){return f
}f=c.utils.getColor(n);
return i
};
i.align=function(n){if(!arguments.length){return m
}m=n;
return i
};
return i
};
c.models.line=function(){var e=c.models.scatter();
var i={top:0,right:0,bottom:0,left:0},f=960,u=500,j=c.utils.defaultColor(),t=function(v){return v.x
},s=function(v){return v.y
},h=function(w,v){return !isNaN(s(w,v))&&s(w,v)!==null
},n=function(v){return v.area
},r=false,p,o,l="linear";
e.size(16).sizeDomain([16,256]);
var g,q;
function m(v){v.each(function(F){var I=f-i.left-i.right,A=u-i.top-i.bottom,x=d3.select(this);
p=e.xScale();
o=e.yScale();
g=g||p;
q=q||o;
var y=x.selectAll("g.nv-wrap.nv-line").data([F]);
var D=y.enter().append("g").attr("class","nvd3 nv-wrap nv-line");
var B=D.append("defs");
var w=D.append("g");
var G=y.select("g");
w.append("g").attr("class","nv-groups");
w.append("g").attr("class","nv-scatterWrap");
y.attr("transform","translate("+i.left+","+i.top+")");
e.width(I).height(A);
var z=y.select(".nv-scatterWrap");
d3.transition(z).call(e);
B.append("clipPath").attr("id","nv-edge-clip-"+e.id()).append("rect");
y.select("#nv-edge-clip-"+e.id()+" rect").attr("width",I).attr("height",A);
G.attr("clip-path",r?"url(#nv-edge-clip-"+e.id()+")":"");
z.attr("clip-path",r?"url(#nv-edge-clip-"+e.id()+")":"");
var C=y.select(".nv-groups").selectAll(".nv-group").data(function(J){return J
},function(J){return J.key
});
C.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);
d3.transition(C.exit()).style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();
C.attr("class",function(K,J){return"nv-group nv-series-"+J
}).classed("hover",function(J){return J.hover
}).style("fill",function(K,J){return j(K,J)
}).style("stroke",function(K,J){return j(K,J)
});
d3.transition(C).style("stroke-opacity",1).style("fill-opacity",0.5);
var H=C.selectAll("path.nv-area").data(function(J){return n(J)?[J]:[]
});
H.enter().append("path").attr("class","nv-area").attr("d",function(J){return d3.svg.area().interpolate(l).defined(h).x(function(L,K){return g(t(L,K))
}).y0(function(L,K){return q(s(L,K))
}).y1(function(L,K){return q(o.domain()[0]<=0?o.domain()[1]>=0?0:o.domain()[1]:o.domain()[0])
}).apply(this,[J.values])
});
d3.transition(C.exit().selectAll("path.nv-area")).attr("d",function(J){return d3.svg.area().interpolate(l).defined(h).x(function(L,K){return g(t(L,K))
}).y0(function(L,K){return q(s(L,K))
}).y1(function(L,K){return q(o.domain()[0]<=0?o.domain()[1]>=0?0:o.domain()[1]:o.domain()[0])
}).apply(this,[J.values])
});
d3.transition(H).attr("d",function(J){return d3.svg.area().interpolate(l).defined(h).x(function(L,K){return g(t(L,K))
}).y0(function(L,K){return q(s(L,K))
}).y1(function(L,K){return q(o.domain()[0]<=0?o.domain()[1]>=0?0:o.domain()[1]:o.domain()[0])
}).apply(this,[J.values])
});
var E=C.selectAll("path.nv-line").data(function(J){return[J.values]
});
E.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(l).defined(h).x(function(K,J){return g(t(K,J))
}).y(function(K,J){return q(s(K,J))
}));
d3.transition(C.exit().selectAll("path.nv-line")).attr("d",d3.svg.line().interpolate(l).defined(h).x(function(K,J){return p(t(K,J))
}).y(function(K,J){return o(s(K,J))
}));
d3.transition(E).attr("d",d3.svg.line().interpolate(l).defined(h).x(function(K,J){return p(t(K,J))
}).y(function(K,J){return o(s(K,J))
}));
g=p.copy();
q=o.copy()
});
return m
}m.dispatch=e.dispatch;
m.scatter=e;
d3.rebind(m,e,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","clipVoronoi","clipRadius","padData");
m.margin=function(v){if(!arguments.length){return i
}i.top=typeof v.top!="undefined"?v.top:i.top;
i.right=typeof v.right!="undefined"?v.right:i.right;
i.bottom=typeof v.bottom!="undefined"?v.bottom:i.bottom;
i.left=typeof v.left!="undefined"?v.left:i.left;
return m
};
m.width=function(v){if(!arguments.length){return f
}f=v;
return m
};
m.height=function(v){if(!arguments.length){return u
}u=v;
return m
};
m.x=function(v){if(!arguments.length){return t
}t=v;
e.x(v);
return m
};
m.y=function(v){if(!arguments.length){return s
}s=v;
e.y(v);
return m
};
m.clipEdge=function(v){if(!arguments.length){return r
}r=v;
return m
};
m.color=function(v){if(!arguments.length){return j
}j=c.utils.getColor(v);
e.color(j);
return m
};
m.interpolate=function(v){if(!arguments.length){return l
}l=v;
return m
};
m.defined=function(v){if(!arguments.length){return h
}h=v;
return m
};
m.isArea=function(v){if(!arguments.length){return n
}n=d3.functor(v);
return m
};
return m
};
c.models.lineChart=function(){var f=c.models.line(),o=c.models.axis(),e=c.models.axis(),h=c.models.legend();
var s={top:30,right:20,bottom:50,left:60},v=c.utils.defaultColor(),u=null,t=null,w=true,g=true,l=function(B,A,E,D,C){return"<h3>"+B+"</h3><p>"+E+" at "+A+"</p>"
},q,p,m={},n=null,j="No Data Available.",z=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");
o.orient("bottom").tickPadding(7);
e.orient("left");
var i=function(D,I){if(I){var B=d3.select(I).select("svg");
var J=(B.node())?B.attr("viewBox"):null;
if(J){J=J.split(" ");
var E=parseInt(B.style("width"))/J[2];
D.pos[0]=D.pos[0]*E;
D.pos[1]=D.pos[1]*E
}}var A=D.pos[0]+(I.offsetLeft||0),G=D.pos[1]+(I.offsetTop||0),H=o.tickFormat()(f.x()(D.point,D.pointIndex)),F=e.tickFormat()(f.y()(D.point,D.pointIndex)),C=l(D.series.key,H,F,D,r);
c.tooltip.show([A,G],C,null,null,I)
};
function r(x){x.each(function(F){var B=d3.select(this),H=this;
var J=(u||parseInt(B.style("width"))||960)-s.left-s.right,E=(t||parseInt(B.style("height"))||400)-s.top-s.bottom;
r.update=function(){r(x)
};
r.container=this;
m.disabled=F.map(function(K){return !!K.disabled
});
if(!n){var I;
n={};
for(I in m){if(m[I] instanceof Array){n[I]=m[I].slice(0)
}else{n[I]=m[I]
}}}if(!F||!F.length||!F.filter(function(K){return K.values.length
}).length){var C=B.selectAll(".nv-noData").data([j]);
C.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
C.attr("x",s.left+J/2).attr("y",s.top+E/2).text(function(K){return K
});
return r
}else{B.selectAll(".nv-noData").remove()
}q=f.xScale();
p=f.yScale();
var D=B.selectAll("g.nv-wrap.nv-lineChart").data([F]);
var y=D.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g");
var G=D.select("g");
y.append("g").attr("class","nv-x nv-axis");
y.append("g").attr("class","nv-y nv-axis");
y.append("g").attr("class","nv-linesWrap");
y.append("g").attr("class","nv-legendWrap");
if(w){h.width(J);
G.select(".nv-legendWrap").datum(F).call(h);
if(s.top!=h.height()){s.top=h.height();
E=(t||parseInt(B.style("height"))||400)-s.top-s.bottom
}D.select(".nv-legendWrap").attr("transform","translate(0,"+(-s.top)+")")
}D.attr("transform","translate("+s.left+","+s.top+")");
f.width(J).height(E).color(F.map(function(L,K){return L.color||v(L,K)
}).filter(function(L,K){return !F[K].disabled
}));
var A=G.select(".nv-linesWrap").datum(F.filter(function(K){return !K.disabled
}));
d3.transition(A).call(f);
o.scale(q).ticks(J/100).tickSize(-E,0);
G.select(".nv-x.nv-axis").attr("transform","translate(0,"+p.range()[0]+")");
d3.transition(G.select(".nv-x.nv-axis")).call(o);
e.scale(p).ticks(E/36).tickSize(-J,0);
d3.transition(G.select(".nv-y.nv-axis")).call(e);
h.dispatch.on("legendClick",function(L,K){L.disabled=!L.disabled;
if(!F.filter(function(M){return !M.disabled
}).length){F.map(function(M){M.disabled=false;
D.selectAll(".nv-series").classed("disabled",false);
return M
})
}m.disabled=F.map(function(M){return !!M.disabled
});
z.stateChange(m);
x.transition().call(r)
});
z.on("tooltipShow",function(K){if(g){i(K,H.parentNode)
}});
z.on("changeState",function(K){if(typeof K.disabled!=="undefined"){F.forEach(function(M,L){M.disabled=K.disabled[L]
});
m.disabled=K.disabled
}x.call(r)
})
});
return r
}f.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+s.left,x.pos[1]+s.top];
z.tooltipShow(x)
});
f.dispatch.on("elementMouseout.tooltip",function(x){z.tooltipHide(x)
});
z.on("tooltipHide",function(){if(g){c.tooltip.cleanup()
}});
r.dispatch=z;
r.lines=f;
r.legend=h;
r.xAxis=o;
r.yAxis=e;
d3.rebind(r,f,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id","interpolate");
r.margin=function(x){if(!arguments.length){return s
}s.top=typeof x.top!="undefined"?x.top:s.top;
s.right=typeof x.right!="undefined"?x.right:s.right;
s.bottom=typeof x.bottom!="undefined"?x.bottom:s.bottom;
s.left=typeof x.left!="undefined"?x.left:s.left;
return r
};
r.width=function(x){if(!arguments.length){return u
}u=x;
return r
};
r.height=function(x){if(!arguments.length){return t
}t=x;
return r
};
r.color=function(x){if(!arguments.length){return v
}v=c.utils.getColor(x);
h.color(v);
return r
};
r.showLegend=function(x){if(!arguments.length){return w
}w=x;
return r
};
r.tooltips=function(x){if(!arguments.length){return g
}g=x;
return r
};
r.tooltipContent=function(x){if(!arguments.length){return l
}l=x;
return r
};
r.state=function(x){if(!arguments.length){return m
}m=x;
return r
};
r.defaultState=function(x){if(!arguments.length){return n
}n=x;
return r
};
r.noData=function(x){if(!arguments.length){return j
}j=x;
return r
};
return r
};
c.models.linePlusBarChart=function(){var e=c.models.line(),w=c.models.historicalBar(),q=c.models.axis(),s=c.models.axis(),h=c.models.axis(),g=c.models.legend();
var u={top:30,right:60,bottom:50,left:60},y=null,v=null,B=function(x){return x.x
},A=function(x){return x.y
},z=c.utils.defaultColor(),C=true,f=true,o=function(F,E,I,H,G){return"<h3>"+F+"</h3><p>"+I+" at "+E+"</p>"
},r,j,i,n={},p=null,m="No Data Available.",D=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");
w.padData(true);
e.clipEdge(false).padData(true);
q.orient("bottom").tickPadding(7).highlightZero(false);
s.orient("left");
h.orient("right");
var l=function(J,F){var I=J.pos[0]+(F.offsetLeft||0),H=J.pos[1]+(F.offsetTop||0),E=q.tickFormat()(e.x()(J.point,J.pointIndex)),K=(J.series.bar?s:h).tickFormat()(e.y()(J.point,J.pointIndex)),G=o(J.series.key,E,K,J,t);
c.tooltip.show([I,H],G,J.value<0?"n":"s",null,F)
};
function t(x){x.each(function(L){var G=d3.select(this),O=this;
var Q=(y||parseInt(G.style("width"))||960)-u.left-u.right,J=(v||parseInt(G.style("height"))||400)-u.top-u.bottom;
t.update=function(){t(x)
};
t.container=this;
n.disabled=L.map(function(S){return !!S.disabled
});
if(!p){var P;
p={};
for(P in n){if(n[P] instanceof Array){p[P]=n[P].slice(0)
}else{p[P]=n[P]
}}}if(!L||!L.length||!L.filter(function(S){return S.values.length
}).length){var H=G.selectAll(".nv-noData").data([m]);
H.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
H.attr("x",u.left+Q/2).attr("y",u.top+J/2).text(function(S){return S
});
return t
}else{G.selectAll(".nv-noData").remove()
}var R=L.filter(function(S){return !S.disabled&&S.bar
});
var K=L.filter(function(S){return !S.bar
});
r=K.filter(function(S){return !S.disabled
}).length&&K.filter(function(S){return !S.disabled
})[0].values.length?e.xScale():w.xScale();
j=w.yScale();
i=e.yScale();
var I=d3.select(this).selectAll("g.nv-wrap.nv-linePlusBar").data([L]);
var E=I.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g");
var M=I.select("g");
E.append("g").attr("class","nv-x nv-axis");
E.append("g").attr("class","nv-y1 nv-axis");
E.append("g").attr("class","nv-y2 nv-axis");
E.append("g").attr("class","nv-barsWrap");
E.append("g").attr("class","nv-linesWrap");
E.append("g").attr("class","nv-legendWrap");
if(C){g.width(Q/2);
M.select(".nv-legendWrap").datum(L.map(function(S){S.originalKey=S.originalKey===undefined?S.key:S.originalKey;
S.key=S.originalKey+(S.bar?" (left axis)":" (right axis)");
return S
})).call(g);
if(u.top!=g.height()){u.top=g.height();
J=(v||parseInt(G.style("height"))||400)-u.top-u.bottom
}M.select(".nv-legendWrap").attr("transform","translate("+(Q/2)+","+(-u.top)+")")
}I.attr("transform","translate("+u.left+","+u.top+")");
e.width(Q).height(J).color(L.map(function(T,S){return T.color||z(T,S)
}).filter(function(T,S){return !L[S].disabled&&!L[S].bar
}));
w.width(Q).height(J).color(L.map(function(T,S){return T.color||z(T,S)
}).filter(function(T,S){return !L[S].disabled&&L[S].bar
}));
var N=M.select(".nv-barsWrap").datum(R.length?R:[{values:[]}]);
var F=M.select(".nv-linesWrap").datum(K[0]&&!K[0].disabled?K:[{values:[]}]);
d3.transition(N).call(w);
d3.transition(F).call(e);
q.scale(r).ticks(Q/100).tickSize(-J,0);
M.select(".nv-x.nv-axis").attr("transform","translate(0,"+j.range()[0]+")");
d3.transition(M.select(".nv-x.nv-axis")).call(q);
s.scale(j).ticks(J/36).tickSize(-Q,0);
d3.transition(M.select(".nv-y1.nv-axis")).style("opacity",R.length?1:0).call(s);
h.scale(i).ticks(J/36).tickSize(R.length?0:-Q,0);
M.select(".nv-y2.nv-axis").style("opacity",K.length?1:0).attr("transform","translate("+Q+",0)");
d3.transition(M.select(".nv-y2.nv-axis")).call(h);
g.dispatch.on("legendClick",function(T,S){T.disabled=!T.disabled;
if(!L.filter(function(U){return !U.disabled
}).length){L.map(function(U){U.disabled=false;
I.selectAll(".nv-series").classed("disabled",false);
return U
})
}n.disabled=L.map(function(U){return !!U.disabled
});
D.stateChange(n);
x.transition().call(t)
});
D.on("tooltipShow",function(S){if(f){l(S,O.parentNode)
}});
D.on("changeState",function(S){if(typeof S.disabled!=="undefined"){L.forEach(function(U,T){U.disabled=S.disabled[T]
});
n.disabled=S.disabled
}x.call(t)
})
});
return t
}e.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+u.left,x.pos[1]+u.top];
D.tooltipShow(x)
});
e.dispatch.on("elementMouseout.tooltip",function(x){D.tooltipHide(x)
});
w.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+u.left,x.pos[1]+u.top];
D.tooltipShow(x)
});
w.dispatch.on("elementMouseout.tooltip",function(x){D.tooltipHide(x)
});
D.on("tooltipHide",function(){if(f){c.tooltip.cleanup()
}});
t.dispatch=D;
t.legend=g;
t.lines=e;
t.bars=w;
t.xAxis=q;
t.y1Axis=s;
t.y2Axis=h;
d3.rebind(t,e,"defined","size","clipVoronoi","interpolate");
t.x=function(x){if(!arguments.length){return B
}B=x;
e.x(x);
w.x(x);
return t
};
t.y=function(x){if(!arguments.length){return A
}A=x;
e.y(x);
w.y(x);
return t
};
t.margin=function(x){if(!arguments.length){return u
}u.top=typeof x.top!="undefined"?x.top:u.top;
u.right=typeof x.right!="undefined"?x.right:u.right;
u.bottom=typeof x.bottom!="undefined"?x.bottom:u.bottom;
u.left=typeof x.left!="undefined"?x.left:u.left;
return t
};
t.width=function(x){if(!arguments.length){return y
}y=x;
return t
};
t.height=function(x){if(!arguments.length){return v
}v=x;
return t
};
t.color=function(x){if(!arguments.length){return z
}z=c.utils.getColor(x);
g.color(z);
return t
};
t.showLegend=function(x){if(!arguments.length){return C
}C=x;
return t
};
t.tooltips=function(x){if(!arguments.length){return f
}f=x;
return t
};
t.tooltipContent=function(x){if(!arguments.length){return o
}o=x;
return t
};
t.state=function(x){if(!arguments.length){return n
}n=x;
return t
};
t.defaultState=function(x){if(!arguments.length){return p
}p=x;
return t
};
t.noData=function(x){if(!arguments.length){return m
}m=x;
return t
};
return t
};
c.models.lineWithFocusChart=function(){var g=c.models.line(),q=c.models.line(),r=c.models.axis(),e=c.models.axis(),G=c.models.axis(),j=c.models.axis(),h=c.models.legend(),i=d3.svg.brush();
var z={top:30,right:30,bottom:30,left:60},u={top:0,right:30,bottom:20,left:60},C=c.utils.defaultColor(),B=null,A=null,o=100,t,s,D,l,E=true,v=null,f=true,p=function(I,H,L,K,J){return"<h3>"+I+"</h3><p>"+L+" at "+H+"</p>"
},n="No Data Available.",F=d3.dispatch("tooltipShow","tooltipHide","brush");
g.clipEdge(true);
q.interactive(false);
r.orient("bottom").tickPadding(5);
e.orient("left");
G.orient("bottom").tickPadding(5);
j.orient("left");
var m=function(M,I){var L=M.pos[0]+(I.offsetLeft||0),K=M.pos[1]+(I.offsetTop||0),H=r.tickFormat()(g.x()(M.point,M.pointIndex)),N=e.tickFormat()(g.y()(M.point,M.pointIndex)),J=p(M.series.key,H,N,M,w);
c.tooltip.show([L,K],J,null,null,I)
};
function w(x){x.each(function(X){var P=d3.select(this),L=this;
var y=(B||parseInt(P.style("width"))||960)-z.left-z.right,M=(A||parseInt(P.style("height"))||400)-z.top-z.bottom-o,K=o-u.top-u.bottom;
w.update=function(){w(x)
};
w.container=this;
if(!X||!X.length||!X.filter(function(Y){return Y.values.length
}).length){var O=P.selectAll(".nv-noData").data([n]);
O.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
O.attr("x",z.left+y/2).attr("y",z.top+M/2).text(function(Y){return Y
});
return w
}else{P.selectAll(".nv-noData").remove()
}t=g.xScale();
s=g.yScale();
D=q.xScale();
l=q.yScale();
var N=P.selectAll("g.nv-wrap.nv-lineWithFocusChart").data([X]);
var S=N.enter().append("g").attr("class","nvd3 nv-wrap nv-lineWithFocusChart").append("g");
var U=N.select("g");
S.append("g").attr("class","nv-legendWrap");
var J=S.append("g").attr("class","nv-focus");
J.append("g").attr("class","nv-x nv-axis");
J.append("g").attr("class","nv-y nv-axis");
J.append("g").attr("class","nv-linesWrap");
var H=S.append("g").attr("class","nv-context");
H.append("g").attr("class","nv-x nv-axis");
H.append("g").attr("class","nv-y nv-axis");
H.append("g").attr("class","nv-linesWrap");
H.append("g").attr("class","nv-brushBackground");
H.append("g").attr("class","nv-x nv-brush");
if(E){h.width(y);
U.select(".nv-legendWrap").datum(X).call(h);
if(z.top!=h.height()){z.top=h.height();
M=(A||parseInt(P.style("height"))||400)-z.top-z.bottom-o
}U.select(".nv-legendWrap").attr("transform","translate(0,"+(-z.top)+")")
}N.attr("transform","translate("+z.left+","+z.top+")");
g.width(y).height(M).color(X.map(function(Z,Y){return Z.color||C(Z,Y)
}).filter(function(Z,Y){return !X[Y].disabled
}));
q.defined(g.defined()).width(y).height(K).color(X.map(function(Z,Y){return Z.color||C(Z,Y)
}).filter(function(Z,Y){return !X[Y].disabled
}));
U.select(".nv-context").attr("transform","translate(0,"+(M+z.bottom+u.top)+")");
var I=U.select(".nv-context .nv-linesWrap").datum(X.filter(function(Y){return !Y.disabled
}));
d3.transition(I).call(q);
r.scale(t).ticks(y/100).tickSize(-M,0);
e.scale(s).ticks(M/36).tickSize(-y,0);
U.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+M+")");
i.x(D).on("brush",R);
if(v){i.extent(v)
}var W=U.select(".nv-brushBackground").selectAll("g").data([v||i.extent()]);
var V=W.enter().append("g");
V.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",K);
V.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",K);
gBrush=U.select(".nv-x.nv-brush").call(i);
gBrush.selectAll("rect").attr("height",K);
gBrush.selectAll(".resize").append("path").attr("d",Q);
R();
G.scale(D).ticks(y/100).tickSize(-K,0);
U.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+l.range()[0]+")");
d3.transition(U.select(".nv-context .nv-x.nv-axis")).call(G);
j.scale(l).ticks(K/36).tickSize(-y,0);
d3.transition(U.select(".nv-context .nv-y.nv-axis")).call(j);
U.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+l.range()[0]+")");
h.dispatch.on("legendClick",function(Z,Y){Z.disabled=!Z.disabled;
if(!X.filter(function(aa){return !aa.disabled
}).length){X.map(function(aa){aa.disabled=false;
N.selectAll(".nv-series").classed("disabled",false);
return aa
})
}x.transition().call(w)
});
F.on("tooltipShow",function(Y){if(f){m(Y,L.parentNode)
}});
function Q(aa){var Z=+(aa=="e"),Y=Z?1:-1,ab=K/3;
return"M"+(0.5*Y)+","+ab+"A6,6 0 0 "+Z+" "+(6.5*Y)+","+(ab+6)+"V"+(2*ab-6)+"A6,6 0 0 "+Z+" "+(0.5*Y)+","+(2*ab)+"ZM"+(2.5*Y)+","+(ab+8)+"V"+(2*ab-8)+"M"+(4.5*Y)+","+(ab+8)+"V"+(2*ab-8)
}function T(){if(!i.empty()){i.extent(v)
}W.data([i.empty()?D.domain():v]).each(function(ab,Y){var Z=D(ab[0])-t.range()[0],aa=t.range()[1]-D(ab[1]);
d3.select(this).select(".left").attr("width",Z<0?0:Z);
d3.select(this).select(".right").attr("x",D(ab[1])).attr("width",aa<0?0:aa)
})
}function R(){v=i.empty()?null:i.extent();
extent=i.empty()?D.domain():i.extent();
F.brush({extent:extent,brush:i});
T();
var Y=U.select(".nv-focus .nv-linesWrap").datum(X.filter(function(Z){return !Z.disabled
}).map(function(aa,Z){return{key:aa.key,values:aa.values.filter(function(ac,ab){return g.x()(ac,ab)>=extent[0]&&g.x()(ac,ab)<=extent[1]
})}
}));
d3.transition(Y).call(g);
d3.transition(U.select(".nv-focus .nv-x.nv-axis")).call(r);
d3.transition(U.select(".nv-focus .nv-y.nv-axis")).call(e)
}});
return w
}g.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+z.left,x.pos[1]+z.top];
F.tooltipShow(x)
});
g.dispatch.on("elementMouseout.tooltip",function(x){F.tooltipHide(x)
});
F.on("tooltipHide",function(){if(f){c.tooltip.cleanup()
}});
w.dispatch=F;
w.legend=h;
w.lines=g;
w.lines2=q;
w.xAxis=r;
w.yAxis=e;
w.x2Axis=G;
w.y2Axis=j;
d3.rebind(w,g,"defined","isArea","size","xDomain","yDomain","forceX","forceY","interactive","clipEdge","clipVoronoi","id");
w.x=function(x){if(!arguments.length){return g.x
}g.x(x);
q.x(x);
return w
};
w.y=function(x){if(!arguments.length){return g.y
}g.y(x);
q.y(x);
return w
};
w.margin=function(x){if(!arguments.length){return z
}z.top=typeof x.top!="undefined"?x.top:z.top;
z.right=typeof x.right!="undefined"?x.right:z.right;
z.bottom=typeof x.bottom!="undefined"?x.bottom:z.bottom;
z.left=typeof x.left!="undefined"?x.left:z.left;
return w
};
w.margin2=function(x){if(!arguments.length){return u
}u=x;
return w
};
w.width=function(x){if(!arguments.length){return B
}B=x;
return w
};
w.height=function(x){if(!arguments.length){return A
}A=x;
return w
};
w.height2=function(x){if(!arguments.length){return o
}o=x;
return w
};
w.color=function(x){if(!arguments.length){return C
}C=c.utils.getColor(x);
h.color(C);
return w
};
w.showLegend=function(x){if(!arguments.length){return E
}E=x;
return w
};
w.tooltips=function(x){if(!arguments.length){return f
}f=x;
return w
};
w.tooltipContent=function(x){if(!arguments.length){return p
}p=x;
return w
};
w.interpolate=function(x){if(!arguments.length){return g.interpolate()
}g.interpolate(x);
q.interpolate(x);
return w
};
w.noData=function(x){if(!arguments.length){return n
}n=x;
return w
};
w.xTickFormat=function(x){if(!arguments.length){return r.tickFormat()
}r.tickFormat(x);
G.tickFormat(x);
return w
};
w.yTickFormat=function(x){if(!arguments.length){return e.tickFormat()
}e.tickFormat(x);
j.tickFormat(x);
return w
};
return w
};
c.models.linePlusBarWithFocusChart=function(){var f=c.models.line(),u=c.models.line(),F=c.models.historicalBar(),g=c.models.historicalBar(),v=c.models.axis(),O=c.models.axis(),A=c.models.axis(),m=c.models.axis(),I=c.models.axis(),t=c.models.axis(),i=c.models.legend(),l=d3.svg.brush();
var D={top:30,right:30,bottom:30,left:60},y={top:0,right:30,bottom:20,left:60},G=null,E=null,r=100,M=function(x){return x.x
},K=function(x){return x.y
},H=c.utils.defaultColor(),L=true,B,z=null,e=true,s=function(Q,P,T,S,R){return"<h3>"+Q+"</h3><p>"+T+" at "+P+"</p>"
},w,J,o,n,j,h,q="No Data Available.",N=d3.dispatch("tooltipShow","tooltipHide","brush");
f.clipEdge(true);
u.interactive(false);
v.orient("bottom").tickPadding(5);
A.orient("left");
m.orient("right");
O.orient("bottom").tickPadding(5);
I.orient("left");
t.orient("right");
var p=function(U,Q){if(B){U.pointIndex+=Math.ceil(B[0])
}var T=U.pos[0]+(Q.offsetLeft||0),S=U.pos[1]+(Q.offsetTop||0),P=v.tickFormat()(f.x()(U.point,U.pointIndex)),V=(U.series.bar?A:m).tickFormat()(f.y()(U.point,U.pointIndex)),R=s(U.series.key,P,V,U,C);
c.tooltip.show([T,S],R,U.value<0?"n":"s",null,Q)
};
function C(x){x.each(function(am){var aa=d3.select(this),U=this;
var P=(G||parseInt(aa.style("width"))||960)-D.left-D.right,V=(E||parseInt(aa.style("height"))||400)-D.top-D.bottom-r,T=r-y.top-y.bottom;
C.update=function(){C(x)
};
C.container=this;
if(!am||!am.length||!am.filter(function(an){return an.values.length
}).length){var Z=aa.selectAll(".nv-noData").data([q]);
Z.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
Z.attr("x",D.left+P/2).attr("y",D.top+V/2).text(function(an){return an
});
return C
}else{aa.selectAll(".nv-noData").remove()
}var Q=am.filter(function(an){return !an.disabled&&an.bar
});
var ag=am.filter(function(an){return !an.bar
});
w=F.xScale();
J=O.scale();
o=F.yScale();
n=f.yScale();
j=g.yScale();
h=u.yScale();
var X=am.filter(function(an){return !an.disabled&&an.bar
}).map(function(an){return an.values.map(function(ap,ao){return{x:M(ap,ao),y:K(ap,ao)}
})
});
var W=am.filter(function(an){return !an.disabled&&!an.bar
}).map(function(an){return an.values.map(function(ap,ao){return{x:M(ap,ao),y:K(ap,ao)}
})
});
w.range([0,P]);
J.domain(d3.extent(d3.merge(X.concat(W)),function(an){return an.x
})).range([0,P]);
var Y=aa.selectAll("g.nv-wrap.nv-linePlusBar").data([am]);
var ad=Y.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g");
var ah=Y.select("g");
ad.append("g").attr("class","nv-legendWrap");
var S=ad.append("g").attr("class","nv-focus");
S.append("g").attr("class","nv-x nv-axis");
S.append("g").attr("class","nv-y1 nv-axis");
S.append("g").attr("class","nv-y2 nv-axis");
S.append("g").attr("class","nv-barsWrap");
S.append("g").attr("class","nv-linesWrap");
var R=ad.append("g").attr("class","nv-context");
R.append("g").attr("class","nv-x nv-axis");
R.append("g").attr("class","nv-y1 nv-axis");
R.append("g").attr("class","nv-y2 nv-axis");
R.append("g").attr("class","nv-barsWrap");
R.append("g").attr("class","nv-linesWrap");
R.append("g").attr("class","nv-brushBackground");
R.append("g").attr("class","nv-x nv-brush");
if(L){i.width(P/2);
ah.select(".nv-legendWrap").datum(am.map(function(an){an.originalKey=an.originalKey===undefined?an.key:an.originalKey;
an.key=an.originalKey+(an.bar?" (left axis)":" (right axis)");
return an
})).call(i);
if(D.top!=i.height()){D.top=i.height();
V=(E||parseInt(aa.style("height"))||400)-D.top-D.bottom-r
}ah.select(".nv-legendWrap").attr("transform","translate("+(P/2)+","+(-D.top)+")")
}Y.attr("transform","translate("+D.left+","+D.top+")");
g.width(P).height(T).color(am.map(function(ao,an){return ao.color||H(ao,an)
}).filter(function(ao,an){return !am[an].disabled&&am[an].bar
}));
u.width(P).height(T).color(am.map(function(ao,an){return ao.color||H(ao,an)
}).filter(function(ao,an){return !am[an].disabled&&!am[an].bar
}));
var ai=ah.select(".nv-context .nv-barsWrap").datum(Q.length?Q:[{values:[]}]);
var af=ah.select(".nv-context .nv-linesWrap").datum(!ag[0].disabled?ag:[{values:[]}]);
ah.select(".nv-context").attr("transform","translate(0,"+(V+D.bottom+y.top)+")");
d3.transition(ai).call(g);
d3.transition(af).call(u);
l.x(J).on("brush",ac);
if(z){l.extent(z)
}var al=ah.select(".nv-brushBackground").selectAll("g").data([z||l.extent()]);
var aj=al.enter().append("g");
aj.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",T);
aj.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",T);
var ak=ah.select(".nv-x.nv-brush").call(l);
ak.selectAll("rect").attr("height",T);
ak.selectAll(".resize").append("path").attr("d",ab);
O.ticks(P/100).tickSize(-T,0);
ah.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+j.range()[0]+")");
d3.transition(ah.select(".nv-context .nv-x.nv-axis")).call(O);
I.scale(j).ticks(T/36).tickSize(-P,0);
ah.select(".nv-context .nv-y1.nv-axis").style("opacity",Q.length?1:0).attr("transform","translate(0,"+J.range()[0]+")");
d3.transition(ah.select(".nv-context .nv-y1.nv-axis")).call(I);
t.scale(h).ticks(T/36).tickSize(Q.length?0:-P,0);
ah.select(".nv-context .nv-y2.nv-axis").style("opacity",ag.length?1:0).attr("transform","translate("+J.range()[1]+",0)");
d3.transition(ah.select(".nv-context .nv-y2.nv-axis")).call(t);
i.dispatch.on("legendClick",function(ao,an){ao.disabled=!ao.disabled;
if(!am.filter(function(ap){return !ap.disabled
}).length){am.map(function(ap){ap.disabled=false;
Y.selectAll(".nv-series").classed("disabled",false);
return ap
})
}x.call(C)
});
N.on("tooltipShow",function(an){if(e){p(an,U.parentNode)
}});
function ab(ap){var ao=+(ap=="e"),an=ao?1:-1,aq=T/3;
return"M"+(0.5*an)+","+aq+"A6,6 0 0 "+ao+" "+(6.5*an)+","+(aq+6)+"V"+(2*aq-6)+"A6,6 0 0 "+ao+" "+(0.5*an)+","+(2*aq)+"ZM"+(2.5*an)+","+(aq+8)+"V"+(2*aq-8)+"M"+(4.5*an)+","+(aq+8)+"V"+(2*aq-8)
}function ae(){if(!l.empty()){l.extent(z)
}al.data([l.empty()?J.domain():z]).each(function(aq,an){var ao=J(aq[0])-J.range()[0],ap=J.range()[1]-J(aq[1]);
d3.select(this).select(".left").attr("width",ao<0?0:ao);
d3.select(this).select(".right").attr("x",J(aq[1])).attr("width",ap<0?0:ap)
})
}function ac(){z=l.empty()?null:l.extent();
B=l.empty()?J.domain():l.extent();
N.brush({extent:B,brush:l});
ae();
F.width(P).height(V).color(am.map(function(aq,ap){return aq.color||H(aq,ap)
}).filter(function(aq,ap){return !am[ap].disabled&&am[ap].bar
}));
f.width(P).height(V).color(am.map(function(aq,ap){return aq.color||H(aq,ap)
}).filter(function(aq,ap){return !am[ap].disabled&&!am[ap].bar
}));
var ao=ah.select(".nv-focus .nv-barsWrap").datum(!Q.length?[{values:[]}]:Q.map(function(aq,ap){return{key:aq.key,values:aq.values.filter(function(at,ar){return F.x()(at,ar)>=B[0]&&F.x()(at,ar)<=B[1]
})}
}));
var an=ah.select(".nv-focus .nv-linesWrap").datum(ag[0].disabled?[{values:[]}]:ag.map(function(aq,ap){return{key:aq.key,values:aq.values.filter(function(at,ar){return f.x()(at,ar)>=B[0]&&f.x()(at,ar)<=B[1]
})}
}));
if(Q.length){w=F.xScale()
}else{w=f.xScale()
}v.scale(w).ticks(P/100).tickSize(-V,0);
v.domain([Math.ceil(B[0]),Math.floor(B[1])]);
d3.transition(ah.select(".nv-x.nv-axis")).call(v);
d3.transition(ao).call(F);
d3.transition(an).call(f);
ah.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+o.range()[0]+")");
A.scale(o).ticks(V/36).tickSize(-P,0);
ah.select(".nv-focus .nv-y1.nv-axis").style("opacity",Q.length?1:0);
m.scale(n).ticks(V/36).tickSize(Q.length?0:-P,0);
ah.select(".nv-focus .nv-y2.nv-axis").style("opacity",ag.length?1:0).attr("transform","translate("+w.range()[1]+",0)");
d3.transition(ah.select(".nv-focus .nv-y1.nv-axis")).call(A);
d3.transition(ah.select(".nv-focus .nv-y2.nv-axis")).call(m)
}ac()
});
return C
}f.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+D.left,x.pos[1]+D.top];
N.tooltipShow(x)
});
f.dispatch.on("elementMouseout.tooltip",function(x){N.tooltipHide(x)
});
F.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+D.left,x.pos[1]+D.top];
N.tooltipShow(x)
});
F.dispatch.on("elementMouseout.tooltip",function(x){N.tooltipHide(x)
});
N.on("tooltipHide",function(){if(e){c.tooltip.cleanup()
}});
C.dispatch=N;
C.legend=i;
C.lines=f;
C.lines2=u;
C.bars=F;
C.bars2=g;
C.xAxis=v;
C.x2Axis=O;
C.y1Axis=A;
C.y2Axis=m;
C.y3Axis=I;
C.y4Axis=t;
d3.rebind(C,f,"defined","size","clipVoronoi","interpolate");
C.x=function(x){if(!arguments.length){return M
}M=x;
f.x(x);
F.x(x);
return C
};
C.y=function(x){if(!arguments.length){return K
}K=x;
f.y(x);
F.y(x);
return C
};
C.margin=function(x){if(!arguments.length){return D
}D.top=typeof x.top!="undefined"?x.top:D.top;
D.right=typeof x.right!="undefined"?x.right:D.right;
D.bottom=typeof x.bottom!="undefined"?x.bottom:D.bottom;
D.left=typeof x.left!="undefined"?x.left:D.left;
return C
};
C.width=function(x){if(!arguments.length){return G
}G=x;
return C
};
C.height=function(x){if(!arguments.length){return E
}E=x;
return C
};
C.color=function(x){if(!arguments.length){return H
}H=c.utils.getColor(x);
i.color(H);
return C
};
C.showLegend=function(x){if(!arguments.length){return L
}L=x;
return C
};
C.tooltips=function(x){if(!arguments.length){return e
}e=x;
return C
};
C.tooltipContent=function(x){if(!arguments.length){return s
}s=x;
return C
};
C.noData=function(x){if(!arguments.length){return q
}q=x;
return C
};
C.brushExtent=function(x){if(!arguments.length){return z
}z=x;
return C
};
return C
};
c.models.multiBar=function(){var l={top:0,right:0,bottom:0,left:0},q=960,m=500,i=d3.scale.ordinal(),h=d3.scale.linear(),n=Math.floor(Math.random()*10000),v=function(x){return x.x
},t=function(x){return x.y
},f=[0],z=true,w=false,s=c.utils.defaultColor(),B=false,o=null,g,A=1200,r,p,C=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");
var u,e;
function j(x){x.each(function(L){var O=q-l.left-l.right,G=m-l.top-l.bottom,D=d3.select(this);
if(B&&L.length){B=[{values:L[0].values.map(function(P){return{x:P.x,y:0,series:P.series,size:0.01}
})}]
}if(w){L=d3.layout.stack().offset("zero").values(function(P){return P.values
}).y(t)(!L.length&&B?B:L)
}L=L.map(function(Q,P){Q.values=Q.values.map(function(R){R.series=P;
return R
});
return Q
});
if(w){L[0].values.map(function(R,P){var S=0,Q=0;
L.map(function(U){var T=U.values[P];
T.size=Math.abs(T.y);
if(T.y<0){T.y1=Q;
Q=Q-T.size
}else{T.y1=T.size+S;
S=S+T.size
}})
})
}var F=(r&&p)?[]:L.map(function(P){return P.values.map(function(R,Q){return{x:v(R,Q),y:t(R,Q),y0:R.y0,y1:R.y1}
})
});
i.domain(d3.merge(F).map(function(P){return P.x
})).rangeBands([0,O],0.1);
h.domain(p||d3.extent(d3.merge(F).map(function(P){return w?(P.y>0?P.y1:P.y1+P.y):P.y
}).concat(f))).range([G,0]);
if(i.domain()[0]===i.domain()[1]||h.domain()[0]===h.domain()[1]){singlePoint=true
}if(i.domain()[0]===i.domain()[1]){i.domain()[0]?i.domain([i.domain()[0]-i.domain()[0]*0.01,i.domain()[1]+i.domain()[1]*0.01]):i.domain([-1,1])
}if(h.domain()[0]===h.domain()[1]){h.domain()[0]?h.domain([h.domain()[0]+h.domain()[0]*0.01,h.domain()[1]-h.domain()[1]*0.01]):h.domain([-1,1])
}u=u||i;
e=e||h;
var E=D.selectAll("g.nv-wrap.nv-multibar").data([L]);
var J=E.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar");
var H=J.append("defs");
var y=J.append("g");
var M=E.select("g");
y.append("g").attr("class","nv-groups");
E.attr("transform","translate("+l.left+","+l.top+")");
H.append("clipPath").attr("id","nv-edge-clip-"+n).append("rect");
E.select("#nv-edge-clip-"+n+" rect").attr("width",O).attr("height",G);
M.attr("clip-path",z?"url(#nv-edge-clip-"+n+")":"");
var I=E.select(".nv-groups").selectAll(".nv-group").data(function(P){return P
},function(P){return P.key
});
I.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);
I.exit().selectAll("rect.nv-bar").transition().delay(function(Q,P){return P*A/L[0].values.length
}).attr("y",function(P){return w?e(P.y0):e(0)
}).attr("height",0).remove();
I.attr("class",function(Q,P){return"nv-group nv-series-"+P
}).classed("hover",function(P){return P.hover
}).style("fill",function(Q,P){return s(Q,P)
}).style("stroke",function(Q,P){return s(Q,P)
});
d3.transition(I).style("stroke-opacity",1).style("fill-opacity",0.75);
var N=I.selectAll("rect.nv-bar").data(function(P){return(B&&!L.length)?B.values:P.values
});
N.exit().remove();
var K=N.enter().append("rect").attr("class",function(Q,P){return t(Q,P)<0?"nv-bar negative":"nv-bar positive"
}).attr("x",function(R,Q,P){return w?0:(P*i.rangeBand()/L.length)
}).attr("y",function(P){return e(w?P.y0:0)
}).attr("height",0).attr("width",i.rangeBand()/(w?1:L.length));
N.style("fill",function(R,Q,P){return s(R,P,Q)
}).style("stroke",function(R,Q,P){return s(R,P,Q)
}).on("mouseover",function(Q,P){d3.select(this).classed("hover",true);
C.elementMouseover({value:t(Q,P),point:Q,series:L[Q.series],pos:[i(v(Q,P))+(i.rangeBand()*(w?L.length/2:Q.series+0.5)/L.length),h(t(Q,P)+(w?Q.y0:0))],pointIndex:P,seriesIndex:Q.series,e:d3.event})
}).on("mouseout",function(Q,P){d3.select(this).classed("hover",false);
C.elementMouseout({value:t(Q,P),point:Q,series:L[Q.series],pointIndex:P,seriesIndex:Q.series,e:d3.event})
}).on("click",function(Q,P){C.elementClick({value:t(Q,P),point:Q,series:L[Q.series],pos:[i(v(Q,P))+(i.rangeBand()*(w?L.length/2:Q.series+0.5)/L.length),h(t(Q,P)+(w?Q.y0:0))],pointIndex:P,seriesIndex:Q.series,e:d3.event});
d3.event.stopPropagation()
}).on("dblclick",function(Q,P){C.elementDblClick({value:t(Q,P),point:Q,series:L[Q.series],pos:[i(v(Q,P))+(i.rangeBand()*(w?L.length/2:Q.series+0.5)/L.length),h(t(Q,P)+(w?Q.y0:0))],pointIndex:P,seriesIndex:Q.series,e:d3.event});
d3.event.stopPropagation()
});
N.attr("class",function(Q,P){return t(Q,P)<0?"nv-bar negative":"nv-bar positive"
}).attr("transform",function(Q,P){return"translate("+i(v(Q,P))+",0)"
});
if(o){if(!g){g=L.map(function(){return true
})
}N.style("fill",function(R,Q,P){return d3.rgb(o(R,Q)).darker(g.map(function(T,S){return S
}).filter(function(T,S){return !g[S]
})[P]).toString()
}).style("stroke",function(R,Q,P){return d3.rgb(o(R,Q)).darker(g.map(function(T,S){return S
}).filter(function(T,S){return !g[S]
})[P]).toString()
})
}if(w){N.transition().delay(function(Q,P){return P*A/L[0].values.length
}).attr("y",function(Q,P){return h((w?Q.y1:0))
}).attr("height",function(Q,P){return Math.max(Math.abs(h(Q.y+(w?Q.y0:0))-h((w?Q.y0:0))),1)
}).each("end",function(){d3.transition(d3.select(this)).attr("x",function(Q,P){return w?0:(Q.series*i.rangeBand()/L.length)
}).attr("width",i.rangeBand()/(w?1:L.length))
})
}else{d3.transition(N).delay(function(Q,P){return P*A/L[0].values.length
}).attr("x",function(Q,P){return Q.series*i.rangeBand()/L.length
}).attr("width",i.rangeBand()/L.length).each("end",function(){d3.transition(d3.select(this)).attr("y",function(Q,P){return t(Q,P)<0?h(0):h(0)-h(t(Q,P))<1?h(0)-1:h(t(Q,P))||0
}).attr("height",function(Q,P){return Math.max(Math.abs(h(t(Q,P))-h(0)),1)||0
})
})
}u=i.copy();
e=h.copy()
});
return j
}j.dispatch=C;
j.x=function(x){if(!arguments.length){return v
}v=x;
return j
};
j.y=function(x){if(!arguments.length){return t
}t=x;
return j
};
j.margin=function(x){if(!arguments.length){return l
}l.top=typeof x.top!="undefined"?x.top:l.top;
l.right=typeof x.right!="undefined"?x.right:l.right;
l.bottom=typeof x.bottom!="undefined"?x.bottom:l.bottom;
l.left=typeof x.left!="undefined"?x.left:l.left;
return j
};
j.width=function(x){if(!arguments.length){return q
}q=x;
return j
};
j.height=function(x){if(!arguments.length){return m
}m=x;
return j
};
j.xScale=function(x){if(!arguments.length){return i
}i=x;
return j
};
j.yScale=function(x){if(!arguments.length){return h
}h=x;
return j
};
j.xDomain=function(x){if(!arguments.length){return r
}r=x;
return j
};
j.yDomain=function(x){if(!arguments.length){return p
}p=x;
return j
};
j.forceY=function(x){if(!arguments.length){return f
}f=x;
return j
};
j.stacked=function(x){if(!arguments.length){return w
}w=x;
return j
};
j.clipEdge=function(x){if(!arguments.length){return z
}z=x;
return j
};
j.color=function(x){if(!arguments.length){return s
}s=c.utils.getColor(x);
return j
};
j.barColor=function(x){if(!arguments.length){return o
}o=c.utils.getColor(x);
return j
};
j.disabled=function(x){if(!arguments.length){return g
}g=x;
return j
};
j.id=function(x){if(!arguments.length){return n
}n=x;
return j
};
j.hideable=function(x){if(!arguments.length){return B
}B=x;
return j
};
j.delay=function(x){if(!arguments.length){return A
}A=x;
return j
};
return j
};
c.models.multiBarChart=function(){var i=c.models.multiBar(),q=c.models.axis(),f=c.models.axis(),h=c.models.legend(),u=c.models.legend();
var w={top:30,right:20,bottom:30,left:60},A=null,z=null,B=c.utils.defaultColor(),D=true,C=true,t=true,j=0,g=true,o=function(G,F,J,I,H){return"<h3>"+G+"</h3><p>"+J+" on "+F+"</p>"
},s,r,n={stacked:false},p=null,m="No Data Available.",E=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),e=function(){return D?180:0
};
i.stacked(false);
q.orient("bottom").tickPadding(7).highlightZero(false).showMaxMin(false).tickFormat(function(x){return x
});
f.orient("left").tickFormat(d3.format(",.1f"));
var l=function(K,G){var J=K.pos[0]+(G.offsetLeft||0),I=K.pos[1]+(G.offsetTop||0),F=q.tickFormat()(i.x()(K.point,K.pointIndex)),L=f.tickFormat()(i.y()(K.point,K.pointIndex)),H=o(K.series.key,F,L,K,v);
c.tooltip.show([J,I],H,K.value<0?"n":"s",null,G)
};
function v(x){x.each(function(K){var F=d3.select(this),N=this;
var Q=(A||parseInt(F.style("width"))||960)-w.left-w.right,I=(z||parseInt(F.style("height"))||400)-w.top-w.bottom;
v.update=function(){x.transition().call(v)
};
v.container=this;
n.disabled=K.map(function(R){return !!R.disabled
});
if(!p){var P;
p={};
for(P in n){if(n[P] instanceof Array){p[P]=n[P].slice(0)
}else{p[P]=n[P]
}}}if(!K||!K.length||!K.filter(function(R){return R.values.length
}).length){var G=F.selectAll(".nv-noData").data([m]);
G.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
G.attr("x",w.left+Q/2).attr("y",w.top+I/2).text(function(R){return R
});
return v
}else{F.selectAll(".nv-noData").remove()
}s=i.xScale();
r=i.yScale();
var H=F.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([K]);
var y=H.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g");
var L=H.select("g");
y.append("g").attr("class","nv-x nv-axis");
y.append("g").attr("class","nv-y nv-axis");
y.append("g").attr("class","nv-barsWrap");
y.append("g").attr("class","nv-legendWrap");
y.append("g").attr("class","nv-controlsWrap");
if(C){h.width(Q-e());
if(i.barColor()){K.forEach(function(S,R){S.color=d3.rgb("#ccc").darker(R*1.5).toString()
})
}L.select(".nv-legendWrap").datum(K).call(h);
if(w.top!=h.height()){w.top=h.height();
I=(z||parseInt(F.style("height"))||400)-w.top-w.bottom
}L.select(".nv-legendWrap").attr("transform","translate("+e()+","+(-w.top)+")")
}if(D){var O=[{key:"Grouped",disabled:i.stacked()},{key:"Stacked",disabled:!i.stacked()}];
u.width(e()).color(["#444","#444","#444"]);
L.select(".nv-controlsWrap").datum(O).attr("transform","translate(0,"+(-w.top)+")").call(u)
}H.attr("transform","translate("+w.left+","+w.top+")");
i.disabled(K.map(function(R){return R.disabled
})).width(Q).height(I).color(K.map(function(S,R){return S.color||B(S,R)
}).filter(function(S,R){return !K[R].disabled
}));
var M=L.select(".nv-barsWrap").datum(K.filter(function(R){return !R.disabled
}));
d3.transition(M).call(i);
q.scale(s).ticks(Q/100).tickSize(-I,0);
L.select(".nv-x.nv-axis").attr("transform","translate(0,"+r.range()[0]+")");
d3.transition(L.select(".nv-x.nv-axis")).call(q);
var J=L.select(".nv-x.nv-axis > g").selectAll("g");
J.selectAll("line, text").style("opacity",1);
if(t){J.filter(function(S,R){return R%Math.ceil(K[0].values.length/(Q/100))!==0
}).selectAll("text, line").style("opacity",0)
}if(j){J.selectAll("text").attr("transform","rotate("+j+" 0,0)").attr("text-anchor",j>0?"start":"end")
}L.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1);
f.scale(r).ticks(I/36).tickSize(-Q,0);
d3.transition(L.select(".nv-y.nv-axis")).call(f);
h.dispatch.on("legendClick",function(S,R){S.disabled=!S.disabled;
if(!K.filter(function(T){return !T.disabled
}).length){K.map(function(T){T.disabled=false;
H.selectAll(".nv-series").classed("disabled",false);
return T
})
}n.disabled=K.map(function(T){return !!T.disabled
});
E.stateChange(n);
x.transition().call(v)
});
u.dispatch.on("legendClick",function(S,R){if(!S.disabled){return
}O=O.map(function(T){T.disabled=true;
return T
});
S.disabled=false;
switch(S.key){case"Grouped":i.stacked(false);
break;
case"Stacked":i.stacked(true);
break
}n.stacked=i.stacked();
E.stateChange(n);
x.transition().call(v)
});
E.on("tooltipShow",function(R){if(g){l(R,N.parentNode)
}});
E.on("changeState",function(R){if(typeof R.disabled!=="undefined"){K.forEach(function(T,S){T.disabled=R.disabled[S]
});
n.disabled=R.disabled
}if(typeof R.stacked!=="undefined"){i.stacked(R.stacked);
n.stacked=R.stacked
}x.call(v)
})
});
return v
}i.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+w.left,x.pos[1]+w.top];
E.tooltipShow(x)
});
i.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
E.on("tooltipHide",function(){if(g){c.tooltip.cleanup()
}});
v.dispatch=E;
v.multibar=i;
v.legend=h;
v.xAxis=q;
v.yAxis=f;
d3.rebind(v,i,"x","y","xDomain","yDomain","forceX","forceY","clipEdge","id","stacked","delay","barColor");
v.margin=function(x){if(!arguments.length){return w
}w.top=typeof x.top!="undefined"?x.top:w.top;
w.right=typeof x.right!="undefined"?x.right:w.right;
w.bottom=typeof x.bottom!="undefined"?x.bottom:w.bottom;
w.left=typeof x.left!="undefined"?x.left:w.left;
return v
};
v.width=function(x){if(!arguments.length){return A
}A=x;
return v
};
v.height=function(x){if(!arguments.length){return z
}z=x;
return v
};
v.color=function(x){if(!arguments.length){return B
}B=c.utils.getColor(x);
h.color(B);
return v
};
v.showControls=function(x){if(!arguments.length){return D
}D=x;
return v
};
v.showLegend=function(x){if(!arguments.length){return C
}C=x;
return v
};
v.reduceXTicks=function(x){if(!arguments.length){return t
}t=x;
return v
};
v.rotateLabels=function(x){if(!arguments.length){return j
}j=x;
return v
};
v.tooltip=function(x){if(!arguments.length){return o
}o=x;
return v
};
v.tooltips=function(x){if(!arguments.length){return g
}g=x;
return v
};
v.tooltipContent=function(x){if(!arguments.length){return o
}o=x;
return v
};
v.state=function(x){if(!arguments.length){return n
}n=x;
return v
};
v.defaultState=function(x){if(!arguments.length){return p
}p=x;
return v
};
v.noData=function(x){if(!arguments.length){return m
}m=x;
return v
};
return v
};
c.models.multiBarHorizontal=function(){var n={top:0,right:0,bottom:0,left:0},s=960,o=500,p=Math.floor(Math.random()*10000),j=d3.scale.ordinal(),i=d3.scale.linear(),z=function(x){return x.x
},v=function(x){return x.y
},f=[0],u=c.utils.defaultColor(),q=null,g,B=false,A=false,l=60,h=d3.format(",.2f"),C=1200,t,r,D=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");
var w,e;
function m(x){x.each(function(M){var P=s-n.left-n.right,H=o-n.top-n.bottom,E=d3.select(this);
if(B){M=d3.layout.stack().offset("zero").values(function(Q){return Q.values
}).y(v)(M)
}M=M.map(function(R,Q){R.values=R.values.map(function(S){S.series=Q;
return S
});
return R
});
if(B){M[0].values.map(function(S,Q){var T=0,R=0;
M.map(function(V){var U=V.values[Q];
U.size=Math.abs(U.y);
if(U.y<0){U.y1=R-U.size;
R=R-U.size
}else{U.y1=T;
T=T+U.size
}})
})
}var G=(t&&r)?[]:M.map(function(Q){return Q.values.map(function(S,R){return{x:z(S,R),y:v(S,R),y0:S.y0,y1:S.y1}
})
});
j.domain(t||d3.merge(G).map(function(Q){return Q.x
})).rangeBands([0,H],0.1);
i.domain(r||d3.extent(d3.merge(G).map(function(Q){return B?(Q.y>0?Q.y1+Q.y:Q.y1):Q.y
}).concat(f)));
if(A&&!B){i.range([(i.domain()[0]<0?l:0),P-(i.domain()[1]>0?l:0)])
}else{i.range([0,P])
}w=w||j;
e=e||d3.scale.linear().domain(i.domain()).range([i(0),i(0)]);
var F=d3.select(this).selectAll("g.nv-wrap.nv-multibarHorizontal").data([M]);
var K=F.enter().append("g").attr("class","nvd3 nv-wrap nv-multibarHorizontal");
var I=K.append("defs");
var y=K.append("g");
var N=F.select("g");
y.append("g").attr("class","nv-groups");
F.attr("transform","translate("+n.left+","+n.top+")");
var J=F.select(".nv-groups").selectAll(".nv-group").data(function(Q){return Q
},function(Q){return Q.key
});
J.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);
d3.transition(J.exit()).style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();
J.attr("class",function(R,Q){return"nv-group nv-series-"+Q
}).classed("hover",function(Q){return Q.hover
}).style("fill",function(R,Q){return u(R,Q)
}).style("stroke",function(R,Q){return u(R,Q)
});
d3.transition(J).style("stroke-opacity",1).style("fill-opacity",0.75);
var O=J.selectAll("g.nv-bar").data(function(Q){return Q.values
});
O.exit().remove();
var L=O.enter().append("g").attr("transform",function(S,R,Q){return"translate("+e(B?S.y0:0)+","+(B?0:(Q*j.rangeBand()/M.length)+j(z(S,R)))+")"
});
L.append("rect").attr("width",0).attr("height",j.rangeBand()/(B?1:M.length));
O.on("mouseover",function(R,Q){d3.select(this).classed("hover",true);
D.elementMouseover({value:v(R,Q),point:R,series:M[R.series],pos:[i(v(R,Q)+(B?R.y0:0)),j(z(R,Q))+(j.rangeBand()*(B?M.length/2:R.series+0.5)/M.length)],pointIndex:Q,seriesIndex:R.series,e:d3.event})
}).on("mouseout",function(R,Q){d3.select(this).classed("hover",false);
D.elementMouseout({value:v(R,Q),point:R,series:M[R.series],pointIndex:Q,seriesIndex:R.series,e:d3.event})
}).on("click",function(R,Q){D.elementClick({value:v(R,Q),point:R,series:M[R.series],pos:[j(z(R,Q))+(j.rangeBand()*(B?M.length/2:R.series+0.5)/M.length),i(v(R,Q)+(B?R.y0:0))],pointIndex:Q,seriesIndex:R.series,e:d3.event});
d3.event.stopPropagation()
}).on("dblclick",function(R,Q){D.elementDblClick({value:v(R,Q),point:R,series:M[R.series],pos:[j(z(R,Q))+(j.rangeBand()*(B?M.length/2:R.series+0.5)/M.length),i(v(R,Q)+(B?R.y0:0))],pointIndex:Q,seriesIndex:R.series,e:d3.event});
d3.event.stopPropagation()
});
L.append("text");
if(A&&!B){O.select("text").attr("text-anchor",function(R,Q){return v(R,Q)<0?"end":"start"
}).attr("y",j.rangeBand()/(M.length*2)).attr("dy",".32em").text(function(R,Q){return h(v(R,Q))
});
d3.transition(O).select("text").attr("x",function(R,Q){return v(R,Q)<0?-4:i(v(R,Q))-i(0)+4
})
}else{O.selectAll("text").text("")
}O.attr("class",function(R,Q){return v(R,Q)<0?"nv-bar negative":"nv-bar positive"
});
if(q){if(!g){g=M.map(function(){return true
})
}O.style("fill",function(S,R,Q){return d3.rgb(q(S,R)).darker(g.map(function(U,T){return T
}).filter(function(U,T){return !g[T]
})[Q]).toString()
}).style("stroke",function(S,R,Q){return d3.rgb(q(S,R)).darker(g.map(function(U,T){return T
}).filter(function(U,T){return !g[T]
})[Q]).toString()
})
}if(B){d3.transition(O).attr("transform",function(R,Q){return"translate("+i(R.y1)+","+j(z(R,Q))+")"
}).select("rect").attr("width",function(R,Q){return Math.abs(i(v(R,Q)+R.y0)-i(R.y0))
}).attr("height",j.rangeBand())
}else{d3.transition(O).attr("transform",function(R,Q){return"translate("+(v(R,Q)<0?i(v(R,Q)):i(0))+","+(R.series*j.rangeBand()/M.length+j(z(R,Q)))+")"
}).select("rect").attr("height",j.rangeBand()/M.length).attr("width",function(R,Q){return Math.max(Math.abs(i(v(R,Q))-i(0)),1)
})
}w=j.copy();
e=i.copy()
});
return m
}m.dispatch=D;
m.x=function(x){if(!arguments.length){return z
}z=x;
return m
};
m.y=function(x){if(!arguments.length){return v
}v=x;
return m
};
m.margin=function(x){if(!arguments.length){return n
}n.top=typeof x.top!="undefined"?x.top:n.top;
n.right=typeof x.right!="undefined"?x.right:n.right;
n.bottom=typeof x.bottom!="undefined"?x.bottom:n.bottom;
n.left=typeof x.left!="undefined"?x.left:n.left;
return m
};
m.width=function(x){if(!arguments.length){return s
}s=x;
return m
};
m.height=function(x){if(!arguments.length){return o
}o=x;
return m
};
m.xScale=function(x){if(!arguments.length){return j
}j=x;
return m
};
m.yScale=function(x){if(!arguments.length){return i
}i=x;
return m
};
m.xDomain=function(x){if(!arguments.length){return t
}t=x;
return m
};
m.yDomain=function(x){if(!arguments.length){return r
}r=x;
return m
};
m.forceY=function(x){if(!arguments.length){return f
}f=x;
return m
};
m.stacked=function(x){if(!arguments.length){return B
}B=x;
return m
};
m.color=function(x){if(!arguments.length){return u
}u=c.utils.getColor(x);
return m
};
m.barColor=function(x){if(!arguments.length){return q
}q=c.utils.getColor(x);
return m
};
m.disabled=function(x){if(!arguments.length){return g
}g=x;
return m
};
m.id=function(x){if(!arguments.length){return p
}p=x;
return m
};
m.delay=function(x){if(!arguments.length){return C
}C=x;
return m
};
m.showValues=function(x){if(!arguments.length){return A
}A=x;
return m
};
m.valueFormat=function(x){if(!arguments.length){return h
}h=x;
return m
};
m.valuePadding=function(x){if(!arguments.length){return l
}l=x;
return m
};
return m
};
c.models.multiBarHorizontalChart=function(){var i=c.models.multiBarHorizontal(),p=c.models.axis(),f=c.models.axis(),h=c.models.legend().height(30),s=c.models.legend().height(30);
var u={top:30,right:20,bottom:50,left:60},w=null,v=null,z=c.utils.defaultColor(),C=true,A=true,B=false,g=true,m=function(F,E,I,H,G){return"<h3>"+F+" - "+E+"</h3><p>"+I+"</p>"
},r,q,n={stacked:B},o=null,l="No Data Available.",D=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),e=function(){return C?180:0
};
i.stacked(B);
p.orient("left").tickPadding(5).highlightZero(false).showMaxMin(false).tickFormat(function(x){return x
});
f.orient("bottom").tickFormat(d3.format(",.1f"));
var j=function(J,F){var I=J.pos[0]+(F.offsetLeft||0),H=J.pos[1]+(F.offsetTop||0),E=p.tickFormat()(i.x()(J.point,J.pointIndex)),K=f.tickFormat()(i.y()(J.point,J.pointIndex)),G=m(J.series.key,E,K,J,t);
c.tooltip.show([I,H],G,J.value<0?"e":"w",null,F)
};
function t(x){x.each(function(J){var E=d3.select(this),M=this;
var P=(w||parseInt(E.style("width"))||960)-u.left-u.right,H=(v||parseInt(E.style("height"))||400)-u.top-u.bottom;
t.update=function(){x.transition().call(t)
};
t.container=this;
n.disabled=J.map(function(Q){return !!Q.disabled
});
if(!o){var O;
o={};
for(O in n){if(n[O] instanceof Array){o[O]=n[O].slice(0)
}else{o[O]=n[O]
}}}if(!J||!J.length||!J.filter(function(Q){return Q.values.length
}).length){var F=E.selectAll(".nv-noData").data([l]);
F.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
F.attr("x",u.left+P/2).attr("y",u.top+H/2).text(function(Q){return Q
});
return t
}else{E.selectAll(".nv-noData").remove()
}r=i.xScale();
q=i.yScale();
var G=E.selectAll("g.nv-wrap.nv-multiBarHorizontalChart").data([J]);
var y=G.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarHorizontalChart").append("g");
var K=G.select("g");
y.append("g").attr("class","nv-x nv-axis");
y.append("g").attr("class","nv-y nv-axis");
y.append("g").attr("class","nv-barsWrap");
y.append("g").attr("class","nv-legendWrap");
y.append("g").attr("class","nv-controlsWrap");
if(A){h.width(P-e());
if(i.barColor()){J.forEach(function(R,Q){R.color=d3.rgb("#ccc").darker(Q*1.5).toString()
})
}K.select(".nv-legendWrap").datum(J).call(h);
if(u.top!=h.height()){u.top=h.height();
H=(v||parseInt(E.style("height"))||400)-u.top-u.bottom
}K.select(".nv-legendWrap").attr("transform","translate("+e()+","+(-u.top)+")")
}if(C){var N=[{key:"Grouped",disabled:i.stacked()},{key:"Stacked",disabled:!i.stacked()}];
s.width(e()).color(["#444","#444","#444"]);
K.select(".nv-controlsWrap").datum(N).attr("transform","translate(0,"+(-u.top)+")").call(s)
}G.attr("transform","translate("+u.left+","+u.top+")");
i.disabled(J.map(function(Q){return Q.disabled
})).width(P).height(H).color(J.map(function(R,Q){return R.color||z(R,Q)
}).filter(function(R,Q){return !J[Q].disabled
}));
var L=K.select(".nv-barsWrap").datum(J.filter(function(Q){return !Q.disabled
}));
d3.transition(L).call(i);
p.scale(r).ticks(H/24).tickSize(-P,0);
d3.transition(K.select(".nv-x.nv-axis")).call(p);
var I=K.select(".nv-x.nv-axis").selectAll("g");
I.selectAll("line, text").style("opacity",1);
f.scale(q).ticks(P/100).tickSize(-H,0);
K.select(".nv-y.nv-axis").attr("transform","translate(0,"+H+")");
d3.transition(K.select(".nv-y.nv-axis")).call(f);
h.dispatch.on("legendClick",function(R,Q){R.disabled=!R.disabled;
if(!J.filter(function(S){return !S.disabled
}).length){J.map(function(S){S.disabled=false;
G.selectAll(".nv-series").classed("disabled",false);
return S
})
}n.disabled=J.map(function(S){return !!S.disabled
});
D.stateChange(n);
x.transition().call(t)
});
s.dispatch.on("legendClick",function(R,Q){if(!R.disabled){return
}N=N.map(function(S){S.disabled=true;
return S
});
R.disabled=false;
switch(R.key){case"Grouped":i.stacked(false);
break;
case"Stacked":i.stacked(true);
break
}n.stacked=i.stacked();
D.stateChange(n);
x.transition().call(t)
});
D.on("tooltipShow",function(Q){if(g){j(Q,M.parentNode)
}});
D.on("changeState",function(Q){if(typeof Q.disabled!=="undefined"){J.forEach(function(S,R){S.disabled=Q.disabled[R]
});
n.disabled=Q.disabled
}if(typeof Q.stacked!=="undefined"){i.stacked(Q.stacked);
n.stacked=Q.stacked
}x.call(t)
})
});
return t
}i.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+u.left,x.pos[1]+u.top];
D.tooltipShow(x)
});
i.dispatch.on("elementMouseout.tooltip",function(x){D.tooltipHide(x)
});
D.on("tooltipHide",function(){if(g){c.tooltip.cleanup()
}});
t.dispatch=D;
t.multibar=i;
t.legend=h;
t.xAxis=p;
t.yAxis=f;
d3.rebind(t,i,"x","y","xDomain","yDomain","forceX","forceY","clipEdge","id","delay","showValues","valueFormat","stacked","barColor");
t.margin=function(x){if(!arguments.length){return u
}u.top=typeof x.top!="undefined"?x.top:u.top;
u.right=typeof x.right!="undefined"?x.right:u.right;
u.bottom=typeof x.bottom!="undefined"?x.bottom:u.bottom;
u.left=typeof x.left!="undefined"?x.left:u.left;
return t
};
t.width=function(x){if(!arguments.length){return w
}w=x;
return t
};
t.height=function(x){if(!arguments.length){return v
}v=x;
return t
};
t.color=function(x){if(!arguments.length){return z
}z=c.utils.getColor(x);
h.color(z);
return t
};
t.showControls=function(x){if(!arguments.length){return C
}C=x;
return t
};
t.showLegend=function(x){if(!arguments.length){return A
}A=x;
return t
};
t.tooltip=function(x){if(!arguments.length){return m
}m=x;
return t
};
t.tooltips=function(x){if(!arguments.length){return g
}g=x;
return t
};
t.tooltipContent=function(x){if(!arguments.length){return m
}m=x;
return t
};
t.state=function(x){if(!arguments.length){return n
}n=x;
return t
};
t.defaultState=function(x){if(!arguments.length){return o
}o=x;
return t
};
t.noData=function(x){if(!arguments.length){return l
}l=x;
return t
};
return t
};
c.models.multiChart=function(){var v={top:30,right:20,bottom:50,left:60},A=d3.scale.category20().range(),z=null,w=null,B=true,h=true,m=function(G,F,J,I,H){return"<h3>"+G+"</h3><p>"+J+" at "+F+"</p>"
},t,s;
var t=d3.scale.linear(),D=d3.scale.linear(),C=d3.scale.linear(),q=c.models.line().yScale(D),p=c.models.line().yScale(C),j=c.models.multiBar().stacked(false).yScale(D),g=c.models.multiBar().stacked(false).yScale(C),o=c.models.stackedArea().yScale(D),n=c.models.stackedArea().yScale(C),r=c.models.axis().scale(t).orient("bottom").tickPadding(5),f=c.models.axis().scale(D).orient("left"),e=c.models.axis().scale(C).orient("right"),i=c.models.legend().height(30),E=d3.dispatch("tooltipShow","tooltipHide");
var l=function(K,G){var J=K.pos[0]+(G.offsetLeft||0),I=K.pos[1]+(G.offsetTop||0),F=r.tickFormat()(q.x()(K.point,K.pointIndex)),L=((K.series.yAxis==2)?e:f).tickFormat()(q.y()(K.point,K.pointIndex)),H=m(K.series.key,F,L,K,u);
c.tooltip.show([J,I],H,undefined,undefined,G.offsetParent)
};
function u(x){x.each(function(ab){var Q=d3.select(this),I=this;
var y=(z||parseInt(Q.style("width"))||960)-v.left-v.right,G=(w||parseInt(Q.style("height"))||400)-v.top-v.bottom;
var T=ab.filter(function(ac){return !ac.disabled&&ac.type=="line"&&ac.yAxis==1
});
var S=ab.filter(function(ac){return !ac.disabled&&ac.type=="line"&&ac.yAxis==2
});
var X=ab.filter(function(ac){return !ac.disabled&&ac.type=="bar"&&ac.yAxis==1
});
var W=ab.filter(function(ac){return !ac.disabled&&ac.type=="bar"&&ac.yAxis==2
});
var P=ab.filter(function(ac){return !ac.disabled&&ac.type=="area"&&ac.yAxis==1
});
var N=ab.filter(function(ac){return !ac.disabled&&ac.type=="area"&&ac.yAxis==2
});
var K=ab.filter(function(ac){return !ac.disabled&&ac.yAxis==1
}).map(function(ac){return ac.values.map(function(ae,ad){return{x:ae.x,y:ae.y}
})
});
var J=ab.filter(function(ac){return !ac.disabled&&ac.yAxis==2
}).map(function(ac){return ac.values.map(function(ae,ad){return{x:ae.x,y:ae.y}
})
});
t.domain(d3.extent(d3.merge(K.concat(J)),function(ac){return ac.x
})).range([0,y]);
var L=Q.selectAll("g.wrap.multiChart").data([ab]);
var U=L.enter().append("g").attr("class","wrap nvd3 multiChart").append("g");
U.append("g").attr("class","x axis");
U.append("g").attr("class","y1 axis");
U.append("g").attr("class","y2 axis");
U.append("g").attr("class","lines1Wrap");
U.append("g").attr("class","lines2Wrap");
U.append("g").attr("class","bars1Wrap");
U.append("g").attr("class","bars2Wrap");
U.append("g").attr("class","stack1Wrap");
U.append("g").attr("class","stack2Wrap");
U.append("g").attr("class","legendWrap");
var Y=L.select("g");
if(B){i.width(y/2);
Y.select(".legendWrap").datum(ab.map(function(ac){ac.originalKey=ac.originalKey===undefined?ac.key:ac.originalKey;
ac.key=ac.originalKey+(ac.yAxis==1?"":" (right axis)");
return ac
})).call(i);
if(v.top!=i.height()){v.top=i.height();
G=(w||parseInt(Q.style("height"))||400)-v.top-v.bottom
}Y.select(".legendWrap").attr("transform","translate("+(y/2)+","+(-v.top)+")")
}q.width(y).height(G).interpolate("monotone").color(ab.map(function(ad,ac){return ad.color||A[ac%A.length]
}).filter(function(ad,ac){return !ab[ac].disabled&&ab[ac].yAxis==1&&ab[ac].type=="line"
}));
p.width(y).height(G).interpolate("monotone").color(ab.map(function(ad,ac){return ad.color||A[ac%A.length]
}).filter(function(ad,ac){return !ab[ac].disabled&&ab[ac].yAxis==2&&ab[ac].type=="line"
}));
j.width(y).height(G).color(ab.map(function(ad,ac){return ad.color||A[ac%A.length]
}).filter(function(ad,ac){return !ab[ac].disabled&&ab[ac].yAxis==1&&ab[ac].type=="bar"
}));
g.width(y).height(G).color(ab.map(function(ad,ac){return ad.color||A[ac%A.length]
}).filter(function(ad,ac){return !ab[ac].disabled&&ab[ac].yAxis==2&&ab[ac].type=="bar"
}));
o.width(y).height(G).color(ab.map(function(ad,ac){return ad.color||A[ac%A.length]
}).filter(function(ad,ac){return !ab[ac].disabled&&ab[ac].yAxis==1&&ab[ac].type=="area"
}));
n.width(y).height(G).color(ab.map(function(ad,ac){return ad.color||A[ac%A.length]
}).filter(function(ad,ac){return !ab[ac].disabled&&ab[ac].yAxis==2&&ab[ac].type=="area"
}));
Y.attr("transform","translate("+v.left+","+v.top+")");
var F=Y.select(".lines1Wrap").datum(T);
var H=Y.select(".bars1Wrap").datum(X);
var aa=Y.select(".stack1Wrap").datum(P);
var V=Y.select(".lines2Wrap").datum(S);
var Z=Y.select(".bars2Wrap").datum(W);
var R=Y.select(".stack2Wrap").datum(N);
var O=P.length?P.map(function(ac){return ac.values
}).reduce(function(ad,ac){return ad.map(function(ae,af){return{x:ae.x,y:ae.y+ac[af].y}
})
}).concat([{x:0,y:0}]):[];
var M=N.length?N.map(function(ac){return ac.values
}).reduce(function(ad,ac){return ad.map(function(ae,af){return{x:ae.x,y:ae.y+ac[af].y}
})
}).concat([{x:0,y:0}]):[];
D.domain(d3.extent(d3.merge(K).concat(O),function(ac){return ac.y
})).range([0,G]);
C.domain(d3.extent(d3.merge(J).concat(M),function(ac){return ac.y
})).range([0,G]);
q.yDomain(D.domain());
j.yDomain(D.domain());
o.yDomain(D.domain());
p.yDomain(C.domain());
g.yDomain(C.domain());
n.yDomain(C.domain());
if(P.length){d3.transition(aa).call(o)
}if(N.length){d3.transition(R).call(n)
}if(X.length){d3.transition(H).call(j)
}if(W.length){d3.transition(Z).call(g)
}if(T.length){d3.transition(F).call(q)
}if(S.length){d3.transition(V).call(p)
}r.ticks(y/100).tickSize(-G,0);
Y.select(".x.axis").attr("transform","translate(0,"+G+")");
d3.transition(Y.select(".x.axis")).call(r);
f.ticks(G/36).tickSize(-y,0);
d3.transition(Y.select(".y1.axis")).call(f);
e.ticks(G/36).tickSize(-y,0);
d3.transition(Y.select(".y2.axis")).call(e);
Y.select(".y2.axis").style("opacity",J.length?1:0).attr("transform","translate("+t.range()[1]+",0)");
i.dispatch.on("legendClick",function(ad,ac){ad.disabled=!ad.disabled;
if(!ab.filter(function(ae){return !ae.disabled
}).length){ab.map(function(ae){ae.disabled=false;
L.selectAll(".series").classed("disabled",false);
return ae
})
}x.transition().call(u)
});
E.on("tooltipShow",function(ac){if(h){l(ac,I.parentNode)
}})
});
u.update=function(){u(x)
};
u.container=this;
return u
}q.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+v.left,x.pos[1]+v.top];
E.tooltipShow(x)
});
q.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
p.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+v.left,x.pos[1]+v.top];
E.tooltipShow(x)
});
p.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
j.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+v.left,x.pos[1]+v.top];
E.tooltipShow(x)
});
j.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
g.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+v.left,x.pos[1]+v.top];
E.tooltipShow(x)
});
g.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
o.dispatch.on("tooltipShow",function(x){if(!Math.round(o.y()(x.point)*100)){setTimeout(function(){d3.selectAll(".point.hover").classed("hover",false)
},0);
return false
}x.pos=[x.pos[0]+v.left,x.pos[1]+v.top],E.tooltipShow(x)
});
o.dispatch.on("tooltipHide",function(x){E.tooltipHide(x)
});
n.dispatch.on("tooltipShow",function(x){if(!Math.round(n.y()(x.point)*100)){setTimeout(function(){d3.selectAll(".point.hover").classed("hover",false)
},0);
return false
}x.pos=[x.pos[0]+v.left,x.pos[1]+v.top],E.tooltipShow(x)
});
n.dispatch.on("tooltipHide",function(x){E.tooltipHide(x)
});
q.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+v.left,x.pos[1]+v.top];
E.tooltipShow(x)
});
q.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
p.dispatch.on("elementMouseover.tooltip",function(x){x.pos=[x.pos[0]+v.left,x.pos[1]+v.top];
E.tooltipShow(x)
});
p.dispatch.on("elementMouseout.tooltip",function(x){E.tooltipHide(x)
});
E.on("tooltipHide",function(){if(h){c.tooltip.cleanup()
}});
u.dispatch=E;
u.lines1=q;
u.lines2=p;
u.bars1=j;
u.bars2=g;
u.stack1=o;
u.stack2=n;
u.xAxis=r;
u.yAxis1=f;
u.yAxis2=e;
u.x=function(x){if(!arguments.length){return getX
}getX=x;
q.x(x);
j.x(x);
return u
};
u.y=function(x){if(!arguments.length){return getY
}getY=x;
q.y(x);
j.y(x);
return u
};
u.margin=function(x){if(!arguments.length){return v
}v=x;
return u
};
u.width=function(x){if(!arguments.length){return z
}z=x;
return u
};
u.height=function(x){if(!arguments.length){return w
}w=x;
return u
};
u.color=function(x){if(!arguments.length){return A
}A=x;
i.color(x);
return u
};
u.showLegend=function(x){if(!arguments.length){return B
}B=x;
return u
};
u.tooltips=function(x){if(!arguments.length){return h
}h=x;
return u
};
u.tooltipContent=function(x){if(!arguments.length){return m
}m=x;
return u
};
return u
};
c.models.ohlcBar=function(){var o={top:0,right:0,bottom:0,left:0},s=960,p=500,q=Math.floor(Math.random()*10000),j=d3.scale.linear(),i=d3.scale.linear(),w=function(x){return x.x
},v=function(x){return x.y
},f=function(x){return x.open
},e=function(x){return x.close
},A=function(x){return x.high
},l=function(x){return x.low
},h=[],g=[],m=false,z=true,u=c.utils.defaultColor(),t,r,B=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");
function n(x){x.each(function(I){var L=s-o.left-o.right,F=p-o.top-o.bottom,C=d3.select(this);
j.domain(t||d3.extent(I[0].values.map(w).concat(h)));
if(m){j.range([L*0.5/I[0].values.length,L*(I[0].values.length-0.5)/I[0].values.length])
}else{j.range([0,L])
}i.domain(r||[d3.min(I[0].values.map(l).concat(g)),d3.max(I[0].values.map(A).concat(g))]).range([F,0]);
if(j.domain()[0]===j.domain()[1]||i.domain()[0]===i.domain()[1]){singlePoint=true
}if(j.domain()[0]===j.domain()[1]){j.domain()[0]?j.domain([j.domain()[0]-j.domain()[0]*0.01,j.domain()[1]+j.domain()[1]*0.01]):j.domain([-1,1])
}if(i.domain()[0]===i.domain()[1]){i.domain()[0]?i.domain([i.domain()[0]+i.domain()[0]*0.01,i.domain()[1]-i.domain()[1]*0.01]):i.domain([-1,1])
}var D=d3.select(this).selectAll("g.nv-wrap.nv-ohlcBar").data([I[0].values]);
var H=D.enter().append("g").attr("class","nvd3 nv-wrap nv-ohlcBar");
var G=H.append("defs");
var y=H.append("g");
var J=D.select("g");
y.append("g").attr("class","nv-ticks");
D.attr("transform","translate("+o.left+","+o.top+")");
C.on("click",function(N,M){B.chartClick({data:N,index:M,pos:d3.event,id:q})
});
G.append("clipPath").attr("id","nv-chart-clip-path-"+q).append("rect");
D.select("#nv-chart-clip-path-"+q+" rect").attr("width",L).attr("height",F);
J.attr("clip-path",z?"url(#nv-chart-clip-path-"+q+")":"");
var K=D.select(".nv-ticks").selectAll(".nv-tick").data(function(M){return M
});
K.exit().remove();
var E=K.enter().append("path").attr("class",function(O,N,M){return(f(O,N)>e(O,N)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+M+"-"+N
}).attr("d",function(O,N){var M=(L/I[0].values.length)*0.9;
return"m0,0l0,"+(i(f(O,N))-i(A(O,N)))+"l"+(-M/2)+",0l"+(M/2)+",0l0,"+(i(l(O,N))-i(f(O,N)))+"l0,"+(i(e(O,N))-i(l(O,N)))+"l"+(M/2)+",0l"+(-M/2)+",0z"
}).attr("transform",function(N,M){return"translate("+j(w(N,M))+","+i(A(N,M))+")"
}).on("mouseover",function(N,M){d3.select(this).classed("hover",true);
B.elementMouseover({point:N,series:I[0],pos:[j(w(N,M)),i(v(N,M))],pointIndex:M,seriesIndex:0,e:d3.event})
}).on("mouseout",function(N,M){d3.select(this).classed("hover",false);
B.elementMouseout({point:N,series:I[0],pointIndex:M,seriesIndex:0,e:d3.event})
}).on("click",function(N,M){B.elementClick({value:v(N,M),data:N,index:M,pos:[j(w(N,M)),i(v(N,M))],e:d3.event,id:q});
d3.event.stopPropagation()
}).on("dblclick",function(N,M){B.elementDblClick({value:v(N,M),data:N,index:M,pos:[j(w(N,M)),i(v(N,M))],e:d3.event,id:q});
d3.event.stopPropagation()
});
K.attr("class",function(O,N,M){return(f(O,N)>e(O,N)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+M+"-"+N
});
d3.transition(K).attr("transform",function(N,M){return"translate("+j(w(N,M))+","+i(A(N,M))+")"
}).attr("d",function(O,N){var M=(L/I[0].values.length)*0.9;
return"m0,0l0,"+(i(f(O,N))-i(A(O,N)))+"l"+(-M/2)+",0l"+(M/2)+",0l0,"+(i(l(O,N))-i(f(O,N)))+"l0,"+(i(e(O,N))-i(l(O,N)))+"l"+(M/2)+",0l"+(-M/2)+",0z"
})
});
return n
}n.dispatch=B;
n.x=function(x){if(!arguments.length){return w
}w=x;
return n
};
n.y=function(x){if(!arguments.length){return v
}v=x;
return n
};
n.open=function(x){if(!arguments.length){return f
}f=x;
return n
};
n.close=function(x){if(!arguments.length){return e
}e=x;
return n
};
n.high=function(x){if(!arguments.length){return A
}A=x;
return n
};
n.low=function(x){if(!arguments.length){return l
}l=x;
return n
};
n.margin=function(x){if(!arguments.length){return o
}o.top=typeof x.top!="undefined"?x.top:o.top;
o.right=typeof x.right!="undefined"?x.right:o.right;
o.bottom=typeof x.bottom!="undefined"?x.bottom:o.bottom;
o.left=typeof x.left!="undefined"?x.left:o.left;
return n
};
n.width=function(x){if(!arguments.length){return s
}s=x;
return n
};
n.height=function(x){if(!arguments.length){return p
}p=x;
return n
};
n.xScale=function(x){if(!arguments.length){return j
}j=x;
return n
};
n.yScale=function(x){if(!arguments.length){return i
}i=x;
return n
};
n.xDomain=function(x){if(!arguments.length){return t
}t=x;
return n
};
n.yDomain=function(x){if(!arguments.length){return r
}r=x;
return n
};
n.forceX=function(x){if(!arguments.length){return h
}h=x;
return n
};
n.forceY=function(x){if(!arguments.length){return g
}g=x;
return n
};
n.padData=function(x){if(!arguments.length){return m
}m=x;
return n
};
n.clipEdge=function(x){if(!arguments.length){return z
}z=x;
return n
};
n.color=function(x){if(!arguments.length){return u
}u=c.utils.getColor(x);
return n
};
n.id=function(x){if(!arguments.length){return q
}q=x;
return n
};
return n
};
c.models.pie=function(){var n={top:0,right:0,bottom:0,left:0},s=500,o=500,e=function(A){return A.values
},y=function(A){return A.x
},x=function(A){return A.y
},i=function(A){return A.description
},q=Math.floor(Math.random()*10000),u=c.utils.defaultColor(),g=d3.format(",.2f"),p=true,h=true,t=false,v=0.02,j=false,f=false,w=false,r=false,l=0.5,z=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");
function m(A){A.each(function(T){var B=s-n.left-n.right,E=o-n.top-n.bottom,F=Math.min(B,E)/2,I=F-(F/5),L=d3.select(this);
var K=L.selectAll(".nv-wrap.nv-pie").data([e(T[0])]);
var G=K.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+q);
var P=G.append("g");
var Q=K.select("g");
P.append("g").attr("class","nv-pie");
K.attr("transform","translate("+n.left+","+n.top+")");
Q.select(".nv-pie").attr("transform","translate("+B/2+","+E/2+")");
L.on("click",function(V,U){z.chartClick({data:V,index:U,pos:d3.event,id:q})
});
var J=d3.svg.arc().outerRadius(I);
if(w){J.startAngle(w)
}if(r){J.endAngle(r)
}if(j){J.innerRadius(F*l)
}var M=d3.layout.pie().sort(null).value(function(U){return U.disabled?0:x(U)
});
var C=K.select(".nv-pie").selectAll(".nv-slice").data(M);
C.exit().remove();
var S=C.enter().append("g").attr("class","nv-slice").on("mouseover",function(V,U){d3.select(this).classed("hover",true);
z.elementMouseover({label:y(V.data),value:x(V.data),point:V.data,pointIndex:U,pos:[d3.event.pageX,d3.event.pageY],id:q})
}).on("mouseout",function(V,U){d3.select(this).classed("hover",false);
z.elementMouseout({label:y(V.data),value:x(V.data),point:V.data,index:U,id:q})
}).on("click",function(V,U){z.elementClick({label:y(V.data),value:x(V.data),point:V.data,index:U,pos:d3.event,id:q});
d3.event.stopPropagation()
}).on("dblclick",function(V,U){z.elementDblClick({label:y(V.data),value:x(V.data),point:V.data,index:U,pos:d3.event,id:q});
d3.event.stopPropagation()
});
C.attr("fill",function(V,U){return u(V,U)
}).attr("stroke",function(V,U){return u(V,U)
});
var O=S.append("path").each(function(U){this._current=U
});
d3.transition(C.select("path")).attr("d",J).attrTween("d",D);
if(p){var H=d3.svg.arc().innerRadius(0);
if(h){H=J
}if(t){H=d3.svg.arc().outerRadius(J.outerRadius())
}S.append("g").classed("nv-label",true).each(function(W,U){var V=d3.select(this);
V.attr("transform",function(Y){if(f){Y.outerRadius=I+10;
Y.innerRadius=I+15;
var X=(Y.startAngle+Y.endAngle)/2*(180/Math.PI);
if((Y.startAngle+Y.endAngle)/2<Math.PI){X-=90
}else{X+=90
}return"translate("+H.centroid(Y)+") rotate("+X+")"
}else{Y.outerRadius=F+10;
Y.innerRadius=F+15;
return"translate("+H.centroid(Y)+")"
}});
V.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3);
V.append("text").style("text-anchor",f?((W.startAngle+W.endAngle)/2<Math.PI?"start":"end"):"middle").style("fill","#000")
});
C.select(".nv-label").transition().attr("transform",function(V){if(f){V.outerRadius=I+10;
V.innerRadius=I+15;
var U=(V.startAngle+V.endAngle)/2*(180/Math.PI);
if((V.startAngle+V.endAngle)/2<Math.PI){U-=90
}else{U+=90
}return"translate("+H.centroid(V)+") rotate("+U+")"
}else{V.outerRadius=F+10;
V.innerRadius=F+15;
return"translate("+H.centroid(V)+")"
}});
C.each(function(X,U){var W=d3.select(this);
W.select(".nv-label text").style("text-anchor",f?((X.startAngle+X.endAngle)/2<Math.PI?"start":"end"):"middle").text(function(aa,Y){var Z=(aa.endAngle-aa.startAngle)/(2*Math.PI);
return(aa.value&&Z>v)?y(aa.data):""
});
var V=W.select("text").node().getBBox();
W.select(".nv-label rect").attr("width",V.width+10).attr("height",V.height+10).attr("transform",function(){return"translate("+[V.x-5,V.y-5]+")"
})
})
}function R(V){var U=(V.startAngle+V.endAngle)*90/Math.PI-90;
return U>90?U-180:U
}function D(U){if(!j){U.innerRadius=0
}var V=d3.interpolate(this._current,U);
this._current=V(0);
return function(W){return J(V(W))
}
}function N(U){U.innerRadius=0;
var V=d3.interpolate({startAngle:0,endAngle:0},U);
return function(W){return J(V(W))
}
}});
return m
}m.dispatch=z;
m.margin=function(A){if(!arguments.length){return n
}n.top=typeof A.top!="undefined"?A.top:n.top;
n.right=typeof A.right!="undefined"?A.right:n.right;
n.bottom=typeof A.bottom!="undefined"?A.bottom:n.bottom;
n.left=typeof A.left!="undefined"?A.left:n.left;
return m
};
m.width=function(A){if(!arguments.length){return s
}s=A;
return m
};
m.height=function(A){if(!arguments.length){return o
}o=A;
return m
};
m.values=function(A){if(!arguments.length){return e
}e=A;
return m
};
m.x=function(A){if(!arguments.length){return y
}y=A;
return m
};
m.y=function(A){if(!arguments.length){return x
}x=d3.functor(A);
return m
};
m.description=function(A){if(!arguments.length){return i
}i=A;
return m
};
m.showLabels=function(A){if(!arguments.length){return p
}p=A;
return m
};
m.labelSunbeamLayout=function(A){if(!arguments.length){return f
}f=A;
return m
};
m.donutLabelsOutside=function(A){if(!arguments.length){return t
}t=A;
return m
};
m.pieLabelsOutside=function(A){if(!arguments.length){return h
}h=A;
return m
};
m.donut=function(A){if(!arguments.length){return j
}j=A;
return m
};
m.donutRatio=function(A){if(!arguments.length){return l
}l=A;
return m
};
m.startAngle=function(A){if(!arguments.length){return w
}w=A;
return m
};
m.endAngle=function(A){if(!arguments.length){return r
}r=A;
return m
};
m.id=function(A){if(!arguments.length){return q
}q=A;
return m
};
m.color=function(A){if(!arguments.length){return u
}u=c.utils.getColor(A);
return m
};
m.valueFormat=function(A){if(!arguments.length){return g
}g=A;
return m
};
m.labelThreshold=function(A){if(!arguments.length){return v
}v=A;
return m
};
return m
};
c.models.pieChart=function(){var i=c.models.pie(),n=c.models.legend();
var g={top:30,right:20,bottom:20,left:20},f=null,r=null,q=true,h=c.utils.defaultColor(),m=true,t=function(u,x,w,v){return"<h3>"+u+"</h3><p>"+x+"</p>"
},e={},s=null,p="No Data Available.",j=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");
var o=function(A,u){var v=i.description()(A.point)||i.x()(A.point);
var z=A.pos[0]+((u&&u.offsetLeft)||0),x=A.pos[1]+((u&&u.offsetTop)||0),B=i.valueFormat()(i.y()(A.point)),w=t(v,B,A,l);
c.tooltip.show([z,x],w,A.value<0?"n":"s",null,u)
};
function l(u){u.each(function(A){var w=d3.select(this),C=this;
var F=(f||parseInt(w.style("width"))||960)-g.left-g.right,z=(r||parseInt(w.style("height"))||400)-g.top-g.bottom;
l.update=function(){l(u)
};
l.container=this;
e.disabled=A[0].map(function(G){return !!G.disabled
});
if(!s){var E;
s={};
for(E in e){if(e[E] instanceof Array){s[E]=e[E].slice(0)
}else{s[E]=e[E]
}}}if(!A[0]||!A[0].length){var x=w.selectAll(".nv-noData").data([p]);
x.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
x.attr("x",g.left+F/2).attr("y",g.top+z/2).text(function(G){return G
});
return l
}else{w.selectAll(".nv-noData").remove()
}var y=w.selectAll("g.nv-wrap.nv-pieChart").data([A]);
var v=y.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g");
var B=y.select("g");
v.append("g").attr("class","nv-pieWrap");
v.append("g").attr("class","nv-legendWrap");
if(q){n.width(F).key(i.x());
y.select(".nv-legendWrap").datum(i.values()(A[0])).call(n);
if(g.top!=n.height()){g.top=n.height();
z=(r||parseInt(w.style("height"))||400)-g.top-g.bottom
}y.select(".nv-legendWrap").attr("transform","translate(0,"+(-g.top)+")")
}y.attr("transform","translate("+g.left+","+g.top+")");
i.width(F).height(z);
var D=B.select(".nv-pieWrap").datum(A);
d3.transition(D).call(i);
n.dispatch.on("legendClick",function(I,G,H){I.disabled=!I.disabled;
if(!i.values()(A[0]).filter(function(J){return !J.disabled
}).length){i.values()(A[0]).map(function(J){J.disabled=false;
y.selectAll(".nv-series").classed("disabled",false);
return J
})
}e.disabled=A[0].map(function(J){return !!J.disabled
});
j.stateChange(e);
u.transition().call(l)
});
i.dispatch.on("elementMouseout.tooltip",function(G){j.tooltipHide(G)
});
j.on("changeState",function(G){if(typeof G.disabled!=="undefined"){A[0].forEach(function(I,H){I.disabled=G.disabled[H]
});
e.disabled=G.disabled
}u.call(l)
})
});
return l
}i.dispatch.on("elementMouseover.tooltip",function(u){u.pos=[u.pos[0]+g.left,u.pos[1]+g.top];
j.tooltipShow(u)
});
j.on("tooltipShow",function(u){if(m){o(u)
}});
j.on("tooltipHide",function(){if(m){c.tooltip.cleanup()
}});
l.legend=n;
l.dispatch=j;
l.pie=i;
d3.rebind(l,i,"valueFormat","values","x","y","description","id","showLabels","donutLabelsOutside","pieLabelsOutside","donut","donutRatio","labelThreshold");
l.margin=function(u){if(!arguments.length){return g
}g.top=typeof u.top!="undefined"?u.top:g.top;
g.right=typeof u.right!="undefined"?u.right:g.right;
g.bottom=typeof u.bottom!="undefined"?u.bottom:g.bottom;
g.left=typeof u.left!="undefined"?u.left:g.left;
return l
};
l.width=function(u){if(!arguments.length){return f
}f=u;
return l
};
l.height=function(u){if(!arguments.length){return r
}r=u;
return l
};
l.color=function(u){if(!arguments.length){return h
}h=c.utils.getColor(u);
n.color(h);
i.color(h);
return l
};
l.showLegend=function(u){if(!arguments.length){return q
}q=u;
return l
};
l.tooltips=function(u){if(!arguments.length){return m
}m=u;
return l
};
l.tooltipContent=function(u){if(!arguments.length){return t
}t=u;
return l
};
l.state=function(u){if(!arguments.length){return e
}e=u;
return l
};
l.defaultState=function(u){if(!arguments.length){return s
}s=u;
return l
};
l.noData=function(u){if(!arguments.length){return p
}p=u;
return l
};
return l
};
c.models.scatter=function(){var l={top:0,right:0,bottom:0,left:0},e=960,g=500,s=c.utils.defaultColor(),w=Math.floor(Math.random()*100000),G=d3.scale.linear(),E=d3.scale.linear(),C=d3.scale.linear(),L=function(x){return x.x
},K=function(x){return x.y
},v=function(x){return x.size||1
},p=function(x){return x.shape||"circle"
},N=true,D=[],B=[],M=[],j=true,O=function(x){return !x.notActive
},I=false,n=0.1,u=false,Q=true,r=function(){return 25
},i=null,h=null,m=null,t=null,H=false,J=d3.dispatch("elementClick","elementMouseover","elementMouseout"),R=true;
var q,f,A,F,o=false;
function P(x){x.each(function(Y){var ac=e-l.left-l.right,U=g-l.top-l.bottom,z=d3.select(this);
Y=Y.map(function(ae,ad){ae.values=ae.values.map(function(af){af.series=ad;
return af
});
return ae
});
var T=(i&&h&&m)?[]:d3.merge(Y.map(function(ad){return ad.values.map(function(af,ae){return{x:L(af,ae),y:K(af,ae),size:v(af,ae)}
})
}));
G.domain(i||d3.extent(T.map(function(ad){return ad.x
}).concat(D)));
if(I&&Y[0]){G.range([(ac*n+ac)/(2*Y[0].values.length),ac-ac*(1+n)/(2*Y[0].values.length)])
}else{G.range([0,ac])
}E.domain(h||d3.extent(T.map(function(ad){return ad.y
}).concat(B))).range([U,0]);
C.domain(m||d3.extent(T.map(function(ad){return ad.size
}).concat(M))).range(t||[16,256]);
if(G.domain()[0]===G.domain()[1]||E.domain()[0]===E.domain()[1]){H=true
}if(G.domain()[0]===G.domain()[1]){G.domain()[0]?G.domain([G.domain()[0]-G.domain()[0]*0.01,G.domain()[1]+G.domain()[1]*0.01]):G.domain([-1,1])
}if(E.domain()[0]===E.domain()[1]){E.domain()[0]?E.domain([E.domain()[0]+E.domain()[0]*0.01,E.domain()[1]-E.domain()[1]*0.01]):E.domain([-1,1])
}if(isNaN(G.domain()[0])){G.domain([-1,1])
}if(isNaN(E.domain()[0])){E.domain([-1,1])
}q=q||G;
f=f||E;
A=A||C;
var S=z.selectAll("g.nv-wrap.nv-scatter").data([Y]);
var X=S.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+w+(H?" nv-single-point":""));
var V=X.append("defs");
var y=X.append("g");
var Z=S.select("g");
y.append("g").attr("class","nv-groups");
y.append("g").attr("class","nv-point-paths");
S.attr("transform","translate("+l.left+","+l.top+")");
V.append("clipPath").attr("id","nv-edge-clip-"+w).append("rect");
S.select("#nv-edge-clip-"+w+" rect").attr("width",ac).attr("height",U);
Z.attr("clip-path",u?"url(#nv-edge-clip-"+w+")":"");
function aa(){if(!j){return false
}var af;
var ae=d3.merge(Y.map(function(al,ak){return al.values.map(function(am,ap){var ao=L(am,ap)+Math.random()*1e-10;
var an=K(am,ap)+Math.random()*1e-10;
return[G(ao),E(an),ak,ap,am]
}).filter(function(am,an){return O(am[4],an)
})
}));
if(R===true){if(Q){var ai=S.select("defs").selectAll(".nv-point-clips").data([w]).enter();
ai.append("clipPath").attr("class","nv-point-clips").attr("id","nv-points-clip-"+w);
var ag=S.select("#nv-points-clip-"+w).selectAll("circle").data(ae);
ag.enter().append("circle").attr("r",r);
ag.exit().remove();
ag.attr("cx",function(ak){return ak[0]
}).attr("cy",function(ak){return ak[1]
});
S.select(".nv-point-paths").attr("clip-path","url(#nv-points-clip-"+w+")")
}ae.push([G.range()[0]-20,E.range()[0]-20,null,null]);
ae.push([G.range()[1]+20,E.range()[1]+20,null,null]);
ae.push([G.range()[0]-20,E.range()[0]+20,null,null]);
ae.push([G.range()[1]+20,E.range()[1]-20,null,null]);
var ah=d3.geom.polygon([[-10,-10],[-10,g+10],[e+10,g+10],[e+10,-10]]);
var aj=d3.geom.voronoi(ae).map(function(al,ak){return{data:ah.clip(al),series:ae[ak][2],point:ae[ak][3]}
});
var ad=S.select(".nv-point-paths").selectAll("path").data(aj);
ad.enter().append("path").attr("class",function(al,ak){return"nv-path-"+ak
});
ad.exit().remove();
ad.attr("d",function(ak){if(ak.data.length===0){return"M 0 0"
}else{return"M"+ak.data.join("L")+"Z"
}});
ad.on("click",function(am){if(o){return 0
}var al=Y[am.series],ak=al.values[am.point];
J.elementClick({point:ak,series:al,pos:[G(L(ak,am.point))+l.left,E(K(ak,am.point))+l.top],seriesIndex:am.series,pointIndex:am.point})
}).on("mouseover",function(am){if(o){return 0
}var al=Y[am.series],ak=al.values[am.point];
J.elementMouseover({point:ak,series:al,pos:[G(L(ak,am.point))+l.left,E(K(ak,am.point))+l.top],seriesIndex:am.series,pointIndex:am.point})
}).on("mouseout",function(an,am){if(o){return 0
}var al=Y[an.series],ak=al.values[an.point];
J.elementMouseout({point:ak,series:al,seriesIndex:an.series,pointIndex:an.point})
})
}else{S.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").on("click",function(an,am){if(o||!Y[an.series]){return 0
}var al=Y[an.series],ak=al.values[am];
J.elementClick({point:ak,series:al,pos:[G(L(ak,am))+l.left,E(K(ak,am))+l.top],seriesIndex:an.series,pointIndex:am})
}).on("mouseover",function(an,am){if(o||!Y[an.series]){return 0
}var al=Y[an.series],ak=al.values[am];
J.elementMouseover({point:ak,series:al,pos:[G(L(ak,am))+l.left,E(K(ak,am))+l.top],seriesIndex:an.series,pointIndex:am})
}).on("mouseout",function(an,am){if(o||!Y[an.series]){return 0
}var al=Y[an.series],ak=al.values[am];
J.elementMouseout({point:ak,series:al,seriesIndex:an.series,pointIndex:am})
})
}o=false
}o=true;
var W=S.select(".nv-groups").selectAll(".nv-group").data(function(ad){return ad
},function(ad){return ad.key
});
W.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);
d3.transition(W.exit()).style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();
W.attr("class",function(ae,ad){return"nv-group nv-series-"+ad
}).classed("hover",function(ad){return ad.hover
});
d3.transition(W).style("fill",function(ae,ad){return s(ae,ad)
}).style("stroke",function(ae,ad){return s(ae,ad)
}).style("stroke-opacity",1).style("fill-opacity",0.5);
if(N){var ab=W.selectAll("circle.nv-point").data(function(ad){return ad.values
});
ab.enter().append("circle").attr("cx",function(ae,ad){return q(L(ae,ad))
}).attr("cy",function(ae,ad){return f(K(ae,ad))
}).attr("r",function(ae,ad){return Math.sqrt(C(v(ae,ad))/Math.PI)
});
ab.exit().remove();
d3.transition(W.exit().selectAll("path.nv-point")).attr("cx",function(ae,ad){return G(L(ae,ad))
}).attr("cy",function(ae,ad){return E(K(ae,ad))
}).remove();
ab.attr("class",function(ae,ad){return"nv-point nv-point-"+ad
});
d3.transition(ab).attr("cx",function(ae,ad){return G(L(ae,ad))
}).attr("cy",function(ae,ad){return E(K(ae,ad))
}).attr("r",function(ae,ad){return Math.sqrt(C(v(ae,ad))/Math.PI)
})
}else{var ab=W.selectAll("path.nv-point").data(function(ad){return ad.values
});
ab.enter().append("path").attr("transform",function(ae,ad){return"translate("+q(L(ae,ad))+","+f(K(ae,ad))+")"
}).attr("d",d3.svg.symbol().type(p).size(function(ae,ad){return C(v(ae,ad))
}));
ab.exit().remove();
d3.transition(W.exit().selectAll("path.nv-point")).attr("transform",function(ae,ad){return"translate("+G(L(ae,ad))+","+E(K(ae,ad))+")"
}).remove();
ab.attr("class",function(ae,ad){return"nv-point nv-point-"+ad
});
d3.transition(ab).attr("transform",function(ae,ad){return"translate("+G(L(ae,ad))+","+E(K(ae,ad))+")"
}).attr("d",d3.svg.symbol().type(p).size(function(ae,ad){return C(v(ae,ad))
}))
}clearTimeout(F);
F=setTimeout(aa,300);
q=G.copy();
f=E.copy();
A=C.copy()
});
return P
}J.on("elementMouseover.point",function(x){if(j){d3.select(".nv-chart-"+w+" .nv-series-"+x.seriesIndex+" .nv-point-"+x.pointIndex).classed("hover",true)
}});
J.on("elementMouseout.point",function(x){if(j){d3.select(".nv-chart-"+w+" .nv-series-"+x.seriesIndex+" .nv-point-"+x.pointIndex).classed("hover",false)
}});
P.dispatch=J;
P.x=function(x){if(!arguments.length){return L
}L=d3.functor(x);
return P
};
P.y=function(x){if(!arguments.length){return K
}K=d3.functor(x);
return P
};
P.size=function(x){if(!arguments.length){return v
}v=d3.functor(x);
return P
};
P.margin=function(x){if(!arguments.length){return l
}l.top=typeof x.top!="undefined"?x.top:l.top;
l.right=typeof x.right!="undefined"?x.right:l.right;
l.bottom=typeof x.bottom!="undefined"?x.bottom:l.bottom;
l.left=typeof x.left!="undefined"?x.left:l.left;
return P
};
P.width=function(x){if(!arguments.length){return e
}e=x;
return P
};
P.height=function(x){if(!arguments.length){return g
}g=x;
return P
};
P.xScale=function(x){if(!arguments.length){return G
}G=x;
return P
};
P.yScale=function(x){if(!arguments.length){return E
}E=x;
return P
};
P.zScale=function(x){if(!arguments.length){return C
}C=x;
return P
};
P.xDomain=function(x){if(!arguments.length){return i
}i=x;
return P
};
P.yDomain=function(x){if(!arguments.length){return h
}h=x;
return P
};
P.sizeDomain=function(x){if(!arguments.length){return m
}m=x;
return P
};
P.sizeRange=function(x){if(!arguments.length){return t
}t=x;
return P
};
P.forceX=function(x){if(!arguments.length){return D
}D=x;
return P
};
P.forceY=function(x){if(!arguments.length){return B
}B=x;
return P
};
P.forceSize=function(x){if(!arguments.length){return M
}M=x;
return P
};
P.interactive=function(x){if(!arguments.length){return j
}j=x;
return P
};
P.pointActive=function(x){if(!arguments.length){return O
}O=x;
return P
};
P.padData=function(x){if(!arguments.length){return I
}I=x;
return P
};
P.padDataOuter=function(x){if(!arguments.length){return n
}n=x;
return P
};
P.clipEdge=function(x){if(!arguments.length){return u
}u=x;
return P
};
P.clipVoronoi=function(x){if(!arguments.length){return Q
}Q=x;
return P
};
P.useVoronoi=function(x){if(!arguments.length){return R
}R=x;
if(R===false){Q=false
}return P
};
P.clipRadius=function(x){if(!arguments.length){return r
}r=x;
return P
};
P.color=function(x){if(!arguments.length){return s
}s=c.utils.getColor(x);
return P
};
P.shape=function(x){if(!arguments.length){return p
}p=x;
return P
};
P.onlyCircles=function(x){if(!arguments.length){return N
}N=x;
return P
};
P.id=function(x){if(!arguments.length){return w
}w=x;
return P
};
P.singlePoint=function(x){if(!arguments.length){return H
}H=x;
return P
};
return P
};
c.models.scatterChart=function(){var u=c.models.scatter(),r=c.models.axis(),f=c.models.axis(),i=c.models.legend(),v=c.models.legend(),B=c.models.distribution(),z=c.models.distribution();
var C={top:30,right:20,bottom:50,left:75},H=null,D=null,I=c.utils.defaultColor(),t=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):u.xScale(),s=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):u.yScale(),w=0,g=0,e=false,O=false,L=true,M=!!d3.fisheye,G=0,J=false,h=true,F=function(Q,P,R){return"<strong>"+P+"</strong>"
},E=function(Q,P,R){return"<strong>"+R+"</strong>"
},o=null,n={},p=null,N=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),m="No Data Available.";
u.xScale(t).yScale(s);
r.orient("bottom").tickPadding(10);
f.orient("left").tickPadding(10);
B.axis("x");
z.axis("y");
var K,j;
var l=function(S,V){var Q=S.pos[0]+(V.offsetLeft||0),U=S.pos[1]+(V.offsetTop||0),R=S.pos[0]+(V.offsetLeft||0),y=s.range()[0]+C.top+(V.offsetTop||0),P=t.range()[0]+C.left+(V.offsetLeft||0),x=S.pos[1]+(V.offsetTop||0),W=r.tickFormat()(u.x()(S.point,S.pointIndex)),T=f.tickFormat()(u.y()(S.point,S.pointIndex));
if(F!=null){c.tooltip.show([R,y],F(S.series.key,W,T,S,A),"n",1,V,"x-nvtooltip")
}if(E!=null){c.tooltip.show([P,x],E(S.series.key,W,T,S,A),"e",1,V,"y-nvtooltip")
}if(o!=null){c.tooltip.show([Q,U],o(S.series.key,W,T,S,A),S.value<0?"n":"s",null,V)
}};
var q=[{key:"Magnify",disabled:true}];
function A(x){x.each(function(X){var R=d3.select(this),Z=this;
var ab=(H||parseInt(R.style("width"))||960)-C.left-C.right,U=(D||parseInt(R.style("height"))||400)-C.top-C.bottom;
A.update=function(){A(x)
};
A.container=this;
n.disabled=X.map(function(ac){return !!ac.disabled
});
if(!p){var aa;
p={};
for(aa in n){if(n[aa] instanceof Array){p[aa]=n[aa].slice(0)
}else{p[aa]=n[aa]
}}}if(!X||!X.length||!X.filter(function(ac){return ac.values.length
}).length){var S=R.selectAll(".nv-noData").data([m]);
S.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
S.attr("x",C.left+ab/2).attr("y",C.top+U/2).text(function(ac){return ac
});
return A
}else{R.selectAll(".nv-noData").remove()
}K=K||t;
j=j||s;
var T=R.selectAll("g.nv-wrap.nv-scatterChart").data([X]);
var V=T.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+u.id());
var P=V.append("g");
var Y=T.select("g");
P.append("rect").attr("class","nvd3 nv-background");
P.append("g").attr("class","nv-x nv-axis");
P.append("g").attr("class","nv-y nv-axis");
P.append("g").attr("class","nv-scatterWrap");
P.append("g").attr("class","nv-distWrap");
P.append("g").attr("class","nv-legendWrap");
P.append("g").attr("class","nv-controlsWrap");
if(L){i.width(ab/2);
T.select(".nv-legendWrap").datum(X).call(i);
if(C.top!=i.height()){C.top=i.height();
U=(D||parseInt(R.style("height"))||400)-C.top-C.bottom
}T.select(".nv-legendWrap").attr("transform","translate("+(ab/2)+","+(-C.top)+")")
}if(M){v.width(180).color(["#444"]);
Y.select(".nv-controlsWrap").datum(q).attr("transform","translate(0,"+(-C.top)+")").call(v)
}T.attr("transform","translate("+C.left+","+C.top+")");
u.width(ab).height(U).color(X.map(function(ad,ac){return ad.color||I(ad,ac)
}).filter(function(ad,ac){return !X[ac].disabled
}));
T.select(".nv-scatterWrap").datum(X.filter(function(ac){return !ac.disabled
})).call(u);
if(w){var y=t.domain()[1]-t.domain()[0];
t.domain([t.domain()[0]-(w*y),t.domain()[1]+(w*y)])
}if(g){var W=s.domain()[1]-s.domain()[0];
s.domain([s.domain()[0]-(g*W),s.domain()[1]+(g*W)])
}r.scale(t).ticks(r.ticks()&&r.ticks().length?r.ticks():ab/100).tickSize(-U,0);
Y.select(".nv-x.nv-axis").attr("transform","translate(0,"+s.range()[0]+")").call(r);
f.scale(s).ticks(f.ticks()&&f.ticks().length?f.ticks():U/36).tickSize(-ab,0);
Y.select(".nv-y.nv-axis").call(f);
if(e){B.getData(u.x()).scale(t).width(ab).color(X.map(function(ad,ac){return ad.color||I(ad,ac)
}).filter(function(ad,ac){return !X[ac].disabled
}));
P.select(".nv-distWrap").append("g").attr("class","nv-distributionX");
Y.select(".nv-distributionX").attr("transform","translate(0,"+s.range()[0]+")").datum(X.filter(function(ac){return !ac.disabled
})).call(B)
}if(O){z.getData(u.y()).scale(s).width(U).color(X.map(function(ad,ac){return ad.color||I(ad,ac)
}).filter(function(ad,ac){return !X[ac].disabled
}));
P.select(".nv-distWrap").append("g").attr("class","nv-distributionY");
Y.select(".nv-distributionY").attr("transform","translate(-"+z.size()+",0)").datum(X.filter(function(ac){return !ac.disabled
})).call(z)
}if(d3.fisheye){Y.select(".nv-background").attr("width",ab).attr("height",U);
Y.select(".nv-background").on("mousemove",Q);
Y.select(".nv-background").on("click",function(){J=!J
});
u.dispatch.on("elementClick.freezeFisheye",function(){J=!J
})
}function Q(){if(J){Y.select(".nv-point-paths").style("pointer-events","all");
return false
}Y.select(".nv-point-paths").style("pointer-events","none");
var ac=d3.mouse(this);
t.distortion(G).focus(ac[0]);
s.distortion(G).focus(ac[1]);
Y.select(".nv-scatterWrap").call(u);
Y.select(".nv-x.nv-axis").call(r);
Y.select(".nv-y.nv-axis").call(f);
Y.select(".nv-distributionX").datum(X.filter(function(ad){return !ad.disabled
})).call(B);
Y.select(".nv-distributionY").datum(X.filter(function(ad){return !ad.disabled
})).call(z)
}v.dispatch.on("legendClick",function(ad,ac){ad.disabled=!ad.disabled;
G=ad.disabled?0:2.5;
Y.select(".nv-background").style("pointer-events",ad.disabled?"none":"all");
Y.select(".nv-point-paths").style("pointer-events",ad.disabled?"all":"none");
if(ad.disabled){t.distortion(G).focus(0);
s.distortion(G).focus(0);
Y.select(".nv-scatterWrap").call(u);
Y.select(".nv-x.nv-axis").call(r);
Y.select(".nv-y.nv-axis").call(f)
}else{J=false
}A(x)
});
i.dispatch.on("legendClick",function(ae,ac,ad){ae.disabled=!ae.disabled;
if(!X.filter(function(af){return !af.disabled
}).length){X.map(function(af){af.disabled=false;
T.selectAll(".nv-series").classed("disabled",false);
return af
})
}n.disabled=X.map(function(af){return !!af.disabled
});
N.stateChange(n);
A(x)
});
u.dispatch.on("elementMouseover.tooltip",function(ac){d3.select(".nv-chart-"+u.id()+" .nv-series-"+ac.seriesIndex+" .nv-distx-"+ac.pointIndex).attr("y1",ac.pos[1]-U);
d3.select(".nv-chart-"+u.id()+" .nv-series-"+ac.seriesIndex+" .nv-disty-"+ac.pointIndex).attr("x2",ac.pos[0]+B.size());
ac.pos=[ac.pos[0]+C.left,ac.pos[1]+C.top];
N.tooltipShow(ac)
});
N.on("tooltipShow",function(ac){if(h){l(ac,Z.parentNode)
}});
N.on("changeState",function(ac){if(typeof ac.disabled!=="undefined"){X.forEach(function(ae,ad){ae.disabled=ac.disabled[ad]
});
n.disabled=ac.disabled
}x.call(A)
});
K=t.copy();
j=s.copy()
});
return A
}u.dispatch.on("elementMouseout.tooltip",function(x){N.tooltipHide(x);
d3.select(".nv-chart-"+u.id()+" .nv-series-"+x.seriesIndex+" .nv-distx-"+x.pointIndex).attr("y1",0);
d3.select(".nv-chart-"+u.id()+" .nv-series-"+x.seriesIndex+" .nv-disty-"+x.pointIndex).attr("x2",z.size())
});
N.on("tooltipHide",function(){if(h){c.tooltip.cleanup()
}});
A.dispatch=N;
A.scatter=u;
A.legend=i;
A.controls=v;
A.xAxis=r;
A.yAxis=f;
A.distX=B;
A.distY=z;
d3.rebind(A,u,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi");
A.margin=function(x){if(!arguments.length){return C
}C.top=typeof x.top!="undefined"?x.top:C.top;
C.right=typeof x.right!="undefined"?x.right:C.right;
C.bottom=typeof x.bottom!="undefined"?x.bottom:C.bottom;
C.left=typeof x.left!="undefined"?x.left:C.left;
return A
};
A.width=function(x){if(!arguments.length){return H
}H=x;
return A
};
A.height=function(x){if(!arguments.length){return D
}D=x;
return A
};
A.color=function(x){if(!arguments.length){return I
}I=c.utils.getColor(x);
i.color(I);
B.color(I);
z.color(I);
return A
};
A.showDistX=function(x){if(!arguments.length){return e
}e=x;
return A
};
A.showDistY=function(x){if(!arguments.length){return O
}O=x;
return A
};
A.showControls=function(x){if(!arguments.length){return M
}M=x;
return A
};
A.showLegend=function(x){if(!arguments.length){return L
}L=x;
return A
};
A.fisheye=function(x){if(!arguments.length){return G
}G=x;
return A
};
A.xPadding=function(x){if(!arguments.length){return w
}w=x;
return A
};
A.yPadding=function(x){if(!arguments.length){return g
}g=x;
return A
};
A.tooltips=function(x){if(!arguments.length){return h
}h=x;
return A
};
A.tooltipContent=function(x){if(!arguments.length){return o
}o=x;
return A
};
A.tooltipXContent=function(x){if(!arguments.length){return F
}F=x;
return A
};
A.tooltipYContent=function(x){if(!arguments.length){return E
}E=x;
return A
};
A.state=function(x){if(!arguments.length){return n
}n=x;
return A
};
A.defaultState=function(x){if(!arguments.length){return p
}p=x;
return A
};
A.noData=function(x){if(!arguments.length){return m
}m=x;
return A
};
return A
};
c.models.scatterPlusLineChart=function(){var t=c.models.scatter(),q=c.models.axis(),f=c.models.axis(),h=c.models.legend(),u=c.models.legend(),z=c.models.distribution(),v=c.models.distribution();
var A={top:30,right:20,bottom:50,left:75},F=null,B=null,G=c.utils.defaultColor(),s=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):t.xScale(),r=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):t.yScale(),e=false,M=false,J=true,K=!!d3.fisheye,E=0,H=false,g=true,D=function(O,N,P){return"<strong>"+N+"</strong>"
},C=function(O,N,P){return"<strong>"+P+"</strong>"
},n=function(P,N,Q,O){return"<h3>"+P+"</h3><p>"+O+"</p>"
},m={},o=null,L=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),l="No Data Available.";
t.xScale(s).yScale(r);
q.orient("bottom").tickPadding(10);
f.orient("left").tickPadding(10);
z.axis("x");
v.axis("y");
var I,i;
var j=function(Q,T){var O=Q.pos[0]+(T.offsetLeft||0),S=Q.pos[1]+(T.offsetTop||0),P=Q.pos[0]+(T.offsetLeft||0),y=r.range()[0]+A.top+(T.offsetTop||0),N=s.range()[0]+A.left+(T.offsetLeft||0),x=Q.pos[1]+(T.offsetTop||0),U=q.tickFormat()(t.x()(Q.point,Q.pointIndex)),R=f.tickFormat()(t.y()(Q.point,Q.pointIndex));
if(D!=null){c.tooltip.show([P,y],D(Q.series.key,U,R,Q,w),"n",1,T,"x-nvtooltip")
}if(C!=null){c.tooltip.show([N,x],C(Q.series.key,U,R,Q,w),"e",1,T,"y-nvtooltip")
}if(n!=null){c.tooltip.show([O,S],n(Q.series.key,U,R,Q.point.tooltip,Q,w),Q.value<0?"n":"s",null,T)
}};
var p=[{key:"Magnify",disabled:true}];
function w(x){x.each(function(U){var O=d3.select(this),W=this;
var Z=(F||parseInt(O.style("width"))||960)-A.left-A.right,R=(B||parseInt(O.style("height"))||400)-A.top-A.bottom;
w.update=function(){w(x)
};
w.container=this;
m.disabled=U.map(function(aa){return !!aa.disabled
});
if(!o){var Y;
o={};
for(Y in m){if(m[Y] instanceof Array){o[Y]=m[Y].slice(0)
}else{o[Y]=m[Y]
}}}if(!U||!U.length||!U.filter(function(aa){return aa.values.length
}).length){var P=O.selectAll(".nv-noData").data([l]);
P.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
P.attr("x",A.left+Z/2).attr("y",A.top+R/2).text(function(aa){return aa
});
return w
}else{O.selectAll(".nv-noData").remove()
}s=t.xScale();
r=t.yScale();
I=I||s;
i=i||r;
var Q=O.selectAll("g.nv-wrap.nv-scatterChart").data([U]);
var S=Q.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+t.id());
var y=S.append("g");
var V=Q.select("g");
y.append("rect").attr("class","nvd3 nv-background");
y.append("g").attr("class","nv-x nv-axis");
y.append("g").attr("class","nv-y nv-axis");
y.append("g").attr("class","nv-scatterWrap");
y.append("g").attr("class","nv-regressionLinesWrap");
y.append("g").attr("class","nv-distWrap");
y.append("g").attr("class","nv-legendWrap");
y.append("g").attr("class","nv-controlsWrap");
Q.attr("transform","translate("+A.left+","+A.top+")");
if(J){h.width(Z/2);
Q.select(".nv-legendWrap").datum(U).call(h);
if(A.top!=h.height()){A.top=h.height();
R=(B||parseInt(O.style("height"))||400)-A.top-A.bottom
}Q.select(".nv-legendWrap").attr("transform","translate("+(Z/2)+","+(-A.top)+")")
}if(K){u.width(180).color(["#444"]);
V.select(".nv-controlsWrap").datum(p).attr("transform","translate(0,"+(-A.top)+")").call(u)
}t.width(Z).height(R).color(U.map(function(ab,aa){return ab.color||G(ab,aa)
}).filter(function(ab,aa){return !U[aa].disabled
}));
Q.select(".nv-scatterWrap").datum(U.filter(function(aa){return !aa.disabled
})).call(t);
Q.select(".nv-regressionLinesWrap").attr("clip-path","url(#nv-edge-clip-"+t.id()+")");
var T=Q.select(".nv-regressionLinesWrap").selectAll(".nv-regLines").data(function(aa){return aa
});
var X=T.enter().append("g").attr("class","nv-regLines").append("line").attr("class","nv-regLine").style("stroke-opacity",0);
T.selectAll(".nv-regLines line").attr("x1",s.range()[0]).attr("x2",s.range()[1]).attr("y1",function(ab,aa){return r(s.domain()[0]*ab.slope+ab.intercept)
}).attr("y2",function(ab,aa){return r(s.domain()[1]*ab.slope+ab.intercept)
}).style("stroke",function(ac,ab,aa){return G(ac,aa)
}).style("stroke-opacity",function(ab,aa){return(ab.disabled||typeof ab.slope==="undefined"||typeof ab.intercept==="undefined")?0:1
});
q.scale(s).ticks(q.ticks()?q.ticks():Z/100).tickSize(-R,0);
V.select(".nv-x.nv-axis").attr("transform","translate(0,"+r.range()[0]+")").call(q);
f.scale(r).ticks(f.ticks()?f.ticks():R/36).tickSize(-Z,0);
V.select(".nv-y.nv-axis").call(f);
if(e){z.getData(t.x()).scale(s).width(Z).color(U.map(function(ab,aa){return ab.color||G(ab,aa)
}).filter(function(ab,aa){return !U[aa].disabled
}));
y.select(".nv-distWrap").append("g").attr("class","nv-distributionX");
V.select(".nv-distributionX").attr("transform","translate(0,"+r.range()[0]+")").datum(U.filter(function(aa){return !aa.disabled
})).call(z)
}if(M){v.getData(t.y()).scale(r).width(R).color(U.map(function(ab,aa){return ab.color||G(ab,aa)
}).filter(function(ab,aa){return !U[aa].disabled
}));
y.select(".nv-distWrap").append("g").attr("class","nv-distributionY");
V.select(".nv-distributionY").attr("transform","translate(-"+v.size()+",0)").datum(U.filter(function(aa){return !aa.disabled
})).call(v)
}if(d3.fisheye){V.select(".nv-background").attr("width",Z).attr("height",R);
V.select(".nv-background").on("mousemove",N);
V.select(".nv-background").on("click",function(){H=!H
});
t.dispatch.on("elementClick.freezeFisheye",function(){H=!H
})
}function N(){if(H){V.select(".nv-point-paths").style("pointer-events","all");
return false
}V.select(".nv-point-paths").style("pointer-events","none");
var aa=d3.mouse(this);
s.distortion(E).focus(aa[0]);
r.distortion(E).focus(aa[1]);
V.select(".nv-scatterWrap").datum(U.filter(function(ab){return !ab.disabled
})).call(t);
V.select(".nv-x.nv-axis").call(q);
V.select(".nv-y.nv-axis").call(f);
V.select(".nv-distributionX").datum(U.filter(function(ab){return !ab.disabled
})).call(z);
V.select(".nv-distributionY").datum(U.filter(function(ab){return !ab.disabled
})).call(v)
}u.dispatch.on("legendClick",function(ab,aa){ab.disabled=!ab.disabled;
E=ab.disabled?0:2.5;
V.select(".nv-background").style("pointer-events",ab.disabled?"none":"all");
V.select(".nv-point-paths").style("pointer-events",ab.disabled?"all":"none");
if(ab.disabled){s.distortion(E).focus(0);
r.distortion(E).focus(0);
V.select(".nv-scatterWrap").call(t);
V.select(".nv-x.nv-axis").call(q);
V.select(".nv-y.nv-axis").call(f)
}else{H=false
}w(x)
});
h.dispatch.on("legendClick",function(ac,aa,ab){ac.disabled=!ac.disabled;
if(!U.filter(function(ad){return !ad.disabled
}).length){U.map(function(ad){ad.disabled=false;
Q.selectAll(".nv-series").classed("disabled",false);
return ad
})
}m.disabled=U.map(function(ad){return !!ad.disabled
});
L.stateChange(m);
w(x)
});
t.dispatch.on("elementMouseover.tooltip",function(aa){d3.select(".nv-chart-"+t.id()+" .nv-series-"+aa.seriesIndex+" .nv-distx-"+aa.pointIndex).attr("y1",aa.pos[1]-R);
d3.select(".nv-chart-"+t.id()+" .nv-series-"+aa.seriesIndex+" .nv-disty-"+aa.pointIndex).attr("x2",aa.pos[0]+z.size());
aa.pos=[aa.pos[0]+A.left,aa.pos[1]+A.top];
L.tooltipShow(aa)
});
L.on("tooltipShow",function(aa){if(g){j(aa,W.parentNode)
}});
L.on("changeState",function(aa){if(typeof aa.disabled!=="undefined"){U.forEach(function(ac,ab){ac.disabled=aa.disabled[ab]
});
m.disabled=aa.disabled
}x.call(w)
});
I=s.copy();
i=r.copy()
});
return w
}t.dispatch.on("elementMouseout.tooltip",function(x){L.tooltipHide(x);
d3.select(".nv-chart-"+t.id()+" .nv-series-"+x.seriesIndex+" .nv-distx-"+x.pointIndex).attr("y1",0);
d3.select(".nv-chart-"+t.id()+" .nv-series-"+x.seriesIndex+" .nv-disty-"+x.pointIndex).attr("x2",v.size())
});
L.on("tooltipHide",function(){if(g){c.tooltip.cleanup()
}});
w.dispatch=L;
w.scatter=t;
w.legend=h;
w.controls=u;
w.xAxis=q;
w.yAxis=f;
w.distX=z;
w.distY=v;
d3.rebind(w,t,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi");
w.margin=function(x){if(!arguments.length){return A
}A.top=typeof x.top!="undefined"?x.top:A.top;
A.right=typeof x.right!="undefined"?x.right:A.right;
A.bottom=typeof x.bottom!="undefined"?x.bottom:A.bottom;
A.left=typeof x.left!="undefined"?x.left:A.left;
return w
};
w.width=function(x){if(!arguments.length){return F
}F=x;
return w
};
w.height=function(x){if(!arguments.length){return B
}B=x;
return w
};
w.color=function(x){if(!arguments.length){return G
}G=c.utils.getColor(x);
h.color(G);
z.color(G);
v.color(G);
return w
};
w.showDistX=function(x){if(!arguments.length){return e
}e=x;
return w
};
w.showDistY=function(x){if(!arguments.length){return M
}M=x;
return w
};
w.showControls=function(x){if(!arguments.length){return K
}K=x;
return w
};
w.showLegend=function(x){if(!arguments.length){return J
}J=x;
return w
};
w.fisheye=function(x){if(!arguments.length){return E
}E=x;
return w
};
w.tooltips=function(x){if(!arguments.length){return g
}g=x;
return w
};
w.tooltipContent=function(x){if(!arguments.length){return n
}n=x;
return w
};
w.tooltipXContent=function(x){if(!arguments.length){return D
}D=x;
return w
};
w.tooltipYContent=function(x){if(!arguments.length){return C
}C=x;
return w
};
w.state=function(x){if(!arguments.length){return m
}m=x;
return w
};
w.defaultState=function(x){if(!arguments.length){return o
}o=x;
return w
};
w.noData=function(x){if(!arguments.length){return l
}l=x;
return w
};
return w
};
c.models.sparkline=function(){var i={top:2,right:0,bottom:2,left:0},f=400,q=32,g=true,n=d3.scale.linear(),m=d3.scale.linear(),p=function(r){return r.x
},o=function(r){return r.y
},h=c.utils.getColor(["#000"]),j,e;
function l(r){r.each(function(x){var A=f-i.left-i.right,v=q-i.top-i.bottom,t=d3.select(this);
n.domain(j||d3.extent(x,p)).range([0,A]);
m.domain(e||d3.extent(x,o)).range([v,0]);
var u=t.selectAll("g.nv-wrap.nv-sparkline").data([x]);
var w=u.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline");
var s=w.append("g");
var y=u.select("g");
u.attr("transform","translate("+i.left+","+i.top+")");
var B=u.selectAll("path").data(function(C){return[C]
});
B.enter().append("path");
B.exit().remove();
B.style("stroke",function(D,C){return D.color||h(D,C)
}).attr("d",d3.svg.line().x(function(D,C){return n(p(D,C))
}).y(function(D,C){return m(o(D,C))
}));
var z=u.selectAll("circle.nv-point").data(function(G){var E=G.map(function(J,I){return o(J,I)
});
function F(J){if(J!=-1){var I=G[J];
I.pointIndex=J;
return I
}else{return null
}}var D=F(E.lastIndexOf(m.domain()[1])),C=F(E.indexOf(m.domain()[0])),H=F(E.length-1);
return[C,D,H].filter(function(I){return I!=null
})
});
z.enter().append("circle");
z.exit().remove();
z.attr("cx",function(D,C){return n(p(D,D.pointIndex))
}).attr("cy",function(D,C){return m(o(D,D.pointIndex))
}).attr("r",2).attr("class",function(D,C){return p(D,D.pointIndex)==n.domain()[1]?"nv-point nv-currentValue":o(D,D.pointIndex)==m.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"
})
});
return l
}l.margin=function(r){if(!arguments.length){return i
}i.top=typeof r.top!="undefined"?r.top:i.top;
i.right=typeof r.right!="undefined"?r.right:i.right;
i.bottom=typeof r.bottom!="undefined"?r.bottom:i.bottom;
i.left=typeof r.left!="undefined"?r.left:i.left;
return l
};
l.width=function(r){if(!arguments.length){return f
}f=r;
return l
};
l.height=function(r){if(!arguments.length){return q
}q=r;
return l
};
l.x=function(r){if(!arguments.length){return p
}p=d3.functor(r);
return l
};
l.y=function(r){if(!arguments.length){return o
}o=d3.functor(r);
return l
};
l.xScale=function(r){if(!arguments.length){return n
}n=r;
return l
};
l.yScale=function(r){if(!arguments.length){return m
}m=r;
return l
};
l.xDomain=function(r){if(!arguments.length){return j
}j=r;
return l
};
l.yDomain=function(r){if(!arguments.length){return e
}e=r;
return l
};
l.animate=function(r){if(!arguments.length){return g
}g=r;
return l
};
l.color=function(r){if(!arguments.length){return h
}h=c.utils.getColor(r);
return l
};
return l
};
c.models.sparklinePlus=function(){var q=c.models.sparkline();
var f={top:15,right:100,bottom:10,left:50},e=null,s=null,n,m,j=[],r=false,p=d3.format(",r"),i=d3.format(",.2f"),h=true,t=true,g=false,o="No Data Available.";
function l(u){u.each(function(C){var w=d3.select(this);
var J=(e||parseInt(w.style("width"))||960)-f.left-f.right,z=(s||parseInt(w.style("height"))||400)-f.top-f.bottom;
l.update=function(){l(u)
};
l.container=this;
if(!C||!C.length){var x=w.selectAll(".nv-noData").data([o]);
x.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
x.attr("x",f.left+J/2).attr("y",f.top+z/2).text(function(K){return K
});
return l
}else{w.selectAll(".nv-noData").remove()
}var I=q.y()(C[C.length-1],C.length-1);
n=q.xScale();
m=q.yScale();
var y=w.selectAll("g.nv-wrap.nv-sparklineplus").data([C]);
var A=y.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus");
var v=A.append("g");
var D=y.select("g");
v.append("g").attr("class","nv-sparklineWrap");
v.append("g").attr("class","nv-valueWrap");
v.append("g").attr("class","nv-hoverArea");
y.attr("transform","translate("+f.left+","+f.top+")");
var E=D.select(".nv-sparklineWrap");
q.width(J).height(z);
E.call(q);
var G=D.select(".nv-valueWrap");
var H=G.selectAll(".nv-currentValue").data([I]);
H.enter().append("text").attr("class","nv-currentValue").attr("dx",g?-8:8).attr("dy",".9em").style("text-anchor",g?"end":"start");
H.attr("x",J+(g?f.right:0)).attr("y",t?function(K){return m(K)
}:0).style("fill",q.color()(C[C.length-1],C.length-1)).text(i(I));
v.select(".nv-hoverArea").append("rect").on("mousemove",B).on("click",function(){r=!r
}).on("mouseout",function(){j=[];
F()
});
D.select(".nv-hoverArea rect").attr("transform",function(K){return"translate("+-f.left+","+-f.top+")"
}).attr("width",J+f.left+f.right).attr("height",z+f.top);
function F(){if(r){return
}var L=D.selectAll(".nv-hoverValue").data(j);
var K=L.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);
L.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove();
L.attr("transform",function(M){return"translate("+n(q.x()(C[M],M))+",0)"
}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1);
if(!j.length){return
}K.append("line").attr("x1",0).attr("y1",-f.top).attr("x2",0).attr("y2",z);
K.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-f.top).attr("text-anchor","end").attr("dy",".9em");
D.select(".nv-hoverValue .nv-xValue").text(p(q.x()(C[j[0]],j[0])));
K.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-f.top).attr("text-anchor","start").attr("dy",".9em");
D.select(".nv-hoverValue .nv-yValue").text(i(q.y()(C[j[0]],j[0])))
}function B(){if(r){return
}var L=d3.mouse(this)[0]-f.left;
function K(P,M){var Q=Math.abs(q.x()(P[0],0)-M);
var O=0;
for(var N=0;
N<P.length;
N++){if(Math.abs(q.x()(P[N],N)-M)<Q){Q=Math.abs(q.x()(P[N],N)-M);
O=N
}}return O
}j=[K(C,Math.round(n.invert(L)))];
F()
}});
return l
}l.sparkline=q;
d3.rebind(l,q,"x","y","xScale","yScale","color");
l.margin=function(u){if(!arguments.length){return f
}f.top=typeof u.top!="undefined"?u.top:f.top;
f.right=typeof u.right!="undefined"?u.right:f.right;
f.bottom=typeof u.bottom!="undefined"?u.bottom:f.bottom;
f.left=typeof u.left!="undefined"?u.left:f.left;
return l
};
l.width=function(u){if(!arguments.length){return e
}e=u;
return l
};
l.height=function(u){if(!arguments.length){return s
}s=u;
return l
};
l.xTickFormat=function(u){if(!arguments.length){return p
}p=u;
return l
};
l.yTickFormat=function(u){if(!arguments.length){return i
}i=u;
return l
};
l.showValue=function(u){if(!arguments.length){return h
}h=u;
return l
};
l.alignValue=function(u){if(!arguments.length){return t
}t=u;
return l
};
l.rightAlignValue=function(u){if(!arguments.length){return g
}g=u;
return l
};
l.noData=function(u){if(!arguments.length){return o
}o=u;
return l
};
return l
};
c.models.stackedArea=function(){var j={top:0,right:0,bottom:0,left:0},h=960,v=500,l=c.utils.defaultColor(),g=Math.floor(Math.random()*100000),u=function(w){return w.x
},t=function(w){return w.y
},f="stack",m="zero",i="default",o="linear",s=false,r,q,e=c.models.scatter(),n=d3.dispatch("tooltipShow","tooltipHide","areaClick","areaMouseover","areaMouseout");
e.size(2.2).sizeDomain([2.2,2.2]);
function p(w){w.each(function(F){var I=h-j.left-j.right,C=v-j.top-j.bottom,y=d3.select(this);
r=e.xScale();
q=e.yScale();
F=F.map(function(K,L){K.values=K.values.map(function(N,M){N.index=M;
N.stackedY=K.disabled?0:t(N,M);
return N
});
return K
});
F=d3.layout.stack().order(i).offset(m).values(function(K){return K.values
}).x(u).y(function(K){return K.stackedY
}).out(function(L,K,M){L.display={y:M,y0:K}
})(F);
var A=y.selectAll("g.nv-wrap.nv-stackedarea").data([F]);
var E=A.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea");
var D=E.append("defs");
var x=E.append("g");
var G=A.select("g");
x.append("g").attr("class","nv-areaWrap");
x.append("g").attr("class","nv-scatterWrap");
A.attr("transform","translate("+j.left+","+j.top+")");
e.width(I).height(C).x(u).y(function(K){return K.display.y+K.display.y0
}).forceY([0]).color(F.map(function(L,K){return L.color||l(L,K)
}).filter(function(L,K){return !F[K].disabled
}));
var B=G.select(".nv-scatterWrap").datum(F.filter(function(K){return !K.disabled
}));
B.call(e);
D.append("clipPath").attr("id","nv-edge-clip-"+g).append("rect");
A.select("#nv-edge-clip-"+g+" rect").attr("width",I).attr("height",C);
G.attr("clip-path",s?"url(#nv-edge-clip-"+g+")":"");
var z=d3.svg.area().x(function(L,K){return r(u(L,K))
}).y0(function(K){return q(K.display.y0)
}).y1(function(K){return q(K.display.y+K.display.y0)
}).interpolate(o);
var H=d3.svg.area().x(function(L,K){return r(u(L,K))
}).y0(function(K){return q(K.display.y0)
}).y1(function(K){return q(K.display.y0)
});
var J=G.select(".nv-areaWrap").selectAll("path.nv-area").data(function(K){return K
});
J.enter().append("path").attr("class",function(L,K){return"nv-area nv-area-"+K
}).on("mouseover",function(L,K){d3.select(this).classed("hover",true);
n.areaMouseover({point:L,series:L.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:K})
}).on("mouseout",function(L,K){d3.select(this).classed("hover",false);
n.areaMouseout({point:L,series:L.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:K})
}).on("click",function(L,K){d3.select(this).classed("hover",false);
n.areaClick({point:L,series:L.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:K})
});
J.exit().attr("d",function(L,K){return H(L.values,K)
}).remove();
J.style("fill",function(L,K){return L.color||l(L,K)
}).style("stroke",function(L,K){return L.color||l(L,K)
});
J.attr("d",function(L,K){return z(L.values,K)
});
e.dispatch.on("elementMouseover.area",function(K){G.select(".nv-chart-"+g+" .nv-area-"+K.seriesIndex).classed("hover",true)
});
e.dispatch.on("elementMouseout.area",function(K){G.select(".nv-chart-"+g+" .nv-area-"+K.seriesIndex).classed("hover",false)
})
});
return p
}e.dispatch.on("elementClick.area",function(w){n.areaClick(w)
});
e.dispatch.on("elementMouseover.tooltip",function(w){w.pos=[w.pos[0]+j.left,w.pos[1]+j.top],n.tooltipShow(w)
});
e.dispatch.on("elementMouseout.tooltip",function(w){n.tooltipHide(w)
});
p.dispatch=n;
p.scatter=e;
d3.rebind(p,e,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","forceX","forceY","forceSize","clipVoronoi","clipRadius");
p.x=function(w){if(!arguments.length){return u
}u=d3.functor(w);
return p
};
p.y=function(w){if(!arguments.length){return t
}t=d3.functor(w);
return p
};
p.margin=function(w){if(!arguments.length){return j
}j.top=typeof w.top!="undefined"?w.top:j.top;
j.right=typeof w.right!="undefined"?w.right:j.right;
j.bottom=typeof w.bottom!="undefined"?w.bottom:j.bottom;
j.left=typeof w.left!="undefined"?w.left:j.left;
return p
};
p.width=function(w){if(!arguments.length){return h
}h=w;
return p
};
p.height=function(w){if(!arguments.length){return v
}v=w;
return p
};
p.clipEdge=function(w){if(!arguments.length){return s
}s=w;
return p
};
p.color=function(w){if(!arguments.length){return l
}l=c.utils.getColor(w);
return p
};
p.offset=function(w){if(!arguments.length){return m
}m=w;
return p
};
p.order=function(w){if(!arguments.length){return i
}i=w;
return p
};
p.style=function(w){if(!arguments.length){return f
}f=w;
switch(f){case"stack":p.offset("zero");
p.order("default");
break;
case"stream":p.offset("wiggle");
p.order("inside-out");
break;
case"stream-center":p.offset("silhouette");
p.order("inside-out");
break;
case"expand":p.offset("expand");
p.order("default");
break
}return p
};
p.interpolate=function(w){if(!arguments.length){return o
}o=w;
return o
};
return p
};
c.models.stackedAreaChart=function(){var B=c.models.stackedArea(),p=c.models.axis(),f=c.models.axis(),h=c.models.legend(),s=c.models.legend();
var u={top:30,right:25,bottom:50,left:60},w=null,v=null,z=c.utils.defaultColor(),C=true,A=true,g=true,m=function(F,E,I,H,G){return"<h3>"+F+"</h3><p>"+I+" on "+E+"</p>"
},r,q,l=d3.format(",.2f"),n={style:B.style()},o=null,j="No Data Available.",D=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),e=250;
p.orient("bottom").tickPadding(7);
f.orient("left");
B.scatter.pointActive(function(x){return !!Math.round(B.y()(x)*100)
});
var i=function(J,F){var I=J.pos[0]+(F.offsetLeft||0),H=J.pos[1]+(F.offsetTop||0),E=p.tickFormat()(B.x()(J.point,J.pointIndex)),K=f.tickFormat()(B.y()(J.point,J.pointIndex)),G=m(J.series.key,E,K,J,t);
c.tooltip.show([I,H],G,J.value<0?"n":"s",null,F)
};
function t(x){x.each(function(I){var E=d3.select(this),L=this;
var O=(w||parseInt(E.style("width"))||960)-u.left-u.right,H=(v||parseInt(E.style("height"))||400)-u.top-u.bottom;
t.update=function(){t(x)
};
t.container=this;
n.disabled=I.map(function(P){return !!P.disabled
});
if(!o){var N;
o={};
for(N in n){if(n[N] instanceof Array){o[N]=n[N].slice(0)
}else{o[N]=n[N]
}}}if(!I||!I.length||!I.filter(function(P){return P.values.length
}).length){var F=E.selectAll(".nv-noData").data([j]);
F.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");
F.attr("x",u.left+O/2).attr("y",u.top+H/2).text(function(P){return P
});
return t
}else{E.selectAll(".nv-noData").remove()
}r=B.xScale();
q=B.yScale();
var G=E.selectAll("g.nv-wrap.nv-stackedAreaChart").data([I]);
var y=G.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g");
var J=G.select("g");
y.append("g").attr("class","nv-x nv-axis");
y.append("g").attr("class","nv-y nv-axis");
y.append("g").attr("class","nv-stackedWrap");
y.append("g").attr("class","nv-legendWrap");
y.append("g").attr("class","nv-controlsWrap");
if(A){h.width(O-e);
J.select(".nv-legendWrap").datum(I).call(h);
if(u.top!=h.height()){u.top=h.height();
H=(v||parseInt(E.style("height"))||400)-u.top-u.bottom
}J.select(".nv-legendWrap").attr("transform","translate("+e+","+(-u.top)+")")
}if(C){var M=[{key:"Stacked",disabled:B.offset()!="zero"},{key:"Stream",disabled:B.offset()!="wiggle"},{key:"Expanded",disabled:B.offset()!="expand"}];
s.width(e).color(["#444","#444","#444"]);
J.select(".nv-controlsWrap").datum(M).call(s);
if(u.top!=Math.max(s.height(),h.height())){u.top=Math.max(s.height(),h.height());
H=(v||parseInt(E.style("height"))||400)-u.top-u.bottom
}J.select(".nv-controlsWrap").attr("transform","translate(0,"+(-u.top)+")")
}G.attr("transform","translate("+u.left+","+u.top+")");
B.width(O).height(H);
var K=J.select(".nv-stackedWrap").datum(I);
K.call(B);
p.scale(r).ticks(O/100).tickSize(-H,0);
J.select(".nv-x.nv-axis").attr("transform","translate(0,"+H+")");
J.select(".nv-x.nv-axis").transition().duration(0).call(p);
f.scale(q).ticks(B.offset()=="wiggle"?0:H/36).tickSize(-O,0).setTickFormat(B.offset()=="expand"?d3.format("%"):l);
J.select(".nv-y.nv-axis").transition().duration(0).call(f);
B.dispatch.on("areaClick.toggle",function(P){if(I.filter(function(Q){return !Q.disabled
}).length===1){I=I.map(function(Q){Q.disabled=false;
return Q
})
}else{I=I.map(function(R,Q){R.disabled=(Q!=P.seriesIndex);
return R
})
}n.disabled=I.map(function(Q){return !!Q.disabled
});
D.stateChange(n);
t(x)
});
h.dispatch.on("legendClick",function(Q,P){Q.disabled=!Q.disabled;
if(!I.filter(function(R){return !R.disabled
}).length){I.map(function(R){R.disabled=false;
return R
})
}n.disabled=I.map(function(R){return !!R.disabled
});
D.stateChange(n);
t(x)
});
s.dispatch.on("legendClick",function(Q,P){if(!Q.disabled){return
}M=M.map(function(R){R.disabled=true;
return R
});
Q.disabled=false;
switch(Q.key){case"Stacked":B.style("stack");
break;
case"Stream":B.style("stream");
break;
case"Expanded":B.style("expand");
break
}n.style=B.style();
D.stateChange(n);
t(x)
});
D.on("tooltipShow",function(P){if(g){i(P,L.parentNode)
}});
D.on("changeState",function(P){if(typeof P.disabled!=="undefined"){I.forEach(function(R,Q){R.disabled=P.disabled[Q]
});
n.disabled=P.disabled
}if(typeof P.style!=="undefined"){B.style(P.style)
}x.call(t)
})
});
return t
}B.dispatch.on("tooltipShow",function(x){x.pos=[x.pos[0]+u.left,x.pos[1]+u.top],D.tooltipShow(x)
});
B.dispatch.on("tooltipHide",function(x){D.tooltipHide(x)
});
D.on("tooltipHide",function(){if(g){c.tooltip.cleanup()
}});
t.dispatch=D;
t.stacked=B;
t.legend=h;
t.controls=s;
t.xAxis=p;
t.yAxis=f;
d3.rebind(t,B,"x","y","size","xScale","yScale","xDomain","yDomain","sizeDomain","interactive","offset","order","style","clipEdge","forceX","forceY","forceSize","interpolate");
t.margin=function(x){if(!arguments.length){return u
}u.top=typeof x.top!="undefined"?x.top:u.top;
u.right=typeof x.right!="undefined"?x.right:u.right;
u.bottom=typeof x.bottom!="undefined"?x.bottom:u.bottom;
u.left=typeof x.left!="undefined"?x.left:u.left;
return t
};
t.width=function(x){if(!arguments.length){return getWidth
}w=x;
return t
};
t.height=function(x){if(!arguments.length){return getHeight
}v=x;
return t
};
t.color=function(x){if(!arguments.length){return z
}z=c.utils.getColor(x);
h.color(z);
B.color(z);
return t
};
t.showControls=function(x){if(!arguments.length){return C
}C=x;
return t
};
t.showLegend=function(x){if(!arguments.length){return A
}A=x;
return t
};
t.tooltip=function(x){if(!arguments.length){return m
}m=x;
return t
};
t.tooltips=function(x){if(!arguments.length){return g
}g=x;
return t
};
t.tooltipContent=function(x){if(!arguments.length){return m
}m=x;
return t
};
t.state=function(x){if(!arguments.length){return n
}n=x;
return t
};
t.defaultState=function(x){if(!arguments.length){return o
}o=x;
return t
};
t.noData=function(x){if(!arguments.length){return j
}j=x;
return t
};
f.setTickFormat=f.tickFormat;
f.tickFormat=function(x){if(!arguments.length){return l
}l=x;
return f
};
return t
}
})();var Handsontable={extension:{},helper:{}};
(function($,window,Handsontable){Handsontable.Core=function(rootElement,settings){this.rootElement=rootElement;
this.guid="ht_"+Handsontable.helper.randomString();
if(!this.rootElement[0].id){this.rootElement[0].id=this.guid
}var priv,datamap,grid,selection,editproxy,autofill,self=this;
priv={settings:{},settingsFromDOM:{},selStart:(new Handsontable.SelectionPoint()),selEnd:(new Handsontable.SelectionPoint()),editProxy:false,isPopulated:null,scrollable:null,undoRedo:null,extensions:{},colToProp:null,propToCol:null,dataSchema:null,dataType:"array",firstRun:true};
datamap={recursiveDuckSchema:function(obj){var schema;
if($.isPlainObject(obj)){schema={};
for(var i in obj){if(obj.hasOwnProperty(i)){if($.isPlainObject(obj[i])){schema[i]=datamap.recursiveDuckSchema(obj[i])
}else{schema[i]=null
}}}}else{schema=[]
}return schema
},recursiveDuckColumns:function(schema,lastCol,parent){var prop,i;
if(typeof lastCol==="undefined"){lastCol=0;
parent=""
}if($.isPlainObject(schema)){for(i in schema){if(schema.hasOwnProperty(i)){if(schema[i]===null){prop=parent+i;
priv.colToProp.push(prop);
priv.propToCol[prop]=lastCol;
lastCol++
}else{lastCol=datamap.recursiveDuckColumns(schema[i],lastCol,i+".")
}}}}return lastCol
},createMap:function(){if(typeof datamap.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")
}var i,ilen,schema=datamap.getSchema();
priv.colToProp=[];
priv.propToCol={};
if(priv.settings.columns){for(i=0,ilen=priv.settings.columns.length;
i<ilen;
i++){priv.colToProp[i]=priv.settings.columns[i].data;
priv.propToCol[priv.settings.columns[i].data]=i
}}else{datamap.recursiveDuckColumns(schema)
}},colToProp:function(col){col=Handsontable.PluginModifiers.run(self,"col",col);
if(priv.colToProp&&typeof priv.colToProp[col]!=="undefined"){return priv.colToProp[col]
}else{return col
}},propToCol:function(prop){var col;
if(typeof priv.propToCol[prop]!=="undefined"){col=priv.propToCol[prop]
}else{col=prop
}col=Handsontable.PluginModifiers.run(self,"col",col);
return col
},getSchema:function(){if(priv.settings.dataSchema){if(typeof priv.settings.dataSchema==="function"){return priv.settings.dataSchema()
}return priv.settings.dataSchema
}return priv.duckDataSchema
},createRow:function(index){var row,rowCount=self.countRows();
if(typeof index!=="number"||index>=rowCount){index=rowCount
}if(priv.dataType==="array"){row=[];
for(var c=0,clen=self.countCols();
c<clen;
c++){row.push(null)
}}else{if(priv.dataType==="function"){row=priv.settings.dataSchema(index)
}else{row=$.extend(true,{},datamap.getSchema())
}}if(priv.settings.onCreateRow){priv.settings.onCreateRow(index,row)
}if(index===rowCount){priv.settings.data.push(row)
}else{priv.settings.data.splice(index,0,row)
}self.forceFullRender=true
},createCol:function(index){if(priv.dataType==="object"||priv.settings.columns){throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting")
}var r=0,rlen=self.countRows();
if(typeof index!=="number"||index>=self.countCols()){for(;
r<rlen;
r++){if(typeof priv.settings.data[r]==="undefined"){priv.settings.data[r]=[]
}priv.settings.data[r].push("")
}}else{for(;
r<rlen;
r++){priv.settings.data[r].splice(index,0,"")
}}self.forceFullRender=true
},removeRow:function(index,amount){if(!amount){amount=1
}if(typeof index!=="number"){index=-amount
}priv.settings.data.splice(index,amount);
self.forceFullRender=true
},removeCol:function(index,amount){if(priv.dataType==="object"||priv.settings.columns){throw new Error("cannot remove column with object data source or columns option specified")
}if(!amount){amount=1
}if(typeof index!=="number"){index=-amount
}for(var r=0,rlen=self.countRows();
r<rlen;
r++){priv.settings.data[r].splice(index,amount)
}self.forceFullRender=true
},getVars:{},get:function(row,prop){datamap.getVars.row=row;
datamap.getVars.prop=prop;
Handsontable.PluginHooks.run(self,"beforeGet",datamap.getVars);
if(typeof datamap.getVars.prop==="string"&&datamap.getVars.prop.indexOf(".")>-1){var sliced=datamap.getVars.prop.split(".");
var out=priv.settings.data[datamap.getVars.row];
if(!out){return null
}for(var i=0,ilen=sliced.length;
i<ilen;
i++){out=out[sliced[i]];
if(typeof out==="undefined"){return null
}}return out
}else{if(typeof datamap.getVars.prop==="function"){return datamap.getVars.prop(priv.settings.data.slice(datamap.getVars.row,datamap.getVars.row+1)[0])
}else{return priv.settings.data[datamap.getVars.row]?priv.settings.data[datamap.getVars.row][datamap.getVars.prop]:null
}}},setVars:{},set:function(row,prop,value){datamap.setVars.row=row;
datamap.setVars.prop=prop;
datamap.setVars.value=value;
Handsontable.PluginHooks.run(self,"beforeSet",datamap.setVars);
if(typeof datamap.setVars.prop==="string"&&datamap.setVars.prop.indexOf(".")>-1){var sliced=datamap.setVars.prop.split(".");
var out=priv.settings.data[datamap.setVars.row];
for(var i=0,ilen=sliced.length-1;
i<ilen;
i++){out=out[sliced[i]]
}out[sliced[i]]=datamap.setVars.value
}else{if(typeof datamap.setVars.prop==="function"){datamap.setVars.prop(priv.settings.data.slice(datamap.setVars.row,datamap.setVars.row+1)[0],datamap.setVars.value)
}else{priv.settings.data[datamap.setVars.row][datamap.setVars.prop]=datamap.setVars.value
}}},clear:function(){for(var r=0;
r<self.countRows();
r++){for(var c=0;
c<self.countCols();
c++){datamap.set(r,datamap.colToProp(c),"")
}}},getAll:function(){return priv.settings.data
},getRange:function(start,end){var r,rlen,c,clen,output=[],row;
rlen=Math.max(start.row,end.row);
clen=Math.max(start.col,end.col);
for(r=Math.min(start.row,end.row);
r<=rlen;
r++){row=[];
for(c=Math.min(start.col,end.col);
c<=clen;
c++){row.push(datamap.get(r,datamap.colToProp(c)))
}output.push(row)
}return output
},getText:function(start,end){return SheetClip.stringify(datamap.getRange(start,end))
}};
grid={alter:function(action,index,amount){var oldData,newData,changes,r,rlen,c,clen,delta;
oldData=$.extend(true,[],datamap.getAll());
switch(action){case"insert_row":if(!amount){amount=1
}delta=0;
while(delta<amount&&self.countRows()<priv.settings.maxRows){datamap.createRow(index);
delta++
}if(delta){if(priv.selStart.exists()&&priv.selStart.row()>=index){priv.selStart.row(priv.selStart.row()+delta);
selection.transformEnd(delta,0)
}else{selection.refreshBorders()
}}break;
case"insert_col":if(!amount){amount=1
}delta=0;
while(delta<amount&&self.countCols()<priv.settings.maxCols){datamap.createCol(index);
delta++
}if(delta){if(priv.selStart.exists()&&priv.selStart.col()>=index){priv.selStart.col(priv.selStart.col()+delta);
selection.transformEnd(0,delta)
}else{selection.refreshBorders()
}}break;
case"remove_row":datamap.removeRow(index,amount);
grid.keepEmptyRows();
selection.refreshBorders();
break;
case"remove_col":datamap.removeCol(index,amount);
grid.keepEmptyRows();
selection.refreshBorders();
break;
default:throw Error('There is no such action "'+action+'"');
break
}changes=[];
newData=datamap.getAll();
for(r=0,rlen=newData.length;
r<rlen;
r++){for(c=0,clen=newData[r].length;
c<clen;
c++){changes.push([r,c,oldData[r]?oldData[r][c]:null,newData[r][c]])
}}fireEvent("datachange.handsontable",[changes,"alter"]);
grid.keepEmptyRows()
},keepEmptyRows:function(){var r,rlen,emptyRows=self.countEmptyRows(true),emptyCols;
rlen=self.countRows();
if(rlen<priv.settings.minRows){for(r=0;
r<priv.settings.minRows-rlen;
r++){datamap.createRow()
}}if(emptyRows<priv.settings.minSpareRows){for(;
emptyRows<priv.settings.minSpareRows&&self.countRows()<priv.settings.maxRows;
emptyRows++){datamap.createRow()
}}emptyCols=self.countEmptyCols(true);
if(!priv.settings.columns&&self.countCols()<priv.settings.minCols){for(;
self.countCols()<priv.settings.minCols;
emptyCols++){datamap.createCol()
}}if(!priv.settings.columns&&priv.dataType==="array"&&emptyCols<priv.settings.minSpareCols){for(;
emptyCols<priv.settings.minSpareCols&&self.countCols()<priv.settings.maxCols;
emptyCols++){datamap.createCol()
}}if(priv.settings.enterBeginsEditing){for(;
(((priv.settings.minRows||priv.settings.minSpareRows)&&self.countRows()>priv.settings.minRows)&&(priv.settings.minSpareRows&&emptyRows>priv.settings.minSpareRows));
emptyRows--){datamap.removeRow()
}}if(priv.settings.enterBeginsEditing&&!priv.settings.columns){for(;
(((priv.settings.minCols||priv.settings.minSpareCols)&&self.countCols()>priv.settings.minCols)&&(priv.settings.minSpareCols&&emptyCols>priv.settings.minSpareCols));
emptyCols--){datamap.removeCol()
}}var rowCount=self.countRows();
var colCount=self.countCols();
if(rowCount===0||colCount===0){selection.deselect()
}if(priv.selStart.exists()){var selectionChanged;
var fromRow=priv.selStart.row();
var fromCol=priv.selStart.col();
var toRow=priv.selEnd.row();
var toCol=priv.selEnd.col();
if(fromRow>rowCount-1){fromRow=rowCount-1;
selectionChanged=true;
if(toRow>fromRow){toRow=fromRow
}}else{if(toRow>rowCount-1){toRow=rowCount-1;
selectionChanged=true;
if(fromRow>toRow){fromRow=toRow
}}}if(fromCol>colCount-1){fromCol=colCount-1;
selectionChanged=true;
if(toCol>fromCol){toCol=fromCol
}}else{if(toCol>colCount-1){toCol=colCount-1;
selectionChanged=true;
if(fromCol>toCol){fromCol=toCol
}}}if(selectionChanged){self.selectCell(fromRow,fromCol,toRow,toCol)
}}},populateFromArray:function(start,input,end,source){var r,rlen,c,clen,setData=[],current={};
rlen=input.length;
if(rlen===0){return false
}current.row=start.row;
current.col=start.col;
for(r=0;
r<rlen;
r++){if((end&&current.row>end.row)||(!priv.settings.minSpareRows&&current.row>self.countRows()-1)||(current.row>=priv.settings.maxRows)){break
}current.col=start.col;
clen=input[r]?input[r].length:0;
for(c=0;
c<clen;
c++){if((end&&current.col>end.col)||(!priv.settings.minSpareCols&&current.col>self.countCols()-1)||(current.col>=priv.settings.maxCols)){break
}if(self.getCellMeta(current.row,current.col).isWritable){setData.push([current.row,current.col,input[r][c]])
}current.col++;
if(end&&c===clen-1){c=-1
}}current.row++;
if(end&&r===rlen-1){r=-1
}}self.setDataAtCell(setData,null,null,source||"populateFromArray")
},getCornerCoords:function(coordsArr){function mapProp(func,array,prop){function getProp(el){return el[prop]
}if(Array.prototype.map){return func.apply(Math,array.map(getProp))
}return func.apply(Math,$.map(array,getProp))
}return{TL:{row:mapProp(Math.min,coordsArr,"row"),col:mapProp(Math.min,coordsArr,"col")},BR:{row:mapProp(Math.max,coordsArr,"row"),col:mapProp(Math.max,coordsArr,"col")}}
},getCellsAtCoords:function(start,end){var corners=grid.getCornerCoords([start,end]);
var r,c,output=[];
for(r=corners.TL.row;
r<=corners.BR.row;
r++){for(c=corners.TL.col;
c<=corners.BR.col;
c++){output.push(self.view.getCellAtCoords({row:r,col:c}))
}}return output
}};
this.selection=selection={inProgress:false,begin:function(){self.selection.inProgress=true
},finish:function(){var sel=self.getSelected();
self.rootElement.triggerHandler("selectionend.handsontable",sel);
self.rootElement.triggerHandler("selectionendbyprop.handsontable",[sel[0],self.colToProp(sel[1]),sel[2],self.colToProp(sel[3])]);
self.selection.inProgress=false
},isInProgress:function(){return self.selection.inProgress
},setRangeStart:function(coords){priv.selStart.coords(coords);
selection.setRangeEnd(coords)
},setRangeEnd:function(coords,scrollToCell){self.selection.begin();
priv.selEnd.coords(coords);
if(!priv.settings.multiSelect){priv.selStart.coords(coords)
}self.view.wt.selections.current.clear();
self.view.wt.selections.current.add(priv.selStart.arr());
self.view.wt.selections.area.clear();
if(selection.isMultiple()){self.view.wt.selections.area.add(priv.selStart.arr());
self.view.wt.selections.area.add(priv.selEnd.arr())
}if(priv.settings.currentRowClassName||priv.settings.currentColClassName){self.view.wt.selections.highlight.clear();
self.view.wt.selections.highlight.add(priv.selStart.arr());
self.view.wt.selections.highlight.add(priv.selEnd.arr())
}self.rootElement.triggerHandler("selection.handsontable",[priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col()]);
self.rootElement.triggerHandler("selectionbyprop.handsontable",[priv.selStart.row(),datamap.colToProp(priv.selStart.col()),priv.selEnd.row(),datamap.colToProp(priv.selEnd.col())]);
if(scrollToCell!==false){self.view.scrollViewport(coords);
self.view.wt.draw(true);
self.view.scrollViewport(coords)
}selection.refreshBorders()
},refreshBorders:function(revertOriginal,keepEditor){if(!keepEditor){editproxy.destroy(revertOriginal)
}self.view.render();
if(selection.isSelected()&&!keepEditor){editproxy.prepare()
}},isMultiple:function(){return !(priv.selEnd.col()===priv.selStart.col()&&priv.selEnd.row()===priv.selStart.row())
},transformStart:function(rowDelta,colDelta,force){if(priv.selStart.row()+rowDelta>self.countRows()-1){if(force&&priv.settings.minSpareRows>0){self.alter("insert_row",self.countRows())
}else{if(priv.settings.autoWrapCol&&priv.selStart.col()+colDelta<self.countCols()-1){rowDelta=1-self.countRows();
colDelta=1
}}}else{if(priv.settings.autoWrapCol&&priv.selStart.row()+rowDelta<0&&priv.selStart.col()+colDelta>=0){rowDelta=self.countRows()-1;
colDelta=-1
}}if(priv.selStart.col()+colDelta>self.countCols()-1){if(force&&priv.settings.minSpareCols>0){self.alter("insert_col",self.countCols())
}else{if(priv.settings.autoWrapRow&&priv.selStart.row()+rowDelta<self.countRows()-1){rowDelta=1;
colDelta=1-self.countCols()
}}}else{if(priv.settings.autoWrapRow&&priv.selStart.col()+colDelta<0&&priv.selStart.row()+rowDelta>=0){rowDelta=-1;
colDelta=self.countCols()-1
}}var totalRows=self.countRows();
var totalCols=self.countCols();
var coords={row:(priv.selStart.row()+rowDelta),col:priv.selStart.col()+colDelta};
if(coords.row<0){coords.row=0
}else{if(coords.row>0&&coords.row>=totalRows){coords.row=totalRows-1
}}if(coords.col<0){coords.col=0
}else{if(coords.col>0&&coords.col>=totalCols){coords.col=totalCols-1
}}selection.setRangeStart(coords)
},transformEnd:function(rowDelta,colDelta){if(priv.selEnd.exists()){var totalRows=self.countRows();
var totalCols=self.countCols();
var coords={row:priv.selEnd.row()+rowDelta,col:priv.selEnd.col()+colDelta};
if(coords.row<0){coords.row=0
}else{if(coords.row>0&&coords.row>=totalRows){coords.row=totalRows-1
}}if(coords.col<0){coords.col=0
}else{if(coords.col>0&&coords.col>=totalCols){coords.col=totalCols-1
}}selection.setRangeEnd(coords)
}},isSelected:function(){return priv.selEnd.exists()
},inInSelection:function(coords){if(!selection.isSelected()){return false
}var sel=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);
return(sel.TL.row<=coords.row&&sel.BR.row>=coords.row&&sel.TL.col<=coords.col&&sel.BR.col>=coords.col)
},deselect:function(){if(!selection.isSelected()){return
}self.selection.inProgress=false;
priv.selEnd=new Handsontable.SelectionPoint();
self.view.wt.selections.current.clear();
self.view.wt.selections.area.clear();
editproxy.destroy();
selection.refreshBorders();
self.rootElement.triggerHandler("deselect.handsontable")
},selectAll:function(){if(!priv.settings.multiSelect){return
}selection.setRangeStart({row:0,col:0});
selection.setRangeEnd({row:self.countRows()-1,col:self.countCols()-1},false)
},empty:function(){if(!selection.isSelected()){return
}var corners=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);
var r,c,changes=[];
for(r=corners.TL.row;
r<=corners.BR.row;
r++){for(c=corners.TL.col;
c<=corners.BR.col;
c++){if(self.getCellMeta(r,c).isWritable){changes.push([r,c,""])
}}}self.setDataAtCell(changes)
}};
this.autofill=autofill={handle:null,init:function(){if(!autofill.handle){autofill.handle={}
}else{autofill.handle.disabled=false
}},disable:function(){autofill.handle.disabled=true
},selectAdjacent:function(){var select,data,r,maxR,c;
if(selection.isMultiple()){select=self.view.wt.selections.area.getCorners()
}else{select=self.view.wt.selections.current.getCorners()
}data=datamap.getAll();
rows:for(r=select[2]+1;
r<self.countRows();
r++){for(c=select[1];
c<=select[3];
c++){if(data[r][c]){break rows
}}if(!!data[r][select[1]-1]||!!data[r][select[3]+1]){maxR=r
}}if(maxR){self.view.wt.selections.fill.clear();
self.view.wt.selections.fill.add([select[0],select[1]]);
self.view.wt.selections.fill.add([maxR,select[3]]);
autofill.apply()
}},apply:function(){var drag,select,start,end;
autofill.handle.isDragged=0;
drag=self.view.wt.selections.fill.getCorners();
if(!drag){return
}self.view.wt.selections.fill.clear();
if(selection.isMultiple()){select=self.view.wt.selections.area.getCorners()
}else{select=self.view.wt.selections.current.getCorners()
}if(drag[0]===select[0]&&drag[1]<select[1]){start={row:drag[0],col:drag[1]};
end={row:drag[2],col:select[1]-1}
}else{if(drag[0]===select[0]&&drag[3]>select[3]){start={row:drag[0],col:select[3]+1};
end={row:drag[2],col:drag[3]}
}else{if(drag[0]<select[0]&&drag[1]===select[1]){start={row:drag[0],col:drag[1]};
end={row:select[0]-1,col:drag[3]}
}else{if(drag[2]>select[2]&&drag[1]===select[1]){start={row:select[2]+1,col:drag[1]};
end={row:drag[2],col:drag[3]}
}}}}if(start){grid.populateFromArray(start,SheetClip.parse(datamap.getText(priv.selStart.coords(),priv.selEnd.coords())),end,"autofill");
selection.setRangeStart({row:drag[0],col:drag[1]});
selection.setRangeEnd({row:drag[2],col:drag[3]})
}},showBorder:function(coords){coords.row=coords[0];
coords.col=coords[1];
var corners=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);
if(priv.settings.fillHandle!=="horizontal"&&(corners.BR.row<coords.row||corners.TL.row>coords.row)){coords=[coords.row,corners.BR.col]
}else{if(priv.settings.fillHandle!=="vertical"){coords=[corners.BR.row,coords.col]
}else{return
}}self.view.wt.selections.fill.clear();
self.view.wt.selections.fill.add([priv.selStart.coords().row,priv.selStart.coords().col]);
self.view.wt.selections.fill.add([priv.selEnd.coords().row,priv.selEnd.coords().col]);
self.view.wt.selections.fill.add(coords);
self.view.render()
}};
editproxy={init:function(){function onCut(){selection.empty()
}function onPaste(str){self.rootElement.one("datachange.handsontable",function(event,changes,source){if(changes.length){var last=changes[changes.length-1];
selection.setRangeEnd({row:last[0],col:self.propToCol(last[1])})
}});
var input=str.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),inputArray=SheetClip.parse(input),coords=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);
grid.populateFromArray(coords.TL,inputArray,{row:Math.max(coords.BR.row,inputArray.length-1+coords.TL.row),col:Math.max(coords.BR.col,inputArray[0].length-1+coords.TL.col)},"paste")
}var $body=$(document.body);
function onKeyDown(event){if(priv.settings.beforeOnKeyDown){priv.settings.beforeOnKeyDown.call(self,event)
}if($body.children(".context-menu-list:visible").length){return
}if(event.keyCode===17||event.keyCode===224||event.keyCode===91||event.keyCode===93){editproxy.setCopyableText();
return
}priv.lastKeyCode=event.keyCode;
if(selection.isSelected()){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;
if(Handsontable.helper.isPrintableChar(event.keyCode)&&ctrlDown){if(event.keyCode===65){selection.selectAll();
editproxy.setCopyableText();
event.preventDefault()
}else{if(event.keyCode===89||(event.shiftKey&&event.keyCode===90)){priv.undoRedo&&priv.undoRedo.redo()
}else{if(event.keyCode===90){priv.undoRedo&&priv.undoRedo.undo()
}}}return
}var rangeModifier=event.shiftKey?selection.setRangeEnd:selection.setRangeStart;
switch(event.keyCode){case 38:if(event.shiftKey){selection.transformEnd(-1,0)
}else{selection.transformStart(-1,0)
}event.preventDefault();
event.stopPropagation();
break;
case 9:var tabMoves=typeof priv.settings.tabMoves==="function"?priv.settings.tabMoves(event):priv.settings.tabMoves;
if(event.shiftKey){selection.transformStart(-tabMoves.row,-tabMoves.col)
}else{selection.transformStart(tabMoves.row,tabMoves.col,true)
}event.preventDefault();
event.stopPropagation();
break;
case 39:if(event.shiftKey){selection.transformEnd(0,1)
}else{selection.transformStart(0,1)
}event.preventDefault();
event.stopPropagation();
break;
case 37:if(event.shiftKey){selection.transformEnd(0,-1)
}else{selection.transformStart(0,-1)
}event.preventDefault();
event.stopPropagation();
break;
case 8:case 46:selection.empty(event);
event.preventDefault();
break;
case 40:if(event.shiftKey){selection.transformEnd(1,0)
}else{selection.transformStart(1,0)
}event.preventDefault();
event.stopPropagation();
break;
case 113:event.preventDefault();
break;
case 13:var enterMoves=typeof priv.settings.enterMoves==="function"?priv.settings.enterMoves(event):priv.settings.enterMoves;
if(event.shiftKey){selection.transformStart(-enterMoves.row,-enterMoves.col)
}else{selection.transformStart(enterMoves.row,enterMoves.col,true)
}event.preventDefault();
break;
case 36:if(event.ctrlKey||event.metaKey){rangeModifier({row:0,col:priv.selStart.col()})
}else{rangeModifier({row:priv.selStart.row(),col:0})
}event.preventDefault();
event.stopPropagation();
break;
case 35:if(event.ctrlKey||event.metaKey){rangeModifier({row:self.countRows()-1,col:priv.selStart.col()})
}else{rangeModifier({row:priv.selStart.row(),col:self.countCols()-1})
}event.preventDefault();
event.stopPropagation();
break;
case 33:selection.transformStart(-self.countVisibleRows(),0);
self.view.wt.scrollVertical(-self.countVisibleRows());
self.view.render();
event.preventDefault();
event.stopPropagation();
break;
case 34:selection.transformStart(self.countVisibleRows(),0);
self.view.wt.scrollVertical(self.countVisibleRows());
self.view.render();
event.preventDefault();
event.stopPropagation();
break;
default:break
}}}self.copyPaste=new CopyPaste(self.rootElement[0]);
self.copyPaste.onCut(onCut);
self.copyPaste.onPaste(onPaste);
self.rootElement.on("keydown.handsontable."+self.guid,onKeyDown)
},destroy:function(revertOriginal){if(typeof priv.editorDestroyer==="function"){var destroyer=priv.editorDestroyer;
priv.editorDestroyer=null;
destroyer(revertOriginal)
}},setCopyableText:function(){var startRow=Math.min(priv.selStart.row(),priv.selEnd.row());
var startCol=Math.min(priv.selStart.col(),priv.selEnd.col());
var endRow=Math.max(priv.selStart.row(),priv.selEnd.row());
var endCol=Math.max(priv.selStart.col(),priv.selEnd.col());
var finalEndRow=Math.min(endRow,startRow+priv.settings.copyRowsLimit-1);
var finalEndCol=Math.min(endCol,startCol+priv.settings.copyColsLimit-1);
self.copyPaste.copyable(datamap.getText({row:startRow,col:startCol},{row:finalEndRow,col:finalEndCol}));
if((endRow!==finalEndRow||endCol!==finalEndCol)&&priv.settings.onCopyLimit){priv.settings.onCopyLimit(endRow-startRow+1,endCol-startCol+1,priv.settings.copyRowsLimit,priv.settings.copyColsLimit)
}},prepare:function(){if(!self.getCellMeta(priv.selStart.row(),priv.selStart.col()).isWritable){return
}self.listen();
var TD=self.view.getCellAtCoords(priv.selStart.coords());
priv.editorDestroyer=self.view.applyCellTypeMethod("editor",TD,priv.selStart.row(),priv.selStart.col())
}};
this.init=function(){Handsontable.PluginHooks.run(self,"beforeInit");
editproxy.init();
bindEvents();
this.updateSettings(settings);
this.parseSettingsFromDOM();
this.focusCatcher=new Handsontable.FocusCatcher(this);
this.view=new Handsontable.TableView(this);
this.forceFullRender=true;
this.view.render();
if(typeof priv.firstRun==="object"){fireEvent("datachange.handsontable",priv.firstRun);
priv.firstRun=false
}Handsontable.PluginHooks.run(self,"afterInit")
};
function validateChanges(changes,source){var validated=$.Deferred();
var deferreds=[];
var process=function(i){var deferred=$.Deferred();
deferreds.push(deferred);
var originalVal=changes[i][3];
var lowercaseVal=typeof originalVal==="string"?originalVal.toLowerCase():null;
return function(source){var found=false;
for(var s=0,slen=source.length;
s<slen;
s++){if(originalVal===source[s]){found=true;
break
}else{if(lowercaseVal===source[s].toLowerCase()){changes[i][3]=source[s];
found=true;
break
}}}if(!found){changes[i]=null
}deferred.resolve()
}
};
for(var i=changes.length-1;
i>=0;
i--){var cellProperties=self.getCellMeta(changes[i][0],datamap.propToCol(changes[i][1]));
if(cellProperties.strict&&cellProperties.source){$.isFunction(cellProperties.source)?cellProperties.source(changes[i][3],process(i)):process(i)(cellProperties.source)
}}$.when.apply($,deferreds).then(function(){for(var i=changes.length-1;
i>=0;
i--){if(changes[i]===null){changes.splice(i,1)
}else{var cellProperties=self.getCellMeta(changes[i][0],datamap.propToCol(changes[i][1]));
if(cellProperties.dataType==="number"&&typeof changes[i][3]==="string"){if(changes[i][3].length>0&&/^[0-9\s]*[.]*[0-9]*$/.test(changes[i][3])){changes[i][3]=numeral().unformat(changes[i][3]||"0")
}}}}if(priv.settings.onBeforeChange&&changes.length){var result=priv.settings.onBeforeChange.apply(self.rootElement[0],[changes,source]);
if(typeof result==="function"){$.when(result).then(function(){validated.resolve()
})
}else{if(result===false){changes.splice(0,changes.length)
}validated.resolve()
}}else{validated.resolve()
}});
return $.when(validated)
}var fireEvent=function(name,params){self.rootElement.triggerHandler(name,params)
};
var bindEvents=function(){self.rootElement.on("datachange.handsontable",function(event,changes,source){if(priv.settings.onChange){priv.settings.onChange.apply(self.rootElement[0],[changes,source])
}});
self.rootElement.on("selection.handsontable",function(event,row,col,endRow,endCol){if(priv.settings.onSelection){priv.settings.onSelection.apply(self.rootElement[0],[row,col,endRow,endCol])
}});
self.rootElement.on("selectionbyprop.handsontable",function(event,row,prop,endRow,endProp){if(priv.settings.onSelectionByProp){priv.settings.onSelectionByProp.apply(self.rootElement[0],[row,prop,endRow,endProp])
}});
self.rootElement.on("selectionend.handsontable",function(event,row,col,endRow,endCol){if(priv.settings.onSelectionEnd){priv.settings.onSelectionEnd.apply(self.rootElement[0],[row,col,endRow,endCol])
}});
self.rootElement.on("selectionendbyprop.handsontable",function(event,row,prop,endRow,endProp){if(priv.settings.onSelectionEndByProp){priv.settings.onSelectionEndByProp.apply(self.rootElement[0],[row,prop,endRow,endProp])
}})
};
function applyChanges(changes,source){var i=0,ilen=changes.length;
if(!ilen){return
}while(i<ilen){if(priv.settings.minSpareRows){while(changes[i][0]>self.countRows()-1){datamap.createRow()
}}if(priv.dataType==="array"&&priv.settings.minSpareCols){while(datamap.propToCol(changes[i][1])>self.countCols()-1){datamap.createCol()
}}datamap.set(changes[i][0],changes[i][1],changes[i][3]);
i++
}self.forceFullRender=true;
grid.keepEmptyRows();
selection.refreshBorders();
fireEvent("datachange.handsontable",[changes,source||"edit"])
}function setDataInputToArray(arg0,arg1,arg2){if(typeof arg0==="object"){return arg0
}else{if($.isPlainObject(arg2)){return value
}else{return[[arg0,arg1,arg2]]
}}}this.setDataAtCell=function(row,col,value,source){var input=setDataInputToArray(row,col,value),i,ilen,changes=[],prop;
for(i=0,ilen=input.length;
i<ilen;
i++){if(typeof input[i][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")
}prop=datamap.colToProp(input[i][1]);
changes.push([input[i][0],prop,datamap.get(input[i][0],prop),input[i][2]])
}validateChanges(changes,source).then(function(){applyChanges(changes,source)
})
};
this.setDataAtRowProp=function(row,prop,value,source){var input=setDataInputToArray(row,prop,value),i,ilen,changes=[];
for(i=0,ilen=input.length;
i<ilen;
i++){changes.push([input[i][0],input[i][1],datamap.get(input[i][0],input[i][1]),input[i][2]])
}validateChanges(changes,source).then(function(){applyChanges(changes,source)
})
};
this.listen=function(){self.focusCatcher.listen()
};
this.destroyEditor=function(revertOriginal){selection.refreshBorders(revertOriginal)
};
this.populateFromArray=function(start,input,end,source){return grid.populateFromArray(start,input,end,source)
};
this.getCornerCoords=function(coordsArr){return grid.getCornerCoords(coordsArr)
};
this.getSelected=function(){if(selection.isSelected()){return[priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col()]
}};
this.parseSettingsFromDOM=function(){var overflow=this.rootElement.css("overflow");
if(overflow==="scroll"||overflow==="auto"){this.rootElement[0].style.overflow="visible";
priv.settingsFromDOM.overflow=overflow
}else{if(priv.settings.width===void 0||priv.settings.height===void 0){priv.settingsFromDOM.overflow="auto"
}}if(priv.settings.width===void 0){priv.settingsFromDOM.width=this.rootElement.width()
}else{priv.settingsFromDOM.width=void 0
}priv.settingsFromDOM.height=void 0;
if(priv.settings.height===void 0){if(priv.settingsFromDOM.overflow==="scroll"||priv.settingsFromDOM.overflow==="auto"){var clone=this.rootElement[0].cloneNode(false);
var parent=this.rootElement[0].parentNode;
if(parent){clone.removeAttribute("id");
parent.appendChild(clone);
var computedHeight=parseInt(window.getComputedStyle(clone,null).getPropertyValue("height"),10);
if(computedHeight>0){priv.settingsFromDOM.height=computedHeight
}parent.removeChild(clone)
}}}};
this.render=function(){if(self.view){self.forceFullRender=true;
self.parseSettingsFromDOM();
selection.refreshBorders(null,true)
}};
this.loadData=function(data){if(!(data.push&&data.splice)){throw new Error("loadData only accepts array of objects or array of arrays ("+typeof data+" given)")
}priv.isPopulated=false;
priv.settings.data=data;
if(priv.settings.dataSchema instanceof Array||data[0] instanceof Array){priv.dataType="array"
}else{if($.isFunction(priv.settings.dataSchema)){priv.dataType="function"
}else{priv.dataType="object"
}}if(data[0]){priv.duckDataSchema=datamap.recursiveDuckSchema(data[0])
}else{priv.duckDataSchema={}
}datamap.createMap();
grid.keepEmptyRows();
Handsontable.PluginHooks.run(self,"afterLoadData");
if(priv.firstRun){priv.firstRun=[null,"loadData"]
}else{fireEvent("datachange.handsontable",[null,"loadData"]);
self.render()
}priv.isPopulated=true;
self.clearUndo()
};
this.getData=function(r,c,r2,c2){if(typeof r==="undefined"){return datamap.getAll()
}else{return datamap.getRange({row:r,col:c},{row:r2,col:c2})
}};
this.updateSettings=function(settings){var i;
if(typeof settings.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")
}if(typeof settings.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")
}if(typeof settings.undo!=="undefined"){if(priv.undoRedo&&settings.undo===false){priv.undoRedo=null
}else{if(!priv.undoRedo&&settings.undo===true){priv.undoRedo=new Handsontable.UndoRedo(self)
}}}for(i in settings){if(i==="data"){continue
}else{if(settings.hasOwnProperty(i)){priv.settings[i]=settings[i];
if(Handsontable.extension[i]){priv.extensions[i]=new Handsontable.extension[i](self,settings[i])
}}}}if(settings.data===void 0&&priv.settings.data===void 0){var data=[];
var row;
for(var r=0,rlen=priv.settings.startRows;
r<rlen;
r++){row=[];
for(var c=0,clen=priv.settings.startCols;
c<clen;
c++){row.push(null)
}data.push(row)
}self.loadData(data)
}else{if(settings.data!==void 0){self.loadData(settings.data)
}else{if(settings.columns!==void 0){datamap.createMap()
}}}if(typeof settings.fillHandle!=="undefined"){if(autofill.handle&&settings.fillHandle===false){autofill.disable()
}else{if(!autofill.handle&&settings.fillHandle!==false){autofill.init()
}}}grid.keepEmptyRows();
if(self.view){self.forceFullRender=true;
selection.refreshBorders(null,true)
}};
this.getSettings=function(){return priv.settings
};
this.getSettingsFromDOM=function(){return priv.settingsFromDOM
};
this.clear=function(){selection.selectAll();
selection.empty()
};
this.isUndoAvailable=function(){return priv.undoRedo&&priv.undoRedo.isUndoAvailable()
};
this.isRedoAvailable=function(){return priv.undoRedo&&priv.undoRedo.isRedoAvailable()
};
this.undo=function(){priv.undoRedo&&priv.undoRedo.undo()
};
this.redo=function(){priv.undoRedo&&priv.undoRedo.redo()
};
this.clearUndo=function(){priv.undoRedo&&priv.undoRedo.clear()
};
this.alter=function(action,index,amount){grid.alter(action,index,amount)
};
this.getCell=function(row,col){return self.view.getCellAtCoords({row:row,col:col})
};
this.colToProp=function(col){return datamap.colToProp(col)
};
this.propToCol=function(prop){return datamap.propToCol(prop)
};
this.getDataAtCell=function(row,col){return datamap.get(row,datamap.colToProp(col))
};
this.getDataAtRowProp=function(row,prop){return datamap.get(row,prop)
};
this.getCellMeta=function(row,col){var cellProperties=$.extend(true,cellProperties,Handsontable.TextCell),prop=datamap.colToProp(col),i,type;
if(priv.settings.columns){cellProperties=$.extend(true,cellProperties,priv.settings.columns[col]||{})
}if(priv.settings.cells){cellProperties=$.extend(true,cellProperties,priv.settings.cells(row,col,prop)||{})
}Handsontable.PluginHooks.run(self,"beforeGetCellMeta",row,col,cellProperties);
if(typeof cellProperties.type==="string"&&Handsontable.cellTypes[cellProperties.type]){type=Handsontable.cellTypes[cellProperties.type]
}else{if(typeof cellProperties.type==="object"){type=cellProperties.type
}}if(type){for(i in type){if(type.hasOwnProperty(i)){cellProperties[i]=type[i]
}}}cellProperties.isWritable=!cellProperties.readOnly;
Handsontable.PluginHooks.run(self,"afterGetCellMeta",row,col,cellProperties);
return cellProperties
};
this.getRowHeader=function(row){if(row===void 0){var out=[];
for(var i=0,ilen=self.countRows();
i<ilen;
i++){out.push(self.getRowHeader(i))
}return out
}else{if(Object.prototype.toString.call(priv.settings.rowHeaders)==="[object Array]"&&priv.settings.rowHeaders[row]!==void 0){return priv.settings.rowHeaders[row]
}else{if(typeof priv.settings.rowHeaders==="function"){return priv.settings.rowHeaders(row)
}else{if(priv.settings.rowHeaders&&typeof priv.settings.rowHeaders!=="string"&&typeof priv.settings.rowHeaders!=="number"){return row+1
}else{return priv.settings.rowHeaders
}}}}};
this.getColHeader=function(col){if(col===void 0){var out=[];
for(var i=0,ilen=self.countCols();
i<ilen;
i++){out.push(self.getColHeader(i))
}return out
}else{col=Handsontable.PluginModifiers.run(self,"col",col);
if(priv.settings.columns&&priv.settings.columns[col]&&priv.settings.columns[col].title){return priv.settings.columns[col].title
}else{if(Object.prototype.toString.call(priv.settings.colHeaders)==="[object Array]"&&priv.settings.colHeaders[col]!==void 0){return priv.settings.colHeaders[col]
}else{if(typeof priv.settings.colHeaders==="function"){return priv.settings.colHeaders(col)
}else{if(priv.settings.colHeaders&&typeof priv.settings.colHeaders!=="string"&&typeof priv.settings.colHeaders!=="number"){return Handsontable.helper.spreadsheetColumnLabel(col)
}else{return priv.settings.colHeaders
}}}}}};
this.getColWidth=function(col){col=Handsontable.PluginModifiers.run(self,"col",col);
var response={};
if(priv.settings.columns&&priv.settings.columns[col]&&priv.settings.columns[col].width){response.width=priv.settings.columns[col].width
}else{if(Object.prototype.toString.call(priv.settings.colWidths)==="[object Array]"&&priv.settings.colWidths[col]!==void 0){response.width=priv.settings.colWidths[col]
}else{response.width=50
}}Handsontable.PluginHooks.run(self,"afterGetColWidth",col,response);
return response.width
};
this.countRows=function(){return priv.settings.data.length
};
this.countCols=function(){if(priv.dataType==="object"||priv.dataType==="function"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length
}else{return priv.colToProp.length
}}else{if(priv.dataType==="array"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length
}else{if(priv.settings.data&&priv.settings.data[0]&&priv.settings.data[0].length){return priv.settings.data[0].length
}else{return 0
}}}}};
this.rowOffset=function(){return self.view.wt.getSetting("offsetRow")
};
this.colOffset=function(){return self.view.wt.getSetting("offsetColumn")
};
this.countVisibleRows=function(){return self.view.wt.wtTable.countVisibleRows()
};
this.countVisibleCols=function(){return self.view.wt.wtTable.countVisibleColumns()
};
this.countEmptyRows=function(ending){var i=self.countRows()-1,empty=0;
while(i>=0){if(self.isEmptyRow(i)){empty++
}else{if(ending){break
}}i--
}return empty
};
this.countEmptyCols=function(ending){if(self.countRows()<1){return 0
}var i=self.countCols()-1,empty=0;
while(i>=0){if(self.isEmptyCol(i)){empty++
}else{if(ending){break
}}i--
}return empty
};
this.isEmptyRow=function(r){if(priv.settings.isEmptyRow){return priv.settings.isEmptyRow.call(this,r)
}var val;
for(var c=0,clen=this.countCols();
c<clen;
c++){val=this.getDataAtCell(r,c);
if(val!==""&&val!==null&&typeof val!=="undefined"){return false
}}return true
};
this.isEmptyCol=function(c){if(priv.settings.isEmptyCol){return priv.settings.isEmptyCol.call(this,c)
}var val;
for(var r=0,rlen=this.countRows();
r<rlen;
r++){val=this.getDataAtCell(r,c);
if(val!==""&&val!==null&&typeof val!=="undefined"){return false
}}return true
};
this.selectCell=function(row,col,endRow,endCol,scrollToCell){if(typeof row!=="number"||row<0||row>=self.countRows()){return false
}if(typeof col!=="number"||col<0||col>=self.countCols()){return false
}if(typeof endRow!=="undefined"){if(typeof endRow!=="number"||endRow<0||endRow>=self.countRows()){return false
}if(typeof endCol!=="number"||endCol<0||endCol>=self.countCols()){return false
}}priv.selStart.coords({row:row,col:col});
self.listen();
if(typeof endRow==="undefined"){selection.setRangeEnd({row:row,col:col},scrollToCell)
}else{selection.setRangeEnd({row:endRow,col:endCol},scrollToCell)
}self.selection.finish();
return true
};
this.selectCellByProp=function(row,prop,endRow,endProp,scrollToCell){arguments[1]=datamap.propToCol(arguments[1]);
if(typeof arguments[3]!=="undefined"){arguments[3]=datamap.propToCol(arguments[3])
}return self.selectCell.apply(self,arguments)
};
this.deselectCell=function(){selection.deselect()
};
this.destroy=function(){self.clearTimeouts();
if(self.view){self.view.wt.destroy()
}self.rootElement.empty();
self.rootElement.removeData("handsontable");
self.rootElement.off(".handsontable");
$(window).off("."+self.guid);
$(document.documentElement).off("."+self.guid);
Handsontable.PluginHooks.run(self,"afterDestroy")
};
this.timeouts={};
this.registerTimeout=function(key,handle,ms){clearTimeout(this.timeouts[key]);
this.timeouts[key]=setTimeout(handle,ms||0)
};
this.clearTimeouts=function(){for(var key in this.timeouts){if(this.timeouts.hasOwnProperty(key)){clearTimeout(this.timeouts[key])
}}};
this.version="0.8.23"
};
var settings={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,undo:true,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1000,copyColsLimit:1000,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:void 0,isEmptyCol:void 0,observeDOMVisibility:true};
$.fn.handsontable=function(action){var i,ilen,args,output=[],userSettings;
if(typeof action!=="string"){userSettings=action||{};
return this.each(function(){var $this=$(this);
if($this.data("handsontable")){instance=$this.data("handsontable");
instance.updateSettings(userSettings)
}else{var currentSettings=$.extend(true,{},settings),instance;
for(i in userSettings){if(userSettings.hasOwnProperty(i)){currentSettings[i]=userSettings[i]
}}instance=new Handsontable.Core($this,currentSettings);
$this.data("handsontable",instance);
instance.init()
}})
}else{args=[];
if(arguments.length>1){for(i=1,ilen=arguments.length;
i<ilen;
i++){args.push(arguments[i])
}}this.each(function(){var instance=$(this).data("handsontable");
if(instance){output=instance[action].apply(this,args)
}});
return output
}};
Handsontable.FocusCatcher=function(instance){this.el=document.createElement("DIV");
this.el.style.position="fixed";
this.el.style.top="0";
this.el.style.left="0";
this.el.style.width="1px";
this.el.style.height="1px";
this.el.setAttribute("tabindex",10000);
instance.rootElement.append(this.el);
this.$el=$(this.el)
};
Handsontable.FocusCatcher.prototype.listen=function(){this.el.focus()
};
Handsontable.TableView=function(instance){var that=this,$window=$(window),$documentElement=$(document.documentElement);
this.instance=instance;
this.settings=instance.getSettings();
this.settingsFromDOM=instance.getSettingsFromDOM();
instance.rootElement.data("originalStyle",instance.rootElement.attr("style"));
instance.rootElement.addClass("handsontable");
var table=document.createElement("TABLE");
table.className="htCore";
table.appendChild(document.createElement("THEAD"));
table.appendChild(document.createElement("TBODY"));
instance.$table=$(table);
instance.rootElement.prepend(instance.$table);
$documentElement.on("keyup."+instance.guid,function(event){if(instance.selection.isInProgress()&&!event.shiftKey){instance.selection.finish()
}});
var isMouseDown,dragInterval;
$documentElement.on("mouseup."+instance.guid,function(event){if(instance.selection.isInProgress()&&event.which===1){instance.selection.finish()
}isMouseDown=false;
clearInterval(dragInterval);
dragInterval=null;
if(instance.autofill.handle&&instance.autofill.handle.isDragged){if(instance.autofill.handle.isDragged>1){instance.autofill.apply()
}instance.autofill.handle.isDragged=0
}});
$documentElement.on("mousedown."+instance.guid,function(event){var next=event.target;
if(next!==that.wt.wtTable.spreader){while(next!==null&&next!==document.documentElement){if(next===instance.rootElement[0]||next.nodeName==="X-HANDSONTABLE"||next.id==="context-menu-layer"||$(next).is(".context-menu-list")||$(next).is(".typeahead li")){return
}next=next.parentNode
}}if(that.settings.outsideClickDeselects){instance.deselectCell()
}else{instance.destroyEditor()
}});
instance.$table.on("selectstart",function(event){event.preventDefault()
});
instance.$table.on("mouseenter",function(){if(dragInterval){clearInterval(dragInterval);
dragInterval=null
}});
instance.$table.on("mouseleave",function(event){if(!(isMouseDown||(instance.autofill.handle&&instance.autofill.handle.isDragged))){return
}var tolerance=1,offset=that.wt.wtDom.offset(table),offsetTop=offset.top+tolerance,offsetLeft=offset.left+tolerance,width=that.containerWidth-that.wt.getSetting("scrollbarWidth")-2*tolerance,height=that.containerHeight-that.wt.getSetting("scrollbarHeight")-2*tolerance,method,row=0,col=0,dragFn;
if(event.pageY<offsetTop){row=-1;
method="scrollVertical"
}else{if(event.pageY>=offsetTop+height){row=1;
method="scrollVertical"
}else{if(event.pageX<offsetLeft){col=-1;
method="scrollHorizontal"
}else{if(event.pageX>=offsetLeft+width){col=1;
method="scrollHorizontal"
}}}}if(method){dragFn=function(){if(isMouseDown||(instance.autofill.handle&&instance.autofill.handle.isDragged)){that.wt[method](row+col).draw()
}};
dragFn();
dragInterval=setInterval(dragFn,100)
}});
var clearTextSelection=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()
}else{if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()
}}}else{if(document.selection){document.selection.empty()
}}};
var walkontableConfig={table:table,stretchH:this.settings.stretchH,data:instance.getDataAtCell,totalRows:instance.countRows,totalColumns:instance.countCols,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:this.settings.fixedColumnsLeft,fixedRowsTop:this.settings.fixedRowsTop,rowHeaders:this.settings.rowHeaders?function(index,TH){that.appendRowHeader(index,TH)
}:null,columnHeaders:this.settings.colHeaders?function(index,TH){that.appendColHeader(index,TH)
}:null,columnWidth:instance.getColWidth,cellRenderer:function(row,column,TD){that.applyCellTypeMethod("renderer",TD,row,column)
},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&!instance.selection.isMultiple()
}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&instance.selection.isMultiple()
}}},highlight:{highlightRowClassName:that.settings.currentRowClassName,highlightColumnClassName:that.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},onCellMouseDown:function(event,coords,TD){isMouseDown=true;
var coordsObj={row:coords[0],col:coords[1]};
if(event.button===2&&instance.selection.inInSelection(coordsObj)){}else{if(event.shiftKey){instance.selection.setRangeEnd(coordsObj)
}else{instance.selection.setRangeStart(coordsObj)
}}event.preventDefault();
clearTextSelection();
if(that.settings.afterOnCellMouseDown){that.settings.afterOnCellMouseDown.call(instance,event,coords,TD)
}setTimeout(function(){instance.listen()
})
},onCellMouseOver:function(event,coords,TD){var coordsObj={row:coords[0],col:coords[1]};
if(isMouseDown){instance.selection.setRangeEnd(coordsObj)
}else{if(instance.autofill.handle&&instance.autofill.handle.isDragged){instance.autofill.handle.isDragged++;
instance.autofill.showBorder(coords)
}}},onCellCornerMouseDown:function(event){instance.autofill.handle.isDragged=1;
event.preventDefault()
},onCellCornerDblClick:function(){instance.autofill.selectAdjacent()
},beforeDraw:function(force){that.beforeRender(force)
}};
Handsontable.PluginHooks.run(instance,"walkontableConfig",walkontableConfig);
this.wt=new Walkontable(walkontableConfig);
$window.on("resize."+instance.guid,function(){instance.registerTimeout("resizeTimeout",function(){instance.parseSettingsFromDOM();
var newWidth=that.getWidth();
var newHeight=that.getHeight();
if(walkontableConfig.width!==newWidth||walkontableConfig.height!==newHeight){instance.forceFullRender=true;
that.render();
walkontableConfig.width=newWidth;
walkontableConfig.height=newHeight
}},60)
});
$(that.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){event.stopPropagation()
}});
$documentElement.on("click."+instance.guid,function(){if(that.settings.observeDOMVisibility){if(that.wt.drawInterrupted){that.instance.forceFullRender=true;
that.render()
}}})
};
Handsontable.TableView.prototype.isCellEdited=function(){return(this.instance.textEditor&&this.instance.textEditor.isCellEdited)||(this.instance.autocompleteEditor&&this.instance.autocompleteEditor.isCellEdited)||(this.instance.handsontableEditor&&this.instance.handsontableEditor.isCellEdited)
};
Handsontable.TableView.prototype.getWidth=function(){var val=this.settings.width!==void 0?this.settings.width:this.settingsFromDOM.width;
return typeof val==="function"?val():val
};
Handsontable.TableView.prototype.getHeight=function(){var val=this.settings.height!==void 0?this.settings.height:this.settingsFromDOM.height;
return typeof val==="function"?val():val
};
Handsontable.TableView.prototype.beforeRender=function(force){if(force){Handsontable.PluginHooks.run(this.instance,"beforeRender");
this.wt.update("width",this.getWidth());
this.wt.update("height",this.getHeight())
}};
Handsontable.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);
this.instance.rootElement.triggerHandler("render.handsontable");
if(this.instance.forceFullRender){Handsontable.PluginHooks.run(this.instance,"afterRender")
}this.instance.forceFullRender=false
};
Handsontable.TableView.prototype.applyCellTypeMethod=function(methodName,td,row,col){var prop=this.instance.colToProp(col),cellProperties=this.instance.getCellMeta(row,col);
if(cellProperties[methodName]){return cellProperties[methodName](this.instance,td,row,col,prop,this.instance.getDataAtRowProp(row,prop),cellProperties)
}};
Handsontable.TableView.prototype.getCellAtCoords=function(coords){var td=this.wt.wtTable.getCell([coords.row,coords.col]);
if(td<0){return null
}else{return td
}};
Handsontable.TableView.prototype.scrollViewport=function(coords){this.wt.scrollViewport([coords.row,coords.col])
};
Handsontable.TableView.prototype.appendRowHeader=function(row,TH){this.wt.wtDom.avoidInnerHTML(TH,this.instance.getRowHeader(row))
};
Handsontable.TableView.prototype.appendColHeader=function(col,TH){var DIV=document.createElement("DIV"),SPAN=document.createElement("SPAN");
DIV.className="relative";
SPAN.className="colHeader";
this.wt.wtDom.avoidInnerHTML(SPAN,this.instance.getColHeader(col));
DIV.appendChild(SPAN);
while(TH.firstChild){TH.removeChild(TH.firstChild)
}TH.appendChild(DIV);
Handsontable.PluginHooks.run(this.instance,"afterGetColHeader",col,TH)
};
Handsontable.helper.isPrintableChar=function(keyCode){return((keyCode==32)||(keyCode>=48&&keyCode<=57)||(keyCode>=96&&keyCode<=111)||(keyCode>=186&&keyCode<=192)||(keyCode>=219&&keyCode<=222)||keyCode>=226||(keyCode>=65&&keyCode<=90))
};
Handsontable.helper.stringify=function(value){switch(typeof value){case"string":case"number":return value+"";
break;
case"object":if(value===null){return""
}else{return value.toString()
}break;
case"undefined":return"";
break;
default:return value.toString()
}};
Handsontable.helper.spreadsheetColumnLabel=function(index){var dividend=index+1;
var columnLabel="";
var modulo;
while(dividend>0){modulo=(dividend-1)%26;
columnLabel=String.fromCharCode(65+modulo)+columnLabel;
dividend=parseInt((dividend-modulo)/26,10)
}return columnLabel
};
Handsontable.helper.isDescendant=function(parent,child){var node=child.parentNode;
while(node!=null){if(node==parent){return true
}node=node.parentNode
}return false
};
Handsontable.helper.randomString=function(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)
}return s4()+s4()+s4()+s4()
};
Handsontable.helper.inherit=function(Child,Parent){function Bridge(){}Bridge.prototype=Parent.prototype;
Child.prototype=new Bridge();
Child.prototype.constructor=Child;
return Child
};
Handsontable.UndoRedo=function(instance){var that=this;
this.instance=instance;
this.clear();
instance.rootElement.on("datachange.handsontable",function(event,changes,origin){if(origin!=="undo"&&origin!=="redo"){that.add(changes)
}})
};
Handsontable.UndoRedo.prototype.undo=function(){var i,ilen;
if(this.isUndoAvailable()){var setData=$.extend(true,[],this.data[this.rev]);
for(i=0,ilen=setData.length;
i<ilen;
i++){setData[i].splice(3,1)
}this.instance.setDataAtRowProp(setData,null,null,"undo");
this.rev--
}};
Handsontable.UndoRedo.prototype.redo=function(){var i,ilen;
if(this.isRedoAvailable()){this.rev++;
var setData=$.extend(true,[],this.data[this.rev]);
for(i=0,ilen=setData.length;
i<ilen;
i++){setData[i].splice(2,1)
}this.instance.setDataAtRowProp(setData,null,null,"redo")
}};
Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return(this.rev>=0)
};
Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return(this.rev<this.data.length-1)
};
Handsontable.UndoRedo.prototype.add=function(changes){this.rev++;
this.data.splice(this.rev);
this.data.push(changes)
};
Handsontable.UndoRedo.prototype.clear=function(){this.data=[];
this.rev=-1
};
Handsontable.SelectionPoint=function(){this._row=null;
this._col=null
};
Handsontable.SelectionPoint.prototype.exists=function(){return(this._row!==null)
};
Handsontable.SelectionPoint.prototype.row=function(val){if(val!==void 0){this._row=val
}return this._row
};
Handsontable.SelectionPoint.prototype.col=function(val){if(val!==void 0){this._col=val
}return this._col
};
Handsontable.SelectionPoint.prototype.coords=function(coords){if(coords!==void 0){this._row=coords.row;
this._col=coords.col
}return{row:this._row,col:this._col}
};
Handsontable.SelectionPoint.prototype.arr=function(arr){if(arr!==void 0){this._row=arr[0];
this._col=arr[1]
}return[this._row,this._col]
};
Handsontable.TextRenderer=function(instance,TD,row,col,prop,value,cellProperties){var escaped=Handsontable.helper.stringify(value);
if(escaped.match(/\n/)){escaped=escaped.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");
TD.innerHTML=escaped.replace(/\n/g,"<br/>")
}else{instance.view.wt.wtDom.empty(TD);
TD.appendChild(document.createTextNode(escaped))
}if(cellProperties.readOnly){TD.className="htDimmed"
}};
Handsontable.AutocompleteRenderer=function(instance,TD,row,col,prop,value,cellProperties){var TEXT=document.createElement("DIV");
TEXT.className="htAutocomplete";
var ARROW=document.createElement("DIV");
ARROW.className="htAutocompleteArrow";
ARROW.appendChild(document.createTextNode("\u25BC"));
if(!instance.acArrowListener){instance.acArrowListener=function(){instance.view.wt.getSetting("onCellDblClick")
};
instance.rootElement.on("mouseup",".htAutocompleteArrow",instance.acArrowListener)
}Handsontable.TextRenderer(instance,TEXT,row,col,prop,value,cellProperties);
if(!TEXT.firstChild){TEXT.appendChild(document.createTextNode("\u00A0"))
}TEXT.appendChild(ARROW);
instance.view.wt.wtDom.empty(TD);
TD.appendChild(TEXT)
};
Handsontable.CheckboxRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(typeof cellProperties.checkedTemplate==="undefined"){cellProperties.checkedTemplate=true
}if(typeof cellProperties.uncheckedTemplate==="undefined"){cellProperties.uncheckedTemplate=false
}instance.view.wt.wtDom.empty(TD);
var INPUT=document.createElement("INPUT");
INPUT.className="htCheckboxRendererInput";
INPUT.type="checkbox";
INPUT.setAttribute("autocomplete","off");
if(value===cellProperties.checkedTemplate||value===Handsontable.helper.stringify(cellProperties.checkedTemplate)){INPUT.checked=true;
TD.appendChild(INPUT)
}else{if(value===cellProperties.uncheckedTemplate||value===Handsontable.helper.stringify(cellProperties.uncheckedTemplate)){TD.appendChild(INPUT)
}else{if(value===null){INPUT.className+=" noValue";
TD.appendChild(INPUT)
}else{TD.appendChild(document.createTextNode("#bad value#"))
}}}var $input=$(INPUT);
if(cellProperties.readOnly){$input.on("click",function(event){event.preventDefault()
})
}else{$input.on("mousedown",function(event){if(!this.checked){instance.setDataAtRowProp(row,prop,cellProperties.checkedTemplate)
}else{instance.setDataAtRowProp(row,prop,cellProperties.uncheckedTemplate)
}event.stopPropagation()
});
$input.on("mouseup",function(event){event.stopPropagation()
})
}return TD
};
Handsontable.NumericRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(typeof value==="number"){if(typeof cellProperties.language!=="undefined"){numeral.language(cellProperties.language)
}instance.view.wt.wtDom.empty(TD);
TD.className="htNumeric";
TD.appendChild(document.createTextNode(numeral(value).format(cellProperties.format||"0")))
}else{Handsontable.TextRenderer(instance,TD,row,col,prop,value,cellProperties)
}};
function HandsontableTextEditorClass(instance){this.isCellEdited=false;
this.instance=instance;
this.createElements();
this.bindEvents()
}HandsontableTextEditorClass.prototype.createElements=function(){this.wtDom=new WalkontableDom();
this.TEXTAREA=document.createElement("TEXTAREA");
this.TEXTAREA.className="handsontableInput";
this.textareaStyle=this.TEXTAREA.style;
this.textareaStyle.width=0;
this.textareaStyle.height=0;
this.$textarea=$(this.TEXTAREA);
this.TEXTAREA_PARENT=document.createElement("DIV");
this.TEXTAREA_PARENT.className="handsontableInputHolder";
this.textareaParentStyle=this.TEXTAREA_PARENT.style;
this.textareaParentStyle.top=0;
this.textareaParentStyle.left=0;
this.textareaParentStyle.display="none";
this.$textareaParent=$(this.TEXTAREA_PARENT);
this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);
this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);
var that=this;
Handsontable.PluginHooks.push("afterRender",function(){that.instance.registerTimeout("refresh_editor_dimensions",function(){that.refreshDimensions()
},0)
})
};
HandsontableTextEditorClass.prototype.bindEvents=function(){var that=this;
this.$textareaParent.off(".editor").on("keydown.editor",function(event){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;
if(event.keyCode===17||event.keyCode===224||event.keyCode===91||event.keyCode===93){event.stopImmediatePropagation();
return
}switch(event.keyCode){case 38:case 40:that.finishEditing(false);
break;
case 9:that.finishEditing(false);
event.preventDefault();
break;
case 39:if(that.getCaretPosition(that.TEXTAREA)===that.TEXTAREA.value.length){that.finishEditing(false)
}else{event.stopImmediatePropagation()
}break;
case 37:if(that.getCaretPosition(that.TEXTAREA)===0){that.finishEditing(false)
}else{event.stopImmediatePropagation()
}break;
case 27:that.instance.destroyEditor(true);
event.stopImmediatePropagation();
break;
case 13:var selected=that.instance.getSelected();
var isMultipleSelection=!(selected[0]===selected[2]&&selected[1]===selected[3]);
if((event.ctrlKey&&!isMultipleSelection)||event.altKey){that.TEXTAREA.value=that.TEXTAREA.value+"\n";
that.TEXTAREA.focus();
event.stopImmediatePropagation()
}else{that.finishEditing(false,ctrlDown)
}event.preventDefault();
break;
default:event.stopImmediatePropagation();
break
}})
};
HandsontableTextEditorClass.prototype.bindTemporaryEvents=function(td,row,col,prop,value,cellProperties){this.TD=td;
this.row=row;
this.col=col;
this.prop=prop;
this.originalValue=value;
this.cellProperties=cellProperties;
var that=this;
this.instance.focusCatcher.$el.on("keydown.editor",function(event){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;
if(!that.isCellEdited){if(Handsontable.helper.isPrintableChar(event.keyCode)){if(!ctrlDown){that.beginEditing(row,col,prop)
}}else{if(event.keyCode===113){that.beginEditing(row,col,prop,true);
event.stopImmediatePropagation();
event.preventDefault()
}else{if(event.keyCode===13&&that.instance.getSettings().enterBeginsEditing){var selected=that.instance.getSelected();
var isMultipleSelection=!(selected[0]===selected[2]&&selected[1]===selected[3]);
if((ctrlDown&&!isMultipleSelection)||event.altKey){that.beginEditing(row,col,prop,true,"\n")
}else{that.beginEditing(row,col,prop,true)
}event.preventDefault();
event.stopImmediatePropagation()
}}}}});
function onDblClick(){that.beginEditing(row,col,prop,true)
}this.instance.view.wt.update("onCellDblClick",onDblClick)
};
HandsontableTextEditorClass.prototype.unbindTemporaryEvents=function(){this.instance.focusCatcher.$el.off(".editor");
this.instance.view.wt.update("onCellDblClick",null)
};
HandsontableTextEditorClass.prototype.getCaretPosition=function(el){if(el.selectionStart){return el.selectionStart
}else{if(document.selection){el.focus();
var r=document.selection.createRange();
if(r==null){return 0
}var re=el.createTextRange(),rc=re.duplicate();
re.moveToBookmark(r.getBookmark());
rc.setEndPoint("EndToStart",re);
return rc.text.length
}}return 0
};
HandsontableTextEditorClass.prototype.setCaretPosition=function(el,pos){if(el.setSelectionRange){el.focus();
el.setSelectionRange(pos,pos)
}else{if(el.createTextRange){var range=el.createTextRange();
range.collapse(true);
range.moveEnd("character",pos);
range.moveStart("character",pos);
range.select()
}}};
HandsontableTextEditorClass.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){if(this.isCellEdited){return
}this.isCellEdited=true;
this.row=row;
this.col=col;
this.prop=prop;
var coords={row:row,col:col};
this.instance.view.scrollViewport(coords);
this.instance.view.render();
this.$textarea.on("cut.editor",function(event){event.stopPropagation()
});
this.$textarea.on("paste.editor",function(event){event.stopPropagation()
});
if(useOriginalValue){this.TEXTAREA.value=Handsontable.helper.stringify(this.originalValue)+(suffix||"")
}else{this.TEXTAREA.value=""
}this.refreshDimensions();
this.TEXTAREA.focus();
this.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)
};
HandsontableTextEditorClass.prototype.refreshDimensions=function(){if(!this.isCellEdited){return
}this.TD=this.instance.getCell(this.row,this.col);
var $td=$(this.TD);
var currentOffset=this.wtDom.offset(this.TD);
var containerOffset=this.wtDom.offset(this.instance.rootElement[0]);
var scrollTop=this.instance.rootElement.scrollTop();
var scrollLeft=this.instance.rootElement.scrollLeft();
var editTop=currentOffset.top-containerOffset.top+scrollTop-1;
var editLeft=currentOffset.left-containerOffset.left+scrollLeft-1;
var settings=this.instance.getSettings();
var rowHeadersCount=settings.rowHeaders===false?0:1;
var colHeadersCount=settings.colHeaders===false?0:1;
if(editTop<0){editTop=0
}if(editLeft<0){editLeft=0
}if(rowHeadersCount>0&&parseInt($td.css("border-top-width"),10)>0){editTop+=1
}if(colHeadersCount>0&&parseInt($td.css("border-left-width"),10)>0){editLeft+=1
}if($.browser.msie&&parseInt($.browser.version,10)<=7){editTop-=1
}this.textareaParentStyle.top=editTop+"px";
this.textareaParentStyle.left=editLeft+"px";
var width=$td.width(),height=$td.outerHeight()-4;
if(parseInt($td.css("border-top-width"),10)>0){height-=1
}if(parseInt($td.css("border-left-width"),10)>0){if(rowHeadersCount>0){width-=1
}}this.$textarea.autoResize({maxHeight:200,minHeight:height,minWidth:width,maxWidth:Math.max(168,width),animate:false,extraSpace:0});
this.textareaParentStyle.display="block"
};
HandsontableTextEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){if(this.isCellEdited){this.isCellEdited=false;
if(!isCancelled){var val=[[$.trim(this.TEXTAREA.value)]];
if(ctrlDown){var sel=this.instance.getSelected();
this.instance.populateFromArray({row:sel[0],col:sel[1]},val,{row:sel[2],col:sel[3]},"edit")
}else{this.instance.populateFromArray({row:this.row,col:this.col},val,null,"edit")
}}}this.unbindTemporaryEvents();
if(document.activeElement===this.TEXTAREA){this.instance.listen()
}this.textareaParentStyle.display="none"
};
Handsontable.TextEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.textEditor){instance.textEditor=new HandsontableTextEditorClass(instance)
}instance.textEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);
return function(isCancelled){instance.textEditor.finishEditing(isCancelled)
}
};
function HandsontableAutocompleteEditorClass(instance){this.isCellEdited=false;
this.instance=instance;
this.createElements();
this.bindEvents();
this.emptyStringLabel="\u00A0\u00A0\u00A0"
}Handsontable.helper.inherit(HandsontableAutocompleteEditorClass,HandsontableTextEditorClass);
HandsontableAutocompleteEditorClass.prototype.createElements=function(){HandsontableTextEditorClass.prototype.createElements.call(this);
this.$textarea.typeahead();
this.typeahead=this.$textarea.data("typeahead");
this.typeahead._render=this.typeahead.render;
this.typeahead.minLength=0;
this.typeahead.lookup=function(){var items;
this.query=this.$element.val();
items=$.isFunction(this.source)?this.source(this.query,$.proxy(this.process,this)):this.source;
return items?this.process(items):this
};
this.typeahead.matcher=function(){return true
};
var _process=this.typeahead.process;
var that=this;
this.typeahead.process=function(items){var cloned=false;
for(var i=0,ilen=items.length;
i<ilen;
i++){if(items[i]===""){if(!cloned){items=$.extend([],items);
cloned=true
}items[i]=that.emptyStringLabel
}}return _process.call(this,items)
}
};
HandsontableAutocompleteEditorClass.prototype.bindEvents=function(){var that=this;
this.$textarea.off("keydown").off("keyup").off("keypress");
this.$textareaParent.off(".acEditor").on("keydown.acEditor",function(event){switch(event.keyCode){case 38:that.typeahead.prev();
event.stopImmediatePropagation();
break;
case 40:that.typeahead.next();
event.stopImmediatePropagation();
break;
case 13:event.preventDefault();
break
}});
this.$textareaParent.on("keyup.acEditor",function(event){if(Handsontable.helper.isPrintableChar(event.keyCode)||event.keyCode===113||event.keyCode===13||event.keyCode===8||event.keyCode===46){that.typeahead.lookup()
}});
HandsontableTextEditorClass.prototype.bindEvents.call(this)
};
HandsontableAutocompleteEditorClass.prototype.bindTemporaryEvents=function(td,row,col,prop,value,cellProperties){var that=this,i,j;
this.typeahead.select=function(){var output=this.hide();
that.instance.destroyEditor(true);
var val=this.$menu.find(".active").attr("data-value");
if(val===that.emptyStringLabel){val=""
}if(typeof cellProperties.onSelect==="function"){cellProperties.onSelect(row,col,prop,val,this.$menu.find(".active").index())
}else{that.instance.setDataAtRowProp(row,prop,val)
}return output
};
this.typeahead.render=function(items){that.typeahead._render.call(this,items);
if(!cellProperties.strict){this.$menu.find("li:eq(0)").removeClass("active")
}return this
};
for(i in cellProperties){if(cellProperties.hasOwnProperty(i)){if(i==="options"){for(j in cellProperties.options){if(cellProperties.options.hasOwnProperty(j)){this.typeahead.options[j]=cellProperties.options[j]
}}}else{this.typeahead[i]=cellProperties[i]
}}}HandsontableTextEditorClass.prototype.bindTemporaryEvents.call(this,td,row,col,prop,value,cellProperties);
function onDblClick(){that.beginEditing(row,col,prop,true);
that.instance.registerTimeout("IE9_align_fix",function(){that.typeahead.lookup()
},1)
}this.instance.view.wt.update("onCellDblClick",onDblClick)
};
HandsontableAutocompleteEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){if(!isCancelled){if(this.isMenuExpanded()&&this.typeahead.$menu.find(".active").length){this.typeahead.select();
this.isCellEdited=false
}else{if(this.cellProperties.strict){this.isCellEdited=false
}}}HandsontableTextEditorClass.prototype.finishEditing.call(this,isCancelled,ctrlDown)
};
HandsontableAutocompleteEditorClass.prototype.isMenuExpanded=function(){if(this.typeahead.$menu.is(":visible")){return this.typeahead
}else{return false
}};
Handsontable.AutocompleteEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.autocompleteEditor){instance.autocompleteEditor=new HandsontableAutocompleteEditorClass(instance)
}instance.autocompleteEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);
return function(isCancelled){instance.autocompleteEditor.finishEditing(isCancelled)
}
};
function toggleCheckboxCell(instance,row,prop,cellProperties){if(Handsontable.helper.stringify(instance.getDataAtRowProp(row,prop))===Handsontable.helper.stringify(cellProperties.checkedTemplate)){instance.setDataAtRowProp(row,prop,cellProperties.uncheckedTemplate)
}else{instance.setDataAtRowProp(row,prop,cellProperties.checkedTemplate)
}}Handsontable.CheckboxEditor=function(instance,td,row,col,prop,value,cellProperties){if(typeof cellProperties==="undefined"){cellProperties={}
}if(typeof cellProperties.checkedTemplate==="undefined"){cellProperties.checkedTemplate=true
}if(typeof cellProperties.uncheckedTemplate==="undefined"){cellProperties.uncheckedTemplate=false
}instance.$table.on("keydown.editor",function(event){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;
if(!ctrlDown&&Handsontable.helper.isPrintableChar(event.keyCode)){toggleCheckboxCell(instance,row,prop,cellProperties);
event.stopImmediatePropagation();
event.preventDefault()
}});
instance.view.wt.update("onCellDblClick",function(){toggleCheckboxCell(instance,row,prop,cellProperties)
});
return function(){instance.$table.off(".editor");
instance.view.wt.update("onCellDblClick",null)
}
};
function HandsontableDateEditorClass(instance){if(!$.datepicker){throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?")
}this.isCellEdited=false;
this.instance=instance;
this.createElements();
this.bindEvents()
}Handsontable.helper.inherit(HandsontableDateEditorClass,HandsontableTextEditorClass);
HandsontableDateEditorClass.prototype.createElements=function(){HandsontableTextEditorClass.prototype.createElements.call(this);
this.datePicker=document.createElement("DIV");
this.datePickerStyle=this.datePicker.style;
this.datePickerStyle.position="absolute";
this.datePickerStyle.top=0;
this.datePickerStyle.left=0;
this.datePickerStyle.zIndex=99;
this.instance.rootElement[0].appendChild(this.datePicker);
this.$datePicker=$(this.datePicker);
var that=this;
var defaultOptions={dateFormat:"yy-mm-dd",showButtonPanel:true,changeMonth:true,changeYear:true,altField:this.$textarea,onSelect:function(){that.finishEditing(false)
}};
this.$datePicker.datepicker(defaultOptions);
this.hideDatepicker()
};
HandsontableDateEditorClass.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){HandsontableTextEditorClass.prototype.beginEditing.call(this,row,col,prop,useOriginalValue,suffix);
this.showDatepicker()
};
HandsontableDateEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){this.hideDatepicker();
HandsontableTextEditorClass.prototype.finishEditing.call(this,isCancelled,ctrlDown)
};
HandsontableDateEditorClass.prototype.showDatepicker=function(){var $td=$(this.instance.dateEditor.TD);
var position=$td.position();
this.datePickerStyle.top=(position.top+$td.height())+"px";
this.datePickerStyle.left=position.left+"px";
var dateOptions={defaultDate:this.originalValue||void 0};
$.extend(dateOptions,this.cellProperties);
this.$datePicker.datepicker("option",dateOptions);
if(this.originalValue){this.$datePicker.datepicker("setDate",this.originalValue)
}this.datePickerStyle.display="block"
};
HandsontableDateEditorClass.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"
};
Handsontable.DateEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.dateEditor){instance.dateEditor=new HandsontableDateEditorClass(instance)
}instance.dateEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);
return function(isCancelled){instance.dateEditor.finishEditing(isCancelled)
}
};
function HandsontableHandsontableEditorClass(instance){this.isCellEdited=false;
this.instance=instance;
this.createElements();
this.bindEvents()
}Handsontable.helper.inherit(HandsontableHandsontableEditorClass,HandsontableTextEditorClass);
HandsontableHandsontableEditorClass.prototype.createElements=function(){HandsontableTextEditorClass.prototype.createElements.call(this);
var DIV=document.createElement("DIV");
DIV.className="handsontableEditor";
this.TEXTAREA_PARENT.appendChild(DIV);
this.$htContainer=$(DIV)
};
HandsontableHandsontableEditorClass.prototype.bindTemporaryEvents=function(td,row,col,prop,value,cellProperties){var parent=this;
var options={colHeaders:true,cells:function(){return{readOnly:true}
},fillHandle:false,width:2000,afterOnCellMouseDown:function(){var sel=this.getSelected();
parent.TEXTAREA.value=this.getDataAtCell(sel[0],sel[1]);
parent.instance.destroyEditor()
},beforeOnKeyDown:function(event){switch(event.keyCode){case 27:parent.instance.destroyEditor(true);
break;
case 13:var sel=this.getSelected();
parent.TEXTAREA.value=this.getDataAtCell(sel[0],sel[1]);
parent.instance.destroyEditor();
break
}}};
if(cellProperties.handsontable){options=$.extend(options,cellProperties.handsontable)
}this.$htContainer.handsontable(options);
HandsontableTextEditorClass.prototype.bindTemporaryEvents.call(this,td,row,col,prop,value,cellProperties)
};
HandsontableHandsontableEditorClass.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){var onBeginEditing=this.instance.getSettings().onBeginEditing;
if(onBeginEditing&&onBeginEditing()===false){return
}HandsontableTextEditorClass.prototype.beginEditing.call(this,row,col,prop,useOriginalValue,suffix);
this.$htContainer.handsontable("render");
this.$htContainer.handsontable("selectCell",0,0)
};
HandsontableHandsontableEditorClass.prototype.finishEditing=function(isCancelled,ctrlDown){if(Handsontable.helper.isDescendant(this.instance.rootElement[0],document.activeElement)){var that=this;
setTimeout(function(){that.instance.listen()
},0);
that.instance.listen()
}this.$htContainer.handsontable("destroy");
HandsontableTextEditorClass.prototype.finishEditing.call(this,isCancelled,ctrlDown)
};
HandsontableHandsontableEditorClass.prototype.isMenuExpanded=function(){if(this.typeahead.$menu.is(":visible")){return this.typeahead
}else{return false
}};
Handsontable.HandsontableEditor=function(instance,td,row,col,prop,value,cellProperties){if(!instance.handsontableEditor){instance.handsontableEditor=new HandsontableHandsontableEditorClass(instance)
}instance.handsontableEditor.bindTemporaryEvents(td,row,col,prop,value,cellProperties);
instance.registerEditor=instance.handsontableEditor;
return function(isCancelled){instance.handsontableEditor.finishEditing(isCancelled)
}
};
Handsontable.AutocompleteCell={renderer:Handsontable.AutocompleteRenderer,editor:Handsontable.AutocompleteEditor};
Handsontable.CheckboxCell={renderer:Handsontable.CheckboxRenderer,editor:Handsontable.CheckboxEditor};
Handsontable.TextCell={renderer:Handsontable.TextRenderer,editor:Handsontable.TextEditor};
Handsontable.NumericCell={renderer:Handsontable.NumericRenderer,editor:Handsontable.TextEditor,dataType:"number"};
Handsontable.DateCell={renderer:Handsontable.AutocompleteRenderer,editor:Handsontable.DateEditor};
Handsontable.HandsontableCell={renderer:Handsontable.AutocompleteRenderer,editor:Handsontable.HandsontableEditor};
Handsontable.cellTypes={autocomplete:Handsontable.AutocompleteCell,checkbox:Handsontable.CheckboxCell,text:Handsontable.TextCell,numeric:Handsontable.NumericCell,date:Handsontable.DateCell,handsontable:Handsontable.HandsontableCell};
Handsontable.PluginHooks={hooks:{beforeInit:[],afterInit:[],afterLoadData:[],beforeRender:[],afterRender:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],walkontableConfig:[],afterDestroy:[]},push:function(key,fn){this.hooks[key].push(fn)
},unshift:function(key,fn){this.hooks[key].unshift(fn)
},run:function(instance,key,p1,p2,p3,p4,p5){for(var i=0,ilen=this.hooks[key].length;
i<ilen;
i++){this.hooks[key][i].call(instance,p1,p2,p3,p4,p5)
}}};
Handsontable.PluginModifiers={modifiers:{col:[]},push:function(key,fn){this.modifiers[key].push(fn)
},unshift:function(key,fn){this.modifiers[key].unshift(fn)
},run:function(instance,key,p1,p2,p3,p4,p5){for(var i=0,ilen=this.modifiers[key].length;
i<ilen;
i++){p1=this.modifiers[key][i].call(instance,p1,p2,p3,p4,p5)
}return p1
}};
function HandsontableAutoColumnSize(){var that=this,instance,sampleCount=5;
this.beforeInit=function(){this.autoColumnWidths=[];
this.autoColumnSizeTmp={thead:null,theadTh:null,theadStyle:null,tbody:null,tbodyTd:null,noRenderer:null,noRendererTd:null,renderer:null,rendererTd:null,container:null,containerStyle:null,$container:null,$noRenderer:null,$renderer:null}
};
this.determineColumnWidth=function(col){var tmp=instance.autoColumnSizeTmp,d;
if(!tmp.container){d=document;
tmp.thead=d.createElement("table");
tmp.thead.appendChild(d.createElement("thead")).appendChild(d.createElement("tr")).appendChild(d.createElement("th"));
tmp.theadTh=tmp.thead.getElementsByTagName("th")[0];
tmp.thead.className="htTable";
tmp.theadStyle=tmp.thead.style;
tmp.theadStyle.tableLayout="auto";
tmp.theadStyle.width="auto";
tmp.tbody=tmp.thead.cloneNode(false);
tmp.tbody.appendChild(d.createElement("tbody")).appendChild(d.createElement("tr")).appendChild(d.createElement("td"));
tmp.tbodyTd=tmp.tbody.getElementsByTagName("td")[0];
tmp.noRenderer=tmp.tbody.cloneNode(true);
tmp.noRendererTd=tmp.noRenderer.getElementsByTagName("td")[0];
tmp.renderer=tmp.tbody.cloneNode(true);
tmp.rendererTd=tmp.renderer.getElementsByTagName("td")[0];
tmp.container=d.createElement("div");
tmp.container.className=instance.rootElement[0].className+" hidden";
tmp.containerStyle=tmp.container.style;
tmp.container.appendChild(tmp.thead);
tmp.container.appendChild(tmp.tbody);
tmp.container.appendChild(tmp.noRenderer);
tmp.container.appendChild(tmp.renderer);
tmp.$container=$(tmp.container);
tmp.$noRenderer=$(tmp.noRenderer);
tmp.$renderer=$(tmp.renderer);
instance.rootElement[0].parentNode.appendChild(tmp.container)
}tmp.container.className=instance.rootElement[0].className+" hidden";
var rows=instance.countRows();
var samples={};
var maxLen=0;
for(var r=0;
r<rows;
r++){var value=Handsontable.helper.stringify(instance.getDataAtCell(r,col));
var len=value.length;
if(len>maxLen){maxLen=len
}if(!samples[len]){samples[len]={needed:sampleCount,strings:[]}
}if(samples[len].needed){samples[len].strings.push(value);
samples[len].needed--
}}var settings=instance.getSettings();
if(settings.colHeaders){instance.view.appendColHeader(col,tmp.theadTh)
}var txt="";
for(var i in samples){if(samples.hasOwnProperty(i)){for(var j=0,jlen=samples[i].strings.length;
j<jlen;
j++){txt+=samples[i].strings[j]+"<br>"
}}}tmp.tbodyTd.innerHTML=txt;
instance.view.wt.wtDom.empty(tmp.rendererTd);
instance.view.wt.wtDom.empty(tmp.noRendererTd);
tmp.containerStyle.display="block";
var width=tmp.$container.outerWidth();
var cellProperties=instance.getCellMeta(0,col);
if(cellProperties.renderer){var str=9999999999;
tmp.noRendererTd.appendChild(document.createTextNode(str));
cellProperties.renderer(instance,tmp.rendererTd,0,col,instance.colToProp(col),str,cellProperties);
width+=tmp.$renderer.width()-tmp.$noRenderer.width()
}tmp.containerStyle.display="none";
return width
};
this.determineColumnsWidth=function(){instance=this;
var settings=this.getSettings();
if(settings.autoColumnSize||!settings.colWidths){var cols=this.countCols();
for(var c=0;
c<cols;
c++){this.autoColumnWidths[c]=that.determineColumnWidth(c)
}}};
this.getColWidth=function(col,response){if(this.autoColumnWidths[col]&&this.autoColumnWidths[col]>response.width){response.width=this.autoColumnWidths[col]
}}
}var htAutoColumnSize=new HandsontableAutoColumnSize();
Handsontable.PluginHooks.push("beforeInit",htAutoColumnSize.beforeInit);
Handsontable.PluginHooks.push("beforeRender",htAutoColumnSize.determineColumnsWidth);
Handsontable.PluginHooks.push("afterGetColWidth",htAutoColumnSize.getColWidth);
function HandsontableColumnSorting(){var plugin=this;
var sortingEnabled;
this.afterInit=function(){var instance=this;
if(this.getSettings().columnSorting){this.sortIndex=[];
this.rootElement.on("click.handsontable",".columnSorting",function(e){var $target=$(e.target);
if($target.is(".columnSorting")){var col=$target.closest("th").index();
if(instance.getSettings().rowHeaders){col--
}if(instance.sortColumn===col){instance.sortOrder=!instance.sortOrder
}else{instance.sortColumn=col;
instance.sortOrder=true
}plugin.sort.call(instance);
instance.render()
}})
}};
this.sort=function(){sortingEnabled=false;
var instance=this;
this.sortIndex.length=0;
for(var i=0,ilen=this.countRows();
i<ilen;
i++){this.sortIndex.push([i,instance.getDataAtCell(i,this.sortColumn)])
}this.sortIndex.sort(function(a,b){if(a[1]===b[1]){return 0
}if(a[1]===null){return 1
}if(b[1]===null){return -1
}if(a[1]<b[1]){return instance.sortOrder?-1:1
}if(a[1]>b[1]){return instance.sortOrder?1:-1
}return 0
});
sortingEnabled=true
};
this.translateRow=function(getVars){if(sortingEnabled&&this.sortIndex&&this.sortIndex.length){getVars.row=this.sortIndex[getVars.row][0]
}};
this.getColHeader=function(col,TH){if(this.getSettings().columnSorting){$(TH).find("span.colHeader")[0].className+=" columnSorting"
}}
}var htSortColumn=new HandsontableColumnSorting();
Handsontable.PluginHooks.push("afterInit",htSortColumn.afterInit);
Handsontable.PluginHooks.push("beforeGet",htSortColumn.translateRow);
Handsontable.PluginHooks.push("beforeSet",htSortColumn.translateRow);
Handsontable.PluginHooks.push("afterGetColHeader",htSortColumn.getColHeader);
function createContextMenu(){var instance=this,selectorId=instance.rootElement[0].id,allItems={row_above:{name:"Insert row above",disabled:isDisabled},row_below:{name:"Insert row below",disabled:isDisabled},hsep1:"---------",col_left:{name:"Insert column on the left",disabled:isDisabled},col_right:{name:"Insert column on the right",disabled:isDisabled},hsep2:"---------",remove_row:{name:"Remove row",disabled:isDisabled},remove_col:{name:"Remove column",disabled:isDisabled},hsep3:"---------",undo:{name:"Undo",disabled:function(){return !instance.isUndoAvailable()
}},redo:{name:"Redo",disabled:function(){return !instance.isRedoAvailable()
}}},defaultOptions={selector:"#"+selectorId+" table, #"+selectorId+" div",trigger:"right",callback:onContextClick},options={},i,ilen,settings=instance.getSettings();
function onContextClick(key){var corners=instance.getSelected();
if(!corners){return
}switch(key){case"row_above":instance.alter("insert_row",corners[0]);
break;
case"row_below":instance.alter("insert_row",corners[2]+1);
break;
case"col_left":instance.alter("insert_col",corners[1]);
break;
case"col_right":instance.alter("insert_col",corners[3]+1);
break;
case"remove_row":instance.alter(key,corners[0],(corners[2]-corners[0])+1);
break;
case"remove_col":instance.alter(key,corners[1],(corners[3]-corners[1])+1);
break;
case"undo":instance.undo();
break;
case"redo":instance.redo();
break
}}function isDisabled(key){if(instance.countRows()>=instance.getSettings().maxRows&&(key==="row_above"||key==="row_below")){return true
}else{if(instance.countCols()>=instance.getSettings().maxCols&&(key==="col_left"||key==="col_right")){return true
}else{return false
}}}if(!settings.contextMenu){return
}else{if(settings.contextMenu===true){options.items=allItems
}else{if(Object.prototype.toString.apply(settings.contextMenu)==="[object Array]"){options.items={};
for(i=0,ilen=settings.contextMenu.length;
i<ilen;
i++){var key=settings.contextMenu[i];
if(typeof allItems[key]==="undefined"){throw new Error('Context menu key "'+key+'" is not recognised')
}options.items[key]=allItems[key]
}}else{if(Object.prototype.toString.apply(settings.contextMenu)==="[object Object]"){options=settings.contextMenu;
if(options.items){for(i in options.items){if(options.items.hasOwnProperty(i)&&allItems[i]){if(typeof options.items[i]==="string"){options.items[i]=allItems[i]
}else{options.items[i]=$.extend(true,allItems[i],options.items[i])
}}}}else{options.items=allItems
}if(options.callback){var handsontableCallback=defaultOptions.callback;
var customCallback=options.callback;
options.callback=function(key,options){handsontableCallback(key,options);
customCallback(key,options)
}
}}}}}if(!selectorId){throw new Error("Handsontable container must have an id")
}$.contextMenu($.extend(true,defaultOptions,options))
}function destroyContextMenu(){var id=this.rootElement[0].id;
$.contextMenu("destroy","#"+id+" table, #"+id+" div")
}Handsontable.PluginHooks.push("afterInit",createContextMenu);
Handsontable.PluginHooks.push("afterDestroy",destroyContextMenu);
Handsontable.PluginHooks.push("beforeGetCellMeta",function(row,col,cellProperties){var settings=this.getSettings(),data=this.getData(),i,ilen,a;
if(settings.autoComplete){for(i=0,ilen=settings.autoComplete.length;
i<ilen;
i++){if(settings.autoComplete[i].match(row,col,data)){if(typeof cellProperties.type==="undefined"){cellProperties.type=Handsontable.AutocompleteCell
}else{if(typeof cellProperties.type.renderer==="undefined"){cellProperties.type.renderer=Handsontable.AutocompleteCell.renderer
}if(typeof cellProperties.type.editor==="undefined"){cellProperties.type.editor=Handsontable.AutocompleteCell.editor
}}for(a in settings.autoComplete[i]){if(settings.autoComplete[i].hasOwnProperty(a)&&a!=="match"&&typeof cellProperties[i]==="undefined"){if(a==="source"){cellProperties[a]=settings.autoComplete[i][a](row,col)
}else{cellProperties[a]=settings.autoComplete[i][a]
}}}break
}}}});
function HandsontableManualColumnMove(){var instance,pressed,startCol,endCol,startX,startOffset;
var ghost=document.createElement("DIV"),ghostStyle=ghost.style;
ghost.className="ghost";
ghostStyle.position="absolute";
ghostStyle.top="25px";
ghostStyle.left=0;
ghostStyle.width="10px";
ghostStyle.height="10px";
ghostStyle.backgroundColor="#CCC";
ghostStyle.opacity=0.7;
$(document).mousemove(function(e){if(pressed){ghostStyle.left=startOffset+e.pageX-startX+6+"px";
if(ghostStyle.display==="none"){ghostStyle.display="block"
}}});
$(document).mouseup(function(){if(pressed){if(startCol<endCol){endCol--
}if(instance.getSettings().rowHeaders){startCol--;
endCol--
}instance.manualColumnPositions.splice(endCol,0,instance.manualColumnPositions.splice(startCol,1)[0]);
$(".manualColumnMover.active").removeClass("active");
pressed=false;
instance.forceFullRender=true;
instance.view.render();
ghostStyle.display="none"
}});
this.beforeInit=function(){this.manualColumnPositions=[]
};
this.afterInit=function(){if(this.getSettings().manualColumnMove){var that=this;
this.rootElement.on("mousedown.handsontable",".manualColumnMover",function(e){instance=that;
var $resizer=$(e.target);
var th=$resizer.closest("th");
startCol=th.index();
pressed=true;
startX=e.pageX;
var $table=that.rootElement.find(".htCore");
$table.parent()[0].appendChild(ghost);
ghostStyle.width=$resizer.parent().width()+"px";
ghostStyle.height=$table.height()+"px";
startOffset=parseInt(th.offset().left-$table.offset().left,10);
ghostStyle.left=startOffset+6+"px"
});
this.rootElement.on("mouseenter.handsontable","td, th",function(){if(pressed){$(".manualColumnMover.active").removeClass("active");
var $ths=that.rootElement.find("thead th");
endCol=$(this).index();
var $hover=$ths.eq(endCol).find(".manualColumnMover").addClass("active");
$ths.not($hover).removeClass("active")
}})
}};
this.modifyCol=function(col){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[col]==="undefined"){this.manualColumnPositions[col]=col
}return this.manualColumnPositions[col]
}return col
};
this.getColHeader=function(col,TH){if(this.getSettings().manualColumnMove){var DIV=document.createElement("DIV");
DIV.className="manualColumnMover";
TH.firstChild.appendChild(DIV)
}}
}var htManualColumnMove=new HandsontableManualColumnMove();
Handsontable.PluginHooks.push("beforeInit",htManualColumnMove.beforeInit);
Handsontable.PluginHooks.push("afterInit",htManualColumnMove.afterInit);
Handsontable.PluginHooks.push("afterGetColHeader",htManualColumnMove.getColHeader);
Handsontable.PluginModifiers.push("col",htManualColumnMove.modifyCol);
function HandsontableManualColumnResize(){var pressed,currentCol,currentWidth,instance,start,startX,startWidth,startOffset,resizer=document.createElement("DIV"),line=document.createElement("DIV"),lineStyle=line.style;
resizer.className="manualColumnResizer";
line.className="manualColumnResizerLine";
lineStyle.position="absolute";
lineStyle.top=0;
lineStyle.left=0;
lineStyle.width=0;
lineStyle.borderRight="1px dashed #777";
line.appendChild(resizer);
$(document).mousemove(function(e){if(pressed){currentWidth=startWidth+(e.pageX-startX);
setManualSize(currentCol,currentWidth);
lineStyle.left=startOffset+currentWidth-1+"px";
if(lineStyle.display==="none"){lineStyle.display="block"
}}});
$(document).mouseup(function(){if(pressed){$(".manualColumnResizer.active").removeClass("active");
pressed=false;
instance.forceFullRender=true;
instance.view.render();
lineStyle.display="none"
}});
$(document).dblclick(function(e){if($(e.target).is(".manualColumnResizer")){setManualSize(currentCol,htAutoColumnSize.determineColumnWidth.call(instance,currentCol))
}});
this.beforeInit=function(){this.manualColumnWidths=[]
};
this.afterInit=function(){if(this.getSettings().manualColumnResize){var that=this;
this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){var _resizer=e.target,$table=that.rootElement.find(".htCore"),$grandpa=$(_resizer.parentNode.parentNode);
instance=that;
currentCol=_resizer.getAttribute("rel");
start=$(that.rootElement[0].getElementsByTagName("col")[$grandpa.index()]);
pressed=true;
startX=e.pageX;
startWidth=start.width();
currentWidth=startWidth;
_resizer.className+=" active";
lineStyle.height=$table.height()+"px";
$table.parent()[0].appendChild(line);
startOffset=parseInt($grandpa.offset().left-$table.offset().left,10);
lineStyle.left=startOffset+currentWidth-1+"px"
})
}};
var setManualSize=function(col,width){width=Math.max(width,20);
width=Math.min(width,500);
instance.manualColumnWidths[col]=width
};
this.getColHeader=function(col,TH){if(this.getSettings().manualColumnResize){var DIV=document.createElement("DIV");
DIV.className="manualColumnResizer";
DIV.setAttribute("rel",col);
TH.firstChild.appendChild(DIV)
}};
this.getColWidth=function(col,response){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[col]){response.width=this.manualColumnWidths[col]
}}
}var htManualColumnResize=new HandsontableManualColumnResize();
Handsontable.PluginHooks.push("beforeInit",htManualColumnResize.beforeInit);
Handsontable.PluginHooks.push("afterInit",htManualColumnResize.afterInit);
Handsontable.PluginHooks.push("afterGetColHeader",htManualColumnResize.getColHeader);
Handsontable.PluginHooks.push("afterGetColWidth",htManualColumnResize.getColWidth);
(function($){autoResize.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};
autoResize.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];
autoResize.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",border:"1px solid black",padding:"0.49em"};
autoResize.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";
autoResize.AutoResizer=AutoResizer;
$.fn.autoResize=autoResize;
function autoResize(config){this.filter(autoResize.resizableFilterSelector).each(function(){new AutoResizer($(this),config)
});
return this
}function AutoResizer(el,config){if(this.clones){return
}this.config=$.extend({},autoResize.defaults,config);
this.el=el;
this.nodeName=el[0].nodeName.toLowerCase();
this.previousScrollTop=null;
if(config.maxWidth==="original"){config.maxWidth=el.width()
}if(config.minWidth==="original"){config.minWidth=el.width()
}if(config.maxHeight==="original"){config.maxHeight=el.height()
}if(config.minHeight==="original"){config.minHeight=el.height()
}if(this.nodeName==="textarea"){el.css({resize:"none",overflowY:"hidden"})
}el.data("AutoResizer",this);
this.createClone();
this.injectClone();
this.bind()
}AutoResizer.prototype={bind:function(){var check=$.proxy(function(){this.check();
return true
},this);
this.unbind();
this.el.bind("keyup.autoResize",check).bind("change.autoResize",check);
this.check(null,true)
},unbind:function(){this.el.unbind(".autoResize")
},createClone:function(){var el=this.el,self=this,config=this.config;
this.clones=$();
if(config.minHeight!=="original"||config.maxHeight!=="original"){this.hClone=el.clone().height("auto");
this.clones=this.clones.add(this.hClone)
}if(config.minWidth!=="original"||config.maxWidth!=="original"){this.wClone=$("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"});
this.clones=this.clones.add(this.wClone)
}$.each(autoResize.cloneCSSProperties,function(i,p){self.clones.css(p,el.css(p))
});
this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(autoResize.cloneCSSValues)
},check:function(e,immediate){var config=this.config,wClone=this.wClone,hClone=this.hClone,el=this.el,value=el.val();
if(wClone){wClone.text(value);
var cloneWidth=wClone.outerWidth(),newWidth=(cloneWidth+config.extraSpace)>=config.minWidth?cloneWidth+config.extraSpace:config.minWidth,currentWidth=el.width();
newWidth=Math.min(newWidth,config.maxWidth);
if((newWidth<currentWidth&&newWidth>=config.minWidth)||(newWidth>=config.minWidth&&newWidth<=config.maxWidth)){config.onResize.call(el);
el.scrollLeft(0);
config.animate&&!immediate?el.stop(1,1).animate({width:newWidth},config.animate):el.width(newWidth)
}}if(hClone){if(newWidth){hClone.width(newWidth)
}hClone.height(0).val(value).scrollTop(10000);
var scrollTop=hClone[0].scrollTop+config.extraSpace;
if(this.previousScrollTop===scrollTop){return
}this.previousScrollTop=scrollTop;
if(scrollTop>=config.maxHeight){el.css("overflowY","");
return
}el.css("overflowY","hidden");
if(scrollTop<config.minHeight){scrollTop=config.minHeight
}config.onResize.call(el);
config.animate&&!immediate?el.stop(1,1).animate({height:scrollTop},config.animate):el.height(scrollTop)
}},destroy:function(){this.unbind();
this.el.removeData("AutoResizer");
this.clones.remove();
delete this.el;
delete this.hClone;
delete this.wClone;
delete this.clones
},injectClone:function(){(autoResize.cloneContainer||(autoResize.cloneContainer=$("<arclones/>").appendTo("body"))).empty().append(this.clones)
}}
})(jQuery);
(function(global){function countQuotes(str){return str.split('"').length-1
}global.SheetClip={parse:function(str){var r,rlen,rows,arr=[],a=0,c,clen,multiline,last;
rows=str.split("\n");
if(rows.length>1&&rows[rows.length-1]===""){rows.pop()
}for(r=0,rlen=rows.length;
r<rlen;
r+=1){rows[r]=rows[r].split("\t");
for(c=0,clen=rows[r].length;
c<clen;
c+=1){if(!arr[a]){arr[a]=[]
}if(multiline&&c===0){last=arr[a].length-1;
arr[a][last]=arr[a][last]+"\n"+rows[r][0];
if(multiline&&(countQuotes(rows[r][0])&1)){multiline=false;
arr[a][last]=arr[a][last].substring(0,arr[a][last].length-1).replace(/""/g,'"')
}}else{if(c===clen-1&&rows[r][c].indexOf('"')===0){arr[a].push(rows[r][c].substring(1).replace(/""/g,'"'));
multiline=true
}else{arr[a].push(rows[r][c].replace(/""/g,'"'));
multiline=false
}}}if(!multiline){a+=1
}}return arr
},stringify:function(arr){var r,rlen,c,clen,str="",val;
for(r=0,rlen=arr.length;
r<rlen;
r+=1){for(c=0,clen=arr[r].length;
c<clen;
c+=1){if(c>0){str+="\t"
}val=arr[r][c];
if(typeof val==="string"){if(val.indexOf("\n")>-1){str+='"'+val.replace(/"/g,'""')+'"'
}else{str+=val
}}else{if(val===null||val===void 0){str+=""
}else{str+=val
}}}str+="\n"
}return str
}}
}(window));
function CopyPaste(listenerElement){var that=this,style;
listenerElement=listenerElement||document.body;
this.elDiv=document.createElement("DIV");
style=this.elDiv.style;
style.position="fixed";
style.top=0;
style.left=0;
listenerElement.appendChild(this.elDiv);
this.elTextarea=document.createElement("TEXTAREA");
this.elTextarea.className="copyPaste";
style=this.elTextarea.style;
style.width="1px";
style.height="1px";
this.elDiv.appendChild(this.elTextarea);
if(typeof style.opacity!=="undefined"){style.opacity=0
}else{
/*@cc_on @if (@_jscript)
     if(typeof style.filter === 'string') {
     style.filter = 'alpha(opacity=0)';
     }
     @end @*/
}this._bindEvent(listenerElement,"keydown",function(event){var isCtrlDown=false;
if(event.metaKey){isCtrlDown=true
}else{if(event.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){isCtrlDown=true
}}if(isCtrlDown){that.selectNodeText(that.elTextarea);
setTimeout(function(){that.selectNodeText(that.elTextarea)
},0)
}if(isCtrlDown&&(event.keyCode===67||event.keyCode===86||event.keyCode===88)){if(event.keyCode===88){setTimeout(function(){that.triggerCut(event)
},0)
}else{if(event.keyCode===86){setTimeout(function(){that.triggerPaste(event)
},0)
}}}})
}CopyPaste.prototype.selectNodeText=function(el){el.select()
};
CopyPaste.prototype.copyable=function(str){if(typeof str!=="string"&&str.toString===void 0){throw new Error("copyable requires string parameter")
}this.elTextarea.value=str
};
CopyPaste.prototype.onCopy=function(fn){this.copyCallback=fn
};
CopyPaste.prototype.onCut=function(fn){this.cutCallback=fn
};
CopyPaste.prototype.onPaste=function(fn){this.pasteCallback=fn
};
CopyPaste.prototype.triggerCut=function(event){var that=this;
if(that.cutCallback){setTimeout(function(){that.cutCallback(event)
},0)
}};
CopyPaste.prototype.triggerPaste=function(event,str){var that=this;
if(that.pasteCallback){setTimeout(function(){that.pasteCallback((str||that.elTextarea.value).replace(/\n$/,""),event)
},0)
}};
CopyPaste.prototype._bindEvent=(function(){if(document.addEventListener){return function(elem,type,cb){elem.addEventListener(type,cb,false)
}
}else{return function(elem,type,cb){elem.attachEvent("on"+type,function(){var e=window.event;
e.target=e.srcElement;
e.relatedTarget=e.relatedTarget||e.type=="mouseover"?e.fromElement:e.toElement;
if(e.target.nodeType===3){e.target=e.target.parentNode
}return cb.call(elem,e)
})
}
}})();
function WalkontableBorder(instance,settings){var style;
this.instance=instance;
this.settings=settings;
this.wtDom=this.instance.wtDom;
this.main=document.createElement("div");
style=this.main.style;
style.position="absolute";
style.top=0;
style.left=0;
for(var i=0;
i<5;
i++){var DIV=document.createElement("DIV");
DIV.className="wtBorder "+(settings.className||"");
style=DIV.style;
style.backgroundColor=settings.border.color;
style.height=settings.border.width+"px";
style.width=settings.border.width+"px";
this.main.appendChild(DIV)
}this.top=this.main.childNodes[0];
this.left=this.main.childNodes[1];
this.bottom=this.main.childNodes[2];
this.right=this.main.childNodes[3];
this.topStyle=this.top.style;
this.leftStyle=this.left.style;
this.bottomStyle=this.bottom.style;
this.rightStyle=this.right.style;
this.corner=this.main.childNodes[4];
this.corner.className+=" corner";
this.cornerStyle=this.corner.style;
this.cornerStyle.width="5px";
this.cornerStyle.height="5px";
this.cornerStyle.border="2px solid #FFF";
this.disappear();
instance.wtTable.hider.appendChild(this.main)
}WalkontableBorder.prototype.appear=function(corners){var isMultiple,$from,$to,fromOffset,toOffset,containerOffset,top,minTop,left,minLeft,height,width;
if(this.disabled){return
}var instance=this.instance,fromRow,fromColumn,toRow,toColumn,hideTop=false,hideLeft=false,hideBottom=false,hideRight=false,i,ilen,s;
if(!instance.wtTable.isRowInViewport(corners[0])){hideTop=true
}if(!instance.wtTable.isRowInViewport(corners[2])){hideBottom=true
}ilen=instance.wtTable.countVisibleRows();
for(i=0;
i<ilen;
i++){s=instance.wtTable.rowFilter.visibleToSource(i);
if(s>=corners[0]&&s<=corners[2]){fromRow=s;
break
}}for(i=ilen-1;
i>=0;
i--){s=instance.wtTable.rowFilter.visibleToSource(i);
if(s>=corners[0]&&s<=corners[2]){toRow=s;
break
}}if(hideTop&&hideBottom){hideLeft=true;
hideRight=true
}else{if(!instance.wtTable.isColumnInViewport(corners[1])){hideLeft=true
}if(!instance.wtTable.isColumnInViewport(corners[3])){hideRight=true
}ilen=instance.wtTable.countVisibleColumns();
for(i=0;
i<ilen;
i++){s=instance.wtTable.columnFilter.visibleToSource(i);
if(s>=corners[1]&&s<=corners[3]){fromColumn=s;
break
}}for(i=ilen-1;
i>=0;
i--){s=instance.wtTable.columnFilter.visibleToSource(i);
if(s>=corners[1]&&s<=corners[3]){toColumn=s;
break
}}}if(fromRow!==void 0&&fromColumn!==void 0){isMultiple=(fromRow!==toRow||fromColumn!==toColumn);
$from=$(instance.wtTable.getCell([fromRow,fromColumn]));
$to=isMultiple?$(instance.wtTable.getCell([toRow,toColumn])):$from;
fromOffset=this.wtDom.offset($from[0]);
toOffset=isMultiple?this.wtDom.offset($to[0]):fromOffset;
containerOffset=this.wtDom.offset(instance.wtTable.TABLE);
minTop=fromOffset.top;
height=toOffset.top+$to.outerHeight()-minTop;
minLeft=fromOffset.left;
width=toOffset.left+$to.outerWidth()-minLeft;
top=minTop-containerOffset.top-1;
left=minLeft-containerOffset.left-1;
if(parseInt($from.css("border-top-width"),10)>0){top+=1;
height-=1
}if(parseInt($from.css("border-left-width"),10)>0){left+=1;
width-=1
}}else{this.disappear();
return
}if(hideTop){this.topStyle.display="none"
}else{this.topStyle.top=top+"px";
this.topStyle.left=left+"px";
this.topStyle.width=width+"px";
this.topStyle.display="block"
}if(hideLeft){this.leftStyle.display="none"
}else{this.leftStyle.top=top+"px";
this.leftStyle.left=left+"px";
this.leftStyle.height=height+"px";
this.leftStyle.display="block"
}var delta=Math.floor(this.settings.border.width/2);
if(hideBottom){this.bottomStyle.display="none"
}else{this.bottomStyle.top=top+height-delta+"px";
this.bottomStyle.left=left+"px";
this.bottomStyle.width=width+"px";
this.bottomStyle.display="block"
}if(hideRight){this.rightStyle.display="none"
}else{this.rightStyle.top=top+"px";
this.rightStyle.left=left+width-delta+"px";
this.rightStyle.height=height+1+"px";
this.rightStyle.display="block"
}if(hideBottom||hideRight||!this.hasSetting(this.settings.border.cornerVisible)){this.cornerStyle.display="none"
}else{this.cornerStyle.top=top+height-4+"px";
this.cornerStyle.left=left+width-4+"px";
this.cornerStyle.display="block"
}};
WalkontableBorder.prototype.disappear=function(){this.topStyle.display="none";
this.leftStyle.display="none";
this.bottomStyle.display="none";
this.rightStyle.display="none";
this.cornerStyle.display="none"
};
WalkontableBorder.prototype.hasSetting=function(setting){if(typeof setting==="function"){return setting()
}return !!setting
};
function WalkontableCellFilter(){this.offset=0;
this.total=0;
this.fixedCount=0
}WalkontableCellFilter.prototype.source=function(n){return n
};
WalkontableCellFilter.prototype.offsetted=function(n){return n+this.offset
};
WalkontableCellFilter.prototype.unOffsetted=function(n){return n-this.offset
};
WalkontableCellFilter.prototype.fixed=function(n){if(n<this.fixedCount){return n-this.offset
}else{return n
}};
WalkontableCellFilter.prototype.unFixed=function(n){if(n<this.fixedCount){return n+this.offset
}else{return n
}};
WalkontableCellFilter.prototype.visibleToSource=function(n){return this.source(this.offsetted(this.fixed(n)))
};
WalkontableCellFilter.prototype.sourceToVisible=function(n){return this.source(this.unOffsetted(this.unFixed(n)))
};
function WalkontableClassNameCache(){this.cache=[]
}WalkontableClassNameCache.prototype.add=function(r,c,cls){if(!this.cache[r]){this.cache[r]=[]
}if(!this.cache[r][c]){this.cache[r][c]=[]
}this.cache[r][c][cls]=true
};
WalkontableClassNameCache.prototype.test=function(r,c,cls){return(this.cache[r]&&this.cache[r][c]&&this.cache[r][c][cls])
};
function WalkontableColumnFilter(){this.countTH=0
}WalkontableColumnFilter.prototype=new WalkontableCellFilter();
WalkontableColumnFilter.prototype.readSettings=function(instance){this.offset=instance.wtSettings.settings.offsetColumn;
this.total=instance.getSetting("totalColumns");
this.fixedCount=instance.getSetting("fixedColumnsLeft");
this.countTH=instance.hasSetting("rowHeaders")?1:0
};
WalkontableColumnFilter.prototype.offsettedTH=function(n){return n-this.countTH
};
WalkontableColumnFilter.prototype.unOffsettedTH=function(n){return n+this.countTH
};
WalkontableColumnFilter.prototype.visibleRowHeadedColumnToSourceColumn=function(n){return this.visibleToSource(this.offsettedTH(n))
};
WalkontableColumnFilter.prototype.sourceColumnToVisibleRowHeadedColumn=function(n){return this.unOffsettedTH(this.sourceToVisible(n))
};
function WalkontableColumnStrategy(containerSizeFn,sizeAtIndex,strategy){var size,i=0;
this.containerSizeFn=containerSizeFn;
this.cellSizesSum=0;
this.cellSizes=[];
this.cellCount=0;
this.remainingSize=0;
while(true){size=sizeAtIndex(i);
if(size===void 0){break
}if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+size)){break
}this.cellSizes.push(size);
this.cellSizesSum+=size;
this.cellCount++;
i++
}var containerSize=this.getContainerSize(this.cellSizesSum);
this.remainingSize=this.cellSizesSum-containerSize;
if(strategy==="all"){if(this.remainingSize<0){var ratio=containerSize/this.cellSizesSum;
var newSize;
for(i=0;
i<this.cellCount-1;
i++){newSize=Math.floor(ratio*this.cellSizes[i]);
this.remainingSize+=newSize-this.cellSizes[i];
this.cellSizes[i]=newSize
}this.cellSizes[this.cellCount-1]-=this.remainingSize;
this.remainingSize=0
}}else{if(strategy==="last"){if(this.remainingSize<0){this.cellSizes[this.cellCount-1]-=this.remainingSize;
this.remainingSize=0
}}}}WalkontableColumnStrategy.prototype.getContainerSize=function(proposedWidth){var containerSize=typeof this.containerSizeFn==="function"?this.containerSizeFn(proposedWidth):this.containerSizeFn;
if(containerSize===void 0||containerSize===null||containerSize<1){containerSize=Infinity
}return containerSize
};
WalkontableColumnStrategy.prototype.getSize=function(index){return this.cellSizes[index]
};
function Walkontable(settings){var self=this,originalHeaders=[];
this.wtSettings=new WalkontableSettings(this,settings);
this.wtDom=new WalkontableDom();
this.wtTable=new WalkontableTable(this);
this.wtScroll=new WalkontableScroll(this);
this.wtWheel=new WalkontableWheel(this);
this.wtEvent=new WalkontableEvent(this);
if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var c=0,clen=this.wtTable.THEAD.childNodes[0].childNodes.length;
c<clen;
c++){originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML)
}if(!this.hasSetting("columnHeaders")){this.update("columnHeaders",function(column,TH){self.wtDom.avoidInnerHTML(TH,originalHeaders[column])
})
}}this.selections={};
var selectionsSettings=this.getSetting("selections");
if(selectionsSettings){for(var i in selectionsSettings){if(selectionsSettings.hasOwnProperty(i)){this.selections[i]=new WalkontableSelection(this,selectionsSettings[i])
}}}this.drawn=false;
this.drawInterrupted=false
}Walkontable.prototype.isVisible=function(){var next=this.wtTable.TABLE;
while(next!==document.documentElement){if(next===null){return false
}else{if(next.style.display==="none"){return false
}else{if(this.wtTable.TABLE.parentNode.clientWidth===0){return false
}}}next=next.parentNode
}return true
};
Walkontable.prototype.draw=function(selectionsOnly){this.drawInterrupted=false;
if(!selectionsOnly&&!this.isVisible()){this.drawInterrupted=true;
return
}this.getSetting("beforeDraw",!selectionsOnly);
selectionsOnly=selectionsOnly&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;
if(this.drawn){this.scrollVertical(0);
this.scrollHorizontal(0)
}this.lastOffsetRow=this.getSetting("offsetRow");
this.lastOffsetColumn=this.getSetting("offsetColumn");
this.wtTable.draw(selectionsOnly);
this.getSetting("onDraw");
return this
};
Walkontable.prototype.update=function(settings,value){return this.wtSettings.update(settings,value)
};
Walkontable.prototype.scrollVertical=function(delta){return this.wtScroll.scrollVertical(delta)
};
Walkontable.prototype.scrollHorizontal=function(delta){return this.wtScroll.scrollHorizontal(delta)
};
Walkontable.prototype.scrollViewport=function(coords){this.wtScroll.scrollViewport(coords);
return this
};
Walkontable.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]
};
Walkontable.prototype.getSetting=function(key,param1,param2,param3){return this.wtSettings.getSetting(key,param1,param2,param3)
};
Walkontable.prototype.hasSetting=function(key){return this.wtSettings.has(key)
};
Walkontable.prototype.destroy=function(){clearTimeout(this.wheelTimeout);
clearTimeout(this.dblClickTimeout)
};
function WalkontableDom(){}WalkontableDom.prototype.closest=function(elem,nodeNames){while(elem!=null){if(elem.nodeType===1&&nodeNames.indexOf(elem.nodeName)>-1){return elem
}elem=elem.parentNode
}return null
};
WalkontableDom.prototype.prevSiblings=function(elem){var out=[];
while((elem=elem.previousSibling)!=null){if(elem.nodeType===1){out.push(elem)
}}return out
};
if(document.documentElement.classList){WalkontableDom.prototype.hasClass=function(ele,cls){return ele.classList.contains(cls)
};
WalkontableDom.prototype.addClass=function(ele,cls){ele.classList.add(cls)
};
WalkontableDom.prototype.removeClass=function(ele,cls){ele.classList.remove(cls)
}
}else{WalkontableDom.prototype.hasClass=function(ele,cls){return ele.className.match(new RegExp("(\\s|^)"+cls+"(\\s|$)"))
};
WalkontableDom.prototype.addClass=function(ele,cls){if(!this.hasClass(ele,cls)){ele.className+=" "+cls
}};
WalkontableDom.prototype.removeClass=function(ele,cls){if(this.hasClass(ele,cls)){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");
ele.className=ele.className.replace(reg," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")
}}
}WalkontableDom.prototype.removeTextNodes=function(elem,parent){if(elem.nodeType===3){parent.removeChild(elem)
}else{if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(elem.nodeName)>-1){var childs=elem.childNodes;
for(var i=childs.length-1;
i>=0;
i--){this.removeTextNodes(childs[i],elem)
}}}};
WalkontableDom.prototype.empty=function(element){var child;
while(child=element.lastChild){element.removeChild(child)
}};
WalkontableDom.prototype.avoidInnerHTML=function(element,content){if((/(<(.*)>|&(.*);)/g).test(content)){element.innerHTML=content
}else{var child;
while(child=element.lastChild){element.removeChild(child)
}element.appendChild(document.createTextNode(content))
}};
WalkontableDom.prototype.offset=function(elem){var offsetLeft=elem.offsetLeft,offsetTop=elem.offsetTop;
while(elem=elem.offsetParent){offsetLeft+=elem.offsetLeft;
offsetTop+=elem.offsetTop
}return{left:offsetLeft,top:offsetTop}
};
function WalkontableEvent(instance){var that=this;
this.instance=instance;
this.wtDom=this.instance.wtDom;
var dblClickOrigin=[null,null,null,null];
this.instance.dblClickTimeout=null;
var onMouseDown=function(event){var cell=that.parentCell(event.target);
if(cell.TD&&cell.TD.nodeName==="TD"){if(that.instance.hasSetting("onCellMouseDown")){that.instance.getSetting("onCellMouseDown",event,cell.coords,cell.TD)
}}else{if(that.wtDom.hasClass(event.target,"corner")){that.instance.getSetting("onCellCornerMouseDown",event,event.target)
}}if(event.button!==2){if(cell.TD&&cell.TD.nodeName==="TD"){dblClickOrigin.shift();
dblClickOrigin.push(cell.TD)
}else{if(that.wtDom.hasClass(event.target,"corner")){dblClickOrigin.shift();
dblClickOrigin.push(event.target)
}}}};
var lastMouseOver;
var onMouseOver=function(event){if(that.instance.hasSetting("onCellMouseOver")){var TD=that.wtDom.closest(event.target,["TD","TH"]);
if(TD&&TD!==lastMouseOver){lastMouseOver=TD;
if(TD.nodeName==="TD"){that.instance.getSetting("onCellMouseOver",event,that.instance.wtTable.getCoords(TD),TD)
}}}};
var onMouseUp=function(event){if(event.button!==2){var cell=that.parentCell(event.target);
if(cell.TD&&cell.TD.nodeName==="TD"){dblClickOrigin.shift();
dblClickOrigin.push(cell.TD)
}else{dblClickOrigin.shift();
dblClickOrigin.push(event.target)
}if(dblClickOrigin[3]!==null&&dblClickOrigin[3]===dblClickOrigin[2]){if(that.instance.dblClickTimeout&&dblClickOrigin[2]===dblClickOrigin[1]&&dblClickOrigin[1]===dblClickOrigin[0]){if(cell.TD){that.instance.getSetting("onCellDblClick",event,cell.coords,cell.TD)
}else{if(that.wtDom.hasClass(event.target,"corner")){that.instance.getSetting("onCellCornerDblClick",event,cell.coords,cell.TD)
}}clearTimeout(that.instance.dblClickTimeout);
that.instance.dblClickTimeout=null
}else{clearTimeout(that.instance.dblClickTimeout);
that.instance.dblClickTimeout=setTimeout(function(){that.instance.dblClickTimeout=null
},500)
}}}};
$(this.instance.wtTable.parent).on("mousedown",onMouseDown);
$(this.instance.wtTable.TABLE).on("mouseover",onMouseOver);
$(this.instance.wtTable.parent).on("mouseup",onMouseUp)
}WalkontableEvent.prototype.parentCell=function(elem){var cell={};
cell.TD=this.wtDom.closest(elem,["TD","TH"]);
if(cell.TD){cell.coords=this.instance.wtTable.getCoords(cell.TD)
}else{if(!cell.TD&&this.wtDom.hasClass(elem,"wtBorder")&&this.wtDom.hasClass(elem,"current")&&!this.wtDom.hasClass(elem,"corner")){cell.coords=this.instance.selections.current.selected[0];
cell.TD=this.instance.wtTable.getCell(cell.coords)
}}return cell
};
function walkontableRangesIntersect(){var from=arguments[0];
var to=arguments[1];
for(var i=1,ilen=arguments.length/2;
i<ilen;
i++){if(from<=arguments[2*i+1]&&to>=arguments[2*i]){return true
}}return false
}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;
var from=Number(arguments[1])||0;
from=(from<0)?Math.ceil(from):Math.floor(from);
if(from<0){from+=len
}for(;
from<len;
from++){if(from in this&&this[from]===elt){return from
}}return -1
}
}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){return window.setTimeout(callback,1000/60)
}
})();
window.cancelRequestAnimFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout
})();
if(!window.getComputedStyle){(function(){var elem;
var styleObj={getPropertyValue:function getPropertyValue(prop){if(prop=="float"){prop="styleFloat"
}return elem.currentStyle[prop.toUpperCase()]||null
}};
window.getComputedStyle=function(el){elem=el;
return styleObj
}
})()
}function WalkontableRowFilter(){}WalkontableRowFilter.prototype=new WalkontableCellFilter();
WalkontableRowFilter.prototype.readSettings=function(instance){this.offset=instance.wtSettings.settings.offsetRow;
this.total=instance.getSetting("totalRows");
this.fixedCount=instance.getSetting("fixedRowsTop")
};
function WalkontableScroll(instance){this.instance=instance;
this.wtScrollbarV=new WalkontableVerticalScrollbar(instance);
this.wtScrollbarH=new WalkontableHorizontalScrollbar(instance)
}WalkontableScroll.prototype.refreshScrollbars=function(){this.wtScrollbarH.readSettings();
this.wtScrollbarV.readSettings();
this.wtScrollbarH.prepare();
this.wtScrollbarV.prepare();
this.wtScrollbarH.refresh();
this.wtScrollbarV.refresh()
};
WalkontableScroll.prototype.scrollVertical=function(delta){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")
}var instance=this.instance,offset=instance.getSetting("offsetRow"),fixedCount=instance.getSetting("fixedRowsTop"),total=instance.getSetting("totalRows"),maxSize=(instance.getSetting("height")||Infinity);
if(maxSize!==Infinity){var TD=instance.wtTable.TBODY.firstChild.firstChild;
if(TD.nodeName==="TH"){TD=TD.nextSibling
}var cellOffset=instance.wtDom.offset(TD);
var tableOffset=instance.wtTable.tableOffset;
maxSize-=cellOffset.top-tableOffset.top;
maxSize-=instance.getSetting("scrollbarHeight")
}var newOffset=this.scrollLogic(delta,offset,total,fixedCount,maxSize,function(row){if(row-offset<fixedCount){return instance.getSetting("rowHeight",row-offset)
}else{return instance.getSetting("rowHeight",row)
}});
if(newOffset!==offset){instance.update("offsetRow",newOffset)
}return instance
};
WalkontableScroll.prototype.scrollHorizontal=function(delta){if(!this.instance.drawn){throw new Error("scrollHorizontal can only be called after table was drawn to DOM")
}var instance=this.instance,offset=instance.getSetting("offsetColumn"),fixedCount=instance.getSetting("fixedColumnsLeft"),total=instance.getSetting("totalColumns"),maxSize=instance.getSetting("width")-instance.getSetting("rowHeaderWidth");
var newOffset=this.scrollLogic(delta,offset,total,fixedCount,maxSize,function(col){if(col-offset<fixedCount){return instance.getSetting("columnWidth",col-offset)
}else{return instance.getSetting("columnWidth",col)
}});
if(newOffset!==offset){instance.update("offsetColumn",newOffset)
}return instance
};
WalkontableScroll.prototype.scrollLogic=function(delta,offset,total,fixedCount,maxSize,cellSizeFn){var newOffset=offset+delta,sum=0,col;
if(newOffset>fixedCount){if(newOffset>=total-fixedCount){newOffset=total-fixedCount-1
}col=newOffset;
while(sum<maxSize&&col<total){sum+=cellSizeFn(col);
col++
}if(sum<maxSize){while(newOffset>0){sum+=cellSizeFn(newOffset-1);
if(sum<maxSize){newOffset--
}else{break
}}}}else{if(newOffset<0){newOffset=0
}}return newOffset
};
WalkontableScroll.prototype.scrollViewport=function(coords){var offsetRow=this.instance.getSetting("offsetRow"),offsetColumn=this.instance.getSetting("offsetColumn"),lastVisibleRow=this.instance.wtTable.getLastVisibleRow(),lastVisibleColumn=this.instance.wtTable.getLastVisibleColumn(),totalRows=this.instance.getSetting("totalRows"),totalColumns=this.instance.getSetting("totalColumns"),fixedRowsTop=this.instance.getSetting("fixedRowsTop"),fixedColumnsLeft=this.instance.getSetting("fixedColumnsLeft");
if(coords[0]<0||coords[0]>totalRows-1){throw new Error("row "+coords[0]+" does not exist")
}else{if(coords[1]<0||coords[1]>totalColumns-1){throw new Error("column "+coords[1]+" does not exist")
}}if(coords[0]>lastVisibleRow){this.scrollVertical(coords[0]-lastVisibleRow+1)
}else{if(coords[0]===lastVisibleRow&&this.instance.wtTable.isLastRowIncomplete()){this.scrollVertical(coords[0]-lastVisibleRow+1)
}else{if(coords[0]-fixedRowsTop<offsetRow){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow)
}else{this.scrollVertical(0)
}}}if(coords[1]>lastVisibleColumn){this.scrollHorizontal(coords[1]-lastVisibleColumn+1)
}else{if(coords[1]===lastVisibleColumn&&this.instance.wtTable.isLastColumnIncomplete()){this.scrollHorizontal(coords[1]-lastVisibleColumn+1)
}else{if(coords[1]-fixedColumnsLeft<offsetColumn){this.scrollHorizontal(coords[1]-fixedColumnsLeft-offsetColumn)
}else{this.scrollHorizontal(0)
}}}return this.instance
};
function WalkontableScrollbar(){}WalkontableScrollbar.prototype.init=function(){var that=this;
this.$table=$(this.instance.wtTable.TABLE);
this.slider=document.createElement("DIV");
this.sliderStyle=this.slider.style;
this.sliderStyle.position="absolute";
this.sliderStyle.top="0";
this.sliderStyle.left="0";
this.sliderStyle.display="none";
this.slider.className="dragdealer "+this.type;
this.handle=document.createElement("DIV");
this.handleStyle=this.handle.style;
this.handle.className="handle";
this.slider.appendChild(this.handle);
this.instance.wtTable.parent.appendChild(this.slider);
var firstRun=true;
this.dragTimeout=null;
var dragDelta;
var dragRender=function(){that.onScroll(dragDelta)
};
this.dragdealer=new Dragdealer(this.slider,{vertical:(this.type==="vertical"),horizontal:(this.type==="horizontal"),slide:false,speed:100,animationCallback:function(x,y){if(firstRun){firstRun=false;
return
}that.skipRefresh=true;
dragDelta=that.type==="vertical"?y:x;
if(that.dragTimeout===null){that.dragTimeout=setInterval(dragRender,100);
dragRender()
}},callback:function(x,y){that.skipRefresh=false;
clearInterval(that.dragTimeout);
that.dragTimeout=null;
dragDelta=that.type==="vertical"?y:x;
that.onScroll(dragDelta)
}});
this.skipRefresh=false
};
WalkontableScrollbar.prototype.onScroll=function(delta){if(this.instance.drawn){this.readSettings();
if(this.total>this.visibleCount){var newOffset=Math.round(this.handlePosition*this.total/this.sliderSize);
if(delta===1){if(this.type==="vertical"){this.instance.scrollVertical(Infinity).draw()
}else{this.instance.scrollHorizontal(Infinity).draw()
}}else{if(newOffset!==this.offset){if(this.type==="vertical"){this.instance.scrollVertical(newOffset-this.offset).draw()
}else{this.instance.scrollHorizontal(newOffset-this.offset).draw()
}}else{this.refresh()
}}}}};
WalkontableScrollbar.prototype.getHandleSizeRatio=function(viewportCount,totalCount){if(!totalCount||viewportCount>totalCount){return 1
}return viewportCount/totalCount
};
WalkontableScrollbar.prototype.prepare=function(){if(this.skipRefresh){return
}var ratio=this.getHandleSizeRatio(this.visibleCount,this.total);
if(((ratio===1||isNaN(ratio))&&this.scrollMode==="auto")||this.scrollMode==="none"){this.visible=false
}else{this.visible=true
}};
WalkontableScrollbar.prototype.refresh=function(){if(this.skipRefresh){return
}else{if(!this.visible){this.sliderStyle.display="none";
return
}}var ratio,sliderSize,handleSize,handlePosition,visibleCount=this.visibleCount,tableOuterWidth=this.$table.outerWidth(),tableOuterHeight=this.$table.outerHeight(),tableWidth=this.instance.hasSetting("width")?this.instance.getSetting("width"):tableOuterWidth,tableHeight=this.instance.hasSetting("height")?this.instance.getSetting("height"):tableOuterHeight;
if(!tableWidth){return
}if(!tableHeight){return
}if(this.instance.hasSetting("width")&&this.instance.wtScroll.wtScrollbarV.visible){tableWidth-=this.instance.getSetting("scrollbarWidth")
}if(tableWidth>tableOuterWidth+this.instance.getSetting("scrollbarWidth")){tableWidth=tableOuterWidth
}if(this.instance.hasSetting("height")&&this.instance.wtScroll.wtScrollbarH.visible){tableHeight-=this.instance.getSetting("scrollbarHeight")
}if(tableHeight>tableOuterHeight+this.instance.getSetting("scrollbarHeight")){tableHeight=tableOuterHeight
}if(this.type==="vertical"){if(this.instance.wtTable.isLastRowIncomplete()){visibleCount--
}sliderSize=tableHeight-2;
this.sliderStyle.top=this.$table.position().top+"px";
this.sliderStyle.left=tableWidth-1+"px";
this.sliderStyle.height=sliderSize+"px"
}else{if(this.instance.wtTable.isLastColumnIncomplete()){visibleCount--
}sliderSize=tableWidth-2;
this.sliderStyle.left=this.$table.position().left+"px";
this.sliderStyle.top=tableHeight-1+"px";
this.sliderStyle.width=sliderSize+"px"
}ratio=this.getHandleSizeRatio(visibleCount,this.total);
handleSize=Math.round(sliderSize*ratio);
if(handleSize<10){handleSize=15
}handlePosition=Math.floor(sliderSize*(this.offset/this.total));
if(handleSize+handlePosition>sliderSize){handlePosition=sliderSize-handleSize
}if(this.type==="vertical"){this.handleStyle.height=handleSize+"px";
this.handleStyle.top=handlePosition+"px"
}else{this.handleStyle.width=handleSize+"px";
this.handleStyle.left=handlePosition+"px"
}this.sliderStyle.display="block"
};
var WalkontableVerticalScrollbar=function(instance){this.instance=instance;
this.type="vertical";
this.init()
};
WalkontableVerticalScrollbar.prototype=new WalkontableScrollbar();
WalkontableVerticalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV");
this.offset=this.instance.getSetting("offsetRow");
this.total=this.instance.getSetting("totalRows");
this.visibleCount=this.instance.wtTable.countVisibleRows();
this.handlePosition=parseInt(this.handleStyle.top,10);
this.sliderSize=parseInt(this.sliderStyle.height,10);
this.fixedCount=this.instance.getSetting("fixedRowsTop")
};
var WalkontableHorizontalScrollbar=function(instance){this.instance=instance;
this.type="horizontal";
this.init()
};
WalkontableHorizontalScrollbar.prototype=new WalkontableScrollbar();
WalkontableHorizontalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH");
this.offset=this.instance.getSetting("offsetColumn");
this.total=this.instance.getSetting("totalColumns");
this.visibleCount=this.instance.wtTable.countVisibleColumns();
this.handlePosition=parseInt(this.handleStyle.left,10);
this.sliderSize=parseInt(this.sliderStyle.width,10);
this.fixedCount=this.instance.getSetting("fixedColumnsLeft")
};
function WalkontableSelection(instance,settings){this.instance=instance;
this.settings=settings;
this.selected=[];
if(settings.border){this.border=new WalkontableBorder(instance,settings)
}}WalkontableSelection.prototype.add=function(coords){this.selected.push(coords)
};
WalkontableSelection.prototype.clear=function(){this.selected.length=0
};
WalkontableSelection.prototype.getCorners=function(){var minRow,minColumn,maxRow,maxColumn,i,ilen=this.selected.length;
if(ilen>0){minRow=maxRow=this.selected[0][0];
minColumn=maxColumn=this.selected[0][1];
if(ilen>1){for(i=1;
i<ilen;
i++){if(this.selected[i][0]<minRow){minRow=this.selected[i][0]
}else{if(this.selected[i][0]>maxRow){maxRow=this.selected[i][0]
}}if(this.selected[i][1]<minColumn){minColumn=this.selected[i][1]
}else{if(this.selected[i][1]>maxColumn){maxColumn=this.selected[i][1]
}}}}}return[minRow,minColumn,maxRow,maxColumn]
};
WalkontableSelection.prototype.draw=function(){var corners,r,c,source_r,source_c;
var visibleRows=this.instance.wtTable.countVisibleRows(),visibleColumns=this.instance.wtTable.countVisibleColumns();
if(this.selected.length){corners=this.getCorners();
for(r=0;
r<visibleRows;
r++){for(c=0;
c<visibleColumns;
c++){source_r=this.instance.wtTable.rowFilter.visibleToSource(r);
source_c=this.instance.wtTable.columnFilter.visibleToSource(c);
if(source_r>=corners[0]&&source_r<=corners[2]&&source_c>=corners[1]&&source_c<=corners[3]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.className)
}else{if(source_r>=corners[0]&&source_r<=corners[2]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.highlightRowClassName)
}else{if(source_c>=corners[1]&&source_c<=corners[3]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.highlightColumnClassName)
}}}}}this.border&&this.border.appear(corners)
}else{this.border&&this.border.disappear()
}};
function WalkontableSettings(instance,settings){var that=this;
this.instance=instance;
this.defaults={table:void 0,scrollH:"auto",scrollV:"auto",stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:null,columnHeaders:null,totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(row,column,TD){var cellData=that.getSetting("data",row,column);
that.instance.wtDom.avoidInnerHTML(TD,cellData===void 0||cellData===null?"":cellData)
},columnWidth:50,selections:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,scrollbarWidth:10,scrollbarHeight:10,rowHeaderWidth:50};
this.settings={};
for(var i in this.defaults){if(this.defaults.hasOwnProperty(i)){if(settings[i]!==void 0){this.settings[i]=settings[i]
}else{if(this.defaults[i]===void 0){throw new Error('A required setting "'+i+'" was not provided')
}else{this.settings[i]=this.defaults[i]
}}}}this.rowHeightCache=[]
}WalkontableSettings.prototype.update=function(settings,value){if(value===void 0){for(var i in settings){if(settings.hasOwnProperty(i)){this.settings[i]=settings[i]
}}}else{this.settings[settings]=value
}return this.instance
};
WalkontableSettings.prototype.getSetting=function(key,param1,param2,param3){if(this[key]){return this[key](param1,param2,param3)
}else{return this._getSetting(key,param1,param2,param3)
}};
WalkontableSettings.prototype._getSetting=function(key,param1,param2,param3){if(typeof this.settings[key]==="function"){return this.settings[key](param1,param2,param3)
}else{if(param1!==void 0&&Object.prototype.toString.call(this.settings[key])==="[object Array]"&&param1!==void 0){return this.settings[key][param1]
}else{return this.settings[key]
}}};
WalkontableSettings.prototype.has=function(key){return !!this.settings[key]
};
WalkontableSettings.prototype.rowHeight=function(row){if(typeof this.rowHeightCache[row]!=="undefined"){return this.rowHeightCache[row]
}return 20
};
WalkontableSettings.prototype.columnWidth=function(column){return Math.min(200,this._getSetting("columnWidth",column))
};
var FLAG_VISIBLE_HORIZONTAL=1;
var FLAG_VISIBLE_VERTICAL=2;
var FLAG_PARTIALLY_VISIBLE_HORIZONTAL=4;
var FLAG_PARTIALLY_VISIBLE_VERTICAL=8;
var FLAG_NOT_VISIBLE_HORIZONTAL=16;
var FLAG_NOT_VISIBLE_VERTICAL=32;
function WalkontableTable(instance){this.instance=instance;
this.TABLE=this.instance.getSetting("table");
this.wtDom=this.instance.wtDom;
this.wtDom.removeTextNodes(this.TABLE);
this.hasEmptyCellProblem=($.browser.msie&&(parseInt($.browser.version,10)<=7));
this.hasCellSpacingProblem=($.browser.msie&&(parseInt($.browser.version,10)<=7));
if(this.hasCellSpacingProblem){this.TABLE.cellSpacing=0
}var parent=this.TABLE.parentNode;
if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var spreader=document.createElement("DIV");
if(this.instance.hasSetting("width")&&this.instance.hasSetting("height")){var spreaderStyle=spreader.style;
spreaderStyle.position="absolute";
spreaderStyle.top="0";
spreaderStyle.left="0";
spreaderStyle.width="4000px";
spreaderStyle.height="4000px"
}spreader.className="wtSpreader";
if(parent){parent.insertBefore(spreader,this.TABLE)
}spreader.appendChild(this.TABLE)
}this.spreader=this.TABLE.parentNode;
parent=this.spreader.parentNode;
if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var hider=document.createElement("DIV");
hider.className="wtHider";
if(parent){parent.insertBefore(hider,this.spreader)
}hider.appendChild(this.spreader)
}this.hider=this.spreader.parentNode;
this.hiderStyle=this.hider.style;
this.hiderStyle.position="relative";
parent=this.hider.parentNode;
if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var holder=document.createElement("DIV");
holder.style.position="relative";
holder.className="wtHolder";
if(parent){parent.insertBefore(holder,this.hider)
}holder.appendChild(this.hider)
}this.parent=this.hider.parentNode;
this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];
if(!this.TBODY){this.TBODY=document.createElement("TBODY");
this.TABLE.appendChild(this.TBODY)
}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];
if(!this.THEAD){this.THEAD=document.createElement("THEAD");
this.TABLE.insertBefore(this.THEAD,this.TBODY)
}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];
if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");
this.TABLE.insertBefore(this.COLGROUP,this.THEAD)
}if(this.instance.hasSetting("columnHeaders")){if(!this.THEAD.childNodes.length){var TR=document.createElement("TR");
this.THEAD.appendChild(TR)
}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;
this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;
this.tbodyChildrenLength=this.TBODY.childNodes.length;
this.oldCellCache=new WalkontableClassNameCache();
this.currentCellCache=new WalkontableClassNameCache();
this.rowFilter=new WalkontableRowFilter();
this.columnFilter=new WalkontableColumnFilter()
}WalkontableTable.prototype.refreshHiderDimensions=function(){var height=this.instance.getSetting("height");
var width=this.instance.getSetting("width");
if(height||width){this.hiderStyle.overflow="hidden"
}if(height){if(this.instance.wtScroll.wtScrollbarH.visible){this.hiderStyle.height=height-this.instance.getSetting("scrollbarHeight")+"px"
}else{this.hiderStyle.height=height+"px"
}}if(width){if(this.instance.wtScroll.wtScrollbarV.visible){this.hiderStyle.width=width-this.instance.getSetting("scrollbarWidth")+"px"
}else{this.hiderStyle.width=width+"px"
}}};
WalkontableTable.prototype.refreshStretching=function(){var instance=this.instance,stretchH=instance.getSetting("stretchH"),scrollH=instance.getSetting("scrollH"),scrollbarWidth=instance.getSetting("scrollbarWidth"),totalColumns=instance.getSetting("totalColumns"),offsetColumn=instance.getSetting("offsetColumn"),rowHeaderWidth=instance.hasSetting("rowHeaders")?instance.getSetting("rowHeaderWidth"):0,containerWidth=instance.getSetting("width")-rowHeaderWidth;
var containerWidthFn=function(cacheWidth){if(scrollH==="scroll"||(scrollH==="auto"&&cacheWidth>containerWidth)){return containerWidth-scrollbarWidth
}return containerWidth
};
var that=this;
var columnWidthFn=function(i){var source_c=that.columnFilter.visibleToSource(i);
if(source_c<totalColumns){return instance.getSetting("columnWidth",source_c)
}};
if(stretchH==="hybrid"){if(offsetColumn>0){stretchH="last"
}else{stretchH="none"
}}this.columnStrategy=new WalkontableColumnStrategy(containerWidthFn,columnWidthFn,stretchH);
this.rowStrategy={cells:[],cellCount:0,remainingSize:0}
};
WalkontableTable.prototype.adjustAvailableNodes=function(){var displayTds,displayThs=this.instance.hasSetting("rowHeaders")?1:0,TR;
this.refreshStretching();
displayTds=this.columnStrategy.cellCount;
while(this.colgroupChildrenLength<displayTds+displayThs){this.COLGROUP.appendChild(document.createElement("COL"));
this.colgroupChildrenLength++
}while(this.colgroupChildrenLength>displayTds+displayThs){this.COLGROUP.removeChild(this.COLGROUP.lastChild);
this.colgroupChildrenLength--
}if(this.instance.hasSetting("columnHeaders")){TR=this.THEAD.firstChild;
while(this.theadChildrenLength<displayTds+displayThs){TR.appendChild(document.createElement("TH"));
this.theadChildrenLength++
}while(this.theadChildrenLength>displayTds+displayThs){TR.removeChild(TR.lastChild);
this.theadChildrenLength--
}}};
WalkontableTable.prototype.adjustColumns=function(TR,desiredCount){var count=TR.childNodes.length;
while(count<desiredCount){var TD=document.createElement("TD");
TR.appendChild(TD);
count++
}while(count>desiredCount){TR.removeChild(TR.lastChild);
count--
}};
WalkontableTable.prototype.draw=function(selectionsOnly){this.rowFilter.readSettings(this.instance);
this.columnFilter.readSettings(this.instance);
if(!selectionsOnly){this.tableOffset=this.wtDom.offset(this.TABLE);
this.adjustAvailableNodes();
this._doDraw()
}this.refreshPositions(selectionsOnly);
this.instance.drawn=true;
return this
};
WalkontableTable.prototype._doDraw=function(){var r=0,source_r,c,source_c,totalRows=this.instance.getSetting("totalRows"),displayTds=this.columnStrategy.cellCount,rowHeaders=this.instance.hasSetting("rowHeaders"),displayThs=rowHeaders?1:0,TR,TD;
for(c=0;
c<this.colgroupChildrenLength;
c++){if(c<displayThs){this.wtDom.addClass(this.COLGROUP.childNodes[c],"rowHeader")
}else{this.wtDom.removeClass(this.COLGROUP.childNodes[c],"rowHeader")
}}var columnHeaders=this.instance.hasSetting("columnHeaders");
if(columnHeaders){TR=this.THEAD.firstChild;
if(displayThs){TD=TR.firstChild;
this.wtDom.empty(TD);
if(this.hasEmptyCellProblem){TD.innerHTML="&nbsp;"
}}}for(c=0;
c<displayTds;
c++){if(columnHeaders){this.instance.getSetting("columnHeaders",this.columnFilter.visibleToSource(c),TR.childNodes[displayThs+c])
}this.COLGROUP.childNodes[c+displayThs].style.width=this.columnStrategy.getSize(c)+"px"
}source_r=this.rowFilter.visibleToSource(r);
while(source_r<totalRows){if(r>=this.tbodyChildrenLength){TR=document.createElement("TR");
if(displayThs){TR.appendChild(document.createElement("TH"))
}this.TBODY.appendChild(TR);
this.tbodyChildrenLength++
}else{if(r===0){TR=this.TBODY.firstChild
}else{TR=TR.nextSibling
}}this.rowStrategy.cellCount++;
if(displayThs){this.instance.getSetting("rowHeaders",source_r,TR.firstChild)
}this.adjustColumns(TR,displayTds+displayThs);
for(c=0;
c<displayTds;
c++){source_c=this.columnFilter.visibleToSource(c);
if(c===0){TD=TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(source_c)]
}else{TD=TD.nextSibling
}TD.className="";
TD.removeAttribute("style");
this.instance.getSetting("cellRenderer",source_r,source_c,TD);
if(this.hasEmptyCellProblem&&TD.innerHTML===""){TD.innerHTML="&nbsp;"
}}var isCellVisible=this.isCellVisible(source_r,source_c,TD);
if(isCellVisible&(FLAG_NOT_VISIBLE_VERTICAL|FLAG_PARTIALLY_VISIBLE_VERTICAL)){break
}r++;
source_r=this.rowFilter.visibleToSource(r)
}r=this.countVisibleRows();
while(this.tbodyChildrenLength>r){this.TBODY.removeChild(this.TBODY.lastChild);
this.tbodyChildrenLength--
}};
WalkontableTable.prototype.refreshPositions=function(selectionsOnly){this.instance.wtScroll.refreshScrollbars();
this.refreshHiderDimensions();
this.refreshSelections(selectionsOnly)
};
WalkontableTable.prototype.refreshSelections=function(selectionsOnly){var vr,r,vc,c,s,slen,classNames=[],visibleRows=this.countVisibleRows(),visibleColumns=this.countVisibleColumns();
this.oldCellCache=this.currentCellCache;
this.currentCellCache=new WalkontableClassNameCache();
if(this.instance.selections){for(r in this.instance.selections){if(this.instance.selections.hasOwnProperty(r)){this.instance.selections[r].draw();
if(this.instance.selections[r].settings.className){classNames.push(this.instance.selections[r].settings.className)
}if(this.instance.selections[r].settings.highlightRowClassName){classNames.push(this.instance.selections[r].settings.highlightRowClassName)
}if(this.instance.selections[r].settings.highlightColumnClassName){classNames.push(this.instance.selections[r].settings.highlightColumnClassName)
}}}}slen=classNames.length;
for(vr=0;
vr<visibleRows;
vr++){for(vc=0;
vc<visibleColumns;
vc++){r=this.rowFilter.visibleToSource(vr);
c=this.columnFilter.visibleToSource(vc);
for(s=0;
s<slen;
s++){if(this.currentCellCache.test(vr,vc,classNames[s])){this.wtDom.addClass(this.getCell([r,c]),classNames[s])
}else{if(selectionsOnly&&this.oldCellCache.test(vr,vc,classNames[s])){this.wtDom.removeClass(this.getCell([r,c]),classNames[s])
}}}}}};
WalkontableTable.prototype.isCellVisible=function(r,c,TD){var out=0,cellOffset=this.wtDom.offset(TD),tableOffset=this.tableOffset,innerOffsetTop=cellOffset.top-tableOffset.top,$td=$(TD),height=$td.outerHeight(),tableHeight=this.instance.hasSetting("height")?this.instance.getSetting("height"):Infinity;
this.instance.wtSettings.rowHeightCache[r]=height;
if(innerOffsetTop>tableHeight){out|=FLAG_NOT_VISIBLE_VERTICAL
}else{if(innerOffsetTop+height>tableHeight){this.rowStrategy.remainingSize=tableHeight-innerOffsetTop;
out|=FLAG_PARTIALLY_VISIBLE_VERTICAL
}else{out|=FLAG_VISIBLE_VERTICAL
}}if(this.isColumnInViewport(c)){if(this.getLastVisibleColumn()===c&&this.columnStrategy.remainingSize>0){out|=FLAG_PARTIALLY_VISIBLE_HORIZONTAL
}else{out|=FLAG_VISIBLE_HORIZONTAL
}}else{out|=FLAG_NOT_VISIBLE_HORIZONTAL
}return out
};
WalkontableTable.prototype.getCell=function(coords){if(this.isRowBeforeViewport(coords[0])){return -1
}else{if(this.isRowAfterViewport(coords[0])){return -2
}else{if(this.isColumnBeforeViewport(coords[1])){return -3
}else{if(this.isColumnAfterViewport(coords[1])){return -4
}else{return this.TBODY.childNodes[this.rowFilter.sourceToVisible(coords[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(coords[1])]
}}}}};
WalkontableTable.prototype.getCoords=function(TD){return[this.rowFilter.visibleToSource(this.wtDom.prevSiblings(TD.parentNode).length),this.columnFilter.visibleRowHeadedColumnToSourceColumn(TD.cellIndex)]
};
WalkontableTable.prototype.countVisibleRows=function(){return(this.rowStrategy&&this.rowStrategy.cellCount)||0
};
WalkontableTable.prototype.countVisibleColumns=function(){return(this.columnStrategy&&this.columnStrategy.cellCount)||0
};
WalkontableTable.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)
};
WalkontableTable.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)
};
WalkontableTable.prototype.isLastRowIncomplete=function(){return(this.rowStrategy.remainingSize>0)
};
WalkontableTable.prototype.isLastColumnIncomplete=function(){return(this.columnStrategy.remainingSize>0)
};
WalkontableTable.prototype.isRowBeforeViewport=function(r){return(this.rowFilter.sourceToVisible(r)<this.rowFilter.fixedCount&&r>=this.rowFilter.fixedCount)
};
WalkontableTable.prototype.isRowAfterViewport=function(r){return(r>this.getLastVisibleRow())
};
WalkontableTable.prototype.isColumnBeforeViewport=function(c){return(this.columnFilter.sourceToVisible(c)<this.columnFilter.fixedCount&&c>=this.columnFilter.fixedCount)
};
WalkontableTable.prototype.isColumnAfterViewport=function(c){return(c>this.getLastVisibleColumn())
};
WalkontableTable.prototype.isRowInViewport=function(r){return(!this.isRowBeforeViewport(r)&&!this.isRowAfterViewport(r))
};
WalkontableTable.prototype.isColumnInViewport=function(c){return(!this.isColumnBeforeViewport(c)&&!this.isColumnAfterViewport(c))
};
function WalkontableWheel(instance){var that=this;
this.instance=instance;
$(this.instance.wtTable.TABLE).on("mousewheel",function(event,delta,deltaX,deltaY){clearTimeout(that.instance.wheelTimeout);
that.instance.wheelTimeout=setTimeout(function(){if(deltaY){if(that.instance.wtScroll.wtScrollbarV.visible){that.instance.scrollVertical(-Math.ceil(deltaY)).draw()
}}else{if(deltaX){if(that.instance.wtScroll.wtScrollbarH.visible){that.instance.scrollHorizontal(Math.ceil(deltaX)).draw()
}}}},0);
event.preventDefault()
})
}var Cursor={x:0,y:0,init:function(){this.setEvent("mouse");
this.setEvent("touch")
},setEvent:function(type){var moveHandler=document["on"+type+"move"]||function(){};
document["on"+type+"move"]=function(e){moveHandler(e);
Cursor.refresh(e)
}
},refresh:function(e){if(!e){e=window.event
}if(e.type=="mousemove"){this.set(e)
}else{if(e.touches){this.set(e.touches[0])
}}},set:function(e){if(e.pageX||e.pageY){this.x=e.pageX;
this.y=e.pageY
}else{if(e.clientX||e.clientY){this.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;
this.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop
}}}};
Cursor.init();
var Position={get:function(obj){var curtop=0,curleft=0;
if(obj.offsetParent){do{curleft+=obj.offsetLeft;
curtop+=obj.offsetTop
}while((obj=obj.offsetParent))
}return[curleft,curtop]
}};
var Dragdealer=function(wrapper,options){if(typeof(wrapper)=="string"){wrapper=document.getElementById(wrapper)
}if(!wrapper){return
}var handle=wrapper.getElementsByTagName("div")[0];
if(!handle||handle.className.search(/(^|\s)handle(\s|$)/)==-1){return
}this.init(wrapper,handle,options||{});
this.setup()
};
Dragdealer.prototype={init:function(wrapper,handle,options){this.wrapper=wrapper;
this.handle=handle;
this.options=options;
this.disabled=this.getOption("disabled",false);
this.horizontal=this.getOption("horizontal",true);
this.vertical=this.getOption("vertical",false);
this.slide=this.getOption("slide",true);
this.steps=this.getOption("steps",0);
this.snap=this.getOption("snap",false);
this.loose=this.getOption("loose",false);
this.speed=this.getOption("speed",10)/100;
this.xPrecision=this.getOption("xPrecision",0);
this.yPrecision=this.getOption("yPrecision",0);
this.callback=options.callback||null;
this.animationCallback=options.animationCallback||null;
this.bounds={left:options.left||0,right:-(options.right||0),top:options.top||0,bottom:-(options.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};
this.value={prev:[-1,-1],current:[options.x||0,options.y||0],target:[options.x||0,options.y||0]};
this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};
this.change=[0,0];
this.activity=false;
this.dragging=false;
this.tapping=false
},getOption:function(name,defaultValue){return this.options[name]!==undefined?this.options[name]:defaultValue
},setup:function(){this.setWrapperOffset();
this.setBoundsPadding();
this.setBounds();
this.setSteps();
this.addListeners()
},setWrapperOffset:function(){this.offset.wrapper=Position.get(this.wrapper)
},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=Position.get(this.handle)[0]-this.offset.wrapper[0];
this.bounds.right=-this.bounds.left
}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=Position.get(this.handle)[1]-this.offset.wrapper[1];
this.bounds.bottom=-this.bounds.top
}},setBounds:function(){this.bounds.x0=this.bounds.left;
this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;
this.bounds.xRange=(this.bounds.x1-this.bounds.x0)-this.handle.offsetWidth;
this.bounds.y0=this.bounds.top;
this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;
this.bounds.yRange=(this.bounds.y1-this.bounds.y0)-this.handle.offsetHeight;
this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));
this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))
},setSteps:function(){if(this.steps>1){this.stepRatios=[];
for(var i=0;
i<=this.steps-1;
i++){this.stepRatios[i]=i/(this.steps-1)
}}},addListeners:function(){var self=this;
this.wrapper.onselectstart=function(){return false
};
this.handle.onmousedown=this.handle.ontouchstart=function(e){self.handleDownHandler(e)
};
this.wrapper.onmousedown=this.wrapper.ontouchstart=function(e){self.wrapperDownHandler(e)
};
var mouseUpHandler=document.onmouseup||function(){};
document.onmouseup=function(e){mouseUpHandler(e);
self.documentUpHandler(e)
};
var touchEndHandler=document.ontouchend||function(){};
document.ontouchend=function(e){touchEndHandler(e);
self.documentUpHandler(e)
};
var resizeHandler=window.onresize||function(){};
window.onresize=function(e){resizeHandler(e);
self.documentResizeHandler(e)
};
this.wrapper.onmousemove=function(e){self.activity=true
};
this.wrapper.onclick=function(e){return !self.activity
};
this.interval=setInterval(function(){self.animate()
},25);
self.animate(false,true)
},handleDownHandler:function(e){this.activity=false;
Cursor.refresh(e);
this.preventDefaults(e,true);
this.startDrag();
this.cancelEvent(e)
},wrapperDownHandler:function(e){Cursor.refresh(e);
this.preventDefaults(e,true);
this.startTap()
},documentUpHandler:function(e){this.stopDrag();
this.stopTap()
},documentResizeHandler:function(e){this.setWrapperOffset();
this.setBounds();
this.update()
},enable:function(){this.disabled=false;
this.handle.className=this.handle.className.replace(/\s?disabled/g,"")
},disable:function(){this.disabled=true;
this.handle.className+=" disabled"
},setStep:function(x,y,snap){this.setValue(this.steps&&x>1?(x-1)/(this.steps-1):0,this.steps&&y>1?(y-1)/(this.steps-1):0,snap)
},setValue:function(x,y,snap){this.setTargetValue([x,y||0]);
if(snap){this.groupCopy(this.value.current,this.value.target)
}},startTap:function(target){if(this.disabled){return
}this.tapping=true;
this.setWrapperOffset();
this.setBounds();
if(target===undefined){target=[Cursor.x-this.offset.wrapper[0]-(this.handle.offsetWidth/2),Cursor.y-this.offset.wrapper[1]-(this.handle.offsetHeight/2)]
}this.setTargetOffset(target)
},stopTap:function(){if(this.disabled||!this.tapping){return
}this.tapping=false;
this.setTargetValue(this.value.current);
this.result()
},startDrag:function(){if(this.disabled){return
}this.setWrapperOffset();
this.setBounds();
this.offset.mouse=[Cursor.x-Position.get(this.handle)[0],Cursor.y-Position.get(this.handle)[1]];
this.dragging=true
},stopDrag:function(){if(this.disabled||!this.dragging){return
}this.dragging=false;
var target=this.groupClone(this.value.current);
if(this.slide){var ratioChange=this.change;
target[0]+=ratioChange[0]*4;
target[1]+=ratioChange[1]*4
}this.setTargetValue(target);
this.result()
},feedback:function(){var value=this.value.current;
if(this.snap&&this.steps>1){value=this.getClosestSteps(value)
}if(!this.groupCompare(value,this.value.prev)){if(typeof(this.animationCallback)=="function"){this.animationCallback(value[0],value[1])
}this.groupCopy(this.value.prev,value)
}},result:function(){if(typeof(this.callback)=="function"){this.callback(this.value.target[0],this.value.target[1])
}},animate:function(direct,first){if(direct&&!this.dragging){return
}if(this.dragging){var prevTarget=this.groupClone(this.value.target);
var offset=[Cursor.x-this.offset.wrapper[0]-this.offset.mouse[0],Cursor.y-this.offset.wrapper[1]-this.offset.mouse[1]];
this.setTargetOffset(offset,this.loose);
this.change=[this.value.target[0]-prevTarget[0],this.value.target[1]-prevTarget[1]]
}if(this.dragging||first){this.groupCopy(this.value.current,this.value.target)
}if(this.dragging||this.glide()||first){this.update();
this.feedback()
}},glide:function(){var diff=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];
if(!diff[0]&&!diff[1]){return false
}if(Math.abs(diff[0])>this.bounds.xStep||Math.abs(diff[1])>this.bounds.yStep){this.value.current[0]+=diff[0]*this.speed;
this.value.current[1]+=diff[1]*this.speed
}else{this.groupCopy(this.value.current,this.value.target)
}return true
},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)
}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))
}this.show()
},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"
}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"
}this.groupCopy(this.offset.prev,this.offset.current)
}},setTargetValue:function(value,loose){var target=loose?this.getLooseValue(value):this.getProperValue(value);
this.groupCopy(this.value.target,target);
this.offset.target=this.getOffsetsByRatios(target)
},setTargetOffset:function(offset,loose){var value=this.getRatiosByOffsets(offset);
var target=loose?this.getLooseValue(value):this.getProperValue(value);
this.groupCopy(this.value.target,target);
this.offset.target=this.getOffsetsByRatios(target)
},getLooseValue:function(value){var proper=this.getProperValue(value);
return[proper[0]+((value[0]-proper[0])/4),proper[1]+((value[1]-proper[1])/4)]
},getProperValue:function(value){var proper=this.groupClone(value);
proper[0]=Math.max(proper[0],0);
proper[1]=Math.max(proper[1],0);
proper[0]=Math.min(proper[0],1);
proper[1]=Math.min(proper[1],1);
if((!this.dragging&&!this.tapping)||this.snap){if(this.steps>1){proper=this.getClosestSteps(proper)
}}return proper
},getRatiosByOffsets:function(group){return[this.getRatioByOffset(group[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(group[1],this.bounds.yRange,this.bounds.y0)]
},getRatioByOffset:function(offset,range,padding){return range?(offset-padding)/range:0
},getOffsetsByRatios:function(group){return[this.getOffsetByRatio(group[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(group[1],this.bounds.yRange,this.bounds.y0)]
},getOffsetByRatio:function(ratio,range,padding){return Math.round(ratio*range)+padding
},getClosestSteps:function(group){return[this.getClosestStep(group[0]),this.getClosestStep(group[1])]
},getClosestStep:function(value){var k=0;
var min=1;
for(var i=0;
i<=this.steps-1;
i++){if(Math.abs(this.stepRatios[i]-value)<min){min=Math.abs(this.stepRatios[i]-value);
k=i
}}return this.stepRatios[k]
},groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]
},groupCopy:function(a,b){a[0]=b[0];
a[1]=b[1]
},groupClone:function(a){return[a[0],a[1]]
},preventDefaults:function(e,selection){if(!e){e=window.event
}if(e.preventDefault){e.preventDefault()
}e.returnValue=false;
if(selection&&document.selection){document.selection.empty()
}},cancelEvent:function(e){if(!e){e=window.event
}if(e.stopPropagation){e.stopPropagation()
}e.cancelBubble=true
}};
if(!jQuery.browser){(function(){var matched,browser;
jQuery.uaMatch=function(ua){ua=ua.toLowerCase();
var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];
return{browser:match[1]||"",version:match[2]||"0"}
};
matched=jQuery.uaMatch(navigator.userAgent);
browser={};
if(matched.browser){browser[matched.browser]=true;
browser.version=matched.version
}if(browser.chrome){browser.webkit=true
}else{if(browser.webkit){browser.safari=true
}}jQuery.browser=browser
})();
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
}(function($){var types=["DOMMouseScroll","mousewheel"];
if($.event.fixHooks){for(var i=types.length;
i;
){$.event.fixHooks[types[--i]]=$.event.mouseHooks
}}$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=types.length;
i;
){this.addEventListener(types[--i],handler,false)
}}else{this.onmousewheel=handler
}},teardown:function(){if(this.removeEventListener){for(var i=types.length;
i;
){this.removeEventListener(types[--i],handler,false)
}}else{this.onmousewheel=null
}}};
$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")
},unmousewheel:function(fn){return this.unbind("mousewheel",fn)
}});
function handler(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,returnValue=true,deltaX=0,deltaY=0;
event=$.event.fix(orgEvent);
event.type="mousewheel";
if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta/120
}if(orgEvent.detail){delta=-orgEvent.detail/3
}deltaY=delta;
if(orgEvent.axis!==undefined&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS){deltaY=0;
deltaX=-1*delta
}if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY/120
}if(orgEvent.wheelDeltaX!==undefined){deltaX=-1*orgEvent.wheelDeltaX/120
}args.unshift(event,delta,deltaX,deltaY);
return($.event.dispatch||$.event.handle).apply(this,args)
}})(jQuery)
})(jQuery,window,Handsontable);
!function(b){var c=function(e,d){this.$element=b(e);
this.options=b.extend({},b.fn.typeahead.defaults,d);
this.matcher=this.options.matcher||this.matcher;
this.sorter=this.options.sorter||this.sorter;
this.highlighter=this.options.highlighter||this.highlighter;
this.updater=this.options.updater||this.updater;
this.source=this.options.source;
this.$menu=b(this.options.menu);
this.shown=false;
this.listen()
};
c.prototype={constructor:c,select:function(){var d=this.$menu.find(".active").attr("data-value");
this.$element.val(this.updater(d)).change();
return this.hide()
},updater:function(d){return d
},show:function(){var d=b.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});
this.$menu.insertAfter(this.$element).css({top:d.top+d.height,left:d.left}).show();
this.shown=true;
return this
},hide:function(){this.$menu.hide();
this.shown=false;
return this
},lookup:function(e){var d;
this.query=this.$element.val();
if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this
}d=b.isFunction(this.source)?this.source(this.query,b.proxy(this.process,this)):this.source;
return d?this.process(d):this
},process:function(d){var e=this;
d=b.grep(d,function(f){return e.matcher(f)
});
d=this.sorter(d);
if(!d.length){return this.shown?this.hide():this
}return this.render(d.slice(0,this.options.items)).show()
},matcher:function(d){return ~d.toLowerCase().indexOf(this.query.toLowerCase())
},sorter:function(f){var g=[],e=[],d=[],h;
while(h=f.shift()){if(!h.toLowerCase().indexOf(this.query.toLowerCase())){g.push(h)
}else{if(~h.indexOf(this.query)){e.push(h)
}else{d.push(h)
}}}return g.concat(e,d)
},highlighter:function(d){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");
return d.replace(new RegExp("("+e+")","ig"),function(f,g){return"<strong>"+g+"</strong>"
})
},render:function(d){var e=this;
d=b(d).map(function(f,g){f=b(e.options.item).attr("data-value",g);
f.find("a").html(e.highlighter(g));
return f[0]
});
d.first().addClass("active");
this.$menu.html(d);
return this
},next:function(e){var f=this.$menu.find(".active").removeClass("active"),d=f.next();
if(!d.length){d=b(this.$menu.find("li")[0])
}d.addClass("active")
},prev:function(e){var f=this.$menu.find(".active").removeClass("active"),d=f.prev();
if(!d.length){d=this.$menu.find("li").last()
}d.addClass("active")
},listen:function(){this.$element.on("focus",b.proxy(this.focus,this)).on("blur",b.proxy(this.blur,this)).on("keypress",b.proxy(this.keypress,this)).on("keyup",b.proxy(this.keyup,this));
if(this.eventSupported("keydown")){this.$element.on("keydown",b.proxy(this.keydown,this))
}this.$menu.on("click",b.proxy(this.click,this)).on("mouseenter","li",b.proxy(this.mouseenter,this)).on("mouseleave","li",b.proxy(this.mouseleave,this))
},eventSupported:function(d){var e=d in this.$element;
if(!e){this.$element.setAttribute(d,"return;");
e=typeof this.$element[d]==="function"
}return e
},move:function(d){if(!this.shown){return
}switch(d.keyCode){case 9:case 13:case 27:d.preventDefault();
break;
case 38:d.preventDefault();
this.prev();
break;
case 40:d.preventDefault();
this.next();
break
}d.stopPropagation()
},keydown:function(d){this.suppressKeyPressRepeat=~b.inArray(d.keyCode,[40,38,9,13,27]);
this.move(d)
},keypress:function(d){if(this.suppressKeyPressRepeat){return
}this.move(d)
},keyup:function(d){switch(d.keyCode){case 40:case 38:case 16:case 17:case 18:break;
case 9:case 13:if(!this.shown){return
}this.select();
break;
case 27:if(!this.shown){return
}this.hide();
break;
default:this.lookup()
}d.stopPropagation();
d.preventDefault()
},focus:function(d){this.focused=true
},blur:function(d){this.focused=false;
if(!this.mousedover&&this.shown){this.hide()
}},click:function(d){d.stopPropagation();
d.preventDefault();
this.select();
this.$element.focus()
},mouseenter:function(d){this.mousedover=true;
this.$menu.find(".active").removeClass("active");
b(d.currentTarget).addClass("active")
},mouseleave:function(d){this.mousedover=false;
if(!this.focused&&this.shown){this.hide()
}}};
var a=b.fn.typeahead;
b.fn.typeahead=function(d){return this.each(function(){var g=b(this),f=g.data("typeahead"),e=typeof d=="object"&&d;
if(!f){g.data("typeahead",(f=new c(this,e)))
}if(typeof d=="string"){f[d]()
}})
};
b.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};
b.fn.typeahead.Constructor=c;
b.fn.typeahead.noConflict=function(){b.fn.typeahead=a;
return this
};
b(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(f){var d=b(this);
if(d.data("typeahead")){return
}d.typeahead(d.data())
})
}(window.jQuery);
(function(){var g,p="1.4.7",h={},f="en",k=null,e=(typeof module!=="undefined"&&module.exports);
function l(q){this._n=q
}function a(u,r,q){var t=Math.pow(10,r),s;
s=(Math.round(u*t)/t).toFixed(r);
if(q){var v=new RegExp("0{1,"+q+"}$");
s=s.replace(v,"")
}return s
}function c(s,r){var q;
if(r.indexOf("$")>-1){q=j(s,r)
}else{if(r.indexOf("%")>-1){q=i(s,r)
}else{if(r.indexOf(":")>-1){q=o(s,r)
}else{q=b(s,r)
}}}return q
}function d(r,x){if(x.indexOf(":")>-1){r._n=n(x)
}else{if(x===k){r._n=0
}else{var v=x;
if(h[f].delimiters.decimal!=="."){x=x.replace(/\./g,"").replace(h[f].delimiters.decimal,".")
}var z=new RegExp(h[f].abbreviations.thousand+"(?:\\)|(\\"+h[f].currency.symbol+")?(?:\\))?)?$"),u=new RegExp(h[f].abbreviations.million+"(?:\\)|(\\"+h[f].currency.symbol+")?(?:\\))?)?$"),t=new RegExp(h[f].abbreviations.billion+"(?:\\)|(\\"+h[f].currency.symbol+")?(?:\\))?)?$"),s=new RegExp(h[f].abbreviations.trillion+"(?:\\)|(\\"+h[f].currency.symbol+")?(?:\\))?)?$");
var w=["KB","MB","GB","TB","PB","EB","ZB","YB"],y=false;
for(var q=0;
q<=w.length;
q++){y=(x.indexOf(w[q])>-1)?Math.pow(1024,q+1):false;
if(y){break
}}r._n=((y)?y:1)*((v.match(z))?Math.pow(10,3):1)*((v.match(u))?Math.pow(10,6):1)*((v.match(t))?Math.pow(10,9):1)*((v.match(s))?Math.pow(10,12):1)*((x.indexOf("%")>-1)?0.01:1)*Number(((x.indexOf("(")>-1)?"-":"")+x.replace(/[^0-9\.-]+/g,""));
r._n=(y)?Math.ceil(r._n):r._n
}}return r._n
}function j(u,t){var r=(t.indexOf("$")<=1)?true:false;
var s="";
if(t.indexOf(" $")>-1){s=" ";
t=t.replace(" $","")
}else{if(t.indexOf("$ ")>-1){s=" ";
t=t.replace("$ ","")
}else{t=t.replace("$","")
}}var q=c(u,t);
if(r){if(q.indexOf("(")>-1||q.indexOf("-")>-1){q=q.split("");
q.splice(1,0,h[f].currency.symbol+s);
q=q.join("")
}else{q=h[f].currency.symbol+s+q
}}else{if(q.indexOf(")")>-1){q=q.split("");
q.splice(-1,0,s+h[f].currency.symbol);
q=q.join("")
}else{q=q+s+h[f].currency.symbol
}}return q
}function i(t,s){var r="";
if(s.indexOf(" %")>-1){r=" ";
s=s.replace(" %","")
}else{s=s.replace("%","")
}t._n=t._n*100;
var q=c(t,s);
if(q.indexOf(")")>-1){q=q.split("");
q.splice(-1,0,r+"%");
q=q.join("")
}else{q=q+r+"%"
}return q
}function o(u,s){var q=Math.floor(u._n/60/60),r=Math.floor((u._n-(q*60*60))/60),t=Math.round(u._n-(q*60*60)-(r*60));
return q+":"+((r<10)?"0"+r:r)+":"+((t<10)?"0"+t:t)
}function n(q){var r=q.split(":"),s=0;
if(r.length===3){s=s+(Number(r[0])*60*60);
s=s+(Number(r[1])*60);
s=s+Number(r[2])
}else{if(r.lenght===2){s=s+(Number(r[0])*60);
s=s+Number(r[1])
}}return Number(s)
}function b(s,D){var E=false,v=false,F="",G="",r="",H=Math.abs(s._n);
if(s._n===0&&k!==null){return k
}else{if(D.indexOf("(")>-1){E=true;
D=D.slice(1,-1)
}if(D.indexOf("a")>-1){if(D.indexOf(" a")>-1){F=" ";
D=D.replace(" a","")
}else{D=D.replace("a","")
}if(H>=Math.pow(10,12)){F=F+h[f].abbreviations.trillion;
s._n=s._n/Math.pow(10,12)
}else{if(H<Math.pow(10,12)&&H>=Math.pow(10,9)){F=F+h[f].abbreviations.billion;
s._n=s._n/Math.pow(10,9)
}else{if(H<Math.pow(10,9)&&H>=Math.pow(10,6)){F=F+h[f].abbreviations.million;
s._n=s._n/Math.pow(10,6)
}else{if(H<Math.pow(10,6)&&H>=Math.pow(10,3)){F=F+h[f].abbreviations.thousand;
s._n=s._n/Math.pow(10,3)
}}}}}if(D.indexOf("b")>-1){if(D.indexOf(" b")>-1){G=" ";
D=D.replace(" b","")
}else{D=D.replace("b","")
}var x=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],u,B;
for(var q=0;
q<=x.length;
q++){u=Math.pow(1024,q);
B=Math.pow(1024,q+1);
if(s._n>=u&&s._n<B){G=G+x[q];
if(u>0){s._n=s._n/u
}break
}}}if(D.indexOf("o")>-1){if(D.indexOf(" o")>-1){r=" ";
D=D.replace(" o","")
}else{D=D.replace("o","")
}r=r+h[f].ordinal(s._n)
}if(D.indexOf("[.]")>-1){v=true;
D=D.replace("[.]",".")
}var C=s._n.toString().split(".")[0],y=D.split(".")[1],z=D.indexOf(","),A="",t=false;
if(y){if(y.indexOf("[")>-1){y=y.replace("]","");
y=y.split("[");
A=a(s._n,(y[0].length+y[1].length),y[1].length)
}else{A=a(s._n,y.length)
}C=A.split(".")[0];
if(A.split(".")[1].length){A=h[f].delimiters.decimal+A.split(".")[1]
}else{A=""
}if(v&&Number(A)===0){A=""
}}else{C=a(s._n,null)
}if(C.indexOf("-")>-1){C=C.slice(1);
t=true
}if(z>-1){C=C.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+h[f].delimiters.thousands)
}if(D.indexOf(".")===0){C=""
}return((E&&t)?"(":"")+((!E&&t)?"-":"")+C+A+((r)?r:"")+((F)?F:"")+((G)?G:"")+((E&&t)?")":"")
}}g=function(q){if(g.isNumeral(q)){q=q.value()
}else{if(!Number(q)){q=0
}}return new l(Number(q))
};
g.version=p;
g.isNumeral=function(q){return q instanceof l
};
g.language=function(r,q){if(!r){return f
}if(r&&!q){f=r
}if(q||!h[r]){m(r,q)
}return g
};
g.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(r){var q=r%10;
return(~~(r%100/10)===1)?"th":(q===1)?"st":(q===2)?"nd":(q===3)?"rd":"th"
},currency:{symbol:"$"}});
g.zeroFormat=function(q){if(typeof(q)==="string"){k=q
}else{k=null
}};
function m(r,q){h[r]=q
}g.fn=l.prototype={clone:function(){return g(this)
},format:function(q){return c(this,q?q:g.defaultFormat)
},unformat:function(q){return d(this,q?q:g.defaultFormat)
},value:function(){return this._n
},valueOf:function(){return this._n
},set:function(q){this._n=Number(q);
return this
},add:function(q){this._n=this._n+Number(q);
return this
},subtract:function(q){this._n=this._n-Number(q);
return this
},multiply:function(q){this._n=this._n*Number(q);
return this
},divide:function(q){this._n=this._n/Number(q);
return this
},difference:function(q){var r=this._n-Number(q);
if(r<0){r=-r
}return r
}};
if(e){module.exports=g
}if(typeof ender==="undefined"){this["numeral"]=g
}if(typeof define==="function"&&define.amd){define([],function(){return g
})
}}).call(this);
/*!
 * jQuery contextMenu - Plugin for simple contextMenu handling
 *
 * Version: 1.5.25
 *
 * Authors: Rodney Rehm, Addy Osmani (patches for FF)
 * Web: http://medialize.github.com/jQuery-contextMenu/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *   GPL v3 http://opensource.org/licenses/GPL-3.0
 *
 */
(function(k,f){k.support.htmlMenuitem=("HTMLMenuItemElement" in window);
k.support.htmlCommand=("HTMLCommandElement" in window);
k.support.eventSelectstart=("onselectstart" in document.documentElement);
var i=null,g=false,d=k(window),a=0,b={},j={},n={},h={selector:null,appendTo:null,trigger:"right",autoHide:false,delay:200,determinePosition:function(r){if(k.ui&&k.ui.position){r.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none")
}else{var s=this.offset();
s.top+=this.outerHeight();
s.left+=this.outerWidth()/2-r.outerWidth()/2;
r.css(s)
}},position:function(t,A,w){var v=this,u;
if(!A&&!w){t.determinePosition.call(this,t.$menu);
return
}else{if(A==="maintain"&&w==="maintain"){u=t.$menu.position()
}else{var z=t.$trigger.parents().andSelf().filter(function(){return k(this).css("position")=="fixed"
}).length;
if(z){w-=d.scrollTop();
A-=d.scrollLeft()
}u={top:w,left:A}
}}var r=d.scrollTop()+d.height(),B=d.scrollLeft()+d.width(),C=t.$menu.height(),s=t.$menu.width();
if(u.top+C>r){u.top-=C
}if(u.left+s>B){u.left-=s
}t.$menu.css(u)
},positionSubmenu:function(r){if(k.ui&&k.ui.position){r.css("display","block").position({my:"left top",at:"right top",of:this,collision:"fit"}).css("display","")
}else{var s={top:0,left:this.outerWidth()};
r.css(s)
}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:k.noop,hide:k.noop},callback:null,items:{}},o={timer:null,pageX:null,pageY:null},q=function(t){var s=0,r=t;
while(true){s=Math.max(s,parseInt(r.css("z-index"),10)||0);
r=r.parent();
if(!r||!r.length||"html body".indexOf(r.prop("nodeName").toLowerCase())>-1){break
}}return s
},m={abortevent:function(r){r.preventDefault();
r.stopImmediatePropagation()
},contextmenu:function(t){var s=k(this);
t.preventDefault();
t.stopImmediatePropagation();
if(t.data.trigger!="right"&&t.originalEvent){return
}if(!s.hasClass("context-menu-disabled")){i=s;
if(t.data.build){var r=t.data.build(i,t);
if(r===false){return
}t.data=k.extend(true,{},h,t.data,r||{});
if(!t.data.items||k.isEmptyObject(t.data.items)){if(window.console){(console.error||console.log)("No items specified to show in contextMenu")
}throw new Error("No Items sepcified")
}t.data.$trigger=i;
l.create(t.data)
}l.show.call(s,t.data,t.pageX,t.pageY)
}},click:function(r){r.preventDefault();
r.stopImmediatePropagation();
k(this).trigger(k.Event("contextmenu",{data:r.data,pageX:r.pageX,pageY:r.pageY}))
},mousedown:function(s){var r=k(this);
if(i&&i.length&&!i.is(r)){i.data("contextMenu").$menu.trigger("contextmenu:hide")
}if(s.button==2){i=r.data("contextMenuActive",true)
}},mouseup:function(s){var r=k(this);
if(r.data("contextMenuActive")&&i&&i.length&&i.is(r)&&!r.hasClass("context-menu-disabled")){s.preventDefault();
s.stopImmediatePropagation();
i=r;
r.trigger(k.Event("contextmenu",{data:s.data,pageX:s.pageX,pageY:s.pageY}))
}r.removeData("contextMenuActive")
},mouseenter:function(t){var s=k(this),r=k(t.relatedTarget),u=k(document);
if(r.is(".context-menu-list")||r.closest(".context-menu-list").length){return
}if(i&&i.length){return
}o.pageX=t.pageX;
o.pageY=t.pageY;
o.data=t.data;
u.on("mousemove.contextMenuShow",m.mousemove);
o.timer=setTimeout(function(){o.timer=null;
u.off("mousemove.contextMenuShow");
i=s;
s.trigger(k.Event("contextmenu",{data:o.data,pageX:o.pageX,pageY:o.pageY}))
},t.data.delay)
},mousemove:function(r){o.pageX=r.pageX;
o.pageY=r.pageY
},mouseleave:function(s){var r=k(s.relatedTarget);
if(r.is(".context-menu-list")||r.closest(".context-menu-list").length){return
}try{clearTimeout(o.timer)
}catch(s){}o.timer=null
},layerClick:function(u){var w=k(this),A=w.data("contextMenuRoot"),s=false,t=u.button,B=u.pageX,z=u.pageY,v,r,C;
u.preventDefault();
u.stopImmediatePropagation();
w.on("mouseup",function(){s=true
});
setTimeout(function(){var D,y;
if((A.trigger=="left"&&t==0)||(A.trigger=="right"&&t==2)){if(document.elementFromPoint){A.$layer.hide();
v=document.elementFromPoint(B-d.scrollLeft(),z-d.scrollTop());
A.$layer.show();
C=[];
for(var x in b){C.push(x)
}v=k(v).closest(C.join(", "));
if(v.length){if(v.is(A.$trigger[0])){A.position.call(A.$trigger,A,B,z);
return
}}}else{r=A.$trigger.offset();
D=k(window);
r.top+=D.scrollTop();
if(r.top<=u.pageY){r.left+=D.scrollLeft();
if(r.left<=u.pageX){r.bottom=r.top+A.$trigger.outerHeight();
if(r.bottom>=u.pageY){r.right=r.left+A.$trigger.outerWidth();
if(r.right>=u.pageX){A.position.call(A.$trigger,A,B,z);
return
}}}}}}y=function(E){if(E){E.preventDefault();
E.stopImmediatePropagation()
}A.$menu.trigger("contextmenu:hide");
if(v&&v.length){setTimeout(function(){v.contextMenu({x:B,y:z})
},50)
}};
if(s){y()
}else{w.on("mouseup",y)
}},50)
},keyStop:function(s,r){if(!r.isInput){s.preventDefault()
}s.stopPropagation()
},key:function(w){var u=i.data("contextMenu")||{},s=u.$menu.children(),x;
switch(w.keyCode){case 9:case 38:m.keyStop(w,u);
if(u.isInput){if(w.keyCode==9&&w.shiftKey){w.preventDefault();
u.$selected&&u.$selected.find("input, textarea, select").blur();
u.$menu.trigger("prevcommand");
return
}else{if(w.keyCode==38&&u.$selected.find("input, textarea, select").prop("type")=="checkbox"){w.preventDefault();
return
}}}else{if(w.keyCode!=9||w.shiftKey){u.$menu.trigger("prevcommand");
return
}}case 40:m.keyStop(w,u);
if(u.isInput){if(w.keyCode==9){w.preventDefault();
u.$selected&&u.$selected.find("input, textarea, select").blur();
u.$menu.trigger("nextcommand");
return
}else{if(w.keyCode==40&&u.$selected.find("input, textarea, select").prop("type")=="checkbox"){w.preventDefault();
return
}}}else{u.$menu.trigger("nextcommand");
return
}break;
case 37:m.keyStop(w,u);
if(u.isInput||!u.$selected||!u.$selected.length){break
}if(!u.$selected.parent().hasClass("context-menu-root")){var v=u.$selected.parent().parent();
u.$selected.trigger("contextmenu:blur");
u.$selected=v;
return
}break;
case 39:m.keyStop(w,u);
if(u.isInput||!u.$selected||!u.$selected.length){break
}var t=u.$selected.data("contextMenu")||{};
if(t.$menu&&u.$selected.hasClass("context-menu-submenu")){u.$selected=null;
t.$selected=null;
t.$menu.trigger("nextcommand");
return
}break;
case 35:case 36:if(u.$selected&&u.$selected.find("input, textarea, select").length){return
}else{(u.$selected&&u.$selected.parent()||u.$menu).children(":not(.disabled, .not-selectable)")[w.keyCode==36?"first":"last"]().trigger("contextmenu:focus");
w.preventDefault();
return
}break;
case 13:m.keyStop(w,u);
if(u.isInput){if(u.$selected&&!u.$selected.is("textarea, select")){w.preventDefault();
return
}break
}u.$selected&&u.$selected.trigger("mouseup");
return;
case 32:case 33:case 34:m.keyStop(w,u);
return;
case 27:m.keyStop(w,u);
u.$menu.trigger("contextmenu:hide");
return;
default:var r=(String.fromCharCode(w.keyCode)).toUpperCase();
if(u.accesskeys[r]){u.accesskeys[r].$node.trigger(u.accesskeys[r].$menu?"contextmenu:focus":"mouseup");
return
}break
}w.stopPropagation();
u.$selected&&u.$selected.trigger(w)
},prevItem:function(v){v.stopPropagation();
var u=k(this).data("contextMenu")||{};
if(u.$selected){var r=u.$selected;
u=u.$selected.parent().data("contextMenu")||{};
u.$selected=r
}var t=u.$menu.children(),s=!u.$selected||!u.$selected.prev().length?t.last():u.$selected.prev(),x=s;
while(s.hasClass("disabled")||s.hasClass("not-selectable")){if(s.prev().length){s=s.prev()
}else{s=t.last()
}if(s.is(x)){return
}}if(u.$selected){m.itemMouseleave.call(u.$selected.get(0),v)
}m.itemMouseenter.call(s.get(0),v);
var w=s.find("input, textarea, select");
if(w.length){w.focus()
}},nextItem:function(v){v.stopPropagation();
var u=k(this).data("contextMenu")||{};
if(u.$selected){var r=u.$selected;
u=u.$selected.parent().data("contextMenu")||{};
u.$selected=r
}var t=u.$menu.children(),s=!u.$selected||!u.$selected.next().length?t.first():u.$selected.next(),x=s;
while(s.hasClass("disabled")||s.hasClass("not-selectable")){if(s.next().length){s=s.next()
}else{s=t.first()
}if(s.is(x)){return
}}if(u.$selected){m.itemMouseleave.call(u.$selected.get(0),v)
}m.itemMouseenter.call(s.get(0),v);
var w=s.find("input, textarea, select");
if(w.length){w.focus()
}},focusInput:function(v){var u=k(this).closest(".context-menu-item"),t=u.data(),s=t.contextMenu,r=t.contextMenuRoot;
r.$selected=s.$selected=u;
r.isInput=s.isInput=true
},blurInput:function(v){var u=k(this).closest(".context-menu-item"),t=u.data(),s=t.contextMenu,r=t.contextMenuRoot;
r.isInput=s.isInput=false
},menuMouseenter:function(s){var r=k(this).data().contextMenuRoot;
r.hovering=true
},menuMouseleave:function(s){var r=k(this).data().contextMenuRoot;
if(r.$layer&&r.$layer.is(s.relatedTarget)){r.hovering=false
}},itemMouseenter:function(v){var u=k(this),t=u.data(),s=t.contextMenu,r=t.contextMenuRoot;
r.hovering=true;
if(v&&r.$layer&&r.$layer.is(v.relatedTarget)){v.preventDefault();
v.stopImmediatePropagation()
}(s.$menu?s:r).$menu.children(".hover").trigger("contextmenu:blur");
if(u.hasClass("disabled")||u.hasClass("not-selectable")){s.$selected=null;
return
}u.trigger("contextmenu:focus")
},itemMouseleave:function(v){var u=k(this),t=u.data(),s=t.contextMenu,r=t.contextMenuRoot;
if(r!==s&&r.$layer&&r.$layer.is(v.relatedTarget)){r.$selected&&r.$selected.trigger("contextmenu:blur");
v.preventDefault();
v.stopImmediatePropagation();
r.$selected=s.$selected=s.$node;
return
}u.trigger("contextmenu:blur")
},itemClick:function(w){var v=k(this),u=v.data(),t=u.contextMenu,r=u.contextMenuRoot,s=u.contextMenuKey,x;
if(!t.items[s]||v.hasClass("disabled")||v.hasClass("context-menu-submenu")){return
}w.preventDefault();
w.stopImmediatePropagation();
if(k.isFunction(r.callbacks[s])){x=r.callbacks[s]
}else{if(k.isFunction(r.callback)){x=r.callback
}else{return
}}if(x.call(r.$trigger,s,r)!==false){r.$menu.trigger("contextmenu:hide")
}else{if(r.$menu.parent().length){l.update.call(r.$trigger,r)
}}},inputClick:function(r){r.stopImmediatePropagation()
},hideMenu:function(t,s){var r=k(this).data("contextMenuRoot");
l.hide.call(r.$trigger,r,s&&s.force)
},focusItem:function(v){v.stopPropagation();
var u=k(this),t=u.data(),s=t.contextMenu,r=t.contextMenuRoot;
u.addClass("hover").siblings(".hover").trigger("contextmenu:blur");
s.$selected=r.$selected=u;
if(s.$node){r.positionSubmenu.call(s.$node,s.$menu)
}},blurItem:function(v){v.stopPropagation();
var u=k(this),t=u.data(),s=t.contextMenu,r=t.contextMenuRoot;
u.removeClass("hover");
s.$selected=null
}},l={show:function(t,r,z){var u=k(this),v,s={};
k("#context-menu-layer").trigger("mousedown");
t.$trigger=u;
if(t.events.show.call(u,t)===false){i=null;
return
}l.update.call(u,t);
t.position.call(u,t,r,z);
if(t.zIndex){s.zIndex=q(u)+t.zIndex
}l.layer.call(t.$menu,t,s.zIndex);
t.$menu.find("ul").css("zIndex",s.zIndex+1);
t.$menu.css(s)[t.animation.show](t.animation.duration);
u.data("contextMenu",t);
k(document).off("keydown.contextMenu").on("keydown.contextMenu",m.key);
if(t.autoHide){var w=u.position();
w.right=w.left+u.outerWidth();
w.bottom=w.top+this.outerHeight();
k(document).on("mousemove.contextMenuAutoHide",function(x){if(t.$layer&&!t.hovering&&(!(x.pageX>=w.left&&x.pageX<=w.right)||!(x.pageY>=w.top&&x.pageY<=w.bottom))){t.$menu.trigger("contextmenu:hide")
}})
}},hide:function(r,s){var u=k(this);
if(!r){r=u.data("contextMenu")||{}
}if(!s&&r.events&&r.events.hide.call(u,r)===false){return
}if(r.$layer){setTimeout((function(v){return function(){v.remove()
}
})(r.$layer),10);
try{delete r.$layer
}catch(t){r.$layer=null
}}i=null;
r.$menu.find(".hover").trigger("contextmenu:blur");
r.$selected=null;
k(document).off(".contextMenuAutoHide").off("keydown.contextMenu");
r.$menu&&r.$menu[r.animation.hide](r.animation.duration,function(){if(r.build){r.$menu.remove();
k.each(r,function(v,w){switch(v){case"ns":case"selector":case"build":case"trigger":return true;
default:r[v]=f;
try{delete r[v]
}catch(x){}return true
}})
}})
},create:function(s,r){if(r===f){r=s
}s.$menu=k('<ul class="context-menu-list '+(s.className||"")+'"></ul>').data({contextMenu:s,contextMenuRoot:r});
k.each(["callbacks","commands","inputs"],function(u,t){s[t]={};
if(!r[t]){r[t]={}
}});
r.accesskeys||(r.accesskeys={});
k.each(s.items,function(v,w){var A=k('<li class="context-menu-item '+(w.className||"")+'"></li>'),t=null,z=null;
w.$node=A.data({contextMenu:s,contextMenuRoot:r,contextMenuKey:v});
if(w.accesskey){var x=c(w.accesskey);
for(var u=0,y;
y=x[u];
u++){if(!r.accesskeys[y]){r.accesskeys[y]=w;
w._name=w.name.replace(new RegExp("("+y+")","i"),'<span class="context-menu-accesskey">$1</span>');
break
}}}if(typeof w=="string"){A.addClass("context-menu-separator not-selectable")
}else{if(w.type&&n[w.type]){n[w.type].call(A,w,s,r);
k.each([s,r],function(C,B){B.commands[v]=w;
if(k.isFunction(w.callback)){B.callbacks[v]=w.callback
}})
}else{if(w.type=="html"){A.addClass("context-menu-html not-selectable")
}else{if(w.type){t=k("<label></label>").appendTo(A);
k("<span></span>").html(w._name||w.name).appendTo(t);
A.addClass("context-menu-input");
s.hasTypes=true;
k.each([s,r],function(C,B){B.commands[v]=w;
B.inputs[v]=w
})
}else{if(w.items){w.type="sub"
}}}switch(w.type){case"text":z=k('<input type="text" value="1" name="context-menu-input-'+v+'" value="">').val(w.value||"").appendTo(t);
break;
case"textarea":z=k('<textarea name="context-menu-input-'+v+'"></textarea>').val(w.value||"").appendTo(t);
if(w.height){z.height(w.height)
}break;
case"checkbox":z=k('<input type="checkbox" value="1" name="context-menu-input-'+v+'" value="">').val(w.value||"").prop("checked",!!w.selected).prependTo(t);
break;
case"radio":z=k('<input type="radio" value="1" name="context-menu-input-'+w.radio+'" value="">').val(w.value||"").prop("checked",!!w.selected).prependTo(t);
break;
case"select":z=k('<select name="context-menu-input-'+v+'">').appendTo(t);
if(w.options){k.each(w.options,function(B,C){k("<option></option>").val(B).text(C).appendTo(z)
});
z.val(w.selected)
}break;
case"sub":k("<span></span>").html(w._name||w.name).appendTo(A);
w.appendTo=w.$node;
l.create(w,r);
A.data("contextMenu",w).addClass("context-menu-submenu");
w.callback=null;
break;
case"html":k(w.html).appendTo(A);
break;
default:k.each([s,r],function(C,B){B.commands[v]=w;
if(k.isFunction(w.callback)){B.callbacks[v]=w.callback
}});
k("<span></span>").html(w._name||w.name||"").appendTo(A);
break
}if(w.type&&w.type!="sub"&&w.type!="html"){z.on("focus",m.focusInput).on("blur",m.blurInput);
if(w.events){z.on(w.events,s)
}}if(w.icon){A.addClass("icon icon-"+w.icon)
}}}w.$input=z;
w.$label=t;
A.appendTo(s.$menu);
if(!s.hasTypes&&k.support.eventSelectstart){A.on("selectstart.disableTextSelect",m.abortevent)
}});
if(!s.$node){s.$menu.css("display","none").addClass("context-menu-root")
}s.$menu.appendTo(s.appendTo||document.body)
},update:function(s,r){var t=this;
if(r===f){r=s;
s.$menu.find("ul").andSelf().css({position:"static",display:"block"}).each(function(){var u=k(this);
u.width(u.css("position","absolute").width()).css("position","static")
}).css({position:"",display:""})
}s.$menu.children().each(function(){var u=k(this),v=u.data("contextMenuKey"),x=s.items[v],w=(k.isFunction(x.disabled)&&x.disabled.call(t,v,r))||x.disabled===true;
u[w?"addClass":"removeClass"]("disabled");
if(x.type){u.find("input, select, textarea").prop("disabled",w);
switch(x.type){case"text":case"textarea":x.$input.val(x.value||"");
break;
case"checkbox":case"radio":x.$input.val(x.value||"").prop("checked",!!x.selected);
break;
case"select":x.$input.val(x.selected||"");
break
}}if(x.$menu){l.update.call(t,x,r)
}})
},layer:function(s,t){var r=s.$layer=k('<div id="context-menu-layer" style="position:fixed; z-index:'+t+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:d.height(),width:d.width(),display:"block"}).data("contextMenuRoot",s).insertBefore(this).on("contextmenu",m.abortevent).on("mousedown",m.layerClick);
if(!k.support.fixedPosition){r.css({position:"absolute",height:k(document).height()})
}return r
}};
function c(w){var u=w.split(/\s+/),v=[];
for(var s=0,r;
r=u[s];
s++){r=r[0].toUpperCase();
v.push(r)
}return v
}k.fn.contextMenu=function(r){if(r===f){this.first().trigger("contextmenu")
}else{if(r.x&&r.y){this.first().trigger(k.Event("contextmenu",{pageX:r.x,pageY:r.y}))
}else{if(r==="hide"){var s=this.data("contextMenu").$menu;
s&&s.trigger("contextmenu:hide")
}else{if(r){this.removeClass("context-menu-disabled")
}else{if(!r){this.addClass("context-menu-disabled")
}}}}}return this
};
k.contextMenu=function(r,s){if(typeof r!="string"){s=r;
r="create"
}if(typeof s=="string"){s={selector:s}
}else{if(s===f){s={}
}}var w=k.extend(true,{},h,s||{}),v=k(document);
switch(r){case"create":if(!w.selector){throw new Error("No selector specified")
}if(w.selector.match(/.context-menu-(list|item|input)($|\s)/)){throw new Error('Cannot bind to selector "'+w.selector+'" as it contains a reserved className')
}if(!w.build&&(!w.items||k.isEmptyObject(w.items))){throw new Error("No Items sepcified")
}a++;
w.ns=".contextMenu"+a;
b[w.selector]=w.ns;
j[w.ns]=w;
if(!w.trigger){w.trigger="right"
}if(!g){v.on({"contextmenu:hide.contextMenu":m.hideMenu,"prevcommand.contextMenu":m.prevItem,"nextcommand.contextMenu":m.nextItem,"contextmenu.contextMenu":m.abortevent,"mouseenter.contextMenu":m.menuMouseenter,"mouseleave.contextMenu":m.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",m.inputClick).on({"mouseup.contextMenu":m.itemClick,"contextmenu:focus.contextMenu":m.focusItem,"contextmenu:blur.contextMenu":m.blurItem,"contextmenu.contextMenu":m.abortevent,"mouseenter.contextMenu":m.itemMouseenter,"mouseleave.contextMenu":m.itemMouseleave},".context-menu-item");
g=true
}v.on("contextmenu"+w.ns,w.selector,w,m.contextmenu);
switch(w.trigger){case"hover":v.on("mouseenter"+w.ns,w.selector,w,m.mouseenter).on("mouseleave"+w.ns,w.selector,w,m.mouseleave);
break;
case"left":v.on("click"+w.ns,w.selector,w,m.click);
break
}if(!w.build){l.create(w)
}break;
case"destroy":if(!w.selector){v.off(".contextMenu .contextMenuAutoHide");
k.each(b,function(x,y){v.off(y)
});
b={};
j={};
a=0;
g=false;
k("#context-menu-layer, .context-menu-list").remove()
}else{if(b[w.selector]){var t=k(".context-menu-list").filter(":visible");
if(t.length&&t.data().contextMenuRoot.$trigger.is(w.selector)){t.trigger("contextmenu:hide",{force:true})
}try{if(j[b[w.selector]].$menu){j[b[w.selector]].$menu.remove()
}delete j[b[w.selector]]
}catch(u){j[b[w.selector]]=null
}v.off(b[w.selector])
}}break;
case"html5":if((!k.support.htmlCommand&&!k.support.htmlMenuitem)||(typeof s=="boolean"&&s)){k('menu[type="context"]').each(function(){if(this.id){k.contextMenu({selector:"[contextmenu="+this.id+"]",items:k.contextMenu.fromMenu(this)})
}}).css("display","none")
}break;
default:throw new Error('Unknown operation "'+r+'"')
}return this
};
k.contextMenu.setInputValues=function(r,s){if(s===f){s={}
}k.each(r.inputs,function(t,u){switch(u.type){case"text":case"textarea":u.value=s[t]||"";
break;
case"checkbox":u.selected=s[t]?true:false;
break;
case"radio":u.selected=(s[u.radio]||"")==u.value?true:false;
break;
case"select":u.selected=s[t]||"";
break
}})
};
k.contextMenu.getInputValues=function(r,s){if(s===f){s={}
}k.each(r.inputs,function(t,u){switch(u.type){case"text":case"textarea":case"select":s[t]=u.$input.val();
break;
case"checkbox":s[t]=u.$input.prop("checked");
break;
case"radio":if(u.$input.prop("checked")){s[u.radio]=u.value
}break
}});
return s
};
function e(r){return(r.id&&k('label[for="'+r.id+'"]').val())||r.name
}function p(t,s,r){if(!r){r=0
}s.each(function(){var u=k(this),x=this,y=this.nodeName.toLowerCase(),v,w;
if(y=="label"&&u.find("input, textarea, select").length){v=u.text();
u=u.children().first();
x=u.get(0);
y=x.nodeName.toLowerCase()
}switch(y){case"menu":w={name:u.attr("label"),items:{}};
r=p(w.items,u.children(),r);
break;
case"a":case"button":w={name:u.text(),disabled:!!u.attr("disabled"),callback:(function(){return function(){u.click()
}
})()};
break;
case"menuitem":case"command":switch(u.attr("type")){case f:case"command":case"menuitem":w={name:u.attr("label"),disabled:!!u.attr("disabled"),callback:(function(){return function(){u.click()
}
})()};
break;
case"checkbox":w={type:"checkbox",disabled:!!u.attr("disabled"),name:u.attr("label"),selected:!!u.attr("checked")};
break;
case"radio":w={type:"radio",disabled:!!u.attr("disabled"),name:u.attr("label"),radio:u.attr("radiogroup"),value:u.attr("id"),selected:!!u.attr("checked")};
break;
default:w=f
}break;
case"hr":w="-------";
break;
case"input":switch(u.attr("type")){case"text":w={type:"text",name:v||e(x),disabled:!!u.attr("disabled"),value:u.val()};
break;
case"checkbox":w={type:"checkbox",name:v||e(x),disabled:!!u.attr("disabled"),selected:!!u.attr("checked")};
break;
case"radio":w={type:"radio",name:v||e(x),disabled:!!u.attr("disabled"),radio:!!u.attr("name"),value:u.val(),selected:!!u.attr("checked")};
break;
default:w=f;
break
}break;
case"select":w={type:"select",name:v||e(x),disabled:!!u.attr("disabled"),selected:u.val(),options:{}};
u.children().each(function(){w.options[this.value]=k(this).text()
});
break;
case"textarea":w={type:"textarea",name:v||e(x),disabled:!!u.attr("disabled"),value:u.val()};
break;
case"label":break;
default:w={type:"html",html:u.clone(true)};
break
}if(w){r++;
t["key"+r]=w
}});
return r
}k.contextMenu.fromMenu=function(s){var t=k(s),r={};
p(r,t.children());
return r
};
k.contextMenu.defaults=h;
k.contextMenu.types=n
})(jQuery);(function(b,c,a){b.plugin2("spreadsheet",{_create:function(g){var e=b(g),d=e.attr("data-input-name"),i=[],f,h;
e.find("tr").each(function(){var j=[];
i.push(j);
b(this).find("td").each(function(){j.push(b(this).text())
})
});
if(i.length===0){i.push([""])
}f=b("<div/>",{});
h=b("<input/>",{type:"hidden",name:d+".json"});
e.after(f);
e.after(h);
e.remove();
f.handsontable({data:i,rowHeaders:true,colHeaders:true,minSpareRows:1,minSpareCols:1,fillHandle:false,contextMenu:true,onChange:function(){h.val(JSON.stringify(i))
}})
}})
})(jQuery,window);(function(b,d,a){var f=b(d),c=d.document,e=b(c);
d.cms=d.cms||{};
d.cms.startToolUserPing=function(){setInterval(function(){b.getJSON(CONTEXT_PATH+"/toolUserPing",function(i){var g=i.status,h=d.location.href,j;
if(g==="ERROR"&&!(/logIn.jsp/.exec(h))){d.location=CONTEXT_PATH+"/logIn.jsp?forced=true&returnPath="+encodeURIComponent(d.location.pathname+d.location.search)
}else{if(g==="OK"&&(/logIn.jsp/.exec(h))){j=(/[?&]returnPath=([^&]+)/.exec(h)||[])[1];
j=j?decodeURIComponent(j):CONTEXT_PATH+"/";
j=j.replace(/^\/?/,"/");
d.location=d.location.protocol+"//"+d.location.host+j
}}})
},2000)
};
e.repeatable("live",".repeatableForm, .repeatableInputs, .repeatableLayout, .repeatableObjectId");
e.repeatable("live",".repeatableText",{addButtonText:"",removeButtonText:"",restoreButtonText:""});
e.autoSubmit("live",".autoSubmit");
e.calendar("live",":text.date");
e.dropDown("live",'select[multiple], select[data-searchable="true"]');
e.expandable("live",":text.expandable, textarea",{shadowClass:"input"});
e.frame({frameClassName:"frame",loadingClassName:"loading",loadedClassName:"loaded"});
e.imageEditor("live",".imageEditor");
e.objectId("live",":input.objectId");
e.pageLayout("live",".pageLayout");
e.pageThumbnails("live",".pageThumbnails");
e.rte("live",".richtext");
e.spreadsheet("live",".spreadsheet");
e.taxonomy("live",".taxonomy");
e.toggleable("live",".toggleable");
e.workflow("live",".workflow");
e.onCreate(".searchInput",function(){var h=b(this),g=h.find("> label"),i=h.find("> :text");
i.bind("input",b.run(function(){g.toggle(!i.val())
}))
});
e.onCreate("[autofocus], .autoFocus",function(){var g=c.activeElement;
if(!g||g===c||g===c.body){b(this).focus()
}});
e.onCreate(".inputContainer .permissions select",function(){var g=b(this);
g.bind("change",b.run(function(){g.parent().find("> h2, > ul").toggle(g.find(":selected").val()==="some")
}))
});
e.onCreate(".dashboardCell",function(){var l=b(this),h,g,j,m,k,i;
h=b("<span/>",{"class":"dashboardMoveContainer"});
g=function(){var p=l.closest(".dashboard"),n,o=[];
p.find(".dashboardColumn:empty").remove();
n=p.find(".dashboardColumn");
p.attr("data-columns",n.length);
n.each(function(){var q=o[o.length]=[];
b(this).find(".dashboardCell").each(function(){q[q.length]=b(this).attr("data-widget")
})
});
b.ajax({type:"post",url:CONTEXT_PATH+"/misc/updateUserSettings",data:"action=dashboardWidgets-position&widgets="+encodeURIComponent(JSON.stringify(o))})
};
j=b("<span/>",{"class":"dashboardMoveUp",click:function(){l.prev().before(l);
g();
return false
}});
m=b("<span/>",{"class":"dashboardMoveDown",click:function(){l.next().after(l);
g();
return false
}});
k=b("<span/>",{"class":"dashboardMoveLeft",click:function(){var n=l.closest(".dashboardColumn");
$prevColumn=n.prev();
if($prevColumn.length===0){$prevColumn=b("<div/>",{"class":"dashboardColumn"});
n.before($prevColumn)
}$prevColumn.prepend(l);
g();
return false
}});
i=b("<span/>",{"class":"dashboardMoveRight",click:function(){var n=l.closest(".dashboardColumn");
$nextColumn=n.next();
if($nextColumn.length===0){$nextColumn=b("<div/>",{"class":"dashboardColumn"});
n.after($nextColumn)
}$nextColumn.prepend(l);
g();
return false
}});
h.append(j);
h.append(m);
h.append(k);
h.append(i);
l.append(h)
});
e.onCreate(".searchSuggestionsForm",function(){var g=b(this),j=g.popup("source"),i=j.closest(".contentForm"),h;
if(i.length===0){return
}h=d.location.search;
h+=h.indexOf("?")>-1?"&":"?";
h+="id="+i.attr("data-object-id");
b.ajax({data:i.serialize(),type:"post",url:CONTEXT_PATH+"/content/state.jsp"+h,complete:function(k){if(g.closest("body").length===0){return
}g.append(b("<input/>",{type:"hidden",name:"object",value:k.responseText}));
g.append(b("<input/>",{type:"hidden",name:"field",value:j.closest(".inputContainer").attr("data-field")}));
g.submit()
}})
});
e.on("change",".inputContainer",function(){var h=b(this),g;
h.find("input, textarea").each(function(){if(this.defaultValue!==this.value){g=true;
return
}});
if(!g){h.find("option").each(function(){if(this.defaultSelected!==this.selected){g=true;
return
}})
}h.toggleClass("state-changed",g)
});
e.onCreate(".objectInputs",function(){var j=b(this),i=j.find("> .inputContainer"),k={},h=[],g;
i.each(function(){var n=b(this),m=n.attr("data-tab"),l;
if(m){l=k[m];
if(!l){l=k[m]=[];
h.push({name:m,items:l})
}n.hide();
l.push(n)
}});
if(h.length>0){g=b("<ul/>",{"class":"tabs"});
g.bind("tabs-select.tabs",function(l){b(this).find("> li").removeClass("state-selected");
b(l.target).closest("li").addClass("state-selected")
});
g.append(b("<li/>",{"class":"state-selected",html:b("<a/>",{text:"Main",click:function(){b(this).trigger("tabs-select");
i.show();
b.each(h,function(l,m){b.each(m.items,function(o,n){n.hide()
})
});
return false
}})}));
b.each(h,function(l,m){g.append(b("<li/>",{html:b("<a/>",{text:m.name,click:function(){b(this).trigger("tabs-select");
i.hide();
b.each(m.items,function(o,n){n.show()
});
return false
}})}))
});
j.prepend(g)
}});
e.onCreate(".contentDiff",function(){var m=b(this),h,k,l,j=m.find("> .contentDiffLeft"),i=m.find("> .contentDiffRight"),g;
h=b("<ul/>",{"class":"tabs"});
k=b("<li/>",{html:b("<a/>",{text:"Edit",click:function(){m.trigger("contentDiff-edit");
return false
}})});
l=b("<li/>",{html:b("<a/>",{text:"Side By Side",click:function(){m.trigger("contentDiff-sideBySide");
return false
}})});
m.bind("contentDiff-edit",function(){m.add(b(".widget-publishing")).removeClass("contentDiff-sideBySide").addClass("contentDiff-edit");
h.find("li").removeClass("state-selected");
k.addClass("state-selected");
j.find("> .objectInputs > .inputContainer").css("height","");
i.find("> .objectInputs > .inputContainer").css("height","")
});
m.bind("contentDiff-sideBySide",function(){m.add(b(".widget-publishing")).removeClass("contentDiff-edit").addClass("contentDiff-sideBySide");
h.find("li").removeClass("state-selected");
l.addClass("state-selected");
j.find("> .objectInputs > .inputContainer").each(function(){var n=b(this),o=i.find('> .objectInputs > .inputContainer[data-field="'+n.attr("data-field")+'"]');
setTimeout(function(){n.add(o).height(Math.max(n.height(),o.height()))
},500)
})
});
g=function(n){return n.find(":input, select, textarea").serialize().replace(new RegExp("(^|&)[^%]+%2F","g"),"$1%2F")
};
j.find("> .objectInputs > .inputContainer").each(function(){var o=b(this),p=i.find('> .objectInputs > .inputContainer[data-field="'+o.attr("data-field")+'"]'),n=Math.max(o.outerHeight(true),p.outerHeight(true));
if(g(o)===g(p)){o.addClass("contentDiffSame");
p.addClass("contentDiffSame")
}});
j.find("> .objectInputs > .inputContainer > .inputSmall > textarea:not(.richtext)").each(function(){var q=b(this),t=i.find('> .objectInputs > .inputContainer[data-field="'+q.closest(".inputContainer").attr("data-field")+'"] textarea:not(.richtext)'),p=q.val(),o=t.val(),s=JsDiff.diffWords(p,o),r=b("<div/>",{"class":"contentDiffCopy"}),n=b("<div/>",{"class":"contentDiffCopy"});
b.each(s,function(u,v){if(!v.added){r.append(v.removed?b("<span/>",{"class":"contentDiffRemoved",text:v.value}):v.value)
}});
b.each(s,function(u,v){if(!v.removed){n.append(v.added?b("<span/>",{"class":"contentDiffAdded",text:v.value}):v.value)
}});
q.addClass("contentDiffText");
q.before(r);
t.addClass("contentDiffText");
t.before(n)
});
h.append(k);
h.append(l);
m.prepend(h);
m.trigger(i.is(".contentDiffCurrent")?"contentDiff-sideBySide":"contentDiff-edit")
});
e.onCreate(".searchAdvancedResult",function(){var g=b(this);
g.on("change",":checkbox",function(){g.find(".actions .action").each(function(){var i=b(this),h=i.text();
if(g.find(":checkbox:checked").length>0){i.text(h.replace("All","Selected"))
}else{i.text(h.replace("Selected","All"))
}})
})
});
e.delegate(".exception > *","click",function(){b(this).find("> .stackTrace").toggle()
});
(function(){var h=/<[^>]*>/g,g=/^\s+|\s+$/g,i=/\s+/;
e.delegate(".inputSmall-text :text, .inputSmall-text textarea","change.wordCount focus.wordCount input.wordCount",function(){var q=b(this),m=+q.attr("data-suggested-minimum"),o=+q.attr("data-suggested-maximum"),n=q.closest(".inputContainer"),j=n.find(".rte-toolbar").eq(0),l=(q.val()||"").replace(h,"").replace(g,""),p=l.length,k=l?l.split(i).length:0;
if(j.length>0){n=j
}e.find(".wordCount").removeClass("wordCount");
n.addClass("wordCount");
n.attr("data-count-message",p<m?"Too Short":p>o?"Too Long":k+"w "+p+"c")
})
})();
(function(){var g=f.scrollTop();
f.scroll(b.throttle(100,function(){var h=f.scrollTop();
b(".leftNav, .withLeftNav > .main, .contentForm-aside").each(function(){var k=b(this),j=k.offset().top,l=k.data("initialElementTop"),p,n,m;
if(!l){l=j;
k.data("initialElementTop",l);
k.css({position:"relative",top:0})
}p=f.height();
n=k.outerHeight();
m=function(){k.stop(true);
k.animate({top:Math.max(h,0)},"fast")
};
if(l+n<p){m()
}else{if(g<h){var i=h+p;
var o=j+n;
if(i>o){k.stop(true);
k.animate({top:Math.min(i,b("body").height())-n-l},"fast")
}}else{if(g>h){if(j>h+l){m()
}}}}});
g=h
}))
})();
e.delegate(":input","focus",function(){var g=b(this).parentsUntil("form");
g.addClass("state-focus");
f.bind("scroll.focus",b.run(b.throttle(100,function(){var h=b(".focusLabel"),k="",j,l,m,i;
for(j=g.length-1;
j>=0;
--j){l=b(g[j]);
if(l.offset().top>f.scrollTop()+100){if(k){if(h.length===0){h=b("<div/>",{"class":"focusLabel"});
b(c.body).append(h)
}m=l.position();
h.text(k);
h.show();
return
}else{break
}}i=l.find("> .inputLabel").text();
if(i){if(k){k+=" \u2192 "
}k+=i
}}h.hide()
})))
});
e.delegate(":input","blur",function(){var g=b(".focusLabel");
g.hide();
b(this).parents(".state-focus").removeClass("state-focus");
f.unbind(".state-focus")
});
(function(){var g;
e.bind("dragenter",function(){var i,h;
if(g){return
}g=true;
i=b(c.body);
h=b("<div/>",{"class":"uploadableCover",css:{left:0,height:"100%",position:"fixed",top:0,width:"100%","z-index":1999999}});
h.bind("dragenter dragover",function(j){j.stopPropagation();
j.preventDefault();
return false
});
h.bind("dragleave",function(){g=false;
h.remove();
b(".uploadableDrop").remove();
b(".uploadableFile").remove()
});
h.bind("drop",function(j){j.preventDefault();
h.trigger("dragleave");
return false
});
i.append(h);
b(".inputContainer .action-upload, .uploadable .uploadableLink").each(function(){var m=b(this),p=m.closest(".inputContainer, .uploadable"),k,n,j,o,l;
k=b.extend(p.offset(),{height:p.outerHeight(),position:"absolute",width:p.outerWidth()});
n=b("<div/>",{"class":"uploadableDrop",css:k});
j=m.clone();
j.text("Drop Files Here");
o=b("<div/>",{"class":"uploadableFile",css:b.extend(k,{"z-index":2000000})});
l=b("<input/>",{type:"file",multiple:"multiple"});
l.one("change",function(){var r=j.offset(),s,q;
h.hide();
j.click();
o.hide();
s=b('.frame[name="'+j.attr("target")+'"]');
s.popup("source",m,{pageX:r.left+j.outerWidth()/2,pageY:r.top+j.outerHeight()});
s.popup("container").bind("close",function(){h.trigger("dragleave")
});
q=function(){var t=s.find(":file");
if(t.length!==1){setTimeout(q,20)
}else{b.each(["class","id","name","style"],function(v,u){l.attr(u,t.attr(u)||"")
});
t.after(l);
t.remove();
t=l;
t.change()
}};
q()
});
n.append(j);
i.append(n);
o.append(l);
i.append(o)
})
})
})();
e.on("click",'button[name="action-delete"], :submit[name="action-delete"]',function(){return confirm("Are you sure you want to permanently delete this item?")
});
e.on("click",'button[name="action-trash"], :submit[name="action-trash"]',function(){return confirm("Are you sure you want to trash this item?")
});
e.ready(function(){b(c.activeElement).focus()
});
e.ready(function(){b(this).trigger("create");
b(".toolNav .selected").each(function(){var g=b(this),j=g.find("> ul"),h=j.find("> .selected > a"),i;
if(h.length>0){i=g.find("> a");
i.text(i.text()+" \u2192 "+h.text())
}j.css("min-width",g.outerWidth())
});
b(".toolNav li.isNested > a").click(function(){return false
});
(function(){var g;
b(".toolSearch :text").bind("focus input",b.throttle(500,function(k){var j=b(this),h=j.closest("form"),i,l,m=j.val();
j.attr("autocomplete","off");
i=b('.frame[name="'+h.attr("target")+'"]');
if(i.length===0||(k.type==="focus"&&m&&i.find(".searchResultList .message-warning").length>0)){h.submit()
}else{i.popup("open");
l=i.find('.searchFilters :input[name="q"]');
if(m!==l.val()){l.val(m).trigger("input")
}}}))
}());
b(".contentForm .repeatableForm").delegate(":input, textarea","change input",b.throttle(1000,function(){var h=b(this).closest("li"),g="_="+(+new Date()),i;
h.find(":input:not([disabled])").each(function(){var j=b(this);
g+="&"+encodeURIComponent(j.attr("name"))+"="+encodeURIComponent(j.val())
});
if(h.data("repeatableLabels-lastInputs")!==g){h.data("repeatableLabels-lastInputs",g);
i=h.find('> :hidden[name$=".id"]').val();
g+="&id="+i;
g+="&typeId="+h.find('> :hidden[name$=".typeId"]').val();
b.ajax({data:g,type:"post",url:CONTEXT_PATH+"content/repeatableLabels.jsp",complete:function(j){h.find("> .inputLabel").text(h.attr("data-type")+": "+b.parseJSON(j.responseText)[i])
}})
}}));
b(".widget-publishing").each(function(){var k=b(this),h=k.find(".dateInput"),j=k.find('[name="action-publish"]'),i=j.text(),g=h.val();
if(h.length===0){j.addClass("schedule");
j.text("Schedule")
}else{h.change(b.run(function(){if(h.val()){j.addClass("schedule");
j.text(g?"Reschedule":"Schedule")
}else{j.removeClass("schedule");
j.text(i)
}}))
}k.closest(".contentForm-aside").each(function(){var l=b(this),m=l.offset().top;
f.resize(b.throttle(100,b.run(function(){k.css({left:l.offset().left,position:"fixed",top:m,width:k.width()});
l.css("padding-top",k.outerHeight(true))
})))
})
})
})
}(jQuery,window));